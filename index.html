<!DOCTYPE html>
<html data-init="no-js">
<head>
<meta charset="UTF-8" />
<title>未命名故事</title>
<meta name="viewport" content="width=device-width,initial-scale=1" />
<!--

SugarCube (v2.36.1): A free (gratis and libre) story format.

Copyright © 2013–2021 Thomas Michael Edwards <thomasmedwards@gmail.com>.
All rights reserved.

Redistribution and use in source and binary forms, with or without
modification, are permitted provided that the following conditions are met:

1. Redistributions of source code must retain the above copyright notice, this
   list of conditions and the following disclaimer.
2. Redistributions in binary form must reproduce the above copyright notice,
   this list of conditions and the following disclaimer in the documentation
   and/or other materials provided with the distribution.

THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND
ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED
WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE LIABLE FOR
ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES
(INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;
LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND
ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
(INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.

-->
<script id="script-libraries" type="text/javascript">
if(document.head&&document.addEventListener&&document.querySelector&&Object.create&&Object.freeze&&JSON){document.documentElement.setAttribute("data-init", "loading");
/*! @source http://purl.eligrey.com/github/classList.js/blob/1.2.20171210/classList.js */
"document"in self&&("classList"in document.createElement("_")&&(!document.createElementNS||"classList"in document.createElementNS("http://www.w3.org/2000/svg","g"))||!function(t){"use strict";if("Element"in t){var e="classList",n="prototype",i=t.Element[n],s=Object,r=String[n].trim||function(){return this.replace(/^\s+|\s+$/g,"")},o=Array[n].indexOf||function(t){for(var e=0,n=this.length;n>e;e++)if(e in this&&this[e]===t)return e;return-1},c=function(t,e){this.name=t,this.code=DOMException[t],this.message=e},a=function(t,e){if(""===e)throw new c("SYNTAX_ERR","The token must not be empty.");if(/\s/.test(e))throw new c("INVALID_CHARACTER_ERR","The token must not contain space characters.");return o.call(t,e)},l=function(t){for(var e=r.call(t.getAttribute("class")||""),n=e?e.split(/\s+/):[],i=0,s=n.length;s>i;i++)this.push(n[i]);this._updateClassName=function(){t.setAttribute("class",this.toString())}},u=l[n]=[],h=function(){return new l(this)};if(c[n]=Error[n],u.item=function(t){return this[t]||null},u.contains=function(t){return~a(this,t+"")},u.add=function(){var t,e=arguments,n=0,i=e.length,s=!1;do t=e[n]+"",~a(this,t)||(this.push(t),s=!0);while(++n<i);s&&this._updateClassName()},u.remove=function(){var t,e,n=arguments,i=0,s=n.length,r=!1;do for(t=n[i]+"",e=a(this,t);~e;)this.splice(e,1),r=!0,e=a(this,t);while(++i<s);r&&this._updateClassName()},u.toggle=function(t,e){var n=this.contains(t),i=n?e!==!0&&"remove":e!==!1&&"add";return i&&this[i](t),e===!0||e===!1?e:!n},u.replace=function(t,e){var n=a(t+"");~n&&(this.splice(n,1,e),this._updateClassName())},u.toString=function(){return this.join(" ")},s.defineProperty){var f={get:h,enumerable:!0,configurable:!0};try{s.defineProperty(i,e,f)}catch(p){void 0!==p.number&&-2146823252!==p.number||(f.enumerable=!1,s.defineProperty(i,e,f))}}else s[n].__defineGetter__&&i.__defineGetter__(e,h)}}(self),function(){"use strict";var t=document.createElement("_");if(t.classList.add("c1","c2"),!t.classList.contains("c2")){var e=function(t){var e=DOMTokenList.prototype[t];DOMTokenList.prototype[t]=function(t){var n,i=arguments.length;for(n=0;i>n;n++)t=arguments[n],e.call(this,t)}};e("add"),e("remove")}if(t.classList.toggle("c3",!1),t.classList.contains("c3")){var n=DOMTokenList.prototype.toggle;DOMTokenList.prototype.toggle=function(t,e){return 1 in arguments&&!this.contains(t)==!e?e:n.call(this,t)}}"replace"in document.createElement("_").classList||(DOMTokenList.prototype.replace=function(t,e){var n=this.toString().split(" "),i=n.indexOf(t+"");~i&&(n=n.slice(i),this.remove.apply(this,n),this.add(e),this.add.apply(this,n.slice(1)))}),t=null}());
/*!
 * https://github.com/es-shims/es5-shim
 * @license es5-shim Copyright 2009-2020 by contributors, MIT License
 * see https://github.com/es-shims/es5-shim/blob/v4.5.14/LICENSE
 */
(function(t,r){"use strict";if(typeof define==="function"&&define.amd){define(r)}else if(typeof exports==="object"){module.exports=r()}else{t.returnExports=r()}})(this,function(){var t=Array;var r=t.prototype;var e=Object;var n=e.prototype;var i=Function;var a=i.prototype;var o=String;var f=o.prototype;var u=Number;var l=u.prototype;var s=r.slice;var c=r.splice;var v=r.push;var h=r.unshift;var p=r.concat;var y=r.join;var d=a.call;var g=a.apply;var w=Math.max;var b=Math.min;var T=n.toString;var m=typeof Symbol==="function"&&typeof Symbol.toStringTag==="symbol";var D;var S=Function.prototype.toString,x=/^\s*class /,O=function isES6ClassFn(t){try{var r=S.call(t);var e=r.replace(/\/\/.*\n/g,"");var n=e.replace(/\/\*[.\s\S]*\*\//g,"");var i=n.replace(/\n/gm," ").replace(/ {2}/g," ");return x.test(i)}catch(a){return false}},E=function tryFunctionObject(t){try{if(O(t)){return false}S.call(t);return true}catch(r){return false}},j="[object Function]",I="[object GeneratorFunction]",D=function isCallable(t){if(!t){return false}if(typeof t!=="function"&&typeof t!=="object"){return false}if(m){return E(t)}if(O(t)){return false}var r=T.call(t);return r===j||r===I};var M;var U=RegExp.prototype.exec,$=function tryRegexExec(t){try{U.call(t);return true}catch(r){return false}},F="[object RegExp]";M=function isRegex(t){if(typeof t!=="object"){return false}return m?$(t):T.call(t)===F};var N;var C=String.prototype.valueOf,k=function tryStringObject(t){try{C.call(t);return true}catch(r){return false}},A="[object String]";N=function isString(t){if(typeof t==="string"){return true}if(typeof t!=="object"){return false}return m?k(t):T.call(t)===A};var R=e.defineProperty&&function(){try{var t={};e.defineProperty(t,"x",{enumerable:false,value:t});for(var r in t){return false}return t.x===t}catch(n){return false}}();var P=function(t){var r;if(R){r=function(t,r,n,i){if(!i&&r in t){return}e.defineProperty(t,r,{configurable:true,enumerable:false,writable:true,value:n})}}else{r=function(t,r,e,n){if(!n&&r in t){return}t[r]=e}}return function defineProperties(e,n,i){for(var a in n){if(t.call(n,a)){r(e,a,n[a],i)}}}}(n.hasOwnProperty);var J=function isPrimitive(t){var r=typeof t;return t===null||r!=="object"&&r!=="function"};var Y=u.isNaN||function isActualNaN(t){return t!==t};var z={ToInteger:function ToInteger(t){var r=+t;if(Y(r)){r=0}else if(r!==0&&r!==1/0&&r!==-(1/0)){r=(r>0||-1)*Math.floor(Math.abs(r))}return r},ToPrimitive:function ToPrimitive(t){var r,e,n;if(J(t)){return t}e=t.valueOf;if(D(e)){r=e.call(t);if(J(r)){return r}}n=t.toString;if(D(n)){r=n.call(t);if(J(r)){return r}}throw new TypeError},ToObject:function(t){if(t==null){throw new TypeError("can't convert "+t+" to object")}return e(t)},ToUint32:function ToUint32(t){return t>>>0}};var Z=function Empty(){};P(a,{bind:function bind(t){var r=this;if(!D(r)){throw new TypeError("Function.prototype.bind called on incompatible "+r)}var n=s.call(arguments,1);var a;var o=function(){if(this instanceof a){var i=g.call(r,this,p.call(n,s.call(arguments)));if(e(i)===i){return i}return this}else{return g.call(r,t,p.call(n,s.call(arguments)))}};var f=w(0,r.length-n.length);var u=[];for(var l=0;l<f;l++){v.call(u,"$"+l)}a=i("binder","return function ("+y.call(u,",")+"){ return binder.apply(this, arguments); }")(o);if(r.prototype){Z.prototype=r.prototype;a.prototype=new Z;Z.prototype=null}return a}});var G=d.bind(n.hasOwnProperty);var H=d.bind(n.toString);var W=d.bind(s);var B=g.bind(s);if(typeof document==="object"&&document&&document.documentElement){try{W(document.documentElement.childNodes)}catch(X){var L=W;var q=B;W=function arraySliceIE(t){var r=[];var e=t.length;while(e-- >0){r[e]=t[e]}return q(r,L(arguments,1))};B=function arraySliceApplyIE(t,r){return q(W(t),r)}}}var K=d.bind(f.slice);var Q=d.bind(f.split);var V=d.bind(f.indexOf);var _=d.bind(v);var tt=d.bind(n.propertyIsEnumerable);var rt=d.bind(r.sort);var et=t.isArray||function isArray(t){return H(t)==="[object Array]"};var nt=[].unshift(0)!==1;P(r,{unshift:function(){h.apply(this,arguments);return this.length}},nt);P(t,{isArray:et});var it=e("a");var at=it[0]!=="a"||!(0 in it);var ot=function properlyBoxed(t){var r=true;var e=true;var n=false;if(t){try{t.call("foo",function(t,e,n){if(typeof n!=="object"){r=false}});t.call([1],function(){"use strict";e=typeof this==="string"},"x")}catch(i){n=true}}return!!t&&!n&&r&&e};P(r,{forEach:function forEach(t){var r=z.ToObject(this);var e=at&&N(this)?Q(this,""):r;var n=-1;var i=z.ToUint32(e.length);var a;if(arguments.length>1){a=arguments[1]}if(!D(t)){throw new TypeError("Array.prototype.forEach callback must be a function")}while(++n<i){if(n in e){if(typeof a==="undefined"){t(e[n],n,r)}else{t.call(a,e[n],n,r)}}}}},!ot(r.forEach));P(r,{map:function map(r){var e=z.ToObject(this);var n=at&&N(this)?Q(this,""):e;var i=z.ToUint32(n.length);var a=t(i);var o;if(arguments.length>1){o=arguments[1]}if(!D(r)){throw new TypeError("Array.prototype.map callback must be a function")}for(var f=0;f<i;f++){if(f in n){if(typeof o==="undefined"){a[f]=r(n[f],f,e)}else{a[f]=r.call(o,n[f],f,e)}}}return a}},!ot(r.map));P(r,{filter:function filter(t){var r=z.ToObject(this);var e=at&&N(this)?Q(this,""):r;var n=z.ToUint32(e.length);var i=[];var a;var o;if(arguments.length>1){o=arguments[1]}if(!D(t)){throw new TypeError("Array.prototype.filter callback must be a function")}for(var f=0;f<n;f++){if(f in e){a=e[f];if(typeof o==="undefined"?t(a,f,r):t.call(o,a,f,r)){_(i,a)}}}return i}},!ot(r.filter));P(r,{every:function every(t){var r=z.ToObject(this);var e=at&&N(this)?Q(this,""):r;var n=z.ToUint32(e.length);var i;if(arguments.length>1){i=arguments[1]}if(!D(t)){throw new TypeError("Array.prototype.every callback must be a function")}for(var a=0;a<n;a++){if(a in e&&!(typeof i==="undefined"?t(e[a],a,r):t.call(i,e[a],a,r))){return false}}return true}},!ot(r.every));P(r,{some:function some(t){var r=z.ToObject(this);var e=at&&N(this)?Q(this,""):r;var n=z.ToUint32(e.length);var i;if(arguments.length>1){i=arguments[1]}if(!D(t)){throw new TypeError("Array.prototype.some callback must be a function")}for(var a=0;a<n;a++){if(a in e&&(typeof i==="undefined"?t(e[a],a,r):t.call(i,e[a],a,r))){return true}}return false}},!ot(r.some));var ft=false;if(r.reduce){ft=typeof r.reduce.call("es5",function(t,r,e,n){return n})==="object"}P(r,{reduce:function reduce(t){var r=z.ToObject(this);var e=at&&N(this)?Q(this,""):r;var n=z.ToUint32(e.length);if(!D(t)){throw new TypeError("Array.prototype.reduce callback must be a function")}if(n===0&&arguments.length===1){throw new TypeError("reduce of empty array with no initial value")}var i=0;var a;if(arguments.length>=2){a=arguments[1]}else{do{if(i in e){a=e[i++];break}if(++i>=n){throw new TypeError("reduce of empty array with no initial value")}}while(true)}for(;i<n;i++){if(i in e){a=t(a,e[i],i,r)}}return a}},!ft);var ut=false;if(r.reduceRight){ut=typeof r.reduceRight.call("es5",function(t,r,e,n){return n})==="object"}P(r,{reduceRight:function reduceRight(t){var r=z.ToObject(this);var e=at&&N(this)?Q(this,""):r;var n=z.ToUint32(e.length);if(!D(t)){throw new TypeError("Array.prototype.reduceRight callback must be a function")}if(n===0&&arguments.length===1){throw new TypeError("reduceRight of empty array with no initial value")}var i;var a=n-1;if(arguments.length>=2){i=arguments[1]}else{do{if(a in e){i=e[a--];break}if(--a<0){throw new TypeError("reduceRight of empty array with no initial value")}}while(true)}if(a<0){return i}do{if(a in e){i=t(i,e[a],a,r)}}while(a--);return i}},!ut);var lt=r.indexOf&&[0,1].indexOf(1,2)!==-1;P(r,{indexOf:function indexOf(t){var r=at&&N(this)?Q(this,""):z.ToObject(this);var e=z.ToUint32(r.length);if(e===0){return-1}var n=0;if(arguments.length>1){n=z.ToInteger(arguments[1])}n=n>=0?n:w(0,e+n);for(;n<e;n++){if(n in r&&r[n]===t){return n}}return-1}},lt);var st=r.lastIndexOf&&[0,1].lastIndexOf(0,-3)!==-1;P(r,{lastIndexOf:function lastIndexOf(t){var r=at&&N(this)?Q(this,""):z.ToObject(this);var e=z.ToUint32(r.length);if(e===0){return-1}var n=e-1;if(arguments.length>1){n=b(n,z.ToInteger(arguments[1]))}n=n>=0?n:e-Math.abs(n);for(;n>=0;n--){if(n in r&&t===r[n]){return n}}return-1}},st);var ct=function(){var t=[1,2];var r=t.splice();return t.length===2&&et(r)&&r.length===0}();P(r,{splice:function splice(t,r){if(arguments.length===0){return[]}else{return c.apply(this,arguments)}}},!ct);var vt=function(){var t={};r.splice.call(t,0,0,1);return t.length===1}();P(r,{splice:function splice(t,r){if(arguments.length===0){return[]}var e=arguments;this.length=w(z.ToInteger(this.length),0);if(arguments.length>0&&typeof r!=="number"){e=W(arguments);if(e.length<2){_(e,this.length-t)}else{e[1]=z.ToInteger(r)}}return c.apply(this,e)}},!vt);var ht=function(){var r=new t(1e5);r[8]="x";r.splice(1,1);return r.indexOf("x")===7}();var pt=function(){var t=256;var r=[];r[t]="a";r.splice(t+1,0,"b");return r[t]==="a"}();P(r,{splice:function splice(t,r){var e=z.ToObject(this);var n=[];var i=z.ToUint32(e.length);var a=z.ToInteger(t);var f=a<0?w(i+a,0):b(a,i);var u=arguments.length===0?0:arguments.length===1?i-f:b(w(z.ToInteger(r),0),i-f);var l=0;var s;while(l<u){s=o(f+l);if(G(e,s)){n[l]=e[s]}l+=1}var c=W(arguments,2);var v=c.length;var h;if(v<u){l=f;var p=i-u;while(l<p){s=o(l+u);h=o(l+v);if(G(e,s)){e[h]=e[s]}else{delete e[h]}l+=1}l=i;var y=i-u+v;while(l>y){delete e[l-1];l-=1}}else if(v>u){l=i-u;while(l>f){s=o(l+u-1);h=o(l+v-1);if(G(e,s)){e[h]=e[s]}else{delete e[h]}l-=1}}l=f;for(var d=0;d<c.length;++d){e[l]=c[d];l+=1}e.length=i-u+v;return n}},!ht||!pt);var yt=r.join;var dt;try{dt=Array.prototype.join.call("123",",")!=="1,2,3"}catch(X){dt=true}if(dt){P(r,{join:function join(t){var r=typeof t==="undefined"?",":t;return yt.call(N(this)?Q(this,""):this,r)}},dt)}var gt=[1,2].join(undefined)!=="1,2";if(gt){P(r,{join:function join(t){var r=typeof t==="undefined"?",":t;return yt.call(this,r)}},gt)}var wt=function push(t){var r=z.ToObject(this);var e=z.ToUint32(r.length);var n=0;while(n<arguments.length){r[e+n]=arguments[n];n+=1}r.length=e+n;return e+n};var bt=function(){var t={};var r=Array.prototype.push.call(t,undefined);return r!==1||t.length!==1||typeof t[0]!=="undefined"||!G(t,0)}();P(r,{push:function push(t){if(et(this)){return v.apply(this,arguments)}return wt.apply(this,arguments)}},bt);var Tt=function(){var t=[];var r=t.push(undefined);return r!==1||t.length!==1||typeof t[0]!=="undefined"||!G(t,0)}();P(r,{push:wt},Tt);P(r,{slice:function(t,r){var e=N(this)?Q(this,""):this;return B(e,arguments)}},at);var mt=function(){try{[1,2].sort(null)}catch(t){try{[1,2].sort({})}catch(r){return false}}return true}();var Dt=function(){try{[1,2].sort(/a/);return false}catch(t){}return true}();var St=function(){try{[1,2].sort(undefined);return true}catch(t){}return false}();P(r,{sort:function sort(t){if(typeof t==="undefined"){return rt(this)}if(!D(t)){throw new TypeError("Array.prototype.sort callback must be a function")}return rt(this,t)}},mt||!St||!Dt);var xt=!tt({toString:null},"toString");var Ot=tt(function(){},"prototype");var Et=!G("x","0");var jt=function(t){var r=t.constructor;return r&&r.prototype===t};var It={$applicationCache:true,$console:true,$external:true,$frame:true,$frameElement:true,$frames:true,$innerHeight:true,$innerWidth:true,$onmozfullscreenchange:true,$onmozfullscreenerror:true,$outerHeight:true,$outerWidth:true,$pageXOffset:true,$pageYOffset:true,$parent:true,$scrollLeft:true,$scrollTop:true,$scrollX:true,$scrollY:true,$self:true,$webkitIndexedDB:true,$webkitStorageInfo:true,$window:true,$width:true,$height:true,$top:true,$localStorage:true};var Mt=function(){if(typeof window==="undefined"){return false}for(var t in window){try{if(!It["$"+t]&&G(window,t)&&window[t]!==null&&typeof window[t]==="object"){jt(window[t])}}catch(r){return true}}return false}();var Ut=function(t){if(typeof window==="undefined"||!Mt){return jt(t)}try{return jt(t)}catch(r){return false}};var $t=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"];var Ft=$t.length;var Nt=function isArguments(t){return H(t)==="[object Arguments]"};var Ct=function isArguments(t){return t!==null&&typeof t==="object"&&typeof t.length==="number"&&t.length>=0&&!et(t)&&D(t.callee)};var kt=Nt(arguments)?Nt:Ct;P(e,{keys:function keys(t){var r=D(t);var e=kt(t);var n=t!==null&&typeof t==="object";var i=n&&N(t);if(!n&&!r&&!e){throw new TypeError("Object.keys called on a non-object")}var a=[];var f=Ot&&r;if(i&&Et||e){for(var u=0;u<t.length;++u){_(a,o(u))}}if(!e){for(var l in t){if(!(f&&l==="prototype")&&G(t,l)){_(a,o(l))}}}if(xt){var s=Ut(t);for(var c=0;c<Ft;c++){var v=$t[c];if(!(s&&v==="constructor")&&G(t,v)){_(a,v)}}}return a}});var At=e.keys&&function(){return e.keys(arguments).length===2}(1,2);var Rt=e.keys&&function(){var t=e.keys(arguments);return arguments.length!==1||t.length!==1||t[0]!==1}(1);var Pt=e.keys;P(e,{keys:function keys(t){if(kt(t)){return Pt(W(t))}else{return Pt(t)}}},!At||Rt);var Jt=new Date(-0xc782b5b342b24).getUTCMonth()!==0;var Yt=new Date(-0x55d318d56a724);var zt=new Date(14496624e5);var Zt=Yt.toUTCString()!=="Mon, 01 Jan -45875 11:59:59 GMT";var Gt;var Ht;var Wt=Yt.getTimezoneOffset();if(Wt<-720){Gt=Yt.toDateString()!=="Tue Jan 02 -45875";Ht=!/^Thu Dec 10 2015 \d\d:\d\d:\d\d GMT[-+]\d\d\d\d(?: |$)/.test(String(zt))}else{Gt=Yt.toDateString()!=="Mon Jan 01 -45875";Ht=!/^Wed Dec 09 2015 \d\d:\d\d:\d\d GMT[-+]\d\d\d\d(?: |$)/.test(String(zt))}var Bt=d.bind(Date.prototype.getFullYear);var Xt=d.bind(Date.prototype.getMonth);var Lt=d.bind(Date.prototype.getDate);var qt=d.bind(Date.prototype.getUTCFullYear);var Kt=d.bind(Date.prototype.getUTCMonth);var Qt=d.bind(Date.prototype.getUTCDate);var Vt=d.bind(Date.prototype.getUTCDay);var _t=d.bind(Date.prototype.getUTCHours);var tr=d.bind(Date.prototype.getUTCMinutes);var rr=d.bind(Date.prototype.getUTCSeconds);var er=d.bind(Date.prototype.getUTCMilliseconds);var nr=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"];var ir=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];var ar=function daysInMonth(t,r){return Lt(new Date(r,t,0))};P(Date.prototype,{getFullYear:function getFullYear(){if(!this||!(this instanceof Date)){throw new TypeError("this is not a Date object.")}var t=Bt(this);if(t<0&&Xt(this)>11){return t+1}return t},getMonth:function getMonth(){if(!this||!(this instanceof Date)){throw new TypeError("this is not a Date object.")}var t=Bt(this);var r=Xt(this);if(t<0&&r>11){return 0}return r},getDate:function getDate(){if(!this||!(this instanceof Date)){throw new TypeError("this is not a Date object.")}var t=Bt(this);var r=Xt(this);var e=Lt(this);if(t<0&&r>11){if(r===12){return e}var n=ar(0,t+1);return n-e+1}return e},getUTCFullYear:function getUTCFullYear(){if(!this||!(this instanceof Date)){throw new TypeError("this is not a Date object.")}var t=qt(this);if(t<0&&Kt(this)>11){return t+1}return t},getUTCMonth:function getUTCMonth(){if(!this||!(this instanceof Date)){throw new TypeError("this is not a Date object.")}var t=qt(this);var r=Kt(this);if(t<0&&r>11){return 0}return r},getUTCDate:function getUTCDate(){if(!this||!(this instanceof Date)){throw new TypeError("this is not a Date object.")}var t=qt(this);var r=Kt(this);var e=Qt(this);if(t<0&&r>11){if(r===12){return e}var n=ar(0,t+1);return n-e+1}return e}},Jt);P(Date.prototype,{toUTCString:function toUTCString(){if(!this||!(this instanceof Date)){throw new TypeError("this is not a Date object.")}var t=Vt(this);var r=Qt(this);var e=Kt(this);var n=qt(this);var i=_t(this);var a=tr(this);var o=rr(this);return nr[t]+", "+(r<10?"0"+r:r)+" "+ir[e]+" "+n+" "+(i<10?"0"+i:i)+":"+(a<10?"0"+a:a)+":"+(o<10?"0"+o:o)+" GMT"}},Jt||Zt);P(Date.prototype,{toDateString:function toDateString(){if(!this||!(this instanceof Date)){throw new TypeError("this is not a Date object.")}var t=this.getDay();var r=this.getDate();var e=this.getMonth();var n=this.getFullYear();return nr[t]+" "+ir[e]+" "+(r<10?"0"+r:r)+" "+n}},Jt||Gt);if(Jt||Ht){Date.prototype.toString=function toString(){if(!this||!(this instanceof Date)){throw new TypeError("this is not a Date object.")}var t=this.getDay();var r=this.getDate();var e=this.getMonth();var n=this.getFullYear();var i=this.getHours();var a=this.getMinutes();var o=this.getSeconds();var f=this.getTimezoneOffset();var u=Math.floor(Math.abs(f)/60);var l=Math.floor(Math.abs(f)%60);return nr[t]+" "+ir[e]+" "+(r<10?"0"+r:r)+" "+n+" "+(i<10?"0"+i:i)+":"+(a<10?"0"+a:a)+":"+(o<10?"0"+o:o)+" GMT"+(f>0?"-":"+")+(u<10?"0"+u:u)+(l<10?"0"+l:l)};if(R){e.defineProperty(Date.prototype,"toString",{configurable:true,enumerable:false,writable:true})}}var or=-621987552e5;var fr="-000001";var ur=Date.prototype.toISOString&&new Date(or).toISOString().indexOf(fr)===-1;var lr=Date.prototype.toISOString&&new Date(-1).toISOString()!=="1969-12-31T23:59:59.999Z";var sr=d.bind(Date.prototype.getTime);P(Date.prototype,{toISOString:function toISOString(){if(!isFinite(this)||!isFinite(sr(this))){throw new RangeError("Date.prototype.toISOString called on non-finite value.")}var t=qt(this);var r=Kt(this);t+=Math.floor(r/12);r=(r%12+12)%12;var e=[r+1,Qt(this),_t(this),tr(this),rr(this)];t=(t<0?"-":t>9999?"+":"")+K("00000"+Math.abs(t),0<=t&&t<=9999?-4:-6);for(var n=0;n<e.length;++n){e[n]=K("00"+e[n],-2)}return t+"-"+W(e,0,2).join("-")+"T"+W(e,2).join(":")+"."+K("000"+er(this),-3)+"Z"}},ur||lr);var cr=function(){try{return Date.prototype.toJSON&&new Date(NaN).toJSON()===null&&new Date(or).toJSON().indexOf(fr)!==-1&&Date.prototype.toJSON.call({toISOString:function(){return true}})}catch(t){return false}}();if(!cr){Date.prototype.toJSON=function toJSON(t){var r=e(this);var n=z.ToPrimitive(r);if(typeof n==="number"&&!isFinite(n)){return null}var i=r.toISOString;if(!D(i)){throw new TypeError("toISOString property is not callable")}return i.call(r)}}var vr=Date.parse("+033658-09-27T01:46:40.000Z")===1e15;var hr=!isNaN(Date.parse("2012-04-04T24:00:00.500Z"))||!isNaN(Date.parse("2012-11-31T23:59:59.000Z"))||!isNaN(Date.parse("2012-12-31T23:59:60.000Z"));var pr=isNaN(Date.parse("2000-01-01T00:00:00.000Z"));if(pr||hr||!vr){var yr=Math.pow(2,31)-1;var dr=Y(new Date(1970,0,1,0,0,0,yr+1).getTime());Date=function(t){var r=function Date(e,n,i,a,f,u,l){var s=arguments.length;var c;if(this instanceof t){var v=u;var h=l;if(dr&&s>=7&&l>yr){var p=Math.floor(l/yr)*yr;var y=Math.floor(p/1e3);v+=y;h-=y*1e3}c=s===1&&o(e)===e?new t(r.parse(e)):s>=7?new t(e,n,i,a,f,v,h):s>=6?new t(e,n,i,a,f,v):s>=5?new t(e,n,i,a,f):s>=4?new t(e,n,i,a):s>=3?new t(e,n,i):s>=2?new t(e,n):s>=1?new t(e instanceof t?+e:e):new t}else{c=t.apply(this,arguments)}if(!J(c)){P(c,{constructor:r},true)}return c};var e=new RegExp("^"+"(\\d{4}|[+-]\\d{6})"+"(?:-(\\d{2})"+"(?:-(\\d{2})"+"(?:"+"T(\\d{2})"+":(\\d{2})"+"(?:"+":(\\d{2})"+"(?:(\\.\\d{1,}))?"+")?"+"("+"Z|"+"(?:"+"([-+])"+"(\\d{2})"+":(\\d{2})"+")"+")?)?)?)?"+"$");var n=[0,31,59,90,120,151,181,212,243,273,304,334,365];var i=function dayFromMonth(t,r){var e=r>1?1:0;return n[r]+Math.floor((t-1969+e)/4)-Math.floor((t-1901+e)/100)+Math.floor((t-1601+e)/400)+365*(t-1970)};var a=function toUTC(r){var e=0;var n=r;if(dr&&n>yr){var i=Math.floor(n/yr)*yr;var a=Math.floor(i/1e3);e+=a;n-=a*1e3}return u(new t(1970,0,1,0,0,e,n))};for(var f in t){if(G(t,f)){r[f]=t[f]}}P(r,{now:t.now,UTC:t.UTC},true);r.prototype=t.prototype;P(r.prototype,{constructor:r},true);var l=function parse(r){var n=e.exec(r);if(n){var o=u(n[1]),f=u(n[2]||1)-1,l=u(n[3]||1)-1,s=u(n[4]||0),c=u(n[5]||0),v=u(n[6]||0),h=Math.floor(u(n[7]||0)*1e3),p=Boolean(n[4]&&!n[8]),y=n[9]==="-"?1:-1,d=u(n[10]||0),g=u(n[11]||0),w;var b=c>0||v>0||h>0;if(s<(b?24:25)&&c<60&&v<60&&h<1e3&&f>-1&&f<12&&d<24&&g<60&&l>-1&&l<i(o,f+1)-i(o,f)){w=((i(o,f)+l)*24+s+d*y)*60;w=((w+c+g*y)*60+v)*1e3+h;if(p){w=a(w)}if(-864e13<=w&&w<=864e13){return w}}return NaN}return t.parse.apply(this,arguments)};P(r,{parse:l});return r}(Date)}if(!Date.now){Date.now=function now(){return(new Date).getTime()}}var gr=l.toFixed&&(8e-5.toFixed(3)!=="0.000"||.9.toFixed(0)!=="1"||1.255.toFixed(2)!=="1.25"||(1000000000000000128).toFixed(0)!=="1000000000000000128");var wr={base:1e7,size:6,data:[0,0,0,0,0,0],multiply:function multiply(t,r){var e=-1;var n=r;while(++e<wr.size){n+=t*wr.data[e];wr.data[e]=n%wr.base;n=Math.floor(n/wr.base)}},divide:function divide(t){var r=wr.size;var e=0;while(--r>=0){e+=wr.data[r];wr.data[r]=Math.floor(e/t);e=e%t*wr.base}},numToString:function numToString(){var t=wr.size;var r="";while(--t>=0){if(r!==""||t===0||wr.data[t]!==0){var e=o(wr.data[t]);if(r===""){r=e}else{r+=K("0000000",0,7-e.length)+e}}}return r},pow:function pow(t,r,e){return r===0?e:r%2===1?pow(t,r-1,e*t):pow(t*t,r/2,e)},log:function log(t){var r=0;var e=t;while(e>=4096){r+=12;e/=4096}while(e>=2){r+=1;e/=2}return r}};var br=function toFixed(t){var r,e,n,i,a,f,l,s;r=u(t);r=Y(r)?0:Math.floor(r);if(r<0||r>20){throw new RangeError("Number.toFixed called with invalid number of decimals")}e=u(this);if(Y(e)){return"NaN"}if(e<=-1e21||e>=1e21){return o(e)}n="";if(e<0){n="-";e=-e}i="0";if(e>1e-21){a=wr.log(e*wr.pow(2,69,1))-69;f=a<0?e*wr.pow(2,-a,1):e/wr.pow(2,a,1);f*=4503599627370496;a=52-a;if(a>0){wr.multiply(0,f);l=r;while(l>=7){wr.multiply(1e7,0);l-=7}wr.multiply(wr.pow(10,l,1),0);l=a-1;while(l>=23){wr.divide(1<<23);l-=23}wr.divide(1<<l);wr.multiply(1,1);wr.divide(2);i=wr.numToString()}else{wr.multiply(0,f);wr.multiply(1<<-a,0);i=wr.numToString()+K("0.00000000000000000000",2,2+r)}}if(r>0){s=i.length;if(s<=r){i=n+K("0.0000000000000000000",0,r-s+2)+i}else{i=n+K(i,0,s-r)+"."+K(i,s-r)}}else{i=n+i}return i};P(l,{toFixed:br},gr);var Tr=function(){try{return 1..toPrecision(undefined)==="1"}catch(t){return true}}();var mr=l.toPrecision;P(l,{toPrecision:function toPrecision(t){return typeof t==="undefined"?mr.call(this):mr.call(this,t)}},Tr);if("ab".split(/(?:ab)*/).length!==2||".".split(/(.?)(.?)/).length!==4||"tesst".split(/(s)*/)[1]==="t"||"test".split(/(?:)/,-1).length!==4||"".split(/.?/).length||".".split(/()()/).length>1){(function(){var t=typeof/()??/.exec("")[1]==="undefined";var r=Math.pow(2,32)-1;f.split=function(e,n){var i=String(this);if(typeof e==="undefined"&&n===0){return[]}if(!M(e)){return Q(this,e,n)}var a=[];var o=(e.ignoreCase?"i":"")+(e.multiline?"m":"")+(e.unicode?"u":"")+(e.sticky?"y":""),f=0,u,l,s,c;var h=new RegExp(e.source,o+"g");if(!t){u=new RegExp("^"+h.source+"$(?!\\s)",o)}var p=typeof n==="undefined"?r:z.ToUint32(n);l=h.exec(i);while(l){s=l.index+l[0].length;if(s>f){_(a,K(i,f,l.index));if(!t&&l.length>1){l[0].replace(u,function(){for(var t=1;t<arguments.length-2;t++){if(typeof arguments[t]==="undefined"){l[t]=void 0}}})}if(l.length>1&&l.index<i.length){v.apply(a,W(l,1))}c=l[0].length;f=s;if(a.length>=p){break}}if(h.lastIndex===l.index){h.lastIndex++}l=h.exec(i)}if(f===i.length){if(c||!h.test("")){_(a,"")}}else{_(a,K(i,f))}return a.length>p?W(a,0,p):a}})()}else if("0".split(void 0,0).length){f.split=function split(t,r){if(typeof t==="undefined"&&r===0){return[]}return Q(this,t,r)}}var Dr=f.replace;var Sr=function(){var t=[];"x".replace(/x(.)?/g,function(r,e){_(t,e)});return t.length===1&&typeof t[0]==="undefined"}();if(!Sr){f.replace=function replace(t,r){var e=D(r);var n=M(t)&&/\)[*?]/.test(t.source);if(!e||!n){return Dr.call(this,t,r)}else{var i=function(e){var n=arguments.length;var i=t.lastIndex;t.lastIndex=0;var a=t.exec(e)||[];t.lastIndex=i;_(a,arguments[n-2],arguments[n-1]);return r.apply(this,a)};return Dr.call(this,t,i)}}}var xr=f.substr;var Or="".substr&&"0b".substr(-1)!=="b";P(f,{substr:function substr(t,r){var e=t;if(t<0){e=w(this.length+t,0)}return xr.call(this,e,r)}},Or);var Er="\t\n\x0B\f\r \xa0\u1680\u2000\u2001\u2002\u2003"+"\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028"+"\u2029\ufeff";var jr="\u200b";var Ir="["+Er+"]";var Mr=new RegExp("^"+Ir+Ir+"*");var Ur=new RegExp(Ir+Ir+"*$");var $r=f.trim&&(Er.trim()||!jr.trim());P(f,{trim:function trim(){if(typeof this==="undefined"||this===null){throw new TypeError("can't convert "+this+" to object")}return o(this).replace(Mr,"").replace(Ur,"")}},$r);var Fr=d.bind(String.prototype.trim);var Nr=f.lastIndexOf&&"abc\u3042\u3044".lastIndexOf("\u3042\u3044",2)!==-1;P(f,{lastIndexOf:function lastIndexOf(t){if(typeof this==="undefined"||this===null){throw new TypeError("can't convert "+this+" to object")}var r=o(this);var e=o(t);var n=arguments.length>1?u(arguments[1]):NaN;var i=Y(n)?Infinity:z.ToInteger(n);var a=b(w(i,0),r.length);var f=e.length;var l=a+f;while(l>0){l=w(0,l-f);var s=V(K(r,l,a+f),e);if(s!==-1){return l+s}}return-1}},Nr);var Cr=f.lastIndexOf;P(f,{lastIndexOf:function lastIndexOf(t){return Cr.apply(this,arguments)}},f.lastIndexOf.length!==1);if(parseInt(Er+"08")!==8||parseInt(Er+"0x16")!==22){parseInt=function(t){var r=/^[-+]?0[xX]/;return function parseInt(e,n){if(typeof e==="symbol"){""+e}var i=Fr(String(e));var a=u(n)||(r.test(i)?16:10);return t(i,a)}}(parseInt)}if(1/parseFloat("-0")!==-Infinity){parseFloat=function(t){return function parseFloat(r){var e=Fr(String(r));var n=t(e);return n===0&&K(e,0,1)==="-"?-0:n}}(parseFloat)}if(String(new RangeError("test"))!=="RangeError: test"){var kr=function toString(){if(typeof this==="undefined"||this===null){throw new TypeError("can't convert "+this+" to object")}var t=this.name;if(typeof t==="undefined"){t="Error"}else if(typeof t!=="string"){t=o(t)}var r=this.message;if(typeof r==="undefined"){r=""}else if(typeof r!=="string"){r=o(r)}if(!t){return r}if(!r){return t}return t+": "+r};Error.prototype.toString=kr}if(R){var Ar=function(t,r){if(tt(t,r)){var e=Object.getOwnPropertyDescriptor(t,r);if(e.configurable){e.enumerable=false;Object.defineProperty(t,r,e)}}};Ar(Error.prototype,"message");if(Error.prototype.message!==""){Error.prototype.message=""}Ar(Error.prototype,"name")}if(String(/a/gim)!=="/a/gim"){var Rr=function toString(){var t="/"+this.source+"/";if(this.global){t+="g"}if(this.ignoreCase){t+="i"}if(this.multiline){t+="m"}return t};RegExp.prototype.toString=Rr}});
/*!
 * https://github.com/paulmillr/es6-shim
 * @license es6-shim Copyright 2013-2016 by Paul Miller (http://paulmillr.com)
 *   and contributors,  MIT License
 * es6-shim: v0.35.4
 * see https://github.com/paulmillr/es6-shim/blob/0.35.4/LICENSE
 * Details and documentation:
 * https://github.com/paulmillr/es6-shim/
 */
(function(e,t){if(typeof define==="function"&&define.amd){define(t)}else if(typeof exports==="object"){module.exports=t()}else{e.returnExports=t()}})(this,function(){"use strict";var e=Function.call.bind(Function.apply);var t=Function.call.bind(Function.call);var r=Array.isArray;var n=Object.keys;var o=function notThunker(t){return function notThunk(){return!e(t,this,arguments)}};var i=function(e){try{e();return false}catch(t){return true}};var a=function valueOrFalseIfThrows(e){try{return e()}catch(t){return false}};var u=o(i);var f=function(){return!i(function(){return Object.defineProperty({},"x",{get:function(){}})})};var s=!!Object.defineProperty&&f();var c=function foo(){}.name==="foo";var l=Function.call.bind(Array.prototype.forEach);var p=Function.call.bind(Array.prototype.reduce);var v=Function.call.bind(Array.prototype.filter);var y=Function.call.bind(Array.prototype.some);var h=function(e,t,r,n){if(!n&&t in e){return}if(s){Object.defineProperty(e,t,{configurable:true,enumerable:false,writable:true,value:r})}else{e[t]=r}};var b=function(e,t,r){l(n(t),function(n){var o=t[n];h(e,n,o,!!r)})};var g=Function.call.bind(Object.prototype.toString);var d=typeof/abc/==="function"?function IsCallableSlow(e){return typeof e==="function"&&g(e)==="[object Function]"}:function IsCallableFast(e){return typeof e==="function"};var m={getter:function(e,t,r){if(!s){throw new TypeError("getters require true ES5 support")}Object.defineProperty(e,t,{configurable:true,enumerable:false,get:r})},proxy:function(e,t,r){if(!s){throw new TypeError("getters require true ES5 support")}var n=Object.getOwnPropertyDescriptor(e,t);Object.defineProperty(r,t,{configurable:n.configurable,enumerable:n.enumerable,get:function getKey(){return e[t]},set:function setKey(r){e[t]=r}})},redefine:function(e,t,r){if(s){var n=Object.getOwnPropertyDescriptor(e,t);n.value=r;Object.defineProperty(e,t,n)}else{e[t]=r}},defineByDescriptor:function(e,t,r){if(s){Object.defineProperty(e,t,r)}else if("value"in r){e[t]=r.value}},preserveToString:function(e,t){if(t&&d(t.toString)){h(e,"toString",t.toString.bind(t),true)}}};var O=Object.create||function(e,t){var r=function Prototype(){};r.prototype=e;var o=new r;if(typeof t!=="undefined"){n(t).forEach(function(e){m.defineByDescriptor(o,e,t[e])})}return o};var w=function(e,t){if(!Object.setPrototypeOf){return false}return a(function(){var r=function Subclass(t){var r=new e(t);Object.setPrototypeOf(r,Subclass.prototype);return r};Object.setPrototypeOf(r,e);r.prototype=O(e.prototype,{constructor:{value:r}});return t(r)})};var j=function(){if(typeof self!=="undefined"){return self}if(typeof window!=="undefined"){return window}if(typeof global!=="undefined"){return global}throw new Error("unable to locate global object")};var S=j();var T=S.isFinite;var I=Function.call.bind(String.prototype.indexOf);var E=Function.apply.bind(Array.prototype.indexOf);var P=Function.call.bind(Array.prototype.concat);var C=Function.call.bind(String.prototype.slice);var M=Function.call.bind(Array.prototype.push);var x=Function.apply.bind(Array.prototype.push);var N=Function.call.bind(Array.prototype.shift);var A=Math.max;var R=Math.min;var _=Math.floor;var k=Math.abs;var L=Math.exp;var F=Math.log;var D=Math.sqrt;var z=Function.call.bind(Object.prototype.hasOwnProperty);var q;var W=function(){};var G=S.Map;var H=G&&G.prototype["delete"];var V=G&&G.prototype.get;var B=G&&G.prototype.has;var U=G&&G.prototype.set;var $=S.Symbol||{};var J=$.species||"@@species";var X=Number.isNaN||function isNaN(e){return e!==e};var K=Number.isFinite||function isFinite(e){return typeof e==="number"&&T(e)};var Z=d(Math.sign)?Math.sign:function sign(e){var t=Number(e);if(t===0){return t}if(X(t)){return t}return t<0?-1:1};var Y=function log1p(e){var t=Number(e);if(t<-1||X(t)){return NaN}if(t===0||t===Infinity){return t}if(t===-1){return-Infinity}return 1+t-1===0?t:t*(F(1+t)/(1+t-1))};var Q=function isArguments(e){return g(e)==="[object Arguments]"};var ee=function isArguments(e){return e!==null&&typeof e==="object"&&typeof e.length==="number"&&e.length>=0&&g(e)!=="[object Array]"&&g(e.callee)==="[object Function]"};var te=Q(arguments)?Q:ee;var re={primitive:function(e){return e===null||typeof e!=="function"&&typeof e!=="object"},string:function(e){return g(e)==="[object String]"},regex:function(e){return g(e)==="[object RegExp]"},symbol:function(e){return typeof S.Symbol==="function"&&typeof e==="symbol"}};var ne=function overrideNative(e,t,r){var n=e[t];h(e,t,r,true);m.preserveToString(e[t],n)};var oe=typeof $==="function"&&typeof $["for"]==="function"&&re.symbol($());var ie=re.symbol($.iterator)?$.iterator:"_es6-shim iterator_";if(S.Set&&typeof(new S.Set)["@@iterator"]==="function"){ie="@@iterator"}if(!S.Reflect){h(S,"Reflect",{},true)}var ae=S.Reflect;var ue=String;var fe=typeof document==="undefined"||!document?null:document.all;var se=fe==null?function isNullOrUndefined(e){return e==null}:function isNullOrUndefinedAndNotDocumentAll(e){return e==null&&e!==fe};var ce={Call:function Call(t,r){var n=arguments.length>2?arguments[2]:[];if(!ce.IsCallable(t)){throw new TypeError(t+" is not a function")}return e(t,r,n)},RequireObjectCoercible:function(e,t){if(se(e)){throw new TypeError(t||"Cannot call method on "+e)}return e},TypeIsObject:function(e){if(e===void 0||e===null||e===true||e===false){return false}return typeof e==="function"||typeof e==="object"||e===fe},ToObject:function(e,t){return Object(ce.RequireObjectCoercible(e,t))},IsCallable:d,IsConstructor:function(e){return ce.IsCallable(e)},ToInt32:function(e){return ce.ToNumber(e)>>0},ToUint32:function(e){return ce.ToNumber(e)>>>0},ToNumber:function(e){if(g(e)==="[object Symbol]"){throw new TypeError("Cannot convert a Symbol value to a number")}return+e},ToInteger:function(e){var t=ce.ToNumber(e);if(X(t)){return 0}if(t===0||!K(t)){return t}return(t>0?1:-1)*_(k(t))},ToLength:function(e){var t=ce.ToInteger(e);if(t<=0){return 0}if(t>Number.MAX_SAFE_INTEGER){return Number.MAX_SAFE_INTEGER}return t},SameValue:function(e,t){if(e===t){if(e===0){return 1/e===1/t}return true}return X(e)&&X(t)},SameValueZero:function(e,t){return e===t||X(e)&&X(t)},IsIterable:function(e){return ce.TypeIsObject(e)&&(typeof e[ie]!=="undefined"||te(e))},GetIterator:function(e){if(te(e)){return new q(e,"value")}var t=ce.GetMethod(e,ie);if(!ce.IsCallable(t)){throw new TypeError("value is not an iterable")}var r=ce.Call(t,e);if(!ce.TypeIsObject(r)){throw new TypeError("bad iterator")}return r},GetMethod:function(e,t){var r=ce.ToObject(e)[t];if(se(r)){return void 0}if(!ce.IsCallable(r)){throw new TypeError("Method not callable: "+t)}return r},IteratorComplete:function(e){return!!e.done},IteratorClose:function(e,t){var r=ce.GetMethod(e,"return");if(r===void 0){return}var n,o;try{n=ce.Call(r,e)}catch(i){o=i}if(t){return}if(o){throw o}if(!ce.TypeIsObject(n)){throw new TypeError("Iterator's return method returned a non-object.")}},IteratorNext:function(e){var t=arguments.length>1?e.next(arguments[1]):e.next();if(!ce.TypeIsObject(t)){throw new TypeError("bad iterator")}return t},IteratorStep:function(e){var t=ce.IteratorNext(e);var r=ce.IteratorComplete(t);return r?false:t},Construct:function(e,t,r,n){var o=typeof r==="undefined"?e:r;if(!n&&ae.construct){return ae.construct(e,t,o)}var i=o.prototype;if(!ce.TypeIsObject(i)){i=Object.prototype}var a=O(i);var u=ce.Call(e,a,t);return ce.TypeIsObject(u)?u:a},SpeciesConstructor:function(e,t){var r=e.constructor;if(r===void 0){return t}if(!ce.TypeIsObject(r)){throw new TypeError("Bad constructor")}var n=r[J];if(se(n)){return t}if(!ce.IsConstructor(n)){throw new TypeError("Bad @@species")}return n},CreateHTML:function(e,t,r,n){var o=ce.ToString(e);var i="<"+t;if(r!==""){var a=ce.ToString(n);var u=a.replace(/"/g,"&quot;");i+=" "+r+'="'+u+'"'}var f=i+">";var s=f+o;return s+"</"+t+">"},IsRegExp:function IsRegExp(e){if(!ce.TypeIsObject(e)){return false}var t=e[$.match];if(typeof t!=="undefined"){return!!t}return re.regex(e)},ToString:function ToString(e){return ue(e)}};if(s&&oe){var le=function defineWellKnownSymbol(e){if(re.symbol($[e])){return $[e]}var t=$["for"]("Symbol."+e);Object.defineProperty($,e,{configurable:false,enumerable:false,writable:false,value:t});return t};if(!re.symbol($.search)){var pe=le("search");var ve=String.prototype.search;h(RegExp.prototype,pe,function search(e){return ce.Call(ve,e,[this])});var ye=function search(e){var t=ce.RequireObjectCoercible(this);if(!se(e)){var r=ce.GetMethod(e,pe);if(typeof r!=="undefined"){return ce.Call(r,e,[t])}}return ce.Call(ve,t,[ce.ToString(e)])};ne(String.prototype,"search",ye)}if(!re.symbol($.replace)){var he=le("replace");var be=String.prototype.replace;h(RegExp.prototype,he,function replace(e,t){return ce.Call(be,e,[this,t])});var ge=function replace(e,t){var r=ce.RequireObjectCoercible(this);if(!se(e)){var n=ce.GetMethod(e,he);if(typeof n!=="undefined"){return ce.Call(n,e,[r,t])}}return ce.Call(be,r,[ce.ToString(e),t])};ne(String.prototype,"replace",ge)}if(!re.symbol($.split)){var de=le("split");var me=String.prototype.split;h(RegExp.prototype,de,function split(e,t){return ce.Call(me,e,[this,t])});var Oe=function split(e,t){var r=ce.RequireObjectCoercible(this);if(!se(e)){var n=ce.GetMethod(e,de);if(typeof n!=="undefined"){return ce.Call(n,e,[r,t])}}return ce.Call(me,r,[ce.ToString(e),t])};ne(String.prototype,"split",Oe)}var we=re.symbol($.match);var je=we&&function(){var e={};e[$.match]=function(){return 42};return"a".match(e)!==42}();if(!we||je){var Se=le("match");var Te=String.prototype.match;h(RegExp.prototype,Se,function match(e){return ce.Call(Te,e,[this])});var Ie=function match(e){var t=ce.RequireObjectCoercible(this);if(!se(e)){var r=ce.GetMethod(e,Se);if(typeof r!=="undefined"){return ce.Call(r,e,[t])}}return ce.Call(Te,t,[ce.ToString(e)])};ne(String.prototype,"match",Ie)}}var Ee=function wrapConstructor(e,t,r){m.preserveToString(t,e);if(Object.setPrototypeOf){Object.setPrototypeOf(e,t)}if(s){l(Object.getOwnPropertyNames(e),function(n){if(n in W||r[n]){return}m.proxy(e,n,t)})}else{l(Object.keys(e),function(n){if(n in W||r[n]){return}t[n]=e[n]})}t.prototype=e.prototype;m.redefine(e.prototype,"constructor",t)};var Pe=function(){return this};var Ce=function(e){if(s&&!z(e,J)){m.getter(e,J,Pe)}};var Me=function(e,t){var r=t||function iterator(){return this};h(e,ie,r);if(!e[ie]&&re.symbol(ie)){e[ie]=r}};var xe=function createDataProperty(e,t,r){if(s){Object.defineProperty(e,t,{configurable:true,enumerable:true,writable:true,value:r})}else{e[t]=r}};var Ne=function createDataPropertyOrThrow(e,t,r){xe(e,t,r);if(!ce.SameValue(e[t],r)){throw new TypeError("property is nonconfigurable")}};var Ae=function(e,t,r,n){if(!ce.TypeIsObject(e)){throw new TypeError("Constructor requires `new`: "+t.name)}var o=t.prototype;if(!ce.TypeIsObject(o)){o=r}var i=O(o);for(var a in n){if(z(n,a)){var u=n[a];h(i,a,u,true)}}return i};if(String.fromCodePoint&&String.fromCodePoint.length!==1){var Re=String.fromCodePoint;ne(String,"fromCodePoint",function fromCodePoint(e){return ce.Call(Re,this,arguments)})}var _e={fromCodePoint:function fromCodePoint(e){var t=[];var r;for(var n=0,o=arguments.length;n<o;n++){r=Number(arguments[n]);if(!ce.SameValue(r,ce.ToInteger(r))||r<0||r>1114111){throw new RangeError("Invalid code point "+r)}if(r<65536){M(t,String.fromCharCode(r))}else{r-=65536;M(t,String.fromCharCode((r>>10)+55296));M(t,String.fromCharCode(r%1024+56320))}}return t.join("")},raw:function raw(e){var t=ce.ToObject(e,"bad callSite");var r=ce.ToObject(t.raw,"bad raw value");var n=r.length;var o=ce.ToLength(n);if(o<=0){return""}var i=[];var a=0;var u,f,s,c;while(a<o){u=ce.ToString(a);s=ce.ToString(r[u]);M(i,s);if(a+1>=o){break}f=a+1<arguments.length?arguments[a+1]:"";c=ce.ToString(f);M(i,c);a+=1}return i.join("")}};if(String.raw&&String.raw({raw:{0:"x",1:"y",length:2}})!=="xy"){ne(String,"raw",_e.raw)}b(String,_e);var ke=function repeat(e,t){if(t<1){return""}if(t%2){return repeat(e,t-1)+e}var r=repeat(e,t/2);return r+r};var Le=Infinity;var Fe={repeat:function repeat(e){var t=ce.ToString(ce.RequireObjectCoercible(this));var r=ce.ToInteger(e);if(r<0||r>=Le){throw new RangeError("repeat count must be less than infinity and not overflow maximum string size")}return ke(t,r)},startsWith:function startsWith(e){var t=ce.ToString(ce.RequireObjectCoercible(this));if(ce.IsRegExp(e)){throw new TypeError('Cannot call method "startsWith" with a regex')}var r=ce.ToString(e);var n;if(arguments.length>1){n=arguments[1]}var o=A(ce.ToInteger(n),0);return C(t,o,o+r.length)===r},endsWith:function endsWith(e){var t=ce.ToString(ce.RequireObjectCoercible(this));if(ce.IsRegExp(e)){throw new TypeError('Cannot call method "endsWith" with a regex')}var r=ce.ToString(e);var n=t.length;var o;if(arguments.length>1){o=arguments[1]}var i=typeof o==="undefined"?n:ce.ToInteger(o);var a=R(A(i,0),n);return C(t,a-r.length,a)===r},includes:function includes(e){if(ce.IsRegExp(e)){throw new TypeError('"includes" does not accept a RegExp')}var t=ce.ToString(e);var r;if(arguments.length>1){r=arguments[1]}return I(this,t,r)!==-1},codePointAt:function codePointAt(e){var t=ce.ToString(ce.RequireObjectCoercible(this));var r=ce.ToInteger(e);var n=t.length;if(r>=0&&r<n){var o=t.charCodeAt(r);var i=r+1===n;if(o<55296||o>56319||i){return o}var a=t.charCodeAt(r+1);if(a<56320||a>57343){return o}return(o-55296)*1024+(a-56320)+65536}}};if(String.prototype.includes&&"a".includes("a",Infinity)!==false){ne(String.prototype,"includes",Fe.includes)}if(String.prototype.startsWith&&String.prototype.endsWith){var De=i(function(){return"/a/".startsWith(/a/)});var ze=a(function(){return"abc".startsWith("a",Infinity)===false});if(!De||!ze){ne(String.prototype,"startsWith",Fe.startsWith);ne(String.prototype,"endsWith",Fe.endsWith)}}if(oe){var qe=a(function(){var e=/a/;e[$.match]=false;return"/a/".startsWith(e)});if(!qe){ne(String.prototype,"startsWith",Fe.startsWith)}var We=a(function(){var e=/a/;e[$.match]=false;return"/a/".endsWith(e)});if(!We){ne(String.prototype,"endsWith",Fe.endsWith)}var Ge=a(function(){var e=/a/;e[$.match]=false;return"/a/".includes(e)});if(!Ge){ne(String.prototype,"includes",Fe.includes)}}b(String.prototype,Fe);var He=["\t\n\x0B\f\r \xa0\u1680\u180e\u2000\u2001\u2002\u2003","\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028","\u2029\ufeff"].join("");var Ve=new RegExp("(^["+He+"]+)|(["+He+"]+$)","g");var Be=function trim(){return ce.ToString(ce.RequireObjectCoercible(this)).replace(Ve,"")};var Ue=["\x85","\u200b","\ufffe"].join("");var $e=new RegExp("["+Ue+"]","g");var Je=/^[-+]0x[0-9a-f]+$/i;var Xe=Ue.trim().length!==Ue.length;h(String.prototype,"trim",Be,Xe);var Ke=function(e){return{value:e,done:arguments.length===0}};var Ze=function(e){ce.RequireObjectCoercible(e);this._s=ce.ToString(e);this._i=0};Ze.prototype.next=function(){var e=this._s;var t=this._i;if(typeof e==="undefined"||t>=e.length){this._s=void 0;return Ke()}var r=e.charCodeAt(t);var n,o;if(r<55296||r>56319||t+1===e.length){o=1}else{n=e.charCodeAt(t+1);o=n<56320||n>57343?1:2}this._i=t+o;return Ke(e.substr(t,o))};Me(Ze.prototype);Me(String.prototype,function(){return new Ze(this)});var Ye={from:function from(e){var r=this;var n;if(arguments.length>1){n=arguments[1]}var o,i;if(typeof n==="undefined"){o=false}else{if(!ce.IsCallable(n)){throw new TypeError("Array.from: when provided, the second argument must be a function")}if(arguments.length>2){i=arguments[2]}o=true}var a=typeof(te(e)||ce.GetMethod(e,ie))!=="undefined";var u,f,s;if(a){f=ce.IsConstructor(r)?Object(new r):[];var c=ce.GetIterator(e);var l,p;s=0;while(true){l=ce.IteratorStep(c);if(l===false){break}p=l.value;try{if(o){p=typeof i==="undefined"?n(p,s):t(n,i,p,s)}f[s]=p}catch(v){ce.IteratorClose(c,true);throw v}s+=1}u=s}else{var y=ce.ToObject(e);u=ce.ToLength(y.length);f=ce.IsConstructor(r)?Object(new r(u)):new Array(u);var h;for(s=0;s<u;++s){h=y[s];if(o){h=typeof i==="undefined"?n(h,s):t(n,i,h,s)}Ne(f,s,h)}}f.length=u;return f},of:function of(){var e=arguments.length;var t=this;var n=r(t)||!ce.IsCallable(t)?new Array(e):ce.Construct(t,[e]);for(var o=0;o<e;++o){Ne(n,o,arguments[o])}n.length=e;return n}};b(Array,Ye);Ce(Array);q=function(e,t){this.i=0;this.array=e;this.kind=t};b(q.prototype,{next:function(){var e=this.i;var t=this.array;if(!(this instanceof q)){throw new TypeError("Not an ArrayIterator")}if(typeof t!=="undefined"){var r=ce.ToLength(t.length);for(;e<r;e++){var n=this.kind;var o;if(n==="key"){o=e}else if(n==="value"){o=t[e]}else if(n==="entry"){o=[e,t[e]]}this.i=e+1;return Ke(o)}}this.array=void 0;return Ke()}});Me(q.prototype);var Qe=Array.of===Ye.of||function(){var e=function Foo(e){this.length=e};e.prototype=[];var t=Array.of.apply(e,[1,2]);return t instanceof e&&t.length===2}();if(!Qe){ne(Array,"of",Ye.of)}var et={copyWithin:function copyWithin(e,t){var r=ce.ToObject(this);var n=ce.ToLength(r.length);var o=ce.ToInteger(e);var i=ce.ToInteger(t);var a=o<0?A(n+o,0):R(o,n);var u=i<0?A(n+i,0):R(i,n);var f;if(arguments.length>2){f=arguments[2]}var s=typeof f==="undefined"?n:ce.ToInteger(f);var c=s<0?A(n+s,0):R(s,n);var l=R(c-u,n-a);var p=1;if(u<a&&a<u+l){p=-1;u+=l-1;a+=l-1}while(l>0){if(u in r){r[a]=r[u]}else{delete r[a]}u+=p;a+=p;l-=1}return r},fill:function fill(e){var t;if(arguments.length>1){t=arguments[1]}var r;if(arguments.length>2){r=arguments[2]}var n=ce.ToObject(this);var o=ce.ToLength(n.length);t=ce.ToInteger(typeof t==="undefined"?0:t);r=ce.ToInteger(typeof r==="undefined"?o:r);var i=t<0?A(o+t,0):R(t,o);var a=r<0?o+r:r;for(var u=i;u<o&&u<a;++u){n[u]=e}return n},find:function find(e){var r=ce.ToObject(this);var n=ce.ToLength(r.length);if(!ce.IsCallable(e)){throw new TypeError("Array#find: predicate must be a function")}var o=arguments.length>1?arguments[1]:null;for(var i=0,a;i<n;i++){a=r[i];if(o){if(t(e,o,a,i,r)){return a}}else if(e(a,i,r)){return a}}},findIndex:function findIndex(e){var r=ce.ToObject(this);var n=ce.ToLength(r.length);if(!ce.IsCallable(e)){throw new TypeError("Array#findIndex: predicate must be a function")}var o=arguments.length>1?arguments[1]:null;for(var i=0;i<n;i++){if(o){if(t(e,o,r[i],i,r)){return i}}else if(e(r[i],i,r)){return i}}return-1},keys:function keys(){return new q(this,"key")},values:function values(){return new q(this,"value")},entries:function entries(){return new q(this,"entry")}};if(Array.prototype.keys&&!ce.IsCallable([1].keys().next)){delete Array.prototype.keys}if(Array.prototype.entries&&!ce.IsCallable([1].entries().next)){delete Array.prototype.entries}if(Array.prototype.keys&&Array.prototype.entries&&!Array.prototype.values&&Array.prototype[ie]){b(Array.prototype,{values:Array.prototype[ie]});if(re.symbol($.unscopables)){Array.prototype[$.unscopables].values=true}}if(c&&Array.prototype.values&&Array.prototype.values.name!=="values"){var tt=Array.prototype.values;ne(Array.prototype,"values",function values(){return ce.Call(tt,this,arguments)});h(Array.prototype,ie,Array.prototype.values,true)}b(Array.prototype,et);if(1/[true].indexOf(true,-0)<0){h(Array.prototype,"indexOf",function indexOf(e){var t=E(this,arguments);if(t===0&&1/t<0){return 0}return t},true)}Me(Array.prototype,function(){return this.values()});if(Object.getPrototypeOf){Me(Object.getPrototypeOf([].values()))}var rt=function(){return a(function(){return Array.from({length:-1}).length===0})}();var nt=function(){var e=Array.from([0].entries());return e.length===1&&r(e[0])&&e[0][0]===0&&e[0][1]===0}();if(!rt||!nt){ne(Array,"from",Ye.from)}var ot=function(){return a(function(){return Array.from([0],void 0)})}();if(!ot){var it=Array.from;ne(Array,"from",function from(e){if(arguments.length>1&&typeof arguments[1]!=="undefined"){return ce.Call(it,this,arguments)}else{return t(it,this,e)}})}var at=-(Math.pow(2,32)-1);var ut=function(e,r){var n={length:at};n[r?(n.length>>>0)-1:0]=true;return a(function(){t(e,n,function(){throw new RangeError("should not reach here")},[]);return true})};if(!ut(Array.prototype.forEach)){var ft=Array.prototype.forEach;ne(Array.prototype,"forEach",function forEach(e){return ce.Call(ft,this.length>=0?this:[],arguments)},true)}if(!ut(Array.prototype.map)){var st=Array.prototype.map;ne(Array.prototype,"map",function map(e){return ce.Call(st,this.length>=0?this:[],arguments)},true)}if(!ut(Array.prototype.filter)){var ct=Array.prototype.filter;ne(Array.prototype,"filter",function filter(e){return ce.Call(ct,this.length>=0?this:[],arguments)},true)}if(!ut(Array.prototype.some)){var lt=Array.prototype.some;ne(Array.prototype,"some",function some(e){return ce.Call(lt,this.length>=0?this:[],arguments)},true)}if(!ut(Array.prototype.every)){var pt=Array.prototype.every;ne(Array.prototype,"every",function every(e){return ce.Call(pt,this.length>=0?this:[],arguments)},true)}if(!ut(Array.prototype.reduce)){var vt=Array.prototype.reduce;ne(Array.prototype,"reduce",function reduce(e){return ce.Call(vt,this.length>=0?this:[],arguments)},true)}if(!ut(Array.prototype.reduceRight,true)){var yt=Array.prototype.reduceRight;ne(Array.prototype,"reduceRight",function reduceRight(e){return ce.Call(yt,this.length>=0?this:[],arguments)},true)}var ht=Number("0o10")!==8;var bt=Number("0b10")!==2;var gt=y(Ue,function(e){return Number(e+0+e)===0});if(ht||bt||gt){var dt=Number;var mt=/^0b[01]+$/i;var Ot=/^0o[0-7]+$/i;var wt=mt.test.bind(mt);var jt=Ot.test.bind(Ot);var St=function(e){var t;if(typeof e.valueOf==="function"){t=e.valueOf();if(re.primitive(t)){return t}}if(typeof e.toString==="function"){t=e.toString();if(re.primitive(t)){return t}}throw new TypeError("No default value")};var Tt=$e.test.bind($e);var It=Je.test.bind(Je);var Et=function(){var e=function Number(t){var r;if(arguments.length>0){r=re.primitive(t)?t:St(t,"number")}else{r=0}if(typeof r==="string"){r=ce.Call(Be,r);if(wt(r)){r=parseInt(C(r,2),2)}else if(jt(r)){r=parseInt(C(r,2),8)}else if(Tt(r)||It(r)){r=NaN}}var n=this;var o=a(function(){dt.prototype.valueOf.call(n);return true});if(n instanceof e&&!o){return new dt(r)}return dt(r)};return e}();Ee(dt,Et,{});b(Et,{NaN:dt.NaN,MAX_VALUE:dt.MAX_VALUE,MIN_VALUE:dt.MIN_VALUE,NEGATIVE_INFINITY:dt.NEGATIVE_INFINITY,POSITIVE_INFINITY:dt.POSITIVE_INFINITY});Number=Et;m.redefine(S,"Number",Et)}var Pt=Math.pow(2,53)-1;b(Number,{MAX_SAFE_INTEGER:Pt,MIN_SAFE_INTEGER:-Pt,EPSILON:2.220446049250313e-16,parseInt:S.parseInt,parseFloat:S.parseFloat,isFinite:K,isInteger:function isInteger(e){return K(e)&&ce.ToInteger(e)===e},isSafeInteger:function isSafeInteger(e){return Number.isInteger(e)&&k(e)<=Number.MAX_SAFE_INTEGER},isNaN:X});h(Number,"parseInt",S.parseInt,Number.parseInt!==S.parseInt);if([,1].find(function(){return true})===1){ne(Array.prototype,"find",et.find)}if([,1].findIndex(function(){return true})!==0){ne(Array.prototype,"findIndex",et.findIndex)}var Ct=Function.bind.call(Function.bind,Object.prototype.propertyIsEnumerable);var Mt=function ensureEnumerable(e,t){if(s&&Ct(e,t)){Object.defineProperty(e,t,{enumerable:false})}};var xt=function sliceArgs(){var e=Number(this);var t=arguments.length;var r=t-e;var n=new Array(r<0?0:r);for(var o=e;o<t;++o){n[o-e]=arguments[o]}return n};var Nt=function assignTo(e){return function assignToSource(t,r){t[r]=e[r];return t}};var At=function(e,t){var r=n(Object(t));var o;if(ce.IsCallable(Object.getOwnPropertySymbols)){o=v(Object.getOwnPropertySymbols(Object(t)),Ct(t))}return p(P(r,o||[]),Nt(t),e)};var Rt={assign:function(e,t){var r=ce.ToObject(e,"Cannot convert undefined or null to object");return p(ce.Call(xt,1,arguments),At,r)},is:function is(e,t){return ce.SameValue(e,t)}};var _t=Object.assign&&Object.preventExtensions&&function(){var e=Object.preventExtensions({1:2});try{Object.assign(e,"xy")}catch(t){return e[1]==="y"}}();if(_t){ne(Object,"assign",Rt.assign)}b(Object,Rt);if(s){var kt={setPrototypeOf:function(e,r){var n;var o=function(e,t){if(!ce.TypeIsObject(e)){throw new TypeError("cannot set prototype on a non-object")}if(!(t===null||ce.TypeIsObject(t))){throw new TypeError("can only set prototype to an object or null"+t)}};var i=function(e,r){o(e,r);t(n,e,r);return e};try{n=e.getOwnPropertyDescriptor(e.prototype,r).set;t(n,{},null)}catch(a){if(e.prototype!=={}[r]){return}n=function(e){this[r]=e};i.polyfill=i(i({},null),e.prototype)instanceof e}return i}(Object,"__proto__")};b(Object,kt)}if(Object.setPrototypeOf&&Object.getPrototypeOf&&Object.getPrototypeOf(Object.setPrototypeOf({},null))!==null&&Object.getPrototypeOf(Object.create(null))===null){(function(){var e=Object.create(null);var t=Object.getPrototypeOf;var r=Object.setPrototypeOf;Object.getPrototypeOf=function(r){var n=t(r);return n===e?null:n};Object.setPrototypeOf=function(t,n){var o=n===null?e:n;return r(t,o)};Object.setPrototypeOf.polyfill=false})()}var Lt=!i(function(){return Object.keys("foo")});if(!Lt){var Ft=Object.keys;ne(Object,"keys",function keys(e){return Ft(ce.ToObject(e))});n=Object.keys}var Dt=i(function(){return Object.keys(/a/g)});if(Dt){var zt=Object.keys;ne(Object,"keys",function keys(e){if(re.regex(e)){var t=[];for(var r in e){if(z(e,r)){M(t,r)}}return t}return zt(e)});n=Object.keys}if(Object.getOwnPropertyNames){var qt=!i(function(){return Object.getOwnPropertyNames("foo")});if(!qt){var Wt=typeof window==="object"?Object.getOwnPropertyNames(window):[];var Gt=Object.getOwnPropertyNames;ne(Object,"getOwnPropertyNames",function getOwnPropertyNames(e){var t=ce.ToObject(e);if(g(t)==="[object Window]"){try{return Gt(t)}catch(r){return P([],Wt)}}return Gt(t)})}}if(Object.getOwnPropertyDescriptor){var Ht=!i(function(){return Object.getOwnPropertyDescriptor("foo","bar")});if(!Ht){var Vt=Object.getOwnPropertyDescriptor;ne(Object,"getOwnPropertyDescriptor",function getOwnPropertyDescriptor(e,t){return Vt(ce.ToObject(e),t)})}}if(Object.seal){var Bt=!i(function(){return Object.seal("foo")});if(!Bt){var Ut=Object.seal;ne(Object,"seal",function seal(e){if(!ce.TypeIsObject(e)){return e}return Ut(e)})}}if(Object.isSealed){var $t=!i(function(){return Object.isSealed("foo")});if(!$t){var Jt=Object.isSealed;ne(Object,"isSealed",function isSealed(e){if(!ce.TypeIsObject(e)){return true}return Jt(e)})}}if(Object.freeze){var Xt=!i(function(){return Object.freeze("foo")});if(!Xt){var Kt=Object.freeze;ne(Object,"freeze",function freeze(e){if(!ce.TypeIsObject(e)){return e}return Kt(e)})}}if(Object.isFrozen){var Zt=!i(function(){return Object.isFrozen("foo")});if(!Zt){var Yt=Object.isFrozen;ne(Object,"isFrozen",function isFrozen(e){if(!ce.TypeIsObject(e)){return true}return Yt(e)})}}if(Object.preventExtensions){var Qt=!i(function(){return Object.preventExtensions("foo")});if(!Qt){var er=Object.preventExtensions;ne(Object,"preventExtensions",function preventExtensions(e){if(!ce.TypeIsObject(e)){return e}return er(e)})}}if(Object.isExtensible){var tr=!i(function(){return Object.isExtensible("foo")});if(!tr){var rr=Object.isExtensible;ne(Object,"isExtensible",function isExtensible(e){if(!ce.TypeIsObject(e)){return false}return rr(e)})}}if(Object.getPrototypeOf){var nr=!i(function(){return Object.getPrototypeOf("foo")});if(!nr){var or=Object.getPrototypeOf;ne(Object,"getPrototypeOf",function getPrototypeOf(e){return or(ce.ToObject(e))})}}var ir=s&&function(){var e=Object.getOwnPropertyDescriptor(RegExp.prototype,"flags");return e&&ce.IsCallable(e.get)}();if(s&&!ir){var ar=function flags(){if(!ce.TypeIsObject(this)){throw new TypeError("Method called on incompatible type: must be an object.")}var e="";if(this.global){e+="g"}if(this.ignoreCase){e+="i"}if(this.multiline){e+="m"}if(this.unicode){e+="u"}if(this.sticky){e+="y"}return e};m.getter(RegExp.prototype,"flags",ar)}var ur=s&&a(function(){return String(new RegExp(/a/g,"i"))==="/a/i"});var fr=oe&&s&&function(){var e=/./;e[$.match]=false;return RegExp(e)===e}();var sr=a(function(){return RegExp.prototype.toString.call({source:"abc"})==="/abc/"});var cr=sr&&a(function(){return RegExp.prototype.toString.call({source:"a",flags:"b"})==="/a/b"});if(!sr||!cr){var lr=RegExp.prototype.toString;h(RegExp.prototype,"toString",function toString(){var e=ce.RequireObjectCoercible(this);if(re.regex(e)){return t(lr,e)}var r=ue(e.source);var n=ue(e.flags);return"/"+r+"/"+n},true);m.preserveToString(RegExp.prototype.toString,lr)}if(s&&(!ur||fr)){var pr=Object.getOwnPropertyDescriptor(RegExp.prototype,"flags").get;var vr=Object.getOwnPropertyDescriptor(RegExp.prototype,"source")||{};var yr=function(){return this.source};var hr=ce.IsCallable(vr.get)?vr.get:yr;var br=RegExp;var gr=function(){return function RegExp(e,t){var r=ce.IsRegExp(e);var n=this instanceof RegExp;if(!n&&r&&typeof t==="undefined"&&e.constructor===RegExp){return e}var o=e;var i=t;if(re.regex(e)){o=ce.Call(hr,e);i=typeof t==="undefined"?ce.Call(pr,e):t;return new RegExp(o,i)}else if(r){o=e.source;i=typeof t==="undefined"?e.flags:t}return new br(e,t)}}();Ee(br,gr,{$input:true});RegExp=gr;m.redefine(S,"RegExp",gr)}if(s){var dr={input:"$_",lastMatch:"$&",lastParen:"$+",leftContext:"$`",rightContext:"$'"};l(n(dr),function(e){if(e in RegExp&&!(dr[e]in RegExp)){m.getter(RegExp,dr[e],function get(){return RegExp[e]})}})}Ce(RegExp);var mr=1/Number.EPSILON;var Or=function roundTiesToEven(e){return e+mr-mr};var wr=Math.pow(2,-23);var jr=Math.pow(2,127)*(2-wr);var Sr=Math.pow(2,-126);var Tr=Math.E;var Ir=Math.LOG2E;var Er=Math.LOG10E;var Pr=Number.prototype.clz;delete Number.prototype.clz;var Cr={acosh:function acosh(e){var t=Number(e);if(X(t)||e<1){return NaN}if(t===1){return 0}if(t===Infinity){return t}var r=1/(t*t);if(t<2){return Y(t-1+D(1-r)*t)}var n=t/2;return Y(n+D(1-r)*n-1)+1/Ir},asinh:function asinh(e){var t=Number(e);if(t===0||!T(t)){return t}var r=k(t);var n=r*r;var o=Z(t);if(r<1){return o*Y(r+n/(D(n+1)+1))}return o*(Y(r/2+D(1+1/n)*r/2-1)+1/Ir)},atanh:function atanh(e){var t=Number(e);if(t===0){return t}if(t===-1){return-Infinity}if(t===1){return Infinity}if(X(t)||t<-1||t>1){return NaN}var r=k(t);return Z(t)*Y(2*r/(1-r))/2},cbrt:function cbrt(e){var t=Number(e);if(t===0){return t}var r=t<0;var n;if(r){t=-t}if(t===Infinity){n=Infinity}else{n=L(F(t)/3);n=(t/(n*n)+2*n)/3}return r?-n:n},clz32:function clz32(e){var t=Number(e);var r=ce.ToUint32(t);if(r===0){return 32}return Pr?ce.Call(Pr,r):31-_(F(r+.5)*Ir)},cosh:function cosh(e){var t=Number(e);if(t===0){return 1}if(X(t)){return NaN}if(!T(t)){return Infinity}var r=L(k(t)-1);return(r+1/(r*Tr*Tr))*(Tr/2)},expm1:function expm1(e){var t=Number(e);if(t===-Infinity){return-1}if(!T(t)||t===0){return t}if(k(t)>.5){return L(t)-1}var r=t;var n=0;var o=1;while(n+r!==n){n+=r;o+=1;r*=t/o}return n},hypot:function hypot(e,t){var r=0;var n=0;for(var o=0;o<arguments.length;++o){var i=k(Number(arguments[o]));if(n<i){r*=n/i*(n/i);r+=1;n=i}else{r+=i>0?i/n*(i/n):i}}return n===Infinity?Infinity:n*D(r)},log2:function log2(e){return F(e)*Ir},log10:function log10(e){return F(e)*Er},log1p:Y,sign:Z,sinh:function sinh(e){var t=Number(e);if(!T(t)||t===0){return t}var r=k(t);if(r<1){var n=Math.expm1(r);return Z(t)*n*(1+1/(n+1))/2}var o=L(r-1);return Z(t)*(o-1/(o*Tr*Tr))*(Tr/2)},tanh:function tanh(e){var t=Number(e);if(X(t)||t===0){return t}if(t>=20){return 1}if(t<=-20){return-1}return(Math.expm1(t)-Math.expm1(-t))/(L(t)+L(-t))},trunc:function trunc(e){var t=Number(e);return t<0?-_(-t):_(t)},imul:function imul(e,t){var r=ce.ToUint32(e);var n=ce.ToUint32(t);var o=r>>>16&65535;var i=r&65535;var a=n>>>16&65535;var u=n&65535;return i*u+(o*u+i*a<<16>>>0)|0},fround:function fround(e){var t=Number(e);if(t===0||t===Infinity||t===-Infinity||X(t)){return t}var r=Z(t);var n=k(t);if(n<Sr){return r*Or(n/Sr/wr)*Sr*wr}var o=(1+wr/Number.EPSILON)*n;var i=o-(o-n);if(i>jr||X(i)){return r*Infinity}return r*i}};var Mr=function withinULPDistance(e,t,r){return k(1-e/t)/Number.EPSILON<(r||8)};b(Math,Cr);h(Math,"sinh",Cr.sinh,Math.sinh(710)===Infinity);h(Math,"cosh",Cr.cosh,Math.cosh(710)===Infinity);h(Math,"log1p",Cr.log1p,Math.log1p(-1e-17)!==-1e-17);h(Math,"asinh",Cr.asinh,Math.asinh(-1e7)!==-Math.asinh(1e7));h(Math,"asinh",Cr.asinh,Math.asinh(1e300)===Infinity);h(Math,"atanh",Cr.atanh,Math.atanh(1e-300)===0);h(Math,"tanh",Cr.tanh,Math.tanh(-2e-17)!==-2e-17);
h(Math,"acosh",Cr.acosh,Math.acosh(Number.MAX_VALUE)===Infinity);h(Math,"acosh",Cr.acosh,!Mr(Math.acosh(1+Number.EPSILON),Math.sqrt(2*Number.EPSILON)));h(Math,"cbrt",Cr.cbrt,!Mr(Math.cbrt(1e-300),1e-100));h(Math,"sinh",Cr.sinh,Math.sinh(-2e-17)!==-2e-17);var xr=Math.expm1(10);h(Math,"expm1",Cr.expm1,xr>22025.465794806718||xr<22025.465794806718);var Nr=Math.round;var Ar=Math.round(.5-Number.EPSILON/4)===0&&Math.round(-.5+Number.EPSILON/3.99)===1;var Rr=mr+1;var _r=2*mr-1;var kr=[Rr,_r].every(function(e){return Math.round(e)===e});h(Math,"round",function round(e){var t=_(e);var r=t===-1?-0:t+1;return e-t<.5?t:r},!Ar||!kr);m.preserveToString(Math.round,Nr);var Lr=Math.imul;if(Math.imul(4294967295,5)!==-5){Math.imul=Cr.imul;m.preserveToString(Math.imul,Lr)}if(Math.imul.length!==2){ne(Math,"imul",function imul(e,t){return ce.Call(Lr,Math,arguments)})}var Fr=function(){var e=S.setTimeout;if(typeof e!=="function"&&typeof e!=="object"){return}ce.IsPromise=function(e){if(!ce.TypeIsObject(e)){return false}if(typeof e._promise==="undefined"){return false}return true};var r=function(e){if(!ce.IsConstructor(e)){throw new TypeError("Bad promise constructor")}var t=this;var r=function(e,r){if(t.resolve!==void 0||t.reject!==void 0){throw new TypeError("Bad Promise implementation!")}t.resolve=e;t.reject=r};t.resolve=void 0;t.reject=void 0;t.promise=new e(r);if(!(ce.IsCallable(t.resolve)&&ce.IsCallable(t.reject))){throw new TypeError("Bad promise constructor")}};var n;if(typeof window!=="undefined"&&ce.IsCallable(window.postMessage)){n=function(){var e=[];var t="zero-timeout-message";var r=function(r){M(e,r);window.postMessage(t,"*")};var n=function(r){if(r.source===window&&r.data===t){r.stopPropagation();if(e.length===0){return}var n=N(e);n()}};window.addEventListener("message",n,true);return r}}var o=function(){var e=S.Promise;var t=e&&e.resolve&&e.resolve();return t&&function(e){return t.then(e)}};var i=ce.IsCallable(S.setImmediate)?S.setImmediate:typeof process==="object"&&process.nextTick?process.nextTick:o()||(ce.IsCallable(n)?n():function(t){e(t,0)});var a=function(e){return e};var u=function(e){throw e};var f=0;var s=1;var c=2;var l=0;var p=1;var v=2;var y={};var h=function(e,t,r){i(function(){g(e,t,r)})};var g=function(e,t,r){var n,o;if(t===y){return e(r)}try{n=e(r);o=t.resolve}catch(i){n=i;o=t.reject}o(n)};var d=function(e,t){var r=e._promise;var n=r.reactionLength;if(n>0){h(r.fulfillReactionHandler0,r.reactionCapability0,t);r.fulfillReactionHandler0=void 0;r.rejectReactions0=void 0;r.reactionCapability0=void 0;if(n>1){for(var o=1,i=0;o<n;o++,i+=3){h(r[i+l],r[i+v],t);e[i+l]=void 0;e[i+p]=void 0;e[i+v]=void 0}}}r.result=t;r.state=s;r.reactionLength=0};var m=function(e,t){var r=e._promise;var n=r.reactionLength;if(n>0){h(r.rejectReactionHandler0,r.reactionCapability0,t);r.fulfillReactionHandler0=void 0;r.rejectReactions0=void 0;r.reactionCapability0=void 0;if(n>1){for(var o=1,i=0;o<n;o++,i+=3){h(r[i+p],r[i+v],t);e[i+l]=void 0;e[i+p]=void 0;e[i+v]=void 0}}}r.result=t;r.state=c;r.reactionLength=0};var O=function(e){var t=false;var r=function(r){var n;if(t){return}t=true;if(r===e){return m(e,new TypeError("Self resolution"))}if(!ce.TypeIsObject(r)){return d(e,r)}try{n=r.then}catch(o){return m(e,o)}if(!ce.IsCallable(n)){return d(e,r)}i(function(){j(e,r,n)})};var n=function(r){if(t){return}t=true;return m(e,r)};return{resolve:r,reject:n}};var w=function(e,r,n,o){if(e===I){t(e,r,n,o,y)}else{t(e,r,n,o)}};var j=function(e,t,r){var n=O(e);var o=n.resolve;var i=n.reject;try{w(r,t,o,i)}catch(a){i(a)}};var T,I;var E=function(){var e=function Promise(t){if(!(this instanceof e)){throw new TypeError('Constructor Promise requires "new"')}if(this&&this._promise){throw new TypeError("Bad construction")}if(!ce.IsCallable(t)){throw new TypeError("not a valid resolver")}var r=Ae(this,e,T,{_promise:{result:void 0,state:f,reactionLength:0,fulfillReactionHandler0:void 0,rejectReactionHandler0:void 0,reactionCapability0:void 0}});var n=O(r);var o=n.reject;try{t(n.resolve,o)}catch(i){o(i)}return r};return e}();T=E.prototype;var P=function(e,t,r,n){var o=false;return function(i){if(o){return}o=true;t[e]=i;if(--n.count===0){var a=r.resolve;a(t)}}};var C=function(e,t,r){var n=e.iterator;var o=[];var i={count:1};var a,u;var f=0;while(true){try{a=ce.IteratorStep(n);if(a===false){e.done=true;break}u=a.value}catch(s){e.done=true;throw s}o[f]=void 0;var c=t.resolve(u);var l=P(f,o,r,i);i.count+=1;w(c.then,c,l,r.reject);f+=1}if(--i.count===0){var p=r.resolve;p(o)}return r.promise};var x=function(e,t,r){var n=e.iterator;var o,i,a;while(true){try{o=ce.IteratorStep(n);if(o===false){e.done=true;break}i=o.value}catch(u){e.done=true;throw u}a=t.resolve(i);w(a.then,a,r.resolve,r.reject)}return r.promise};b(E,{all:function all(e){var t=this;if(!ce.TypeIsObject(t)){throw new TypeError("Promise is not object")}var n=new r(t);var o,i;try{o=ce.GetIterator(e);i={iterator:o,done:false};return C(i,t,n)}catch(a){var u=a;if(i&&!i.done){try{ce.IteratorClose(o,true)}catch(f){u=f}}var s=n.reject;s(u);return n.promise}},race:function race(e){var t=this;if(!ce.TypeIsObject(t)){throw new TypeError("Promise is not object")}var n=new r(t);var o,i;try{o=ce.GetIterator(e);i={iterator:o,done:false};return x(i,t,n)}catch(a){var u=a;if(i&&!i.done){try{ce.IteratorClose(o,true)}catch(f){u=f}}var s=n.reject;s(u);return n.promise}},reject:function reject(e){var t=this;if(!ce.TypeIsObject(t)){throw new TypeError("Bad promise constructor")}var n=new r(t);var o=n.reject;o(e);return n.promise},resolve:function resolve(e){var t=this;if(!ce.TypeIsObject(t)){throw new TypeError("Bad promise constructor")}if(ce.IsPromise(e)){var n=e.constructor;if(n===t){return e}}var o=new r(t);var i=o.resolve;i(e);return o.promise}});b(T,{"catch":function(e){return this.then(null,e)},then:function then(e,t){var n=this;if(!ce.IsPromise(n)){throw new TypeError("not a promise")}var o=ce.SpeciesConstructor(n,E);var i;var b=arguments.length>2&&arguments[2]===y;if(b&&o===E){i=y}else{i=new r(o)}var g=ce.IsCallable(e)?e:a;var d=ce.IsCallable(t)?t:u;var m=n._promise;var O;if(m.state===f){if(m.reactionLength===0){m.fulfillReactionHandler0=g;m.rejectReactionHandler0=d;m.reactionCapability0=i}else{var w=3*(m.reactionLength-1);m[w+l]=g;m[w+p]=d;m[w+v]=i}m.reactionLength+=1}else if(m.state===s){O=m.result;h(g,i,O)}else if(m.state===c){O=m.result;h(d,i,O)}else{throw new TypeError("unexpected Promise state")}return i.promise}});y=new r(E);I=T.then;return E}();if(S.Promise){delete S.Promise.accept;delete S.Promise.defer;delete S.Promise.prototype.chain}if(typeof Fr==="function"){b(S,{Promise:Fr});var Dr=w(S.Promise,function(e){return e.resolve(42).then(function(){})instanceof e});var zr=!i(function(){return S.Promise.reject(42).then(null,5).then(null,W)});var qr=i(function(){return S.Promise.call(3,W)});var Wr=function(e){var t=e.resolve(5);t.constructor={};var r=e.resolve(t);try{r.then(null,W).then(null,W)}catch(n){return true}return t===r}(S.Promise);var Gr=s&&function(){var e=0;var t=Object.defineProperty({},"then",{get:function(){e+=1}});Promise.resolve(t);return e===1}();var Hr=function BadResolverPromise(e){var t=new Promise(e);e(3,function(){});this.then=t.then;this.constructor=BadResolverPromise};Hr.prototype=Promise.prototype;Hr.all=Promise.all;var Vr=a(function(){return!!Hr.all([1,2])});if(!Dr||!zr||!qr||Wr||!Gr||Vr){Promise=Fr;ne(S,"Promise",Fr)}if(Promise.all.length!==1){var Br=Promise.all;ne(Promise,"all",function all(e){return ce.Call(Br,this,arguments)})}if(Promise.race.length!==1){var Ur=Promise.race;ne(Promise,"race",function race(e){return ce.Call(Ur,this,arguments)})}if(Promise.resolve.length!==1){var $r=Promise.resolve;ne(Promise,"resolve",function resolve(e){return ce.Call($r,this,arguments)})}if(Promise.reject.length!==1){var Jr=Promise.reject;ne(Promise,"reject",function reject(e){return ce.Call(Jr,this,arguments)})}Mt(Promise,"all");Mt(Promise,"race");Mt(Promise,"resolve");Mt(Promise,"reject");Ce(Promise)}var Xr=function(e){var t=n(p(e,function(e,t){e[t]=true;return e},{}));return e.join(":")===t.join(":")};var Kr=Xr(["z","a","bb"]);var Zr=Xr(["z",1,"a","3",2]);if(s){var Yr=function fastkey(e,t){if(!t&&!Kr){return null}if(se(e)){return"^"+ce.ToString(e)}else if(typeof e==="string"){return"$"+e}else if(typeof e==="number"){if(!Zr){return"n"+e}return e}else if(typeof e==="boolean"){return"b"+e}return null};var Qr=function emptyObject(){return Object.create?Object.create(null):{}};var en=function addIterableToMap(e,n,o){if(r(o)||re.string(o)){l(o,function(e){if(!ce.TypeIsObject(e)){throw new TypeError("Iterator value "+e+" is not an entry object")}n.set(e[0],e[1])})}else if(o instanceof e){t(e.prototype.forEach,o,function(e,t){n.set(t,e)})}else{var i,a;if(!se(o)){a=n.set;if(!ce.IsCallable(a)){throw new TypeError("bad map")}i=ce.GetIterator(o)}if(typeof i!=="undefined"){while(true){var u=ce.IteratorStep(i);if(u===false){break}var f=u.value;try{if(!ce.TypeIsObject(f)){throw new TypeError("Iterator value "+f+" is not an entry object")}t(a,n,f[0],f[1])}catch(s){ce.IteratorClose(i,true);throw s}}}}};var tn=function addIterableToSet(e,n,o){if(r(o)||re.string(o)){l(o,function(e){n.add(e)})}else if(o instanceof e){t(e.prototype.forEach,o,function(e){n.add(e)})}else{var i,a;if(!se(o)){a=n.add;if(!ce.IsCallable(a)){throw new TypeError("bad set")}i=ce.GetIterator(o)}if(typeof i!=="undefined"){while(true){var u=ce.IteratorStep(i);if(u===false){break}var f=u.value;try{t(a,n,f)}catch(s){ce.IteratorClose(i,true);throw s}}}}};var rn={Map:function(){var e={};var r=function MapEntry(e,t){this.key=e;this.value=t;this.next=null;this.prev=null};r.prototype.isRemoved=function isRemoved(){return this.key===e};var n=function isMap(e){return!!e._es6map};var o=function requireMapSlot(e,t){if(!ce.TypeIsObject(e)||!n(e)){throw new TypeError("Method Map.prototype."+t+" called on incompatible receiver "+ce.ToString(e))}};var i=function MapIterator(e,t){o(e,"[[MapIterator]]");this.head=e._head;this.i=this.head;this.kind=t};i.prototype={isMapIterator:true,next:function next(){if(!this.isMapIterator){throw new TypeError("Not a MapIterator")}var e=this.i;var t=this.kind;var r=this.head;if(typeof this.i==="undefined"){return Ke()}while(e.isRemoved()&&e!==r){e=e.prev}var n;while(e.next!==r){e=e.next;if(!e.isRemoved()){if(t==="key"){n=e.key}else if(t==="value"){n=e.value}else{n=[e.key,e.value]}this.i=e;return Ke(n)}}this.i=void 0;return Ke()}};Me(i.prototype);var a;var u=function Map(){if(!(this instanceof Map)){throw new TypeError('Constructor Map requires "new"')}if(this&&this._es6map){throw new TypeError("Bad construction")}var e=Ae(this,Map,a,{_es6map:true,_head:null,_map:G?new G:null,_size:0,_storage:Qr()});var t=new r(null,null);t.next=t.prev=t;e._head=t;if(arguments.length>0){en(Map,e,arguments[0])}return e};a=u.prototype;m.getter(a,"size",function(){if(typeof this._size==="undefined"){throw new TypeError("size method called on incompatible Map")}return this._size});b(a,{get:function get(e){o(this,"get");var t;var r=Yr(e,true);if(r!==null){t=this._storage[r];if(t){return t.value}else{return}}if(this._map){t=V.call(this._map,e);if(t){return t.value}else{return}}var n=this._head;var i=n;while((i=i.next)!==n){if(ce.SameValueZero(i.key,e)){return i.value}}},has:function has(e){o(this,"has");var t=Yr(e,true);if(t!==null){return typeof this._storage[t]!=="undefined"}if(this._map){return B.call(this._map,e)}var r=this._head;var n=r;while((n=n.next)!==r){if(ce.SameValueZero(n.key,e)){return true}}return false},set:function set(e,t){o(this,"set");var n=this._head;var i=n;var a;var u=Yr(e,true);if(u!==null){if(typeof this._storage[u]!=="undefined"){this._storage[u].value=t;return this}else{a=this._storage[u]=new r(e,t);i=n.prev}}else if(this._map){if(B.call(this._map,e)){V.call(this._map,e).value=t}else{a=new r(e,t);U.call(this._map,e,a);i=n.prev}}while((i=i.next)!==n){if(ce.SameValueZero(i.key,e)){i.value=t;return this}}a=a||new r(e,t);if(ce.SameValue(-0,e)){a.key=+0}a.next=this._head;a.prev=this._head.prev;a.prev.next=a;a.next.prev=a;this._size+=1;return this},"delete":function(t){o(this,"delete");var r=this._head;var n=r;var i=Yr(t,true);if(i!==null){if(typeof this._storage[i]==="undefined"){return false}n=this._storage[i].prev;delete this._storage[i]}else if(this._map){if(!B.call(this._map,t)){return false}n=V.call(this._map,t).prev;H.call(this._map,t)}while((n=n.next)!==r){if(ce.SameValueZero(n.key,t)){n.key=e;n.value=e;n.prev.next=n.next;n.next.prev=n.prev;this._size-=1;return true}}return false},clear:function clear(){o(this,"clear");this._map=G?new G:null;this._size=0;this._storage=Qr();var t=this._head;var r=t;var n=r.next;while((r=n)!==t){r.key=e;r.value=e;n=r.next;r.next=r.prev=t}t.next=t.prev=t},keys:function keys(){o(this,"keys");return new i(this,"key")},values:function values(){o(this,"values");return new i(this,"value")},entries:function entries(){o(this,"entries");return new i(this,"key+value")},forEach:function forEach(e){o(this,"forEach");var r=arguments.length>1?arguments[1]:null;var n=this.entries();for(var i=n.next();!i.done;i=n.next()){if(r){t(e,r,i.value[1],i.value[0],this)}else{e(i.value[1],i.value[0],this)}}}});Me(a,a.entries);return u}(),Set:function(){var e=function isSet(e){return e._es6set&&typeof e._storage!=="undefined"};var r=function requireSetSlot(t,r){if(!ce.TypeIsObject(t)||!e(t)){throw new TypeError("Set.prototype."+r+" called on incompatible receiver "+ce.ToString(t))}};var o;var i=function Set(){if(!(this instanceof Set)){throw new TypeError('Constructor Set requires "new"')}if(this&&this._es6set){throw new TypeError("Bad construction")}var e=Ae(this,Set,o,{_es6set:true,"[[SetData]]":null,_storage:Qr()});if(!e._es6set){throw new TypeError("bad set")}if(arguments.length>0){tn(Set,e,arguments[0])}return e};o=i.prototype;var a=function(e){var t=e;if(t==="^null"){return null}else if(t==="^undefined"){return void 0}else{var r=t.charAt(0);if(r==="$"){return C(t,1)}else if(r==="n"){return+C(t,1)}else if(r==="b"){return t==="btrue"}}return+t};var u=function ensureMap(e){if(!e["[[SetData]]"]){var t=new rn.Map;e["[[SetData]]"]=t;l(n(e._storage),function(e){var r=a(e);t.set(r,r)});e["[[SetData]]"]=t}e._storage=null};m.getter(i.prototype,"size",function(){r(this,"size");if(this._storage){return n(this._storage).length}u(this);return this["[[SetData]]"].size});b(i.prototype,{has:function has(e){r(this,"has");var t;if(this._storage&&(t=Yr(e))!==null){return!!this._storage[t]}u(this);return this["[[SetData]]"].has(e)},add:function add(e){r(this,"add");var t;if(this._storage&&(t=Yr(e))!==null){this._storage[t]=true;return this}u(this);this["[[SetData]]"].set(e,e);return this},"delete":function(e){r(this,"delete");var t;if(this._storage&&(t=Yr(e))!==null){var n=z(this._storage,t);return delete this._storage[t]&&n}u(this);return this["[[SetData]]"]["delete"](e)},clear:function clear(){r(this,"clear");if(this._storage){this._storage=Qr()}if(this["[[SetData]]"]){this["[[SetData]]"].clear()}},values:function values(){r(this,"values");u(this);return new f(this["[[SetData]]"].values())},entries:function entries(){r(this,"entries");u(this);return new f(this["[[SetData]]"].entries())},forEach:function forEach(e){r(this,"forEach");var n=arguments.length>1?arguments[1]:null;var o=this;u(o);this["[[SetData]]"].forEach(function(r,i){if(n){t(e,n,i,i,o)}else{e(i,i,o)}})}});h(i.prototype,"keys",i.prototype.values,true);Me(i.prototype,i.prototype.values);var f=function SetIterator(e){this.it=e};f.prototype={isSetIterator:true,next:function next(){if(!this.isSetIterator){throw new TypeError("Not a SetIterator")}return this.it.next()}};Me(f.prototype);return i}()};var nn=S.Set&&!Set.prototype["delete"]&&Set.prototype.remove&&Set.prototype.items&&Set.prototype.map&&Array.isArray((new Set).keys);if(nn){S.Set=rn.Set}if(S.Map||S.Set){var on=a(function(){return new Map([[1,2]]).get(1)===2});if(!on){S.Map=function Map(){if(!(this instanceof Map)){throw new TypeError('Constructor Map requires "new"')}var e=new G;if(arguments.length>0){en(Map,e,arguments[0])}delete e.constructor;Object.setPrototypeOf(e,S.Map.prototype);return e};S.Map.prototype=O(G.prototype);h(S.Map.prototype,"constructor",S.Map,true);m.preserveToString(S.Map,G)}var an=new Map;var un=function(){var e=new Map([[1,0],[2,0],[3,0],[4,0]]);e.set(-0,e);return e.get(0)===e&&e.get(-0)===e&&e.has(0)&&e.has(-0)}();var fn=an.set(1,2)===an;if(!un||!fn){ne(Map.prototype,"set",function set(e,r){t(U,this,e===0?0:e,r);return this})}if(!un){b(Map.prototype,{get:function get(e){return t(V,this,e===0?0:e)},has:function has(e){return t(B,this,e===0?0:e)}},true);m.preserveToString(Map.prototype.get,V);m.preserveToString(Map.prototype.has,B)}var sn=new Set;var cn=Set.prototype["delete"]&&Set.prototype.add&&Set.prototype.has&&function(e){e["delete"](0);e.add(-0);return!e.has(0)}(sn);var ln=sn.add(1)===sn;if(!cn||!ln){var pn=Set.prototype.add;Set.prototype.add=function add(e){t(pn,this,e===0?0:e);return this};m.preserveToString(Set.prototype.add,pn)}if(!cn){var vn=Set.prototype.has;Set.prototype.has=function has(e){return t(vn,this,e===0?0:e)};m.preserveToString(Set.prototype.has,vn);var yn=Set.prototype["delete"];Set.prototype["delete"]=function SetDelete(e){return t(yn,this,e===0?0:e)};m.preserveToString(Set.prototype["delete"],yn)}var hn=w(S.Map,function(e){var t=new e([]);t.set(42,42);return t instanceof e});var bn=Object.setPrototypeOf&&!hn;var gn=function(){try{return!(S.Map()instanceof S.Map)}catch(e){return e instanceof TypeError}}();if(S.Map.length!==0||bn||!gn){S.Map=function Map(){if(!(this instanceof Map)){throw new TypeError('Constructor Map requires "new"')}var e=new G;if(arguments.length>0){en(Map,e,arguments[0])}delete e.constructor;Object.setPrototypeOf(e,Map.prototype);return e};S.Map.prototype=G.prototype;h(S.Map.prototype,"constructor",S.Map,true);m.preserveToString(S.Map,G)}var dn=w(S.Set,function(e){var t=new e([]);t.add(42,42);return t instanceof e});var mn=Object.setPrototypeOf&&!dn;var On=function(){try{return!(S.Set()instanceof S.Set)}catch(e){return e instanceof TypeError}}();if(S.Set.length!==0||mn||!On){var wn=S.Set;S.Set=function Set(){if(!(this instanceof Set)){throw new TypeError('Constructor Set requires "new"')}var e=new wn;if(arguments.length>0){tn(Set,e,arguments[0])}delete e.constructor;Object.setPrototypeOf(e,Set.prototype);return e};S.Set.prototype=wn.prototype;h(S.Set.prototype,"constructor",S.Set,true);m.preserveToString(S.Set,wn)}var jn=new S.Map;var Sn=!a(function(){return jn.keys().next().done});if(typeof S.Map.prototype.clear!=="function"||(new S.Set).size!==0||jn.size!==0||typeof S.Map.prototype.keys!=="function"||typeof S.Set.prototype.keys!=="function"||typeof S.Map.prototype.forEach!=="function"||typeof S.Set.prototype.forEach!=="function"||u(S.Map)||u(S.Set)||typeof jn.keys().next!=="function"||Sn||!hn){b(S,{Map:rn.Map,Set:rn.Set},true)}if(S.Set.prototype.keys!==S.Set.prototype.values){h(S.Set.prototype,"keys",S.Set.prototype.values,true)}Me(Object.getPrototypeOf((new S.Map).keys()));Me(Object.getPrototypeOf((new S.Set).keys()));if(c&&S.Set.prototype.has.name!=="has"){var Tn=S.Set.prototype.has;ne(S.Set.prototype,"has",function has(e){return t(Tn,this,e)})}}b(S,rn);Ce(S.Map);Ce(S.Set)}var In=function throwUnlessTargetIsObject(e){if(!ce.TypeIsObject(e)){throw new TypeError("target must be an object")}};var En={apply:function apply(){return ce.Call(ce.Call,null,arguments)},construct:function construct(e,t){if(!ce.IsConstructor(e)){throw new TypeError("First argument must be a constructor.")}var r=arguments.length>2?arguments[2]:e;if(!ce.IsConstructor(r)){throw new TypeError("new.target must be a constructor.")}return ce.Construct(e,t,r,"internal")},deleteProperty:function deleteProperty(e,t){In(e);if(s){var r=Object.getOwnPropertyDescriptor(e,t);if(r&&!r.configurable){return false}}return delete e[t]},has:function has(e,t){In(e);return t in e}};if(Object.getOwnPropertyNames){Object.assign(En,{ownKeys:function ownKeys(e){In(e);var t=Object.getOwnPropertyNames(e);if(ce.IsCallable(Object.getOwnPropertySymbols)){x(t,Object.getOwnPropertySymbols(e))}return t}})}var Pn=function ConvertExceptionToBoolean(e){return!i(e)};if(Object.preventExtensions){Object.assign(En,{isExtensible:function isExtensible(e){In(e);return Object.isExtensible(e)},preventExtensions:function preventExtensions(e){In(e);return Pn(function(){return Object.preventExtensions(e)})}})}if(s){var Cn=function get(e,t,r){var n=Object.getOwnPropertyDescriptor(e,t);if(!n){var o=Object.getPrototypeOf(e);if(o===null){return void 0}return Cn(o,t,r)}if("value"in n){return n.value}if(n.get){return ce.Call(n.get,r)}return void 0};var Mn=function set(e,r,n,o){var i=Object.getOwnPropertyDescriptor(e,r);if(!i){var a=Object.getPrototypeOf(e);if(a!==null){return Mn(a,r,n,o)}i={value:void 0,writable:true,enumerable:true,configurable:true}}if("value"in i){if(!i.writable){return false}if(!ce.TypeIsObject(o)){return false}var u=Object.getOwnPropertyDescriptor(o,r);if(u){return ae.defineProperty(o,r,{value:n})}else{return ae.defineProperty(o,r,{value:n,writable:true,enumerable:true,configurable:true})}}if(i.set){t(i.set,o,n);return true}return false};Object.assign(En,{defineProperty:function defineProperty(e,t,r){In(e);return Pn(function(){return Object.defineProperty(e,t,r)})},getOwnPropertyDescriptor:function getOwnPropertyDescriptor(e,t){In(e);return Object.getOwnPropertyDescriptor(e,t)},get:function get(e,t){In(e);var r=arguments.length>2?arguments[2]:e;return Cn(e,t,r)},set:function set(e,t,r){In(e);var n=arguments.length>3?arguments[3]:e;return Mn(e,t,r,n)}})}if(Object.getPrototypeOf){var xn=Object.getPrototypeOf;En.getPrototypeOf=function getPrototypeOf(e){In(e);return xn(e)}}if(Object.setPrototypeOf&&En.getPrototypeOf){var Nn=function(e,t){var r=t;while(r){if(e===r){return true}r=En.getPrototypeOf(r)}return false};Object.assign(En,{setPrototypeOf:function setPrototypeOf(e,t){In(e);if(t!==null&&!ce.TypeIsObject(t)){throw new TypeError("proto must be an object or null")}if(t===ae.getPrototypeOf(e)){return true}if(ae.isExtensible&&!ae.isExtensible(e)){return false}if(Nn(e,t)){return false}Object.setPrototypeOf(e,t);return true}})}var An=function(e,t){if(!ce.IsCallable(S.Reflect[e])){h(S.Reflect,e,t)}else{var r=a(function(){S.Reflect[e](1);S.Reflect[e](NaN);S.Reflect[e](true);return true});if(r){ne(S.Reflect,e,t)}}};Object.keys(En).forEach(function(e){An(e,En[e])});var Rn=S.Reflect.getPrototypeOf;if(c&&Rn&&Rn.name!=="getPrototypeOf"){ne(S.Reflect,"getPrototypeOf",function getPrototypeOf(e){return t(Rn,S.Reflect,e)})}if(S.Reflect.setPrototypeOf){if(a(function(){S.Reflect.setPrototypeOf(1,{});return true})){ne(S.Reflect,"setPrototypeOf",En.setPrototypeOf)}}if(S.Reflect.defineProperty){if(!a(function(){var e=!S.Reflect.defineProperty(1,"test",{value:1});var t=typeof Object.preventExtensions!=="function"||!S.Reflect.defineProperty(Object.preventExtensions({}),"test",{});return e&&t})){ne(S.Reflect,"defineProperty",En.defineProperty)}}if(S.Reflect.construct){if(!a(function(){var e=function F(){};return S.Reflect.construct(function(){},[],e)instanceof e})){ne(S.Reflect,"construct",En.construct)}}if(String(new Date(NaN))!=="Invalid Date"){var _n=Date.prototype.toString;var kn=function toString(){var e=+this;if(e!==e){return"Invalid Date"}return ce.Call(_n,this)};ne(Date.prototype,"toString",kn)}var Ln={anchor:function anchor(e){return ce.CreateHTML(this,"a","name",e)},big:function big(){return ce.CreateHTML(this,"big","","")},blink:function blink(){return ce.CreateHTML(this,"blink","","")},bold:function bold(){return ce.CreateHTML(this,"b","","")},fixed:function fixed(){return ce.CreateHTML(this,"tt","","")},fontcolor:function fontcolor(e){return ce.CreateHTML(this,"font","color",e)},fontsize:function fontsize(e){return ce.CreateHTML(this,"font","size",e)},italics:function italics(){return ce.CreateHTML(this,"i","","")},link:function link(e){return ce.CreateHTML(this,"a","href",e)},small:function small(){return ce.CreateHTML(this,"small","","")},strike:function strike(){return ce.CreateHTML(this,"strike","","")},sub:function sub(){return ce.CreateHTML(this,"sub","","")},sup:function sub(){return ce.CreateHTML(this,"sup","","")}};l(Object.keys(Ln),function(e){var r=String.prototype[e];var n=false;if(ce.IsCallable(r)){var o=t(r,"",' " ');var i=P([],o.match(/"/g)).length;n=o!==o.toLowerCase()||i>2}else{n=true}if(n){ne(String.prototype,e,Ln[e])}});var Fn=function(){if(!oe){return false}var e=typeof JSON==="object"&&typeof JSON.stringify==="function"?JSON.stringify:null;if(!e){return false}if(typeof e($())!=="undefined"){return true}if(e([$()])!=="[null]"){return true}var t={a:$()};t[$()]=true;if(e(t)!=="{}"){return true}return false}();var Dn=a(function(){if(!oe){return true}return JSON.stringify(Object($()))==="{}"&&JSON.stringify([Object($())])==="[{}]"});if(Fn||!Dn){var zn=JSON.stringify;ne(JSON,"stringify",function stringify(e){if(typeof e==="symbol"){return}var n;if(arguments.length>1){n=arguments[1]}var o=[e];if(!r(n)){var i=ce.IsCallable(n)?n:null;var a=function(e,r){var n=i?t(i,this,e,r):r;if(typeof n!=="symbol"){if(re.symbol(n)){return Nt({})(n)}else{return n}}};o.push(a)}else{o.push(n)}if(arguments.length>2){o.push(arguments[2])}return zn.apply(this,o)})}return S});
/*! jQuery v3.6.0 | (c) OpenJS Foundation and other contributors | jquery.org/license */
!function(e,t){"use strict";"object"==typeof module&&"object"==typeof module.exports?module.exports=e.document?t(e,!0):function(e){if(!e.document)throw new Error("jQuery requires a window with a document");return t(e)}:t(e)}("undefined"!=typeof window?window:this,function(C,e){"use strict";var t=[],r=Object.getPrototypeOf,s=t.slice,g=t.flat?function(e){return t.flat.call(e)}:function(e){return t.concat.apply([],e)},u=t.push,i=t.indexOf,n={},o=n.toString,v=n.hasOwnProperty,a=v.toString,l=a.call(Object),y={},m=function(e){return"function"==typeof e&&"number"!=typeof e.nodeType&&"function"!=typeof e.item},x=function(e){return null!=e&&e===e.window},E=C.document,c={type:!0,src:!0,nonce:!0,noModule:!0};function b(e,t,n){var r,i,o=(n=n||E).createElement("script");if(o.text=e,t)for(r in c)(i=t[r]||t.getAttribute&&t.getAttribute(r))&&o.setAttribute(r,i);n.head.appendChild(o).parentNode.removeChild(o)}function w(e){return null==e?e+"":"object"==typeof e||"function"==typeof e?n[o.call(e)]||"object":typeof e}var f="3.6.0",S=function(e,t){return new S.fn.init(e,t)};function p(e){var t=!!e&&"length"in e&&e.length,n=w(e);return!m(e)&&!x(e)&&("array"===n||0===t||"number"==typeof t&&0<t&&t-1 in e)}S.fn=S.prototype={jquery:f,constructor:S,length:0,toArray:function(){return s.call(this)},get:function(e){return null==e?s.call(this):e<0?this[e+this.length]:this[e]},pushStack:function(e){var t=S.merge(this.constructor(),e);return t.prevObject=this,t},each:function(e){return S.each(this,e)},map:function(n){return this.pushStack(S.map(this,function(e,t){return n.call(e,t,e)}))},slice:function(){return this.pushStack(s.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},even:function(){return this.pushStack(S.grep(this,function(e,t){return(t+1)%2}))},odd:function(){return this.pushStack(S.grep(this,function(e,t){return t%2}))},eq:function(e){var t=this.length,n=+e+(e<0?t:0);return this.pushStack(0<=n&&n<t?[this[n]]:[])},end:function(){return this.prevObject||this.constructor()},push:u,sort:t.sort,splice:t.splice},S.extend=S.fn.extend=function(){var e,t,n,r,i,o,a=arguments[0]||{},s=1,u=arguments.length,l=!1;for("boolean"==typeof a&&(l=a,a=arguments[s]||{},s++),"object"==typeof a||m(a)||(a={}),s===u&&(a=this,s--);s<u;s++)if(null!=(e=arguments[s]))for(t in e)r=e[t],"__proto__"!==t&&a!==r&&(l&&r&&(S.isPlainObject(r)||(i=Array.isArray(r)))?(n=a[t],o=i&&!Array.isArray(n)?[]:i||S.isPlainObject(n)?n:{},i=!1,a[t]=S.extend(l,o,r)):void 0!==r&&(a[t]=r));return a},S.extend({expando:"jQuery"+(f+Math.random()).replace(/\D/g,""),isReady:!0,error:function(e){throw new Error(e)},noop:function(){},isPlainObject:function(e){var t,n;return!(!e||"[object Object]"!==o.call(e))&&(!(t=r(e))||"function"==typeof(n=v.call(t,"constructor")&&t.constructor)&&a.call(n)===l)},isEmptyObject:function(e){var t;for(t in e)return!1;return!0},globalEval:function(e,t,n){b(e,{nonce:t&&t.nonce},n)},each:function(e,t){var n,r=0;if(p(e)){for(n=e.length;r<n;r++)if(!1===t.call(e[r],r,e[r]))break}else for(r in e)if(!1===t.call(e[r],r,e[r]))break;return e},makeArray:function(e,t){var n=t||[];return null!=e&&(p(Object(e))?S.merge(n,"string"==typeof e?[e]:e):u.call(n,e)),n},inArray:function(e,t,n){return null==t?-1:i.call(t,e,n)},merge:function(e,t){for(var n=+t.length,r=0,i=e.length;r<n;r++)e[i++]=t[r];return e.length=i,e},grep:function(e,t,n){for(var r=[],i=0,o=e.length,a=!n;i<o;i++)!t(e[i],i)!==a&&r.push(e[i]);return r},map:function(e,t,n){var r,i,o=0,a=[];if(p(e))for(r=e.length;o<r;o++)null!=(i=t(e[o],o,n))&&a.push(i);else for(o in e)null!=(i=t(e[o],o,n))&&a.push(i);return g(a)},guid:1,support:y}),"function"==typeof Symbol&&(S.fn[Symbol.iterator]=t[Symbol.iterator]),S.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "),function(e,t){n["[object "+t+"]"]=t.toLowerCase()});var d=function(n){var e,d,b,o,i,h,f,g,w,u,l,T,C,a,E,v,s,c,y,S="sizzle"+1*new Date,p=n.document,k=0,r=0,m=ue(),x=ue(),A=ue(),N=ue(),j=function(e,t){return e===t&&(l=!0),0},D={}.hasOwnProperty,t=[],q=t.pop,L=t.push,H=t.push,O=t.slice,P=function(e,t){for(var n=0,r=e.length;n<r;n++)if(e[n]===t)return n;return-1},R="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",M="[\\x20\\t\\r\\n\\f]",I="(?:\\\\[\\da-fA-F]{1,6}"+M+"?|\\\\[^\\r\\n\\f]|[\\w-]|[^\0-\\x7f])+",W="\\["+M+"*("+I+")(?:"+M+"*([*^$|!~]?=)"+M+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+I+"))|)"+M+"*\\]",F=":("+I+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+W+")*)|.*)\\)|)",B=new RegExp(M+"+","g"),$=new RegExp("^"+M+"+|((?:^|[^\\\\])(?:\\\\.)*)"+M+"+$","g"),_=new RegExp("^"+M+"*,"+M+"*"),z=new RegExp("^"+M+"*([>+~]|"+M+")"+M+"*"),U=new RegExp(M+"|>"),X=new RegExp(F),V=new RegExp("^"+I+"$"),G={ID:new RegExp("^#("+I+")"),CLASS:new RegExp("^\\.("+I+")"),TAG:new RegExp("^("+I+"|[*])"),ATTR:new RegExp("^"+W),PSEUDO:new RegExp("^"+F),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+M+"*(even|odd|(([+-]|)(\\d*)n|)"+M+"*(?:([+-]|)"+M+"*(\\d+)|))"+M+"*\\)|)","i"),bool:new RegExp("^(?:"+R+")$","i"),needsContext:new RegExp("^"+M+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+M+"*((?:-\\d)?\\d*)"+M+"*\\)|)(?=[^-]|$)","i")},Y=/HTML$/i,Q=/^(?:input|select|textarea|button)$/i,J=/^h\d$/i,K=/^[^{]+\{\s*\[native \w/,Z=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,ee=/[+~]/,te=new RegExp("\\\\[\\da-fA-F]{1,6}"+M+"?|\\\\([^\\r\\n\\f])","g"),ne=function(e,t){var n="0x"+e.slice(1)-65536;return t||(n<0?String.fromCharCode(n+65536):String.fromCharCode(n>>10|55296,1023&n|56320))},re=/([\0-\x1f\x7f]|^-?\d)|^-$|[^\0-\x1f\x7f-\uFFFF\w-]/g,ie=function(e,t){return t?"\0"===e?"\ufffd":e.slice(0,-1)+"\\"+e.charCodeAt(e.length-1).toString(16)+" ":"\\"+e},oe=function(){T()},ae=be(function(e){return!0===e.disabled&&"fieldset"===e.nodeName.toLowerCase()},{dir:"parentNode",next:"legend"});try{H.apply(t=O.call(p.childNodes),p.childNodes),t[p.childNodes.length].nodeType}catch(e){H={apply:t.length?function(e,t){L.apply(e,O.call(t))}:function(e,t){var n=e.length,r=0;while(e[n++]=t[r++]);e.length=n-1}}}function se(t,e,n,r){var i,o,a,s,u,l,c,f=e&&e.ownerDocument,p=e?e.nodeType:9;if(n=n||[],"string"!=typeof t||!t||1!==p&&9!==p&&11!==p)return n;if(!r&&(T(e),e=e||C,E)){if(11!==p&&(u=Z.exec(t)))if(i=u[1]){if(9===p){if(!(a=e.getElementById(i)))return n;if(a.id===i)return n.push(a),n}else if(f&&(a=f.getElementById(i))&&y(e,a)&&a.id===i)return n.push(a),n}else{if(u[2])return H.apply(n,e.getElementsByTagName(t)),n;if((i=u[3])&&d.getElementsByClassName&&e.getElementsByClassName)return H.apply(n,e.getElementsByClassName(i)),n}if(d.qsa&&!N[t+" "]&&(!v||!v.test(t))&&(1!==p||"object"!==e.nodeName.toLowerCase())){if(c=t,f=e,1===p&&(U.test(t)||z.test(t))){(f=ee.test(t)&&ye(e.parentNode)||e)===e&&d.scope||((s=e.getAttribute("id"))?s=s.replace(re,ie):e.setAttribute("id",s=S)),o=(l=h(t)).length;while(o--)l[o]=(s?"#"+s:":scope")+" "+xe(l[o]);c=l.join(",")}try{return H.apply(n,f.querySelectorAll(c)),n}catch(e){N(t,!0)}finally{s===S&&e.removeAttribute("id")}}}return g(t.replace($,"$1"),e,n,r)}function ue(){var r=[];return function e(t,n){return r.push(t+" ")>b.cacheLength&&delete e[r.shift()],e[t+" "]=n}}function le(e){return e[S]=!0,e}function ce(e){var t=C.createElement("fieldset");try{return!!e(t)}catch(e){return!1}finally{t.parentNode&&t.parentNode.removeChild(t),t=null}}function fe(e,t){var n=e.split("|"),r=n.length;while(r--)b.attrHandle[n[r]]=t}function pe(e,t){var n=t&&e,r=n&&1===e.nodeType&&1===t.nodeType&&e.sourceIndex-t.sourceIndex;if(r)return r;if(n)while(n=n.nextSibling)if(n===t)return-1;return e?1:-1}function de(t){return function(e){return"input"===e.nodeName.toLowerCase()&&e.type===t}}function he(n){return function(e){var t=e.nodeName.toLowerCase();return("input"===t||"button"===t)&&e.type===n}}function ge(t){return function(e){return"form"in e?e.parentNode&&!1===e.disabled?"label"in e?"label"in e.parentNode?e.parentNode.disabled===t:e.disabled===t:e.isDisabled===t||e.isDisabled!==!t&&ae(e)===t:e.disabled===t:"label"in e&&e.disabled===t}}function ve(a){return le(function(o){return o=+o,le(function(e,t){var n,r=a([],e.length,o),i=r.length;while(i--)e[n=r[i]]&&(e[n]=!(t[n]=e[n]))})})}function ye(e){return e&&"undefined"!=typeof e.getElementsByTagName&&e}for(e in d=se.support={},i=se.isXML=function(e){var t=e&&e.namespaceURI,n=e&&(e.ownerDocument||e).documentElement;return!Y.test(t||n&&n.nodeName||"HTML")},T=se.setDocument=function(e){var t,n,r=e?e.ownerDocument||e:p;return r!=C&&9===r.nodeType&&r.documentElement&&(a=(C=r).documentElement,E=!i(C),p!=C&&(n=C.defaultView)&&n.top!==n&&(n.addEventListener?n.addEventListener("unload",oe,!1):n.attachEvent&&n.attachEvent("onunload",oe)),d.scope=ce(function(e){return a.appendChild(e).appendChild(C.createElement("div")),"undefined"!=typeof e.querySelectorAll&&!e.querySelectorAll(":scope fieldset div").length}),d.attributes=ce(function(e){return e.className="i",!e.getAttribute("className")}),d.getElementsByTagName=ce(function(e){return e.appendChild(C.createComment("")),!e.getElementsByTagName("*").length}),d.getElementsByClassName=K.test(C.getElementsByClassName),d.getById=ce(function(e){return a.appendChild(e).id=S,!C.getElementsByName||!C.getElementsByName(S).length}),d.getById?(b.filter.ID=function(e){var t=e.replace(te,ne);return function(e){return e.getAttribute("id")===t}},b.find.ID=function(e,t){if("undefined"!=typeof t.getElementById&&E){var n=t.getElementById(e);return n?[n]:[]}}):(b.filter.ID=function(e){var n=e.replace(te,ne);return function(e){var t="undefined"!=typeof e.getAttributeNode&&e.getAttributeNode("id");return t&&t.value===n}},b.find.ID=function(e,t){if("undefined"!=typeof t.getElementById&&E){var n,r,i,o=t.getElementById(e);if(o){if((n=o.getAttributeNode("id"))&&n.value===e)return[o];i=t.getElementsByName(e),r=0;while(o=i[r++])if((n=o.getAttributeNode("id"))&&n.value===e)return[o]}return[]}}),b.find.TAG=d.getElementsByTagName?function(e,t){return"undefined"!=typeof t.getElementsByTagName?t.getElementsByTagName(e):d.qsa?t.querySelectorAll(e):void 0}:function(e,t){var n,r=[],i=0,o=t.getElementsByTagName(e);if("*"===e){while(n=o[i++])1===n.nodeType&&r.push(n);return r}return o},b.find.CLASS=d.getElementsByClassName&&function(e,t){if("undefined"!=typeof t.getElementsByClassName&&E)return t.getElementsByClassName(e)},s=[],v=[],(d.qsa=K.test(C.querySelectorAll))&&(ce(function(e){var t;a.appendChild(e).innerHTML="<a id='"+S+"'></a><select id='"+S+"-\r\\' msallowcapture=''><option selected=''></option></select>",e.querySelectorAll("[msallowcapture^='']").length&&v.push("[*^$]="+M+"*(?:''|\"\")"),e.querySelectorAll("[selected]").length||v.push("\\["+M+"*(?:value|"+R+")"),e.querySelectorAll("[id~="+S+"-]").length||v.push("~="),(t=C.createElement("input")).setAttribute("name",""),e.appendChild(t),e.querySelectorAll("[name='']").length||v.push("\\["+M+"*name"+M+"*="+M+"*(?:''|\"\")"),e.querySelectorAll(":checked").length||v.push(":checked"),e.querySelectorAll("a#"+S+"+*").length||v.push(".#.+[+~]"),e.querySelectorAll("\\\f"),v.push("[\\r\\n\\f]")}),ce(function(e){e.innerHTML="<a href='' disabled='disabled'></a><select disabled='disabled'><option/></select>";var t=C.createElement("input");t.setAttribute("type","hidden"),e.appendChild(t).setAttribute("name","D"),e.querySelectorAll("[name=d]").length&&v.push("name"+M+"*[*^$|!~]?="),2!==e.querySelectorAll(":enabled").length&&v.push(":enabled",":disabled"),a.appendChild(e).disabled=!0,2!==e.querySelectorAll(":disabled").length&&v.push(":enabled",":disabled"),e.querySelectorAll("*,:x"),v.push(",.*:")})),(d.matchesSelector=K.test(c=a.matches||a.webkitMatchesSelector||a.mozMatchesSelector||a.oMatchesSelector||a.msMatchesSelector))&&ce(function(e){d.disconnectedMatch=c.call(e,"*"),c.call(e,"[s!='']:x"),s.push("!=",F)}),v=v.length&&new RegExp(v.join("|")),s=s.length&&new RegExp(s.join("|")),t=K.test(a.compareDocumentPosition),y=t||K.test(a.contains)?function(e,t){var n=9===e.nodeType?e.documentElement:e,r=t&&t.parentNode;return e===r||!(!r||1!==r.nodeType||!(n.contains?n.contains(r):e.compareDocumentPosition&&16&e.compareDocumentPosition(r)))}:function(e,t){if(t)while(t=t.parentNode)if(t===e)return!0;return!1},j=t?function(e,t){if(e===t)return l=!0,0;var n=!e.compareDocumentPosition-!t.compareDocumentPosition;return n||(1&(n=(e.ownerDocument||e)==(t.ownerDocument||t)?e.compareDocumentPosition(t):1)||!d.sortDetached&&t.compareDocumentPosition(e)===n?e==C||e.ownerDocument==p&&y(p,e)?-1:t==C||t.ownerDocument==p&&y(p,t)?1:u?P(u,e)-P(u,t):0:4&n?-1:1)}:function(e,t){if(e===t)return l=!0,0;var n,r=0,i=e.parentNode,o=t.parentNode,a=[e],s=[t];if(!i||!o)return e==C?-1:t==C?1:i?-1:o?1:u?P(u,e)-P(u,t):0;if(i===o)return pe(e,t);n=e;while(n=n.parentNode)a.unshift(n);n=t;while(n=n.parentNode)s.unshift(n);while(a[r]===s[r])r++;return r?pe(a[r],s[r]):a[r]==p?-1:s[r]==p?1:0}),C},se.matches=function(e,t){return se(e,null,null,t)},se.matchesSelector=function(e,t){if(T(e),d.matchesSelector&&E&&!N[t+" "]&&(!s||!s.test(t))&&(!v||!v.test(t)))try{var n=c.call(e,t);if(n||d.disconnectedMatch||e.document&&11!==e.document.nodeType)return n}catch(e){N(t,!0)}return 0<se(t,C,null,[e]).length},se.contains=function(e,t){return(e.ownerDocument||e)!=C&&T(e),y(e,t)},se.attr=function(e,t){(e.ownerDocument||e)!=C&&T(e);var n=b.attrHandle[t.toLowerCase()],r=n&&D.call(b.attrHandle,t.toLowerCase())?n(e,t,!E):void 0;return void 0!==r?r:d.attributes||!E?e.getAttribute(t):(r=e.getAttributeNode(t))&&r.specified?r.value:null},se.escape=function(e){return(e+"").replace(re,ie)},se.error=function(e){throw new Error("Syntax error, unrecognized expression: "+e)},se.uniqueSort=function(e){var t,n=[],r=0,i=0;if(l=!d.detectDuplicates,u=!d.sortStable&&e.slice(0),e.sort(j),l){while(t=e[i++])t===e[i]&&(r=n.push(i));while(r--)e.splice(n[r],1)}return u=null,e},o=se.getText=function(e){var t,n="",r=0,i=e.nodeType;if(i){if(1===i||9===i||11===i){if("string"==typeof e.textContent)return e.textContent;for(e=e.firstChild;e;e=e.nextSibling)n+=o(e)}else if(3===i||4===i)return e.nodeValue}else while(t=e[r++])n+=o(t);return n},(b=se.selectors={cacheLength:50,createPseudo:le,match:G,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(e){return e[1]=e[1].replace(te,ne),e[3]=(e[3]||e[4]||e[5]||"").replace(te,ne),"~="===e[2]&&(e[3]=" "+e[3]+" "),e.slice(0,4)},CHILD:function(e){return e[1]=e[1].toLowerCase(),"nth"===e[1].slice(0,3)?(e[3]||se.error(e[0]),e[4]=+(e[4]?e[5]+(e[6]||1):2*("even"===e[3]||"odd"===e[3])),e[5]=+(e[7]+e[8]||"odd"===e[3])):e[3]&&se.error(e[0]),e},PSEUDO:function(e){var t,n=!e[6]&&e[2];return G.CHILD.test(e[0])?null:(e[3]?e[2]=e[4]||e[5]||"":n&&X.test(n)&&(t=h(n,!0))&&(t=n.indexOf(")",n.length-t)-n.length)&&(e[0]=e[0].slice(0,t),e[2]=n.slice(0,t)),e.slice(0,3))}},filter:{TAG:function(e){var t=e.replace(te,ne).toLowerCase();return"*"===e?function(){return!0}:function(e){return e.nodeName&&e.nodeName.toLowerCase()===t}},CLASS:function(e){var t=m[e+" "];return t||(t=new RegExp("(^|"+M+")"+e+"("+M+"|$)"))&&m(e,function(e){return t.test("string"==typeof e.className&&e.className||"undefined"!=typeof e.getAttribute&&e.getAttribute("class")||"")})},ATTR:function(n,r,i){return function(e){var t=se.attr(e,n);return null==t?"!="===r:!r||(t+="","="===r?t===i:"!="===r?t!==i:"^="===r?i&&0===t.indexOf(i):"*="===r?i&&-1<t.indexOf(i):"$="===r?i&&t.slice(-i.length)===i:"~="===r?-1<(" "+t.replace(B," ")+" ").indexOf(i):"|="===r&&(t===i||t.slice(0,i.length+1)===i+"-"))}},CHILD:function(h,e,t,g,v){var y="nth"!==h.slice(0,3),m="last"!==h.slice(-4),x="of-type"===e;return 1===g&&0===v?function(e){return!!e.parentNode}:function(e,t,n){var r,i,o,a,s,u,l=y!==m?"nextSibling":"previousSibling",c=e.parentNode,f=x&&e.nodeName.toLowerCase(),p=!n&&!x,d=!1;if(c){if(y){while(l){a=e;while(a=a[l])if(x?a.nodeName.toLowerCase()===f:1===a.nodeType)return!1;u=l="only"===h&&!u&&"nextSibling"}return!0}if(u=[m?c.firstChild:c.lastChild],m&&p){d=(s=(r=(i=(o=(a=c)[S]||(a[S]={}))[a.uniqueID]||(o[a.uniqueID]={}))[h]||[])[0]===k&&r[1])&&r[2],a=s&&c.childNodes[s];while(a=++s&&a&&a[l]||(d=s=0)||u.pop())if(1===a.nodeType&&++d&&a===e){i[h]=[k,s,d];break}}else if(p&&(d=s=(r=(i=(o=(a=e)[S]||(a[S]={}))[a.uniqueID]||(o[a.uniqueID]={}))[h]||[])[0]===k&&r[1]),!1===d)while(a=++s&&a&&a[l]||(d=s=0)||u.pop())if((x?a.nodeName.toLowerCase()===f:1===a.nodeType)&&++d&&(p&&((i=(o=a[S]||(a[S]={}))[a.uniqueID]||(o[a.uniqueID]={}))[h]=[k,d]),a===e))break;return(d-=v)===g||d%g==0&&0<=d/g}}},PSEUDO:function(e,o){var t,a=b.pseudos[e]||b.setFilters[e.toLowerCase()]||se.error("unsupported pseudo: "+e);return a[S]?a(o):1<a.length?(t=[e,e,"",o],b.setFilters.hasOwnProperty(e.toLowerCase())?le(function(e,t){var n,r=a(e,o),i=r.length;while(i--)e[n=P(e,r[i])]=!(t[n]=r[i])}):function(e){return a(e,0,t)}):a}},pseudos:{not:le(function(e){var r=[],i=[],s=f(e.replace($,"$1"));return s[S]?le(function(e,t,n,r){var i,o=s(e,null,r,[]),a=e.length;while(a--)(i=o[a])&&(e[a]=!(t[a]=i))}):function(e,t,n){return r[0]=e,s(r,null,n,i),r[0]=null,!i.pop()}}),has:le(function(t){return function(e){return 0<se(t,e).length}}),contains:le(function(t){return t=t.replace(te,ne),function(e){return-1<(e.textContent||o(e)).indexOf(t)}}),lang:le(function(n){return V.test(n||"")||se.error("unsupported lang: "+n),n=n.replace(te,ne).toLowerCase(),function(e){var t;do{if(t=E?e.lang:e.getAttribute("xml:lang")||e.getAttribute("lang"))return(t=t.toLowerCase())===n||0===t.indexOf(n+"-")}while((e=e.parentNode)&&1===e.nodeType);return!1}}),target:function(e){var t=n.location&&n.location.hash;return t&&t.slice(1)===e.id},root:function(e){return e===a},focus:function(e){return e===C.activeElement&&(!C.hasFocus||C.hasFocus())&&!!(e.type||e.href||~e.tabIndex)},enabled:ge(!1),disabled:ge(!0),checked:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&!!e.checked||"option"===t&&!!e.selected},selected:function(e){return e.parentNode&&e.parentNode.selectedIndex,!0===e.selected},empty:function(e){for(e=e.firstChild;e;e=e.nextSibling)if(e.nodeType<6)return!1;return!0},parent:function(e){return!b.pseudos.empty(e)},header:function(e){return J.test(e.nodeName)},input:function(e){return Q.test(e.nodeName)},button:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&"button"===e.type||"button"===t},text:function(e){var t;return"input"===e.nodeName.toLowerCase()&&"text"===e.type&&(null==(t=e.getAttribute("type"))||"text"===t.toLowerCase())},first:ve(function(){return[0]}),last:ve(function(e,t){return[t-1]}),eq:ve(function(e,t,n){return[n<0?n+t:n]}),even:ve(function(e,t){for(var n=0;n<t;n+=2)e.push(n);return e}),odd:ve(function(e,t){for(var n=1;n<t;n+=2)e.push(n);return e}),lt:ve(function(e,t,n){for(var r=n<0?n+t:t<n?t:n;0<=--r;)e.push(r);return e}),gt:ve(function(e,t,n){for(var r=n<0?n+t:n;++r<t;)e.push(r);return e})}}).pseudos.nth=b.pseudos.eq,{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})b.pseudos[e]=de(e);for(e in{submit:!0,reset:!0})b.pseudos[e]=he(e);function me(){}function xe(e){for(var t=0,n=e.length,r="";t<n;t++)r+=e[t].value;return r}function be(s,e,t){var u=e.dir,l=e.next,c=l||u,f=t&&"parentNode"===c,p=r++;return e.first?function(e,t,n){while(e=e[u])if(1===e.nodeType||f)return s(e,t,n);return!1}:function(e,t,n){var r,i,o,a=[k,p];if(n){while(e=e[u])if((1===e.nodeType||f)&&s(e,t,n))return!0}else while(e=e[u])if(1===e.nodeType||f)if(i=(o=e[S]||(e[S]={}))[e.uniqueID]||(o[e.uniqueID]={}),l&&l===e.nodeName.toLowerCase())e=e[u]||e;else{if((r=i[c])&&r[0]===k&&r[1]===p)return a[2]=r[2];if((i[c]=a)[2]=s(e,t,n))return!0}return!1}}function we(i){return 1<i.length?function(e,t,n){var r=i.length;while(r--)if(!i[r](e,t,n))return!1;return!0}:i[0]}function Te(e,t,n,r,i){for(var o,a=[],s=0,u=e.length,l=null!=t;s<u;s++)(o=e[s])&&(n&&!n(o,r,i)||(a.push(o),l&&t.push(s)));return a}function Ce(d,h,g,v,y,e){return v&&!v[S]&&(v=Ce(v)),y&&!y[S]&&(y=Ce(y,e)),le(function(e,t,n,r){var i,o,a,s=[],u=[],l=t.length,c=e||function(e,t,n){for(var r=0,i=t.length;r<i;r++)se(e,t[r],n);return n}(h||"*",n.nodeType?[n]:n,[]),f=!d||!e&&h?c:Te(c,s,d,n,r),p=g?y||(e?d:l||v)?[]:t:f;if(g&&g(f,p,n,r),v){i=Te(p,u),v(i,[],n,r),o=i.length;while(o--)(a=i[o])&&(p[u[o]]=!(f[u[o]]=a))}if(e){if(y||d){if(y){i=[],o=p.length;while(o--)(a=p[o])&&i.push(f[o]=a);y(null,p=[],i,r)}o=p.length;while(o--)(a=p[o])&&-1<(i=y?P(e,a):s[o])&&(e[i]=!(t[i]=a))}}else p=Te(p===t?p.splice(l,p.length):p),y?y(null,t,p,r):H.apply(t,p)})}function Ee(e){for(var i,t,n,r=e.length,o=b.relative[e[0].type],a=o||b.relative[" "],s=o?1:0,u=be(function(e){return e===i},a,!0),l=be(function(e){return-1<P(i,e)},a,!0),c=[function(e,t,n){var r=!o&&(n||t!==w)||((i=t).nodeType?u(e,t,n):l(e,t,n));return i=null,r}];s<r;s++)if(t=b.relative[e[s].type])c=[be(we(c),t)];else{if((t=b.filter[e[s].type].apply(null,e[s].matches))[S]){for(n=++s;n<r;n++)if(b.relative[e[n].type])break;return Ce(1<s&&we(c),1<s&&xe(e.slice(0,s-1).concat({value:" "===e[s-2].type?"*":""})).replace($,"$1"),t,s<n&&Ee(e.slice(s,n)),n<r&&Ee(e=e.slice(n)),n<r&&xe(e))}c.push(t)}return we(c)}return me.prototype=b.filters=b.pseudos,b.setFilters=new me,h=se.tokenize=function(e,t){var n,r,i,o,a,s,u,l=x[e+" "];if(l)return t?0:l.slice(0);a=e,s=[],u=b.preFilter;while(a){for(o in n&&!(r=_.exec(a))||(r&&(a=a.slice(r[0].length)||a),s.push(i=[])),n=!1,(r=z.exec(a))&&(n=r.shift(),i.push({value:n,type:r[0].replace($," ")}),a=a.slice(n.length)),b.filter)!(r=G[o].exec(a))||u[o]&&!(r=u[o](r))||(n=r.shift(),i.push({value:n,type:o,matches:r}),a=a.slice(n.length));if(!n)break}return t?a.length:a?se.error(e):x(e,s).slice(0)},f=se.compile=function(e,t){var n,v,y,m,x,r,i=[],o=[],a=A[e+" "];if(!a){t||(t=h(e)),n=t.length;while(n--)(a=Ee(t[n]))[S]?i.push(a):o.push(a);(a=A(e,(v=o,m=0<(y=i).length,x=0<v.length,r=function(e,t,n,r,i){var o,a,s,u=0,l="0",c=e&&[],f=[],p=w,d=e||x&&b.find.TAG("*",i),h=k+=null==p?1:Math.random()||.1,g=d.length;for(i&&(w=t==C||t||i);l!==g&&null!=(o=d[l]);l++){if(x&&o){a=0,t||o.ownerDocument==C||(T(o),n=!E);while(s=v[a++])if(s(o,t||C,n)){r.push(o);break}i&&(k=h)}m&&((o=!s&&o)&&u--,e&&c.push(o))}if(u+=l,m&&l!==u){a=0;while(s=y[a++])s(c,f,t,n);if(e){if(0<u)while(l--)c[l]||f[l]||(f[l]=q.call(r));f=Te(f)}H.apply(r,f),i&&!e&&0<f.length&&1<u+y.length&&se.uniqueSort(r)}return i&&(k=h,w=p),c},m?le(r):r))).selector=e}return a},g=se.select=function(e,t,n,r){var i,o,a,s,u,l="function"==typeof e&&e,c=!r&&h(e=l.selector||e);if(n=n||[],1===c.length){if(2<(o=c[0]=c[0].slice(0)).length&&"ID"===(a=o[0]).type&&9===t.nodeType&&E&&b.relative[o[1].type]){if(!(t=(b.find.ID(a.matches[0].replace(te,ne),t)||[])[0]))return n;l&&(t=t.parentNode),e=e.slice(o.shift().value.length)}i=G.needsContext.test(e)?0:o.length;while(i--){if(a=o[i],b.relative[s=a.type])break;if((u=b.find[s])&&(r=u(a.matches[0].replace(te,ne),ee.test(o[0].type)&&ye(t.parentNode)||t))){if(o.splice(i,1),!(e=r.length&&xe(o)))return H.apply(n,r),n;break}}}return(l||f(e,c))(r,t,!E,n,!t||ee.test(e)&&ye(t.parentNode)||t),n},d.sortStable=S.split("").sort(j).join("")===S,d.detectDuplicates=!!l,T(),d.sortDetached=ce(function(e){return 1&e.compareDocumentPosition(C.createElement("fieldset"))}),ce(function(e){return e.innerHTML="<a href='#'></a>","#"===e.firstChild.getAttribute("href")})||fe("type|href|height|width",function(e,t,n){if(!n)return e.getAttribute(t,"type"===t.toLowerCase()?1:2)}),d.attributes&&ce(function(e){return e.innerHTML="<input/>",e.firstChild.setAttribute("value",""),""===e.firstChild.getAttribute("value")})||fe("value",function(e,t,n){if(!n&&"input"===e.nodeName.toLowerCase())return e.defaultValue}),ce(function(e){return null==e.getAttribute("disabled")})||fe(R,function(e,t,n){var r;if(!n)return!0===e[t]?t.toLowerCase():(r=e.getAttributeNode(t))&&r.specified?r.value:null}),se}(C);S.find=d,S.expr=d.selectors,S.expr[":"]=S.expr.pseudos,S.uniqueSort=S.unique=d.uniqueSort,S.text=d.getText,S.isXMLDoc=d.isXML,S.contains=d.contains,S.escapeSelector=d.escape;var h=function(e,t,n){var r=[],i=void 0!==n;while((e=e[t])&&9!==e.nodeType)if(1===e.nodeType){if(i&&S(e).is(n))break;r.push(e)}return r},T=function(e,t){for(var n=[];e;e=e.nextSibling)1===e.nodeType&&e!==t&&n.push(e);return n},k=S.expr.match.needsContext;function A(e,t){return e.nodeName&&e.nodeName.toLowerCase()===t.toLowerCase()}var N=/^<([a-z][^\/\0>:\x20\t\r\n\f]*)[\x20\t\r\n\f]*\/?>(?:<\/\1>|)$/i;function j(e,n,r){return m(n)?S.grep(e,function(e,t){return!!n.call(e,t,e)!==r}):n.nodeType?S.grep(e,function(e){return e===n!==r}):"string"!=typeof n?S.grep(e,function(e){return-1<i.call(n,e)!==r}):S.filter(n,e,r)}S.filter=function(e,t,n){var r=t[0];return n&&(e=":not("+e+")"),1===t.length&&1===r.nodeType?S.find.matchesSelector(r,e)?[r]:[]:S.find.matches(e,S.grep(t,function(e){return 1===e.nodeType}))},S.fn.extend({find:function(e){var t,n,r=this.length,i=this;if("string"!=typeof e)return this.pushStack(S(e).filter(function(){for(t=0;t<r;t++)if(S.contains(i[t],this))return!0}));for(n=this.pushStack([]),t=0;t<r;t++)S.find(e,i[t],n);return 1<r?S.uniqueSort(n):n},filter:function(e){return this.pushStack(j(this,e||[],!1))},not:function(e){return this.pushStack(j(this,e||[],!0))},is:function(e){return!!j(this,"string"==typeof e&&k.test(e)?S(e):e||[],!1).length}});var D,q=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]+))$/;(S.fn.init=function(e,t,n){var r,i;if(!e)return this;if(n=n||D,"string"==typeof e){if(!(r="<"===e[0]&&">"===e[e.length-1]&&3<=e.length?[null,e,null]:q.exec(e))||!r[1]&&t)return!t||t.jquery?(t||n).find(e):this.constructor(t).find(e);if(r[1]){if(t=t instanceof S?t[0]:t,S.merge(this,S.parseHTML(r[1],t&&t.nodeType?t.ownerDocument||t:E,!0)),N.test(r[1])&&S.isPlainObject(t))for(r in t)m(this[r])?this[r](t[r]):this.attr(r,t[r]);return this}return(i=E.getElementById(r[2]))&&(this[0]=i,this.length=1),this}return e.nodeType?(this[0]=e,this.length=1,this):m(e)?void 0!==n.ready?n.ready(e):e(S):S.makeArray(e,this)}).prototype=S.fn,D=S(E);var L=/^(?:parents|prev(?:Until|All))/,H={children:!0,contents:!0,next:!0,prev:!0};function O(e,t){while((e=e[t])&&1!==e.nodeType);return e}S.fn.extend({has:function(e){var t=S(e,this),n=t.length;return this.filter(function(){for(var e=0;e<n;e++)if(S.contains(this,t[e]))return!0})},closest:function(e,t){var n,r=0,i=this.length,o=[],a="string"!=typeof e&&S(e);if(!k.test(e))for(;r<i;r++)for(n=this[r];n&&n!==t;n=n.parentNode)if(n.nodeType<11&&(a?-1<a.index(n):1===n.nodeType&&S.find.matchesSelector(n,e))){o.push(n);break}return this.pushStack(1<o.length?S.uniqueSort(o):o)},index:function(e){return e?"string"==typeof e?i.call(S(e),this[0]):i.call(this,e.jquery?e[0]:e):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(e,t){return this.pushStack(S.uniqueSort(S.merge(this.get(),S(e,t))))},addBack:function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}}),S.each({parent:function(e){var t=e.parentNode;return t&&11!==t.nodeType?t:null},parents:function(e){return h(e,"parentNode")},parentsUntil:function(e,t,n){return h(e,"parentNode",n)},next:function(e){return O(e,"nextSibling")},prev:function(e){return O(e,"previousSibling")},nextAll:function(e){return h(e,"nextSibling")},prevAll:function(e){return h(e,"previousSibling")},nextUntil:function(e,t,n){return h(e,"nextSibling",n)},prevUntil:function(e,t,n){return h(e,"previousSibling",n)},siblings:function(e){return T((e.parentNode||{}).firstChild,e)},children:function(e){return T(e.firstChild)},contents:function(e){return null!=e.contentDocument&&r(e.contentDocument)?e.contentDocument:(A(e,"template")&&(e=e.content||e),S.merge([],e.childNodes))}},function(r,i){S.fn[r]=function(e,t){var n=S.map(this,i,e);return"Until"!==r.slice(-5)&&(t=e),t&&"string"==typeof t&&(n=S.filter(t,n)),1<this.length&&(H[r]||S.uniqueSort(n),L.test(r)&&n.reverse()),this.pushStack(n)}});var P=/[^\x20\t\r\n\f]+/g;function R(e){return e}function M(e){throw e}function I(e,t,n,r){var i;try{e&&m(i=e.promise)?i.call(e).done(t).fail(n):e&&m(i=e.then)?i.call(e,t,n):t.apply(void 0,[e].slice(r))}catch(e){n.apply(void 0,[e])}}S.Callbacks=function(r){var e,n;r="string"==typeof r?(e=r,n={},S.each(e.match(P)||[],function(e,t){n[t]=!0}),n):S.extend({},r);var i,t,o,a,s=[],u=[],l=-1,c=function(){for(a=a||r.once,o=i=!0;u.length;l=-1){t=u.shift();while(++l<s.length)!1===s[l].apply(t[0],t[1])&&r.stopOnFalse&&(l=s.length,t=!1)}r.memory||(t=!1),i=!1,a&&(s=t?[]:"")},f={add:function(){return s&&(t&&!i&&(l=s.length-1,u.push(t)),function n(e){S.each(e,function(e,t){m(t)?r.unique&&f.has(t)||s.push(t):t&&t.length&&"string"!==w(t)&&n(t)})}(arguments),t&&!i&&c()),this},remove:function(){return S.each(arguments,function(e,t){var n;while(-1<(n=S.inArray(t,s,n)))s.splice(n,1),n<=l&&l--}),this},has:function(e){return e?-1<S.inArray(e,s):0<s.length},empty:function(){return s&&(s=[]),this},disable:function(){return a=u=[],s=t="",this},disabled:function(){return!s},lock:function(){return a=u=[],t||i||(s=t=""),this},locked:function(){return!!a},fireWith:function(e,t){return a||(t=[e,(t=t||[]).slice?t.slice():t],u.push(t),i||c()),this},fire:function(){return f.fireWith(this,arguments),this},fired:function(){return!!o}};return f},S.extend({Deferred:function(e){var o=[["notify","progress",S.Callbacks("memory"),S.Callbacks("memory"),2],["resolve","done",S.Callbacks("once memory"),S.Callbacks("once memory"),0,"resolved"],["reject","fail",S.Callbacks("once memory"),S.Callbacks("once memory"),1,"rejected"]],i="pending",a={state:function(){return i},always:function(){return s.done(arguments).fail(arguments),this},"catch":function(e){return a.then(null,e)},pipe:function(){var i=arguments;return S.Deferred(function(r){S.each(o,function(e,t){var n=m(i[t[4]])&&i[t[4]];s[t[1]](function(){var e=n&&n.apply(this,arguments);e&&m(e.promise)?e.promise().progress(r.notify).done(r.resolve).fail(r.reject):r[t[0]+"With"](this,n?[e]:arguments)})}),i=null}).promise()},then:function(t,n,r){var u=0;function l(i,o,a,s){return function(){var n=this,r=arguments,e=function(){var e,t;if(!(i<u)){if((e=a.apply(n,r))===o.promise())throw new TypeError("Thenable self-resolution");t=e&&("object"==typeof e||"function"==typeof e)&&e.then,m(t)?s?t.call(e,l(u,o,R,s),l(u,o,M,s)):(u++,t.call(e,l(u,o,R,s),l(u,o,M,s),l(u,o,R,o.notifyWith))):(a!==R&&(n=void 0,r=[e]),(s||o.resolveWith)(n,r))}},t=s?e:function(){try{e()}catch(e){S.Deferred.exceptionHook&&S.Deferred.exceptionHook(e,t.stackTrace),u<=i+1&&(a!==M&&(n=void 0,r=[e]),o.rejectWith(n,r))}};i?t():(S.Deferred.getStackHook&&(t.stackTrace=S.Deferred.getStackHook()),C.setTimeout(t))}}return S.Deferred(function(e){o[0][3].add(l(0,e,m(r)?r:R,e.notifyWith)),o[1][3].add(l(0,e,m(t)?t:R)),o[2][3].add(l(0,e,m(n)?n:M))}).promise()},promise:function(e){return null!=e?S.extend(e,a):a}},s={};return S.each(o,function(e,t){var n=t[2],r=t[5];a[t[1]]=n.add,r&&n.add(function(){i=r},o[3-e][2].disable,o[3-e][3].disable,o[0][2].lock,o[0][3].lock),n.add(t[3].fire),s[t[0]]=function(){return s[t[0]+"With"](this===s?void 0:this,arguments),this},s[t[0]+"With"]=n.fireWith}),a.promise(s),e&&e.call(s,s),s},when:function(e){var n=arguments.length,t=n,r=Array(t),i=s.call(arguments),o=S.Deferred(),a=function(t){return function(e){r[t]=this,i[t]=1<arguments.length?s.call(arguments):e,--n||o.resolveWith(r,i)}};if(n<=1&&(I(e,o.done(a(t)).resolve,o.reject,!n),"pending"===o.state()||m(i[t]&&i[t].then)))return o.then();while(t--)I(i[t],a(t),o.reject);return o.promise()}});var W=/^(Eval|Internal|Range|Reference|Syntax|Type|URI)Error$/;S.Deferred.exceptionHook=function(e,t){C.console&&C.console.warn&&e&&W.test(e.name)&&C.console.warn("jQuery.Deferred exception: "+e.message,e.stack,t)},S.readyException=function(e){C.setTimeout(function(){throw e})};var F=S.Deferred();function B(){E.removeEventListener("DOMContentLoaded",B),C.removeEventListener("load",B),S.ready()}S.fn.ready=function(e){return F.then(e)["catch"](function(e){S.readyException(e)}),this},S.extend({isReady:!1,readyWait:1,ready:function(e){(!0===e?--S.readyWait:S.isReady)||(S.isReady=!0)!==e&&0<--S.readyWait||F.resolveWith(E,[S])}}),S.ready.then=F.then,"complete"===E.readyState||"loading"!==E.readyState&&!E.documentElement.doScroll?C.setTimeout(S.ready):(E.addEventListener("DOMContentLoaded",B),C.addEventListener("load",B));var $=function(e,t,n,r,i,o,a){var s=0,u=e.length,l=null==n;if("object"===w(n))for(s in i=!0,n)$(e,t,s,n[s],!0,o,a);else if(void 0!==r&&(i=!0,m(r)||(a=!0),l&&(a?(t.call(e,r),t=null):(l=t,t=function(e,t,n){return l.call(S(e),n)})),t))for(;s<u;s++)t(e[s],n,a?r:r.call(e[s],s,t(e[s],n)));return i?e:l?t.call(e):u?t(e[0],n):o},_=/^-ms-/,z=/-([a-z])/g;function U(e,t){return t.toUpperCase()}function X(e){return e.replace(_,"ms-").replace(z,U)}var V=function(e){return 1===e.nodeType||9===e.nodeType||!+e.nodeType};function G(){this.expando=S.expando+G.uid++}G.uid=1,G.prototype={cache:function(e){var t=e[this.expando];return t||(t={},V(e)&&(e.nodeType?e[this.expando]=t:Object.defineProperty(e,this.expando,{value:t,configurable:!0}))),t},set:function(e,t,n){var r,i=this.cache(e);if("string"==typeof t)i[X(t)]=n;else for(r in t)i[X(r)]=t[r];return i},get:function(e,t){return void 0===t?this.cache(e):e[this.expando]&&e[this.expando][X(t)]},access:function(e,t,n){return void 0===t||t&&"string"==typeof t&&void 0===n?this.get(e,t):(this.set(e,t,n),void 0!==n?n:t)},remove:function(e,t){var n,r=e[this.expando];if(void 0!==r){if(void 0!==t){n=(t=Array.isArray(t)?t.map(X):(t=X(t))in r?[t]:t.match(P)||[]).length;while(n--)delete r[t[n]]}(void 0===t||S.isEmptyObject(r))&&(e.nodeType?e[this.expando]=void 0:delete e[this.expando])}},hasData:function(e){var t=e[this.expando];return void 0!==t&&!S.isEmptyObject(t)}};var Y=new G,Q=new G,J=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,K=/[A-Z]/g;function Z(e,t,n){var r,i;if(void 0===n&&1===e.nodeType)if(r="data-"+t.replace(K,"-$&").toLowerCase(),"string"==typeof(n=e.getAttribute(r))){try{n="true"===(i=n)||"false"!==i&&("null"===i?null:i===+i+""?+i:J.test(i)?JSON.parse(i):i)}catch(e){}Q.set(e,t,n)}else n=void 0;return n}S.extend({hasData:function(e){return Q.hasData(e)||Y.hasData(e)},data:function(e,t,n){return Q.access(e,t,n)},removeData:function(e,t){Q.remove(e,t)},_data:function(e,t,n){return Y.access(e,t,n)},_removeData:function(e,t){Y.remove(e,t)}}),S.fn.extend({data:function(n,e){var t,r,i,o=this[0],a=o&&o.attributes;if(void 0===n){if(this.length&&(i=Q.get(o),1===o.nodeType&&!Y.get(o,"hasDataAttrs"))){t=a.length;while(t--)a[t]&&0===(r=a[t].name).indexOf("data-")&&(r=X(r.slice(5)),Z(o,r,i[r]));Y.set(o,"hasDataAttrs",!0)}return i}return"object"==typeof n?this.each(function(){Q.set(this,n)}):$(this,function(e){var t;if(o&&void 0===e)return void 0!==(t=Q.get(o,n))?t:void 0!==(t=Z(o,n))?t:void 0;this.each(function(){Q.set(this,n,e)})},null,e,1<arguments.length,null,!0)},removeData:function(e){return this.each(function(){Q.remove(this,e)})}}),S.extend({queue:function(e,t,n){var r;if(e)return t=(t||"fx")+"queue",r=Y.get(e,t),n&&(!r||Array.isArray(n)?r=Y.access(e,t,S.makeArray(n)):r.push(n)),r||[]},dequeue:function(e,t){t=t||"fx";var n=S.queue(e,t),r=n.length,i=n.shift(),o=S._queueHooks(e,t);"inprogress"===i&&(i=n.shift(),r--),i&&("fx"===t&&n.unshift("inprogress"),delete o.stop,i.call(e,function(){S.dequeue(e,t)},o)),!r&&o&&o.empty.fire()},_queueHooks:function(e,t){var n=t+"queueHooks";return Y.get(e,n)||Y.access(e,n,{empty:S.Callbacks("once memory").add(function(){Y.remove(e,[t+"queue",n])})})}}),S.fn.extend({queue:function(t,n){var e=2;return"string"!=typeof t&&(n=t,t="fx",e--),arguments.length<e?S.queue(this[0],t):void 0===n?this:this.each(function(){var e=S.queue(this,t,n);S._queueHooks(this,t),"fx"===t&&"inprogress"!==e[0]&&S.dequeue(this,t)})},dequeue:function(e){return this.each(function(){S.dequeue(this,e)})},clearQueue:function(e){return this.queue(e||"fx",[])},promise:function(e,t){var n,r=1,i=S.Deferred(),o=this,a=this.length,s=function(){--r||i.resolveWith(o,[o])};"string"!=typeof e&&(t=e,e=void 0),e=e||"fx";while(a--)(n=Y.get(o[a],e+"queueHooks"))&&n.empty&&(r++,n.empty.add(s));return s(),i.promise(t)}});var ee=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,te=new RegExp("^(?:([+-])=|)("+ee+")([a-z%]*)$","i"),ne=["Top","Right","Bottom","Left"],re=E.documentElement,ie=function(e){return S.contains(e.ownerDocument,e)},oe={composed:!0};re.getRootNode&&(ie=function(e){return S.contains(e.ownerDocument,e)||e.getRootNode(oe)===e.ownerDocument});var ae=function(e,t){return"none"===(e=t||e).style.display||""===e.style.display&&ie(e)&&"none"===S.css(e,"display")};function se(e,t,n,r){var i,o,a=20,s=r?function(){return r.cur()}:function(){return S.css(e,t,"")},u=s(),l=n&&n[3]||(S.cssNumber[t]?"":"px"),c=e.nodeType&&(S.cssNumber[t]||"px"!==l&&+u)&&te.exec(S.css(e,t));if(c&&c[3]!==l){u/=2,l=l||c[3],c=+u||1;while(a--)S.style(e,t,c+l),(1-o)*(1-(o=s()/u||.5))<=0&&(a=0),c/=o;c*=2,S.style(e,t,c+l),n=n||[]}return n&&(c=+c||+u||0,i=n[1]?c+(n[1]+1)*n[2]:+n[2],r&&(r.unit=l,r.start=c,r.end=i)),i}var ue={};function le(e,t){for(var n,r,i,o,a,s,u,l=[],c=0,f=e.length;c<f;c++)(r=e[c]).style&&(n=r.style.display,t?("none"===n&&(l[c]=Y.get(r,"display")||null,l[c]||(r.style.display="")),""===r.style.display&&ae(r)&&(l[c]=(u=a=o=void 0,a=(i=r).ownerDocument,s=i.nodeName,(u=ue[s])||(o=a.body.appendChild(a.createElement(s)),u=S.css(o,"display"),o.parentNode.removeChild(o),"none"===u&&(u="block"),ue[s]=u)))):"none"!==n&&(l[c]="none",Y.set(r,"display",n)));for(c=0;c<f;c++)null!=l[c]&&(e[c].style.display=l[c]);return e}S.fn.extend({show:function(){return le(this,!0)},hide:function(){return le(this)},toggle:function(e){return"boolean"==typeof e?e?this.show():this.hide():this.each(function(){ae(this)?S(this).show():S(this).hide()})}});var ce,fe,pe=/^(?:checkbox|radio)$/i,de=/<([a-z][^\/\0>\x20\t\r\n\f]*)/i,he=/^$|^module$|\/(?:java|ecma)script/i;ce=E.createDocumentFragment().appendChild(E.createElement("div")),(fe=E.createElement("input")).setAttribute("type","radio"),fe.setAttribute("checked","checked"),fe.setAttribute("name","t"),ce.appendChild(fe),y.checkClone=ce.cloneNode(!0).cloneNode(!0).lastChild.checked,ce.innerHTML="<textarea>x</textarea>",y.noCloneChecked=!!ce.cloneNode(!0).lastChild.defaultValue,ce.innerHTML="<option></option>",y.option=!!ce.lastChild;var ge={thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};function ve(e,t){var n;return n="undefined"!=typeof e.getElementsByTagName?e.getElementsByTagName(t||"*"):"undefined"!=typeof e.querySelectorAll?e.querySelectorAll(t||"*"):[],void 0===t||t&&A(e,t)?S.merge([e],n):n}function ye(e,t){for(var n=0,r=e.length;n<r;n++)Y.set(e[n],"globalEval",!t||Y.get(t[n],"globalEval"))}ge.tbody=ge.tfoot=ge.colgroup=ge.caption=ge.thead,ge.th=ge.td,y.option||(ge.optgroup=ge.option=[1,"<select multiple='multiple'>","</select>"]);var me=/<|&#?\w+;/;function xe(e,t,n,r,i){for(var o,a,s,u,l,c,f=t.createDocumentFragment(),p=[],d=0,h=e.length;d<h;d++)if((o=e[d])||0===o)if("object"===w(o))S.merge(p,o.nodeType?[o]:o);else if(me.test(o)){a=a||f.appendChild(t.createElement("div")),s=(de.exec(o)||["",""])[1].toLowerCase(),u=ge[s]||ge._default,a.innerHTML=u[1]+S.htmlPrefilter(o)+u[2],c=u[0];while(c--)a=a.lastChild;S.merge(p,a.childNodes),(a=f.firstChild).textContent=""}else p.push(t.createTextNode(o));f.textContent="",d=0;while(o=p[d++])if(r&&-1<S.inArray(o,r))i&&i.push(o);else if(l=ie(o),a=ve(f.appendChild(o),"script"),l&&ye(a),n){c=0;while(o=a[c++])he.test(o.type||"")&&n.push(o)}return f}var be=/^([^.]*)(?:\.(.+)|)/;function we(){return!0}function Te(){return!1}function Ce(e,t){return e===function(){try{return E.activeElement}catch(e){}}()==("focus"===t)}function Ee(e,t,n,r,i,o){var a,s;if("object"==typeof t){for(s in"string"!=typeof n&&(r=r||n,n=void 0),t)Ee(e,s,n,r,t[s],o);return e}if(null==r&&null==i?(i=n,r=n=void 0):null==i&&("string"==typeof n?(i=r,r=void 0):(i=r,r=n,n=void 0)),!1===i)i=Te;else if(!i)return e;return 1===o&&(a=i,(i=function(e){return S().off(e),a.apply(this,arguments)}).guid=a.guid||(a.guid=S.guid++)),e.each(function(){S.event.add(this,t,i,r,n)})}function Se(e,i,o){o?(Y.set(e,i,!1),S.event.add(e,i,{namespace:!1,handler:function(e){var t,n,r=Y.get(this,i);if(1&e.isTrigger&&this[i]){if(r.length)(S.event.special[i]||{}).delegateType&&e.stopPropagation();else if(r=s.call(arguments),Y.set(this,i,r),t=o(this,i),this[i](),r!==(n=Y.get(this,i))||t?Y.set(this,i,!1):n={},r!==n)return e.stopImmediatePropagation(),e.preventDefault(),n&&n.value}else r.length&&(Y.set(this,i,{value:S.event.trigger(S.extend(r[0],S.Event.prototype),r.slice(1),this)}),e.stopImmediatePropagation())}})):void 0===Y.get(e,i)&&S.event.add(e,i,we)}S.event={global:{},add:function(t,e,n,r,i){var o,a,s,u,l,c,f,p,d,h,g,v=Y.get(t);if(V(t)){n.handler&&(n=(o=n).handler,i=o.selector),i&&S.find.matchesSelector(re,i),n.guid||(n.guid=S.guid++),(u=v.events)||(u=v.events=Object.create(null)),(a=v.handle)||(a=v.handle=function(e){return"undefined"!=typeof S&&S.event.triggered!==e.type?S.event.dispatch.apply(t,arguments):void 0}),l=(e=(e||"").match(P)||[""]).length;while(l--)d=g=(s=be.exec(e[l])||[])[1],h=(s[2]||"").split(".").sort(),d&&(f=S.event.special[d]||{},d=(i?f.delegateType:f.bindType)||d,f=S.event.special[d]||{},c=S.extend({type:d,origType:g,data:r,handler:n,guid:n.guid,selector:i,needsContext:i&&S.expr.match.needsContext.test(i),namespace:h.join(".")},o),(p=u[d])||((p=u[d]=[]).delegateCount=0,f.setup&&!1!==f.setup.call(t,r,h,a)||t.addEventListener&&t.addEventListener(d,a)),f.add&&(f.add.call(t,c),c.handler.guid||(c.handler.guid=n.guid)),i?p.splice(p.delegateCount++,0,c):p.push(c),S.event.global[d]=!0)}},remove:function(e,t,n,r,i){var o,a,s,u,l,c,f,p,d,h,g,v=Y.hasData(e)&&Y.get(e);if(v&&(u=v.events)){l=(t=(t||"").match(P)||[""]).length;while(l--)if(d=g=(s=be.exec(t[l])||[])[1],h=(s[2]||"").split(".").sort(),d){f=S.event.special[d]||{},p=u[d=(r?f.delegateType:f.bindType)||d]||[],s=s[2]&&new RegExp("(^|\\.)"+h.join("\\.(?:.*\\.|)")+"(\\.|$)"),a=o=p.length;while(o--)c=p[o],!i&&g!==c.origType||n&&n.guid!==c.guid||s&&!s.test(c.namespace)||r&&r!==c.selector&&("**"!==r||!c.selector)||(p.splice(o,1),c.selector&&p.delegateCount--,f.remove&&f.remove.call(e,c));a&&!p.length&&(f.teardown&&!1!==f.teardown.call(e,h,v.handle)||S.removeEvent(e,d,v.handle),delete u[d])}else for(d in u)S.event.remove(e,d+t[l],n,r,!0);S.isEmptyObject(u)&&Y.remove(e,"handle events")}},dispatch:function(e){var t,n,r,i,o,a,s=new Array(arguments.length),u=S.event.fix(e),l=(Y.get(this,"events")||Object.create(null))[u.type]||[],c=S.event.special[u.type]||{};for(s[0]=u,t=1;t<arguments.length;t++)s[t]=arguments[t];if(u.delegateTarget=this,!c.preDispatch||!1!==c.preDispatch.call(this,u)){a=S.event.handlers.call(this,u,l),t=0;while((i=a[t++])&&!u.isPropagationStopped()){u.currentTarget=i.elem,n=0;while((o=i.handlers[n++])&&!u.isImmediatePropagationStopped())u.rnamespace&&!1!==o.namespace&&!u.rnamespace.test(o.namespace)||(u.handleObj=o,u.data=o.data,void 0!==(r=((S.event.special[o.origType]||{}).handle||o.handler).apply(i.elem,s))&&!1===(u.result=r)&&(u.preventDefault(),u.stopPropagation()))}return c.postDispatch&&c.postDispatch.call(this,u),u.result}},handlers:function(e,t){var n,r,i,o,a,s=[],u=t.delegateCount,l=e.target;if(u&&l.nodeType&&!("click"===e.type&&1<=e.button))for(;l!==this;l=l.parentNode||this)if(1===l.nodeType&&("click"!==e.type||!0!==l.disabled)){for(o=[],a={},n=0;n<u;n++)void 0===a[i=(r=t[n]).selector+" "]&&(a[i]=r.needsContext?-1<S(i,this).index(l):S.find(i,this,null,[l]).length),a[i]&&o.push(r);o.length&&s.push({elem:l,handlers:o})}return l=this,u<t.length&&s.push({elem:l,handlers:t.slice(u)}),s},addProp:function(t,e){Object.defineProperty(S.Event.prototype,t,{enumerable:!0,configurable:!0,get:m(e)?function(){if(this.originalEvent)return e(this.originalEvent)}:function(){if(this.originalEvent)return this.originalEvent[t]},set:function(e){Object.defineProperty(this,t,{enumerable:!0,configurable:!0,writable:!0,value:e})}})},fix:function(e){return e[S.expando]?e:new S.Event(e)},special:{load:{noBubble:!0},click:{setup:function(e){var t=this||e;return pe.test(t.type)&&t.click&&A(t,"input")&&Se(t,"click",we),!1},trigger:function(e){var t=this||e;return pe.test(t.type)&&t.click&&A(t,"input")&&Se(t,"click"),!0},_default:function(e){var t=e.target;return pe.test(t.type)&&t.click&&A(t,"input")&&Y.get(t,"click")||A(t,"a")}},beforeunload:{postDispatch:function(e){void 0!==e.result&&e.originalEvent&&(e.originalEvent.returnValue=e.result)}}}},S.removeEvent=function(e,t,n){e.removeEventListener&&e.removeEventListener(t,n)},S.Event=function(e,t){if(!(this instanceof S.Event))return new S.Event(e,t);e&&e.type?(this.originalEvent=e,this.type=e.type,this.isDefaultPrevented=e.defaultPrevented||void 0===e.defaultPrevented&&!1===e.returnValue?we:Te,this.target=e.target&&3===e.target.nodeType?e.target.parentNode:e.target,this.currentTarget=e.currentTarget,this.relatedTarget=e.relatedTarget):this.type=e,t&&S.extend(this,t),this.timeStamp=e&&e.timeStamp||Date.now(),this[S.expando]=!0},S.Event.prototype={constructor:S.Event,isDefaultPrevented:Te,isPropagationStopped:Te,isImmediatePropagationStopped:Te,isSimulated:!1,preventDefault:function(){var e=this.originalEvent;this.isDefaultPrevented=we,e&&!this.isSimulated&&e.preventDefault()},stopPropagation:function(){var e=this.originalEvent;this.isPropagationStopped=we,e&&!this.isSimulated&&e.stopPropagation()},stopImmediatePropagation:function(){var e=this.originalEvent;this.isImmediatePropagationStopped=we,e&&!this.isSimulated&&e.stopImmediatePropagation(),this.stopPropagation()}},S.each({altKey:!0,bubbles:!0,cancelable:!0,changedTouches:!0,ctrlKey:!0,detail:!0,eventPhase:!0,metaKey:!0,pageX:!0,pageY:!0,shiftKey:!0,view:!0,"char":!0,code:!0,charCode:!0,key:!0,keyCode:!0,button:!0,buttons:!0,clientX:!0,clientY:!0,offsetX:!0,offsetY:!0,pointerId:!0,pointerType:!0,screenX:!0,screenY:!0,targetTouches:!0,toElement:!0,touches:!0,which:!0},S.event.addProp),S.each({focus:"focusin",blur:"focusout"},function(e,t){S.event.special[e]={setup:function(){return Se(this,e,Ce),!1},trigger:function(){return Se(this,e),!0},_default:function(){return!0},delegateType:t}}),S.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(e,i){S.event.special[e]={delegateType:i,bindType:i,handle:function(e){var t,n=e.relatedTarget,r=e.handleObj;return n&&(n===this||S.contains(this,n))||(e.type=r.origType,t=r.handler.apply(this,arguments),e.type=i),t}}}),S.fn.extend({on:function(e,t,n,r){return Ee(this,e,t,n,r)},one:function(e,t,n,r){return Ee(this,e,t,n,r,1)},off:function(e,t,n){var r,i;if(e&&e.preventDefault&&e.handleObj)return r=e.handleObj,S(e.delegateTarget).off(r.namespace?r.origType+"."+r.namespace:r.origType,r.selector,r.handler),this;if("object"==typeof e){for(i in e)this.off(i,t,e[i]);return this}return!1!==t&&"function"!=typeof t||(n=t,t=void 0),!1===n&&(n=Te),this.each(function(){S.event.remove(this,e,n,t)})}});var ke=/<script|<style|<link/i,Ae=/checked\s*(?:[^=]|=\s*.checked.)/i,Ne=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g;function je(e,t){return A(e,"table")&&A(11!==t.nodeType?t:t.firstChild,"tr")&&S(e).children("tbody")[0]||e}function De(e){return e.type=(null!==e.getAttribute("type"))+"/"+e.type,e}function qe(e){return"true/"===(e.type||"").slice(0,5)?e.type=e.type.slice(5):e.removeAttribute("type"),e}function Le(e,t){var n,r,i,o,a,s;if(1===t.nodeType){if(Y.hasData(e)&&(s=Y.get(e).events))for(i in Y.remove(t,"handle events"),s)for(n=0,r=s[i].length;n<r;n++)S.event.add(t,i,s[i][n]);Q.hasData(e)&&(o=Q.access(e),a=S.extend({},o),Q.set(t,a))}}function He(n,r,i,o){r=g(r);var e,t,a,s,u,l,c=0,f=n.length,p=f-1,d=r[0],h=m(d);if(h||1<f&&"string"==typeof d&&!y.checkClone&&Ae.test(d))return n.each(function(e){var t=n.eq(e);h&&(r[0]=d.call(this,e,t.html())),He(t,r,i,o)});if(f&&(t=(e=xe(r,n[0].ownerDocument,!1,n,o)).firstChild,1===e.childNodes.length&&(e=t),t||o)){for(s=(a=S.map(ve(e,"script"),De)).length;c<f;c++)u=e,c!==p&&(u=S.clone(u,!0,!0),s&&S.merge(a,ve(u,"script"))),i.call(n[c],u,c);if(s)for(l=a[a.length-1].ownerDocument,S.map(a,qe),c=0;c<s;c++)u=a[c],he.test(u.type||"")&&!Y.access(u,"globalEval")&&S.contains(l,u)&&(u.src&&"module"!==(u.type||"").toLowerCase()?S._evalUrl&&!u.noModule&&S._evalUrl(u.src,{nonce:u.nonce||u.getAttribute("nonce")},l):b(u.textContent.replace(Ne,""),u,l))}return n}function Oe(e,t,n){for(var r,i=t?S.filter(t,e):e,o=0;null!=(r=i[o]);o++)n||1!==r.nodeType||S.cleanData(ve(r)),r.parentNode&&(n&&ie(r)&&ye(ve(r,"script")),r.parentNode.removeChild(r));return e}S.extend({htmlPrefilter:function(e){return e},clone:function(e,t,n){var r,i,o,a,s,u,l,c=e.cloneNode(!0),f=ie(e);if(!(y.noCloneChecked||1!==e.nodeType&&11!==e.nodeType||S.isXMLDoc(e)))for(a=ve(c),r=0,i=(o=ve(e)).length;r<i;r++)s=o[r],u=a[r],void 0,"input"===(l=u.nodeName.toLowerCase())&&pe.test(s.type)?u.checked=s.checked:"input"!==l&&"textarea"!==l||(u.defaultValue=s.defaultValue);if(t)if(n)for(o=o||ve(e),a=a||ve(c),r=0,i=o.length;r<i;r++)Le(o[r],a[r]);else Le(e,c);return 0<(a=ve(c,"script")).length&&ye(a,!f&&ve(e,"script")),c},cleanData:function(e){for(var t,n,r,i=S.event.special,o=0;void 0!==(n=e[o]);o++)if(V(n)){if(t=n[Y.expando]){if(t.events)for(r in t.events)i[r]?S.event.remove(n,r):S.removeEvent(n,r,t.handle);n[Y.expando]=void 0}n[Q.expando]&&(n[Q.expando]=void 0)}}}),S.fn.extend({detach:function(e){return Oe(this,e,!0)},remove:function(e){return Oe(this,e)},text:function(e){return $(this,function(e){return void 0===e?S.text(this):this.empty().each(function(){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||(this.textContent=e)})},null,e,arguments.length)},append:function(){return He(this,arguments,function(e){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||je(this,e).appendChild(e)})},prepend:function(){return He(this,arguments,function(e){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var t=je(this,e);t.insertBefore(e,t.firstChild)}})},before:function(){return He(this,arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this)})},after:function(){return He(this,arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this.nextSibling)})},empty:function(){for(var e,t=0;null!=(e=this[t]);t++)1===e.nodeType&&(S.cleanData(ve(e,!1)),e.textContent="");return this},clone:function(e,t){return e=null!=e&&e,t=null==t?e:t,this.map(function(){return S.clone(this,e,t)})},html:function(e){return $(this,function(e){var t=this[0]||{},n=0,r=this.length;if(void 0===e&&1===t.nodeType)return t.innerHTML;if("string"==typeof e&&!ke.test(e)&&!ge[(de.exec(e)||["",""])[1].toLowerCase()]){e=S.htmlPrefilter(e);try{for(;n<r;n++)1===(t=this[n]||{}).nodeType&&(S.cleanData(ve(t,!1)),t.innerHTML=e);t=0}catch(e){}}t&&this.empty().append(e)},null,e,arguments.length)},replaceWith:function(){var n=[];return He(this,arguments,function(e){var t=this.parentNode;S.inArray(this,n)<0&&(S.cleanData(ve(this)),t&&t.replaceChild(e,this))},n)}}),S.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(e,a){S.fn[e]=function(e){for(var t,n=[],r=S(e),i=r.length-1,o=0;o<=i;o++)t=o===i?this:this.clone(!0),S(r[o])[a](t),u.apply(n,t.get());return this.pushStack(n)}});var Pe=new RegExp("^("+ee+")(?!px)[a-z%]+$","i"),Re=function(e){var t=e.ownerDocument.defaultView;return t&&t.opener||(t=C),t.getComputedStyle(e)},Me=function(e,t,n){var r,i,o={};for(i in t)o[i]=e.style[i],e.style[i]=t[i];for(i in r=n.call(e),t)e.style[i]=o[i];return r},Ie=new RegExp(ne.join("|"),"i");function We(e,t,n){var r,i,o,a,s=e.style;return(n=n||Re(e))&&(""!==(a=n.getPropertyValue(t)||n[t])||ie(e)||(a=S.style(e,t)),!y.pixelBoxStyles()&&Pe.test(a)&&Ie.test(t)&&(r=s.width,i=s.minWidth,o=s.maxWidth,s.minWidth=s.maxWidth=s.width=a,a=n.width,s.width=r,s.minWidth=i,s.maxWidth=o)),void 0!==a?a+"":a}function Fe(e,t){return{get:function(){if(!e())return(this.get=t).apply(this,arguments);delete this.get}}}!function(){function e(){if(l){u.style.cssText="position:absolute;left:-11111px;width:60px;margin-top:1px;padding:0;border:0",l.style.cssText="position:relative;display:block;box-sizing:border-box;overflow:scroll;margin:auto;border:1px;padding:1px;width:60%;top:1%",re.appendChild(u).appendChild(l);var e=C.getComputedStyle(l);n="1%"!==e.top,s=12===t(e.marginLeft),l.style.right="60%",o=36===t(e.right),r=36===t(e.width),l.style.position="absolute",i=12===t(l.offsetWidth/3),re.removeChild(u),l=null}}function t(e){return Math.round(parseFloat(e))}var n,r,i,o,a,s,u=E.createElement("div"),l=E.createElement("div");l.style&&(l.style.backgroundClip="content-box",l.cloneNode(!0).style.backgroundClip="",y.clearCloneStyle="content-box"===l.style.backgroundClip,S.extend(y,{boxSizingReliable:function(){return e(),r},pixelBoxStyles:function(){return e(),o},pixelPosition:function(){return e(),n},reliableMarginLeft:function(){return e(),s},scrollboxSize:function(){return e(),i},reliableTrDimensions:function(){var e,t,n,r;return null==a&&(e=E.createElement("table"),t=E.createElement("tr"),n=E.createElement("div"),e.style.cssText="position:absolute;left:-11111px;border-collapse:separate",t.style.cssText="border:1px solid",t.style.height="1px",n.style.height="9px",n.style.display="block",re.appendChild(e).appendChild(t).appendChild(n),r=C.getComputedStyle(t),a=parseInt(r.height,10)+parseInt(r.borderTopWidth,10)+parseInt(r.borderBottomWidth,10)===t.offsetHeight,re.removeChild(e)),a}}))}();var Be=["Webkit","Moz","ms"],$e=E.createElement("div").style,_e={};function ze(e){var t=S.cssProps[e]||_e[e];return t||(e in $e?e:_e[e]=function(e){var t=e[0].toUpperCase()+e.slice(1),n=Be.length;while(n--)if((e=Be[n]+t)in $e)return e}(e)||e)}var Ue=/^(none|table(?!-c[ea]).+)/,Xe=/^--/,Ve={position:"absolute",visibility:"hidden",display:"block"},Ge={letterSpacing:"0",fontWeight:"400"};function Ye(e,t,n){var r=te.exec(t);return r?Math.max(0,r[2]-(n||0))+(r[3]||"px"):t}function Qe(e,t,n,r,i,o){var a="width"===t?1:0,s=0,u=0;if(n===(r?"border":"content"))return 0;for(;a<4;a+=2)"margin"===n&&(u+=S.css(e,n+ne[a],!0,i)),r?("content"===n&&(u-=S.css(e,"padding"+ne[a],!0,i)),"margin"!==n&&(u-=S.css(e,"border"+ne[a]+"Width",!0,i))):(u+=S.css(e,"padding"+ne[a],!0,i),"padding"!==n?u+=S.css(e,"border"+ne[a]+"Width",!0,i):s+=S.css(e,"border"+ne[a]+"Width",!0,i));return!r&&0<=o&&(u+=Math.max(0,Math.ceil(e["offset"+t[0].toUpperCase()+t.slice(1)]-o-u-s-.5))||0),u}function Je(e,t,n){var r=Re(e),i=(!y.boxSizingReliable()||n)&&"border-box"===S.css(e,"boxSizing",!1,r),o=i,a=We(e,t,r),s="offset"+t[0].toUpperCase()+t.slice(1);if(Pe.test(a)){if(!n)return a;a="auto"}return(!y.boxSizingReliable()&&i||!y.reliableTrDimensions()&&A(e,"tr")||"auto"===a||!parseFloat(a)&&"inline"===S.css(e,"display",!1,r))&&e.getClientRects().length&&(i="border-box"===S.css(e,"boxSizing",!1,r),(o=s in e)&&(a=e[s])),(a=parseFloat(a)||0)+Qe(e,t,n||(i?"border":"content"),o,r,a)+"px"}function Ke(e,t,n,r,i){return new Ke.prototype.init(e,t,n,r,i)}S.extend({cssHooks:{opacity:{get:function(e,t){if(t){var n=We(e,"opacity");return""===n?"1":n}}}},cssNumber:{animationIterationCount:!0,columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,gridArea:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnStart:!0,gridRow:!0,gridRowEnd:!0,gridRowStart:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{},style:function(e,t,n,r){if(e&&3!==e.nodeType&&8!==e.nodeType&&e.style){var i,o,a,s=X(t),u=Xe.test(t),l=e.style;if(u||(t=ze(s)),a=S.cssHooks[t]||S.cssHooks[s],void 0===n)return a&&"get"in a&&void 0!==(i=a.get(e,!1,r))?i:l[t];"string"===(o=typeof n)&&(i=te.exec(n))&&i[1]&&(n=se(e,t,i),o="number"),null!=n&&n==n&&("number"!==o||u||(n+=i&&i[3]||(S.cssNumber[s]?"":"px")),y.clearCloneStyle||""!==n||0!==t.indexOf("background")||(l[t]="inherit"),a&&"set"in a&&void 0===(n=a.set(e,n,r))||(u?l.setProperty(t,n):l[t]=n))}},css:function(e,t,n,r){var i,o,a,s=X(t);return Xe.test(t)||(t=ze(s)),(a=S.cssHooks[t]||S.cssHooks[s])&&"get"in a&&(i=a.get(e,!0,n)),void 0===i&&(i=We(e,t,r)),"normal"===i&&t in Ge&&(i=Ge[t]),""===n||n?(o=parseFloat(i),!0===n||isFinite(o)?o||0:i):i}}),S.each(["height","width"],function(e,u){S.cssHooks[u]={get:function(e,t,n){if(t)return!Ue.test(S.css(e,"display"))||e.getClientRects().length&&e.getBoundingClientRect().width?Je(e,u,n):Me(e,Ve,function(){return Je(e,u,n)})},set:function(e,t,n){var r,i=Re(e),o=!y.scrollboxSize()&&"absolute"===i.position,a=(o||n)&&"border-box"===S.css(e,"boxSizing",!1,i),s=n?Qe(e,u,n,a,i):0;return a&&o&&(s-=Math.ceil(e["offset"+u[0].toUpperCase()+u.slice(1)]-parseFloat(i[u])-Qe(e,u,"border",!1,i)-.5)),s&&(r=te.exec(t))&&"px"!==(r[3]||"px")&&(e.style[u]=t,t=S.css(e,u)),Ye(0,t,s)}}}),S.cssHooks.marginLeft=Fe(y.reliableMarginLeft,function(e,t){if(t)return(parseFloat(We(e,"marginLeft"))||e.getBoundingClientRect().left-Me(e,{marginLeft:0},function(){return e.getBoundingClientRect().left}))+"px"}),S.each({margin:"",padding:"",border:"Width"},function(i,o){S.cssHooks[i+o]={expand:function(e){for(var t=0,n={},r="string"==typeof e?e.split(" "):[e];t<4;t++)n[i+ne[t]+o]=r[t]||r[t-2]||r[0];return n}},"margin"!==i&&(S.cssHooks[i+o].set=Ye)}),S.fn.extend({css:function(e,t){return $(this,function(e,t,n){var r,i,o={},a=0;if(Array.isArray(t)){for(r=Re(e),i=t.length;a<i;a++)o[t[a]]=S.css(e,t[a],!1,r);return o}return void 0!==n?S.style(e,t,n):S.css(e,t)},e,t,1<arguments.length)}}),((S.Tween=Ke).prototype={constructor:Ke,init:function(e,t,n,r,i,o){this.elem=e,this.prop=n,this.easing=i||S.easing._default,this.options=t,this.start=this.now=this.cur(),this.end=r,this.unit=o||(S.cssNumber[n]?"":"px")},cur:function(){var e=Ke.propHooks[this.prop];return e&&e.get?e.get(this):Ke.propHooks._default.get(this)},run:function(e){var t,n=Ke.propHooks[this.prop];return this.options.duration?this.pos=t=S.easing[this.easing](e,this.options.duration*e,0,1,this.options.duration):this.pos=t=e,this.now=(this.end-this.start)*t+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),n&&n.set?n.set(this):Ke.propHooks._default.set(this),this}}).init.prototype=Ke.prototype,(Ke.propHooks={_default:{get:function(e){var t;return 1!==e.elem.nodeType||null!=e.elem[e.prop]&&null==e.elem.style[e.prop]?e.elem[e.prop]:(t=S.css(e.elem,e.prop,""))&&"auto"!==t?t:0},set:function(e){S.fx.step[e.prop]?S.fx.step[e.prop](e):1!==e.elem.nodeType||!S.cssHooks[e.prop]&&null==e.elem.style[ze(e.prop)]?e.elem[e.prop]=e.now:S.style(e.elem,e.prop,e.now+e.unit)}}}).scrollTop=Ke.propHooks.scrollLeft={set:function(e){e.elem.nodeType&&e.elem.parentNode&&(e.elem[e.prop]=e.now)}},S.easing={linear:function(e){return e},swing:function(e){return.5-Math.cos(e*Math.PI)/2},_default:"swing"},S.fx=Ke.prototype.init,S.fx.step={};var Ze,et,tt,nt,rt=/^(?:toggle|show|hide)$/,it=/queueHooks$/;function ot(){et&&(!1===E.hidden&&C.requestAnimationFrame?C.requestAnimationFrame(ot):C.setTimeout(ot,S.fx.interval),S.fx.tick())}function at(){return C.setTimeout(function(){Ze=void 0}),Ze=Date.now()}function st(e,t){var n,r=0,i={height:e};for(t=t?1:0;r<4;r+=2-t)i["margin"+(n=ne[r])]=i["padding"+n]=e;return t&&(i.opacity=i.width=e),i}function ut(e,t,n){for(var r,i=(lt.tweeners[t]||[]).concat(lt.tweeners["*"]),o=0,a=i.length;o<a;o++)if(r=i[o].call(n,t,e))return r}function lt(o,e,t){var n,a,r=0,i=lt.prefilters.length,s=S.Deferred().always(function(){delete u.elem}),u=function(){if(a)return!1;for(var e=Ze||at(),t=Math.max(0,l.startTime+l.duration-e),n=1-(t/l.duration||0),r=0,i=l.tweens.length;r<i;r++)l.tweens[r].run(n);return s.notifyWith(o,[l,n,t]),n<1&&i?t:(i||s.notifyWith(o,[l,1,0]),s.resolveWith(o,[l]),!1)},l=s.promise({elem:o,props:S.extend({},e),opts:S.extend(!0,{specialEasing:{},easing:S.easing._default},t),originalProperties:e,originalOptions:t,startTime:Ze||at(),duration:t.duration,tweens:[],createTween:function(e,t){var n=S.Tween(o,l.opts,e,t,l.opts.specialEasing[e]||l.opts.easing);return l.tweens.push(n),n},stop:function(e){var t=0,n=e?l.tweens.length:0;if(a)return this;for(a=!0;t<n;t++)l.tweens[t].run(1);return e?(s.notifyWith(o,[l,1,0]),s.resolveWith(o,[l,e])):s.rejectWith(o,[l,e]),this}}),c=l.props;for(!function(e,t){var n,r,i,o,a;for(n in e)if(i=t[r=X(n)],o=e[n],Array.isArray(o)&&(i=o[1],o=e[n]=o[0]),n!==r&&(e[r]=o,delete e[n]),(a=S.cssHooks[r])&&"expand"in a)for(n in o=a.expand(o),delete e[r],o)n in e||(e[n]=o[n],t[n]=i);else t[r]=i}(c,l.opts.specialEasing);r<i;r++)if(n=lt.prefilters[r].call(l,o,c,l.opts))return m(n.stop)&&(S._queueHooks(l.elem,l.opts.queue).stop=n.stop.bind(n)),n;return S.map(c,ut,l),m(l.opts.start)&&l.opts.start.call(o,l),l.progress(l.opts.progress).done(l.opts.done,l.opts.complete).fail(l.opts.fail).always(l.opts.always),S.fx.timer(S.extend(u,{elem:o,anim:l,queue:l.opts.queue})),l}S.Animation=S.extend(lt,{tweeners:{"*":[function(e,t){var n=this.createTween(e,t);return se(n.elem,e,te.exec(t),n),n}]},tweener:function(e,t){m(e)?(t=e,e=["*"]):e=e.match(P);for(var n,r=0,i=e.length;r<i;r++)n=e[r],lt.tweeners[n]=lt.tweeners[n]||[],lt.tweeners[n].unshift(t)},prefilters:[function(e,t,n){var r,i,o,a,s,u,l,c,f="width"in t||"height"in t,p=this,d={},h=e.style,g=e.nodeType&&ae(e),v=Y.get(e,"fxshow");for(r in n.queue||(null==(a=S._queueHooks(e,"fx")).unqueued&&(a.unqueued=0,s=a.empty.fire,a.empty.fire=function(){a.unqueued||s()}),a.unqueued++,p.always(function(){p.always(function(){a.unqueued--,S.queue(e,"fx").length||a.empty.fire()})})),t)if(i=t[r],rt.test(i)){if(delete t[r],o=o||"toggle"===i,i===(g?"hide":"show")){if("show"!==i||!v||void 0===v[r])continue;g=!0}d[r]=v&&v[r]||S.style(e,r)}if((u=!S.isEmptyObject(t))||!S.isEmptyObject(d))for(r in f&&1===e.nodeType&&(n.overflow=[h.overflow,h.overflowX,h.overflowY],null==(l=v&&v.display)&&(l=Y.get(e,"display")),"none"===(c=S.css(e,"display"))&&(l?c=l:(le([e],!0),l=e.style.display||l,c=S.css(e,"display"),le([e]))),("inline"===c||"inline-block"===c&&null!=l)&&"none"===S.css(e,"float")&&(u||(p.done(function(){h.display=l}),null==l&&(c=h.display,l="none"===c?"":c)),h.display="inline-block")),n.overflow&&(h.overflow="hidden",p.always(function(){h.overflow=n.overflow[0],h.overflowX=n.overflow[1],h.overflowY=n.overflow[2]})),u=!1,d)u||(v?"hidden"in v&&(g=v.hidden):v=Y.access(e,"fxshow",{display:l}),o&&(v.hidden=!g),g&&le([e],!0),p.done(function(){for(r in g||le([e]),Y.remove(e,"fxshow"),d)S.style(e,r,d[r])})),u=ut(g?v[r]:0,r,p),r in v||(v[r]=u.start,g&&(u.end=u.start,u.start=0))}],prefilter:function(e,t){t?lt.prefilters.unshift(e):lt.prefilters.push(e)}}),S.speed=function(e,t,n){var r=e&&"object"==typeof e?S.extend({},e):{complete:n||!n&&t||m(e)&&e,duration:e,easing:n&&t||t&&!m(t)&&t};return S.fx.off?r.duration=0:"number"!=typeof r.duration&&(r.duration in S.fx.speeds?r.duration=S.fx.speeds[r.duration]:r.duration=S.fx.speeds._default),null!=r.queue&&!0!==r.queue||(r.queue="fx"),r.old=r.complete,r.complete=function(){m(r.old)&&r.old.call(this),r.queue&&S.dequeue(this,r.queue)},r},S.fn.extend({fadeTo:function(e,t,n,r){return this.filter(ae).css("opacity",0).show().end().animate({opacity:t},e,n,r)},animate:function(t,e,n,r){var i=S.isEmptyObject(t),o=S.speed(e,n,r),a=function(){var e=lt(this,S.extend({},t),o);(i||Y.get(this,"finish"))&&e.stop(!0)};return a.finish=a,i||!1===o.queue?this.each(a):this.queue(o.queue,a)},stop:function(i,e,o){var a=function(e){var t=e.stop;delete e.stop,t(o)};return"string"!=typeof i&&(o=e,e=i,i=void 0),e&&this.queue(i||"fx",[]),this.each(function(){var e=!0,t=null!=i&&i+"queueHooks",n=S.timers,r=Y.get(this);if(t)r[t]&&r[t].stop&&a(r[t]);else for(t in r)r[t]&&r[t].stop&&it.test(t)&&a(r[t]);for(t=n.length;t--;)n[t].elem!==this||null!=i&&n[t].queue!==i||(n[t].anim.stop(o),e=!1,n.splice(t,1));!e&&o||S.dequeue(this,i)})},finish:function(a){return!1!==a&&(a=a||"fx"),this.each(function(){var e,t=Y.get(this),n=t[a+"queue"],r=t[a+"queueHooks"],i=S.timers,o=n?n.length:0;for(t.finish=!0,S.queue(this,a,[]),r&&r.stop&&r.stop.call(this,!0),e=i.length;e--;)i[e].elem===this&&i[e].queue===a&&(i[e].anim.stop(!0),i.splice(e,1));for(e=0;e<o;e++)n[e]&&n[e].finish&&n[e].finish.call(this);delete t.finish})}}),S.each(["toggle","show","hide"],function(e,r){var i=S.fn[r];S.fn[r]=function(e,t,n){return null==e||"boolean"==typeof e?i.apply(this,arguments):this.animate(st(r,!0),e,t,n)}}),S.each({slideDown:st("show"),slideUp:st("hide"),slideToggle:st("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(e,r){S.fn[e]=function(e,t,n){return this.animate(r,e,t,n)}}),S.timers=[],S.fx.tick=function(){var e,t=0,n=S.timers;for(Ze=Date.now();t<n.length;t++)(e=n[t])()||n[t]!==e||n.splice(t--,1);n.length||S.fx.stop(),Ze=void 0},S.fx.timer=function(e){S.timers.push(e),S.fx.start()},S.fx.interval=13,S.fx.start=function(){et||(et=!0,ot())},S.fx.stop=function(){et=null},S.fx.speeds={slow:600,fast:200,_default:400},S.fn.delay=function(r,e){return r=S.fx&&S.fx.speeds[r]||r,e=e||"fx",this.queue(e,function(e,t){var n=C.setTimeout(e,r);t.stop=function(){C.clearTimeout(n)}})},tt=E.createElement("input"),nt=E.createElement("select").appendChild(E.createElement("option")),tt.type="checkbox",y.checkOn=""!==tt.value,y.optSelected=nt.selected,(tt=E.createElement("input")).value="t",tt.type="radio",y.radioValue="t"===tt.value;var ct,ft=S.expr.attrHandle;S.fn.extend({attr:function(e,t){return $(this,S.attr,e,t,1<arguments.length)},removeAttr:function(e){return this.each(function(){S.removeAttr(this,e)})}}),S.extend({attr:function(e,t,n){var r,i,o=e.nodeType;if(3!==o&&8!==o&&2!==o)return"undefined"==typeof e.getAttribute?S.prop(e,t,n):(1===o&&S.isXMLDoc(e)||(i=S.attrHooks[t.toLowerCase()]||(S.expr.match.bool.test(t)?ct:void 0)),void 0!==n?null===n?void S.removeAttr(e,t):i&&"set"in i&&void 0!==(r=i.set(e,n,t))?r:(e.setAttribute(t,n+""),n):i&&"get"in i&&null!==(r=i.get(e,t))?r:null==(r=S.find.attr(e,t))?void 0:r)},attrHooks:{type:{set:function(e,t){if(!y.radioValue&&"radio"===t&&A(e,"input")){var n=e.value;return e.setAttribute("type",t),n&&(e.value=n),t}}}},removeAttr:function(e,t){var n,r=0,i=t&&t.match(P);if(i&&1===e.nodeType)while(n=i[r++])e.removeAttribute(n)}}),ct={set:function(e,t,n){return!1===t?S.removeAttr(e,n):e.setAttribute(n,n),n}},S.each(S.expr.match.bool.source.match(/\w+/g),function(e,t){var a=ft[t]||S.find.attr;ft[t]=function(e,t,n){var r,i,o=t.toLowerCase();return n||(i=ft[o],ft[o]=r,r=null!=a(e,t,n)?o:null,ft[o]=i),r}});var pt=/^(?:input|select|textarea|button)$/i,dt=/^(?:a|area)$/i;function ht(e){return(e.match(P)||[]).join(" ")}function gt(e){return e.getAttribute&&e.getAttribute("class")||""}function vt(e){return Array.isArray(e)?e:"string"==typeof e&&e.match(P)||[]}S.fn.extend({prop:function(e,t){return $(this,S.prop,e,t,1<arguments.length)},removeProp:function(e){return this.each(function(){delete this[S.propFix[e]||e]})}}),S.extend({prop:function(e,t,n){var r,i,o=e.nodeType;if(3!==o&&8!==o&&2!==o)return 1===o&&S.isXMLDoc(e)||(t=S.propFix[t]||t,i=S.propHooks[t]),void 0!==n?i&&"set"in i&&void 0!==(r=i.set(e,n,t))?r:e[t]=n:i&&"get"in i&&null!==(r=i.get(e,t))?r:e[t]},propHooks:{tabIndex:{get:function(e){var t=S.find.attr(e,"tabindex");return t?parseInt(t,10):pt.test(e.nodeName)||dt.test(e.nodeName)&&e.href?0:-1}}},propFix:{"for":"htmlFor","class":"className"}}),y.optSelected||(S.propHooks.selected={get:function(e){var t=e.parentNode;return t&&t.parentNode&&t.parentNode.selectedIndex,null},set:function(e){var t=e.parentNode;t&&(t.selectedIndex,t.parentNode&&t.parentNode.selectedIndex)}}),S.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){S.propFix[this.toLowerCase()]=this}),S.fn.extend({addClass:function(t){var e,n,r,i,o,a,s,u=0;if(m(t))return this.each(function(e){S(this).addClass(t.call(this,e,gt(this)))});if((e=vt(t)).length)while(n=this[u++])if(i=gt(n),r=1===n.nodeType&&" "+ht(i)+" "){a=0;while(o=e[a++])r.indexOf(" "+o+" ")<0&&(r+=o+" ");i!==(s=ht(r))&&n.setAttribute("class",s)}return this},removeClass:function(t){var e,n,r,i,o,a,s,u=0;if(m(t))return this.each(function(e){S(this).removeClass(t.call(this,e,gt(this)))});if(!arguments.length)return this.attr("class","");if((e=vt(t)).length)while(n=this[u++])if(i=gt(n),r=1===n.nodeType&&" "+ht(i)+" "){a=0;while(o=e[a++])while(-1<r.indexOf(" "+o+" "))r=r.replace(" "+o+" "," ");i!==(s=ht(r))&&n.setAttribute("class",s)}return this},toggleClass:function(i,t){var o=typeof i,a="string"===o||Array.isArray(i);return"boolean"==typeof t&&a?t?this.addClass(i):this.removeClass(i):m(i)?this.each(function(e){S(this).toggleClass(i.call(this,e,gt(this),t),t)}):this.each(function(){var e,t,n,r;if(a){t=0,n=S(this),r=vt(i);while(e=r[t++])n.hasClass(e)?n.removeClass(e):n.addClass(e)}else void 0!==i&&"boolean"!==o||((e=gt(this))&&Y.set(this,"__className__",e),this.setAttribute&&this.setAttribute("class",e||!1===i?"":Y.get(this,"__className__")||""))})},hasClass:function(e){var t,n,r=0;t=" "+e+" ";while(n=this[r++])if(1===n.nodeType&&-1<(" "+ht(gt(n))+" ").indexOf(t))return!0;return!1}});var yt=/\r/g;S.fn.extend({val:function(n){var r,e,i,t=this[0];return arguments.length?(i=m(n),this.each(function(e){var t;1===this.nodeType&&(null==(t=i?n.call(this,e,S(this).val()):n)?t="":"number"==typeof t?t+="":Array.isArray(t)&&(t=S.map(t,function(e){return null==e?"":e+""})),(r=S.valHooks[this.type]||S.valHooks[this.nodeName.toLowerCase()])&&"set"in r&&void 0!==r.set(this,t,"value")||(this.value=t))})):t?(r=S.valHooks[t.type]||S.valHooks[t.nodeName.toLowerCase()])&&"get"in r&&void 0!==(e=r.get(t,"value"))?e:"string"==typeof(e=t.value)?e.replace(yt,""):null==e?"":e:void 0}}),S.extend({valHooks:{option:{get:function(e){var t=S.find.attr(e,"value");return null!=t?t:ht(S.text(e))}},select:{get:function(e){var t,n,r,i=e.options,o=e.selectedIndex,a="select-one"===e.type,s=a?null:[],u=a?o+1:i.length;for(r=o<0?u:a?o:0;r<u;r++)if(((n=i[r]).selected||r===o)&&!n.disabled&&(!n.parentNode.disabled||!A(n.parentNode,"optgroup"))){if(t=S(n).val(),a)return t;s.push(t)}return s},set:function(e,t){var n,r,i=e.options,o=S.makeArray(t),a=i.length;while(a--)((r=i[a]).selected=-1<S.inArray(S.valHooks.option.get(r),o))&&(n=!0);return n||(e.selectedIndex=-1),o}}}}),S.each(["radio","checkbox"],function(){S.valHooks[this]={set:function(e,t){if(Array.isArray(t))return e.checked=-1<S.inArray(S(e).val(),t)}},y.checkOn||(S.valHooks[this].get=function(e){return null===e.getAttribute("value")?"on":e.value})}),y.focusin="onfocusin"in C;var mt=/^(?:focusinfocus|focusoutblur)$/,xt=function(e){e.stopPropagation()};S.extend(S.event,{trigger:function(e,t,n,r){var i,o,a,s,u,l,c,f,p=[n||E],d=v.call(e,"type")?e.type:e,h=v.call(e,"namespace")?e.namespace.split("."):[];if(o=f=a=n=n||E,3!==n.nodeType&&8!==n.nodeType&&!mt.test(d+S.event.triggered)&&(-1<d.indexOf(".")&&(d=(h=d.split(".")).shift(),h.sort()),u=d.indexOf(":")<0&&"on"+d,(e=e[S.expando]?e:new S.Event(d,"object"==typeof e&&e)).isTrigger=r?2:3,e.namespace=h.join("."),e.rnamespace=e.namespace?new RegExp("(^|\\.)"+h.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,e.result=void 0,e.target||(e.target=n),t=null==t?[e]:S.makeArray(t,[e]),c=S.event.special[d]||{},r||!c.trigger||!1!==c.trigger.apply(n,t))){if(!r&&!c.noBubble&&!x(n)){for(s=c.delegateType||d,mt.test(s+d)||(o=o.parentNode);o;o=o.parentNode)p.push(o),a=o;a===(n.ownerDocument||E)&&p.push(a.defaultView||a.parentWindow||C)}i=0;while((o=p[i++])&&!e.isPropagationStopped())f=o,e.type=1<i?s:c.bindType||d,(l=(Y.get(o,"events")||Object.create(null))[e.type]&&Y.get(o,"handle"))&&l.apply(o,t),(l=u&&o[u])&&l.apply&&V(o)&&(e.result=l.apply(o,t),!1===e.result&&e.preventDefault());return e.type=d,r||e.isDefaultPrevented()||c._default&&!1!==c._default.apply(p.pop(),t)||!V(n)||u&&m(n[d])&&!x(n)&&((a=n[u])&&(n[u]=null),S.event.triggered=d,e.isPropagationStopped()&&f.addEventListener(d,xt),n[d](),e.isPropagationStopped()&&f.removeEventListener(d,xt),S.event.triggered=void 0,a&&(n[u]=a)),e.result}},simulate:function(e,t,n){var r=S.extend(new S.Event,n,{type:e,isSimulated:!0});S.event.trigger(r,null,t)}}),S.fn.extend({trigger:function(e,t){return this.each(function(){S.event.trigger(e,t,this)})},triggerHandler:function(e,t){var n=this[0];if(n)return S.event.trigger(e,t,n,!0)}}),y.focusin||S.each({focus:"focusin",blur:"focusout"},function(n,r){var i=function(e){S.event.simulate(r,e.target,S.event.fix(e))};S.event.special[r]={setup:function(){var e=this.ownerDocument||this.document||this,t=Y.access(e,r);t||e.addEventListener(n,i,!0),Y.access(e,r,(t||0)+1)},teardown:function(){var e=this.ownerDocument||this.document||this,t=Y.access(e,r)-1;t?Y.access(e,r,t):(e.removeEventListener(n,i,!0),Y.remove(e,r))}}});var bt=C.location,wt={guid:Date.now()},Tt=/\?/;S.parseXML=function(e){var t,n;if(!e||"string"!=typeof e)return null;try{t=(new C.DOMParser).parseFromString(e,"text/xml")}catch(e){}return n=t&&t.getElementsByTagName("parsererror")[0],t&&!n||S.error("Invalid XML: "+(n?S.map(n.childNodes,function(e){return e.textContent}).join("\n"):e)),t};var Ct=/\[\]$/,Et=/\r?\n/g,St=/^(?:submit|button|image|reset|file)$/i,kt=/^(?:input|select|textarea|keygen)/i;function At(n,e,r,i){var t;if(Array.isArray(e))S.each(e,function(e,t){r||Ct.test(n)?i(n,t):At(n+"["+("object"==typeof t&&null!=t?e:"")+"]",t,r,i)});else if(r||"object"!==w(e))i(n,e);else for(t in e)At(n+"["+t+"]",e[t],r,i)}S.param=function(e,t){var n,r=[],i=function(e,t){var n=m(t)?t():t;r[r.length]=encodeURIComponent(e)+"="+encodeURIComponent(null==n?"":n)};if(null==e)return"";if(Array.isArray(e)||e.jquery&&!S.isPlainObject(e))S.each(e,function(){i(this.name,this.value)});else for(n in e)At(n,e[n],t,i);return r.join("&")},S.fn.extend({serialize:function(){return S.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var e=S.prop(this,"elements");return e?S.makeArray(e):this}).filter(function(){var e=this.type;return this.name&&!S(this).is(":disabled")&&kt.test(this.nodeName)&&!St.test(e)&&(this.checked||!pe.test(e))}).map(function(e,t){var n=S(this).val();return null==n?null:Array.isArray(n)?S.map(n,function(e){return{name:t.name,value:e.replace(Et,"\r\n")}}):{name:t.name,value:n.replace(Et,"\r\n")}}).get()}});var Nt=/%20/g,jt=/#.*$/,Dt=/([?&])_=[^&]*/,qt=/^(.*?):[ \t]*([^\r\n]*)$/gm,Lt=/^(?:GET|HEAD)$/,Ht=/^\/\//,Ot={},Pt={},Rt="*/".concat("*"),Mt=E.createElement("a");function It(o){return function(e,t){"string"!=typeof e&&(t=e,e="*");var n,r=0,i=e.toLowerCase().match(P)||[];if(m(t))while(n=i[r++])"+"===n[0]?(n=n.slice(1)||"*",(o[n]=o[n]||[]).unshift(t)):(o[n]=o[n]||[]).push(t)}}function Wt(t,i,o,a){var s={},u=t===Pt;function l(e){var r;return s[e]=!0,S.each(t[e]||[],function(e,t){var n=t(i,o,a);return"string"!=typeof n||u||s[n]?u?!(r=n):void 0:(i.dataTypes.unshift(n),l(n),!1)}),r}return l(i.dataTypes[0])||!s["*"]&&l("*")}function Ft(e,t){var n,r,i=S.ajaxSettings.flatOptions||{};for(n in t)void 0!==t[n]&&((i[n]?e:r||(r={}))[n]=t[n]);return r&&S.extend(!0,e,r),e}Mt.href=bt.href,S.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:bt.href,type:"GET",isLocal:/^(?:about|app|app-storage|.+-extension|file|res|widget):$/.test(bt.protocol),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":Rt,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/\bxml\b/,html:/\bhtml/,json:/\bjson\b/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":JSON.parse,"text xml":S.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(e,t){return t?Ft(Ft(e,S.ajaxSettings),t):Ft(S.ajaxSettings,e)},ajaxPrefilter:It(Ot),ajaxTransport:It(Pt),ajax:function(e,t){"object"==typeof e&&(t=e,e=void 0),t=t||{};var c,f,p,n,d,r,h,g,i,o,v=S.ajaxSetup({},t),y=v.context||v,m=v.context&&(y.nodeType||y.jquery)?S(y):S.event,x=S.Deferred(),b=S.Callbacks("once memory"),w=v.statusCode||{},a={},s={},u="canceled",T={readyState:0,getResponseHeader:function(e){var t;if(h){if(!n){n={};while(t=qt.exec(p))n[t[1].toLowerCase()+" "]=(n[t[1].toLowerCase()+" "]||[]).concat(t[2])}t=n[e.toLowerCase()+" "]}return null==t?null:t.join(", ")},getAllResponseHeaders:function(){return h?p:null},setRequestHeader:function(e,t){return null==h&&(e=s[e.toLowerCase()]=s[e.toLowerCase()]||e,a[e]=t),this},overrideMimeType:function(e){return null==h&&(v.mimeType=e),this},statusCode:function(e){var t;if(e)if(h)T.always(e[T.status]);else for(t in e)w[t]=[w[t],e[t]];return this},abort:function(e){var t=e||u;return c&&c.abort(t),l(0,t),this}};if(x.promise(T),v.url=((e||v.url||bt.href)+"").replace(Ht,bt.protocol+"//"),v.type=t.method||t.type||v.method||v.type,v.dataTypes=(v.dataType||"*").toLowerCase().match(P)||[""],null==v.crossDomain){r=E.createElement("a");try{r.href=v.url,r.href=r.href,v.crossDomain=Mt.protocol+"//"+Mt.host!=r.protocol+"//"+r.host}catch(e){v.crossDomain=!0}}if(v.data&&v.processData&&"string"!=typeof v.data&&(v.data=S.param(v.data,v.traditional)),Wt(Ot,v,t,T),h)return T;for(i in(g=S.event&&v.global)&&0==S.active++&&S.event.trigger("ajaxStart"),v.type=v.type.toUpperCase(),v.hasContent=!Lt.test(v.type),f=v.url.replace(jt,""),v.hasContent?v.data&&v.processData&&0===(v.contentType||"").indexOf("application/x-www-form-urlencoded")&&(v.data=v.data.replace(Nt,"+")):(o=v.url.slice(f.length),v.data&&(v.processData||"string"==typeof v.data)&&(f+=(Tt.test(f)?"&":"?")+v.data,delete v.data),!1===v.cache&&(f=f.replace(Dt,"$1"),o=(Tt.test(f)?"&":"?")+"_="+wt.guid+++o),v.url=f+o),v.ifModified&&(S.lastModified[f]&&T.setRequestHeader("If-Modified-Since",S.lastModified[f]),S.etag[f]&&T.setRequestHeader("If-None-Match",S.etag[f])),(v.data&&v.hasContent&&!1!==v.contentType||t.contentType)&&T.setRequestHeader("Content-Type",v.contentType),T.setRequestHeader("Accept",v.dataTypes[0]&&v.accepts[v.dataTypes[0]]?v.accepts[v.dataTypes[0]]+("*"!==v.dataTypes[0]?", "+Rt+"; q=0.01":""):v.accepts["*"]),v.headers)T.setRequestHeader(i,v.headers[i]);if(v.beforeSend&&(!1===v.beforeSend.call(y,T,v)||h))return T.abort();if(u="abort",b.add(v.complete),T.done(v.success),T.fail(v.error),c=Wt(Pt,v,t,T)){if(T.readyState=1,g&&m.trigger("ajaxSend",[T,v]),h)return T;v.async&&0<v.timeout&&(d=C.setTimeout(function(){T.abort("timeout")},v.timeout));try{h=!1,c.send(a,l)}catch(e){if(h)throw e;l(-1,e)}}else l(-1,"No Transport");function l(e,t,n,r){var i,o,a,s,u,l=t;h||(h=!0,d&&C.clearTimeout(d),c=void 0,p=r||"",T.readyState=0<e?4:0,i=200<=e&&e<300||304===e,n&&(s=function(e,t,n){var r,i,o,a,s=e.contents,u=e.dataTypes;while("*"===u[0])u.shift(),void 0===r&&(r=e.mimeType||t.getResponseHeader("Content-Type"));if(r)for(i in s)if(s[i]&&s[i].test(r)){u.unshift(i);break}if(u[0]in n)o=u[0];else{for(i in n){if(!u[0]||e.converters[i+" "+u[0]]){o=i;break}a||(a=i)}o=o||a}if(o)return o!==u[0]&&u.unshift(o),n[o]}(v,T,n)),!i&&-1<S.inArray("script",v.dataTypes)&&S.inArray("json",v.dataTypes)<0&&(v.converters["text script"]=function(){}),s=function(e,t,n,r){var i,o,a,s,u,l={},c=e.dataTypes.slice();if(c[1])for(a in e.converters)l[a.toLowerCase()]=e.converters[a];o=c.shift();while(o)if(e.responseFields[o]&&(n[e.responseFields[o]]=t),!u&&r&&e.dataFilter&&(t=e.dataFilter(t,e.dataType)),u=o,o=c.shift())if("*"===o)o=u;else if("*"!==u&&u!==o){if(!(a=l[u+" "+o]||l["* "+o]))for(i in l)if((s=i.split(" "))[1]===o&&(a=l[u+" "+s[0]]||l["* "+s[0]])){!0===a?a=l[i]:!0!==l[i]&&(o=s[0],c.unshift(s[1]));break}if(!0!==a)if(a&&e["throws"])t=a(t);else try{t=a(t)}catch(e){return{state:"parsererror",error:a?e:"No conversion from "+u+" to "+o}}}return{state:"success",data:t}}(v,s,T,i),i?(v.ifModified&&((u=T.getResponseHeader("Last-Modified"))&&(S.lastModified[f]=u),(u=T.getResponseHeader("etag"))&&(S.etag[f]=u)),204===e||"HEAD"===v.type?l="nocontent":304===e?l="notmodified":(l=s.state,o=s.data,i=!(a=s.error))):(a=l,!e&&l||(l="error",e<0&&(e=0))),T.status=e,T.statusText=(t||l)+"",i?x.resolveWith(y,[o,l,T]):x.rejectWith(y,[T,l,a]),T.statusCode(w),w=void 0,g&&m.trigger(i?"ajaxSuccess":"ajaxError",[T,v,i?o:a]),b.fireWith(y,[T,l]),g&&(m.trigger("ajaxComplete",[T,v]),--S.active||S.event.trigger("ajaxStop")))}return T},getJSON:function(e,t,n){return S.get(e,t,n,"json")},getScript:function(e,t){return S.get(e,void 0,t,"script")}}),S.each(["get","post"],function(e,i){S[i]=function(e,t,n,r){return m(t)&&(r=r||n,n=t,t=void 0),S.ajax(S.extend({url:e,type:i,dataType:r,data:t,success:n},S.isPlainObject(e)&&e))}}),S.ajaxPrefilter(function(e){var t;for(t in e.headers)"content-type"===t.toLowerCase()&&(e.contentType=e.headers[t]||"")}),S._evalUrl=function(e,t,n){return S.ajax({url:e,type:"GET",dataType:"script",cache:!0,async:!1,global:!1,converters:{"text script":function(){}},dataFilter:function(e){S.globalEval(e,t,n)}})},S.fn.extend({wrapAll:function(e){var t;return this[0]&&(m(e)&&(e=e.call(this[0])),t=S(e,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&t.insertBefore(this[0]),t.map(function(){var e=this;while(e.firstElementChild)e=e.firstElementChild;return e}).append(this)),this},wrapInner:function(n){return m(n)?this.each(function(e){S(this).wrapInner(n.call(this,e))}):this.each(function(){var e=S(this),t=e.contents();t.length?t.wrapAll(n):e.append(n)})},wrap:function(t){var n=m(t);return this.each(function(e){S(this).wrapAll(n?t.call(this,e):t)})},unwrap:function(e){return this.parent(e).not("body").each(function(){S(this).replaceWith(this.childNodes)}),this}}),S.expr.pseudos.hidden=function(e){return!S.expr.pseudos.visible(e)},S.expr.pseudos.visible=function(e){return!!(e.offsetWidth||e.offsetHeight||e.getClientRects().length)},S.ajaxSettings.xhr=function(){try{return new C.XMLHttpRequest}catch(e){}};var Bt={0:200,1223:204},$t=S.ajaxSettings.xhr();y.cors=!!$t&&"withCredentials"in $t,y.ajax=$t=!!$t,S.ajaxTransport(function(i){var o,a;if(y.cors||$t&&!i.crossDomain)return{send:function(e,t){var n,r=i.xhr();if(r.open(i.type,i.url,i.async,i.username,i.password),i.xhrFields)for(n in i.xhrFields)r[n]=i.xhrFields[n];for(n in i.mimeType&&r.overrideMimeType&&r.overrideMimeType(i.mimeType),i.crossDomain||e["X-Requested-With"]||(e["X-Requested-With"]="XMLHttpRequest"),e)r.setRequestHeader(n,e[n]);o=function(e){return function(){o&&(o=a=r.onload=r.onerror=r.onabort=r.ontimeout=r.onreadystatechange=null,"abort"===e?r.abort():"error"===e?"number"!=typeof r.status?t(0,"error"):t(r.status,r.statusText):t(Bt[r.status]||r.status,r.statusText,"text"!==(r.responseType||"text")||"string"!=typeof r.responseText?{binary:r.response}:{text:r.responseText},r.getAllResponseHeaders()))}},r.onload=o(),a=r.onerror=r.ontimeout=o("error"),void 0!==r.onabort?r.onabort=a:r.onreadystatechange=function(){4===r.readyState&&C.setTimeout(function(){o&&a()})},o=o("abort");try{r.send(i.hasContent&&i.data||null)}catch(e){if(o)throw e}},abort:function(){o&&o()}}}),S.ajaxPrefilter(function(e){e.crossDomain&&(e.contents.script=!1)}),S.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/\b(?:java|ecma)script\b/},converters:{"text script":function(e){return S.globalEval(e),e}}}),S.ajaxPrefilter("script",function(e){void 0===e.cache&&(e.cache=!1),e.crossDomain&&(e.type="GET")}),S.ajaxTransport("script",function(n){var r,i;if(n.crossDomain||n.scriptAttrs)return{send:function(e,t){r=S("<script>").attr(n.scriptAttrs||{}).prop({charset:n.scriptCharset,src:n.url}).on("load error",i=function(e){r.remove(),i=null,e&&t("error"===e.type?404:200,e.type)}),E.head.appendChild(r[0])},abort:function(){i&&i()}}});var _t,zt=[],Ut=/(=)\?(?=&|$)|\?\?/;S.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var e=zt.pop()||S.expando+"_"+wt.guid++;return this[e]=!0,e}}),S.ajaxPrefilter("json jsonp",function(e,t,n){var r,i,o,a=!1!==e.jsonp&&(Ut.test(e.url)?"url":"string"==typeof e.data&&0===(e.contentType||"").indexOf("application/x-www-form-urlencoded")&&Ut.test(e.data)&&"data");if(a||"jsonp"===e.dataTypes[0])return r=e.jsonpCallback=m(e.jsonpCallback)?e.jsonpCallback():e.jsonpCallback,a?e[a]=e[a].replace(Ut,"$1"+r):!1!==e.jsonp&&(e.url+=(Tt.test(e.url)?"&":"?")+e.jsonp+"="+r),e.converters["script json"]=function(){return o||S.error(r+" was not called"),o[0]},e.dataTypes[0]="json",i=C[r],C[r]=function(){o=arguments},n.always(function(){void 0===i?S(C).removeProp(r):C[r]=i,e[r]&&(e.jsonpCallback=t.jsonpCallback,zt.push(r)),o&&m(i)&&i(o[0]),o=i=void 0}),"script"}),y.createHTMLDocument=((_t=E.implementation.createHTMLDocument("").body).innerHTML="<form></form><form></form>",2===_t.childNodes.length),S.parseHTML=function(e,t,n){return"string"!=typeof e?[]:("boolean"==typeof t&&(n=t,t=!1),t||(y.createHTMLDocument?((r=(t=E.implementation.createHTMLDocument("")).createElement("base")).href=E.location.href,t.head.appendChild(r)):t=E),o=!n&&[],(i=N.exec(e))?[t.createElement(i[1])]:(i=xe([e],t,o),o&&o.length&&S(o).remove(),S.merge([],i.childNodes)));var r,i,o},S.fn.load=function(e,t,n){var r,i,o,a=this,s=e.indexOf(" ");return-1<s&&(r=ht(e.slice(s)),e=e.slice(0,s)),m(t)?(n=t,t=void 0):t&&"object"==typeof t&&(i="POST"),0<a.length&&S.ajax({url:e,type:i||"GET",dataType:"html",data:t}).done(function(e){o=arguments,a.html(r?S("<div>").append(S.parseHTML(e)).find(r):e)}).always(n&&function(e,t){a.each(function(){n.apply(this,o||[e.responseText,t,e])})}),this},S.expr.pseudos.animated=function(t){return S.grep(S.timers,function(e){return t===e.elem}).length},S.offset={setOffset:function(e,t,n){var r,i,o,a,s,u,l=S.css(e,"position"),c=S(e),f={};"static"===l&&(e.style.position="relative"),s=c.offset(),o=S.css(e,"top"),u=S.css(e,"left"),("absolute"===l||"fixed"===l)&&-1<(o+u).indexOf("auto")?(a=(r=c.position()).top,i=r.left):(a=parseFloat(o)||0,i=parseFloat(u)||0),m(t)&&(t=t.call(e,n,S.extend({},s))),null!=t.top&&(f.top=t.top-s.top+a),null!=t.left&&(f.left=t.left-s.left+i),"using"in t?t.using.call(e,f):c.css(f)}},S.fn.extend({offset:function(t){if(arguments.length)return void 0===t?this:this.each(function(e){S.offset.setOffset(this,t,e)});var e,n,r=this[0];return r?r.getClientRects().length?(e=r.getBoundingClientRect(),n=r.ownerDocument.defaultView,{top:e.top+n.pageYOffset,left:e.left+n.pageXOffset}):{top:0,left:0}:void 0},position:function(){if(this[0]){var e,t,n,r=this[0],i={top:0,left:0};if("fixed"===S.css(r,"position"))t=r.getBoundingClientRect();else{t=this.offset(),n=r.ownerDocument,e=r.offsetParent||n.documentElement;while(e&&(e===n.body||e===n.documentElement)&&"static"===S.css(e,"position"))e=e.parentNode;e&&e!==r&&1===e.nodeType&&((i=S(e).offset()).top+=S.css(e,"borderTopWidth",!0),i.left+=S.css(e,"borderLeftWidth",!0))}return{top:t.top-i.top-S.css(r,"marginTop",!0),left:t.left-i.left-S.css(r,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){var e=this.offsetParent;while(e&&"static"===S.css(e,"position"))e=e.offsetParent;return e||re})}}),S.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(t,i){var o="pageYOffset"===i;S.fn[t]=function(e){return $(this,function(e,t,n){var r;if(x(e)?r=e:9===e.nodeType&&(r=e.defaultView),void 0===n)return r?r[i]:e[t];r?r.scrollTo(o?r.pageXOffset:n,o?n:r.pageYOffset):e[t]=n},t,e,arguments.length)}}),S.each(["top","left"],function(e,n){S.cssHooks[n]=Fe(y.pixelPosition,function(e,t){if(t)return t=We(e,n),Pe.test(t)?S(e).position()[n]+"px":t})}),S.each({Height:"height",Width:"width"},function(a,s){S.each({padding:"inner"+a,content:s,"":"outer"+a},function(r,o){S.fn[o]=function(e,t){var n=arguments.length&&(r||"boolean"!=typeof e),i=r||(!0===e||!0===t?"margin":"border");return $(this,function(e,t,n){var r;return x(e)?0===o.indexOf("outer")?e["inner"+a]:e.document.documentElement["client"+a]:9===e.nodeType?(r=e.documentElement,Math.max(e.body["scroll"+a],r["scroll"+a],e.body["offset"+a],r["offset"+a],r["client"+a])):void 0===n?S.css(e,t,i):S.style(e,t,n,i)},s,n?e:void 0,n)}})}),S.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(e,t){S.fn[t]=function(e){return this.on(t,e)}}),S.fn.extend({bind:function(e,t,n){return this.on(e,null,t,n)},unbind:function(e,t){return this.off(e,null,t)},delegate:function(e,t,n,r){return this.on(t,e,n,r)},undelegate:function(e,t,n){return 1===arguments.length?this.off(e,"**"):this.off(t,e||"**",n)},hover:function(e,t){return this.mouseenter(e).mouseleave(t||e)}}),S.each("blur focus focusin focusout resize scroll click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup contextmenu".split(" "),function(e,n){S.fn[n]=function(e,t){return 0<arguments.length?this.on(n,null,e,t):this.trigger(n)}});var Xt=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g;S.proxy=function(e,t){var n,r,i;if("string"==typeof t&&(n=e[t],t=e,e=n),m(e))return r=s.call(arguments,2),(i=function(){return e.apply(t||this,r.concat(s.call(arguments)))}).guid=e.guid=e.guid||S.guid++,i},S.holdReady=function(e){e?S.readyWait++:S.ready(!0)},S.isArray=Array.isArray,S.parseJSON=JSON.parse,S.nodeName=A,S.isFunction=m,S.isWindow=x,S.camelCase=X,S.type=w,S.now=Date.now,S.isNumeric=function(e){var t=S.type(e);return("number"===t||"string"===t)&&!isNaN(e-parseFloat(e))},S.trim=function(e){return null==e?"":(e+"").replace(Xt,"")},"function"==typeof define&&define.amd&&define("jquery",[],function(){return S});var Vt=C.jQuery,Gt=C.$;return S.noConflict=function(e){return C.$===S&&(C.$=Gt),e&&C.jQuery===S&&(C.jQuery=Vt),S},"undefined"==typeof e&&(C.jQuery=C.$=S),S});
/*
 * jQuery throttle / debounce - v1.1 - 3/7/2010
 * http://benalman.com/projects/jquery-throttle-debounce-plugin/
 * 
 * Copyright (c) 2010 "Cowboy" Ben Alman
 * Dual licensed under the MIT and GPL licenses.
 * http://benalman.com/about/license/
 */
(function(b,c){var $=b.jQuery||b.Cowboy||(b.Cowboy={}),a;$.throttle=a=function(e,f,j,i){var h,d=0;if(typeof f!=="boolean"){i=j;j=f;f=c}function g(){var o=this,m=+new Date()-d,n=arguments;function l(){d=+new Date();j.apply(o,n)}function k(){h=c}if(i&&!h){l()}h&&clearTimeout(h);if(i===c&&m>e){l()}else{if(f!==true){h=setTimeout(i?k:l,i===c?e-m:e)}}}if($.guid){g.guid=j.guid=j.guid||$.guid++}return g};$.debounce=function(d,e,f){return f===c?a(d,e,false):a(d,f,e!==false)}})(this);
/*!
 * imagesLoaded PACKAGED v4.1.4
 * JavaScript is all like "You images are done yet or what?"
 * MIT License
 */
!function(e,t){"function"==typeof define&&define.amd?define("ev-emitter/ev-emitter",t):"object"==typeof module&&module.exports?module.exports=t():e.EvEmitter=t()}("undefined"!=typeof window?window:this,function(){function e(){}var t=e.prototype;return t.on=function(e,t){if(e&&t){var i=this._events=this._events||{},n=i[e]=i[e]||[];return n.indexOf(t)==-1&&n.push(t),this}},t.once=function(e,t){if(e&&t){this.on(e,t);var i=this._onceEvents=this._onceEvents||{},n=i[e]=i[e]||{};return n[t]=!0,this}},t.off=function(e,t){var i=this._events&&this._events[e];if(i&&i.length){var n=i.indexOf(t);return n!=-1&&i.splice(n,1),this}},t.emitEvent=function(e,t){var i=this._events&&this._events[e];if(i&&i.length){i=i.slice(0),t=t||[];for(var n=this._onceEvents&&this._onceEvents[e],o=0;o<i.length;o++){var r=i[o],s=n&&n[r];s&&(this.off(e,r),delete n[r]),r.apply(this,t)}return this}},t.allOff=function(){delete this._events,delete this._onceEvents},e}),function(e,t){"use strict";"function"==typeof define&&define.amd?define(["ev-emitter/ev-emitter"],function(i){return t(e,i)}):"object"==typeof module&&module.exports?module.exports=t(e,require("ev-emitter")):e.imagesLoaded=t(e,e.EvEmitter)}("undefined"!=typeof window?window:this,function(e,t){function i(e,t){for(var i in t)e[i]=t[i];return e}function n(e){if(Array.isArray(e))return e;var t="object"==typeof e&&"number"==typeof e.length;return t?d.call(e):[e]}function o(e,t,r){if(!(this instanceof o))return new o(e,t,r);var s=e;return"string"==typeof e&&(s=document.querySelectorAll(e)),s?(this.elements=n(s),this.options=i({},this.options),"function"==typeof t?r=t:i(this.options,t),r&&this.on("always",r),this.getImages(),h&&(this.jqDeferred=new h.Deferred),void setTimeout(this.check.bind(this))):void a.error("Bad element for imagesLoaded "+(s||e))}function r(e){this.img=e}function s(e,t){this.url=e,this.element=t,this.img=new Image}var h=e.jQuery,a=e.console,d=Array.prototype.slice;o.prototype=Object.create(t.prototype),o.prototype.options={},o.prototype.getImages=function(){this.images=[],this.elements.forEach(this.addElementImages,this)},o.prototype.addElementImages=function(e){"IMG"==e.nodeName&&this.addImage(e),this.options.background===!0&&this.addElementBackgroundImages(e);var t=e.nodeType;if(t&&u[t]){for(var i=e.querySelectorAll("img"),n=0;n<i.length;n++){var o=i[n];this.addImage(o)}if("string"==typeof this.options.background){var r=e.querySelectorAll(this.options.background);for(n=0;n<r.length;n++){var s=r[n];this.addElementBackgroundImages(s)}}}};var u={1:!0,9:!0,11:!0};return o.prototype.addElementBackgroundImages=function(e){var t=getComputedStyle(e);if(t)for(var i=/url\((['"])?(.*?)\1\)/gi,n=i.exec(t.backgroundImage);null!==n;){var o=n&&n[2];o&&this.addBackground(o,e),n=i.exec(t.backgroundImage)}},o.prototype.addImage=function(e){var t=new r(e);this.images.push(t)},o.prototype.addBackground=function(e,t){var i=new s(e,t);this.images.push(i)},o.prototype.check=function(){function e(e,i,n){setTimeout(function(){t.progress(e,i,n)})}var t=this;return this.progressedCount=0,this.hasAnyBroken=!1,this.images.length?void this.images.forEach(function(t){t.once("progress",e),t.check()}):void this.complete()},o.prototype.progress=function(e,t,i){this.progressedCount++,this.hasAnyBroken=this.hasAnyBroken||!e.isLoaded,this.emitEvent("progress",[this,e,t]),this.jqDeferred&&this.jqDeferred.notify&&this.jqDeferred.notify(this,e),this.progressedCount==this.images.length&&this.complete(),this.options.debug&&a&&a.log("progress: "+i,e,t)},o.prototype.complete=function(){var e=this.hasAnyBroken?"fail":"done";if(this.isComplete=!0,this.emitEvent(e,[this]),this.emitEvent("always",[this]),this.jqDeferred){var t=this.hasAnyBroken?"reject":"resolve";this.jqDeferred[t](this)}},r.prototype=Object.create(t.prototype),r.prototype.check=function(){var e=this.getIsImageComplete();return e?void this.confirm(0!==this.img.naturalWidth,"naturalWidth"):(this.proxyImage=new Image,this.proxyImage.addEventListener("load",this),this.proxyImage.addEventListener("error",this),this.img.addEventListener("load",this),this.img.addEventListener("error",this),void(this.proxyImage.src=this.img.src))},r.prototype.getIsImageComplete=function(){return this.img.complete&&this.img.naturalWidth},r.prototype.confirm=function(e,t){this.isLoaded=e,this.emitEvent("progress",[this,this.img,t])},r.prototype.handleEvent=function(e){var t="on"+e.type;this[t]&&this[t](e)},r.prototype.onload=function(){this.confirm(!0,"onload"),this.unbindEvents()},r.prototype.onerror=function(){this.confirm(!1,"onerror"),this.unbindEvents()},r.prototype.unbindEvents=function(){this.proxyImage.removeEventListener("load",this),this.proxyImage.removeEventListener("error",this),this.img.removeEventListener("load",this),this.img.removeEventListener("error",this)},s.prototype=Object.create(r.prototype),s.prototype.check=function(){this.img.addEventListener("load",this),this.img.addEventListener("error",this),this.img.src=this.url;var e=this.getIsImageComplete();e&&(this.confirm(0!==this.img.naturalWidth,"naturalWidth"),this.unbindEvents())},s.prototype.unbindEvents=function(){this.img.removeEventListener("load",this),this.img.removeEventListener("error",this)},s.prototype.confirm=function(e,t){this.isLoaded=e,this.emitEvent("progress",[this,this.element,t])},o.makeJQueryPlugin=function(t){t=t||e.jQuery,t&&(h=t,h.fn.imagesLoaded=function(e,t){var i=new o(this,e,t);return i.jqDeferred.promise(h(this))})},o.makeJQueryPlugin(),o});
/*! lz-string-1.3.3-min.js | (c) 2013 Pieroxy | Licensed under a WTFPL license */
var LZString={_keyStr:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",_f:String.fromCharCode,compressToBase64:function(e){if(e==null)return"";var t="";var n,r,i,s,o,u,a;var f=0;e=LZString.compress(e);while(f<e.length*2){if(f%2==0){n=e.charCodeAt(f/2)>>8;r=e.charCodeAt(f/2)&255;if(f/2+1<e.length)i=e.charCodeAt(f/2+1)>>8;else i=NaN}else{n=e.charCodeAt((f-1)/2)&255;if((f+1)/2<e.length){r=e.charCodeAt((f+1)/2)>>8;i=e.charCodeAt((f+1)/2)&255}else r=i=NaN}f+=3;s=n>>2;o=(n&3)<<4|r>>4;u=(r&15)<<2|i>>6;a=i&63;if(isNaN(r)){u=a=64}else if(isNaN(i)){a=64}t=t+LZString._keyStr.charAt(s)+LZString._keyStr.charAt(o)+LZString._keyStr.charAt(u)+LZString._keyStr.charAt(a)}return t},decompressFromBase64:function(e){if(e==null)return"";var t="",n=0,r,i,s,o,u,a,f,l,c=0,h=LZString._f;e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");while(c<e.length){u=LZString._keyStr.indexOf(e.charAt(c++));a=LZString._keyStr.indexOf(e.charAt(c++));f=LZString._keyStr.indexOf(e.charAt(c++));l=LZString._keyStr.indexOf(e.charAt(c++));i=u<<2|a>>4;s=(a&15)<<4|f>>2;o=(f&3)<<6|l;if(n%2==0){r=i<<8;if(f!=64){t+=h(r|s)}if(l!=64){r=o<<8}}else{t=t+h(r|i);if(f!=64){r=s<<8}if(l!=64){t+=h(r|o)}}n+=3}return LZString.decompress(t)},compressToUTF16:function(e){if(e==null)return"";var t="",n,r,i,s=0,o=LZString._f;e=LZString.compress(e);for(n=0;n<e.length;n++){r=e.charCodeAt(n);switch(s++){case 0:t+=o((r>>1)+32);i=(r&1)<<14;break;case 1:t+=o(i+(r>>2)+32);i=(r&3)<<13;break;case 2:t+=o(i+(r>>3)+32);i=(r&7)<<12;break;case 3:t+=o(i+(r>>4)+32);i=(r&15)<<11;break;case 4:t+=o(i+(r>>5)+32);i=(r&31)<<10;break;case 5:t+=o(i+(r>>6)+32);i=(r&63)<<9;break;case 6:t+=o(i+(r>>7)+32);i=(r&127)<<8;break;case 7:t+=o(i+(r>>8)+32);i=(r&255)<<7;break;case 8:t+=o(i+(r>>9)+32);i=(r&511)<<6;break;case 9:t+=o(i+(r>>10)+32);i=(r&1023)<<5;break;case 10:t+=o(i+(r>>11)+32);i=(r&2047)<<4;break;case 11:t+=o(i+(r>>12)+32);i=(r&4095)<<3;break;case 12:t+=o(i+(r>>13)+32);i=(r&8191)<<2;break;case 13:t+=o(i+(r>>14)+32);i=(r&16383)<<1;break;case 14:t+=o(i+(r>>15)+32,(r&32767)+32);s=0;break}}return t+o(i+32)},decompressFromUTF16:function(e){if(e==null)return"";var t="",n,r,i=0,s=0,o=LZString._f;while(s<e.length){r=e.charCodeAt(s)-32;switch(i++){case 0:n=r<<1;break;case 1:t+=o(n|r>>14);n=(r&16383)<<2;break;case 2:t+=o(n|r>>13);n=(r&8191)<<3;break;case 3:t+=o(n|r>>12);n=(r&4095)<<4;break;case 4:t+=o(n|r>>11);n=(r&2047)<<5;break;case 5:t+=o(n|r>>10);n=(r&1023)<<6;break;case 6:t+=o(n|r>>9);n=(r&511)<<7;break;case 7:t+=o(n|r>>8);n=(r&255)<<8;break;case 8:t+=o(n|r>>7);n=(r&127)<<9;break;case 9:t+=o(n|r>>6);n=(r&63)<<10;break;case 10:t+=o(n|r>>5);n=(r&31)<<11;break;case 11:t+=o(n|r>>4);n=(r&15)<<12;break;case 12:t+=o(n|r>>3);n=(r&7)<<13;break;case 13:t+=o(n|r>>2);n=(r&3)<<14;break;case 14:t+=o(n|r>>1);n=(r&1)<<15;break;case 15:t+=o(n|r);i=0;break}s++}return LZString.decompress(t)},compress:function(e){if(e==null)return"";var t,n,r={},i={},s="",o="",u="",a=2,f=3,l=2,c="",h=0,p=0,d,v=LZString._f;for(d=0;d<e.length;d+=1){s=e.charAt(d);if(!Object.prototype.hasOwnProperty.call(r,s)){r[s]=f++;i[s]=true}o=u+s;if(Object.prototype.hasOwnProperty.call(r,o)){u=o}else{if(Object.prototype.hasOwnProperty.call(i,u)){if(u.charCodeAt(0)<256){for(t=0;t<l;t++){h=h<<1;if(p==15){p=0;c+=v(h);h=0}else{p++}}n=u.charCodeAt(0);for(t=0;t<8;t++){h=h<<1|n&1;if(p==15){p=0;c+=v(h);h=0}else{p++}n=n>>1}}else{n=1;for(t=0;t<l;t++){h=h<<1|n;if(p==15){p=0;c+=v(h);h=0}else{p++}n=0}n=u.charCodeAt(0);for(t=0;t<16;t++){h=h<<1|n&1;if(p==15){p=0;c+=v(h);h=0}else{p++}n=n>>1}}a--;if(a==0){a=Math.pow(2,l);l++}delete i[u]}else{n=r[u];for(t=0;t<l;t++){h=h<<1|n&1;if(p==15){p=0;c+=v(h);h=0}else{p++}n=n>>1}}a--;if(a==0){a=Math.pow(2,l);l++}r[o]=f++;u=String(s)}}if(u!==""){if(Object.prototype.hasOwnProperty.call(i,u)){if(u.charCodeAt(0)<256){for(t=0;t<l;t++){h=h<<1;if(p==15){p=0;c+=v(h);h=0}else{p++}}n=u.charCodeAt(0);for(t=0;t<8;t++){h=h<<1|n&1;if(p==15){p=0;c+=v(h);h=0}else{p++}n=n>>1}}else{n=1;for(t=0;t<l;t++){h=h<<1|n;if(p==15){p=0;c+=v(h);h=0}else{p++}n=0}n=u.charCodeAt(0);for(t=0;t<16;t++){h=h<<1|n&1;if(p==15){p=0;c+=v(h);h=0}else{p++}n=n>>1}}a--;if(a==0){a=Math.pow(2,l);l++}delete i[u]}else{n=r[u];for(t=0;t<l;t++){h=h<<1|n&1;if(p==15){p=0;c+=v(h);h=0}else{p++}n=n>>1}}a--;if(a==0){a=Math.pow(2,l);l++}}n=2;for(t=0;t<l;t++){h=h<<1|n&1;if(p==15){p=0;c+=v(h);h=0}else{p++}n=n>>1}while(true){h=h<<1;if(p==15){c+=v(h);break}else p++}return c},decompress:function(e){if(e==null)return"";if(e=="")return null;var t=[],n,r=4,i=4,s=3,o="",u="",a,f,l,c,h,p,d,v=LZString._f,m={string:e,val:e.charCodeAt(0),position:32768,index:1};for(a=0;a<3;a+=1){t[a]=a}l=0;h=Math.pow(2,2);p=1;while(p!=h){c=m.val&m.position;m.position>>=1;if(m.position==0){m.position=32768;m.val=m.string.charCodeAt(m.index++)}l|=(c>0?1:0)*p;p<<=1}switch(n=l){case 0:l=0;h=Math.pow(2,8);p=1;while(p!=h){c=m.val&m.position;m.position>>=1;if(m.position==0){m.position=32768;m.val=m.string.charCodeAt(m.index++)}l|=(c>0?1:0)*p;p<<=1}d=v(l);break;case 1:l=0;h=Math.pow(2,16);p=1;while(p!=h){c=m.val&m.position;m.position>>=1;if(m.position==0){m.position=32768;m.val=m.string.charCodeAt(m.index++)}l|=(c>0?1:0)*p;p<<=1}d=v(l);break;case 2:return""}t[3]=d;f=u=d;while(true){if(m.index>m.string.length){return""}l=0;h=Math.pow(2,s);p=1;while(p!=h){c=m.val&m.position;m.position>>=1;if(m.position==0){m.position=32768;m.val=m.string.charCodeAt(m.index++)}l|=(c>0?1:0)*p;p<<=1}switch(d=l){case 0:l=0;h=Math.pow(2,8);p=1;while(p!=h){c=m.val&m.position;m.position>>=1;if(m.position==0){m.position=32768;m.val=m.string.charCodeAt(m.index++)}l|=(c>0?1:0)*p;p<<=1}t[i++]=v(l);d=i-1;r--;break;case 1:l=0;h=Math.pow(2,16);p=1;while(p!=h){c=m.val&m.position;m.position>>=1;if(m.position==0){m.position=32768;m.val=m.string.charCodeAt(m.index++)}l|=(c>0?1:0)*p;p<<=1}t[i++]=v(l);d=i-1;r--;break;case 2:return u}if(r==0){r=Math.pow(2,s);s++}if(t[d]){o=t[d]}else{if(d===i){o=f+f.charAt(0)}else{return null}}u+=o;t[i++]=f+o.charAt(0);r--;f=o;if(r==0){r=Math.pow(2,s);s++}}}};if(typeof module!=="undefined"&&module!=null){module.exports=LZString}
/*! @source http://purl.eligrey.com/github/FileSaver.js/blob/master/dist/FileSaver.js */
(function(a,b){if("function"==typeof define&&define.amd)define([],b);else if("undefined"!=typeof exports)b();else{b(),a.FileSaver={exports:{}}.exports}})(this,function(){"use strict";function b(a,b){return"undefined"==typeof b?b={autoBom:!1}:"object"!=typeof b&&(console.warn("Deprecated: Expected third argument to be a object"),b={autoBom:!b}),b.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(a.type)?new Blob(["\uFEFF",a],{type:a.type}):a}function c(a,b,c){var d=new XMLHttpRequest;d.open("GET",a),d.responseType="blob",d.onload=function(){g(d.response,b,c)},d.onerror=function(){console.error("could not download file")},d.send()}function d(a){var b=new XMLHttpRequest;b.open("HEAD",a,!1);try{b.send()}catch(a){}return 200<=b.status&&299>=b.status}function e(a){try{a.dispatchEvent(new MouseEvent("click"))}catch(c){var b=document.createEvent("MouseEvents");b.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),a.dispatchEvent(b)}}var f="object"==typeof window&&window.window===window?window:"object"==typeof self&&self.self===self?self:"object"==typeof global&&global.global===global?global:void 0,a=/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),g=f.saveAs||("object"!=typeof window||window!==f?function(){}:"download"in HTMLAnchorElement.prototype&&!a?function(b,g,h){var i=f.URL||f.webkitURL,j=document.createElement("a");g=g||b.name||"download",j.download=g,j.rel="noopener","string"==typeof b?(j.href=b,j.origin===location.origin?e(j):d(j.href)?c(b,g,h):e(j,j.target="_blank")):(j.href=i.createObjectURL(b),setTimeout(function(){i.revokeObjectURL(j.href)},4E4),setTimeout(function(){e(j)},0))}:"msSaveOrOpenBlob"in navigator?function(f,g,h){if(g=g||f.name||"download","string"!=typeof f)navigator.msSaveOrOpenBlob(b(f,h),g);else if(d(f))c(f,g,h);else{var i=document.createElement("a");i.href=f,i.target="_blank",setTimeout(function(){e(i)})}}:function(b,d,e,g){if(g=g||open("","_blank"),g&&(g.document.title=g.document.body.innerText="downloading..."),"string"==typeof b)return c(b,d,e);var h="application/octet-stream"===b.type,i=/constructor/i.test(f.HTMLElement)||f.safari,j=/CriOS\/[\d]+/.test(navigator.userAgent);if((j||h&&i||a)&&"undefined"!=typeof FileReader){var k=new FileReader;k.onloadend=function(){var a=k.result;a=j?a:a.replace(/^data:[^;]*;/,"data:attachment/file;"),g?g.location.href=a:location=a,g=null},k.readAsDataURL(b)}else{var l=f.URL||f.webkitURL,m=l.createObjectURL(b);g?g.location=m:location.href=m,g=null,setTimeout(function(){l.revokeObjectURL(m)},4E4)}});f.saveAs=g.saveAs=g,"undefined"!=typeof module&&(module.exports=g)});
/*! seedrandom.js v2.3.3 | (c) 2013 David Bau, all rights reserved. | Licensed under a BSD-style license */
!function(a,b,c,d,e,f,g,h,i){function j(a){var b,c=a.length,e=this,f=0,g=e.i=e.j=0,h=e.S=[];for(c||(a=[c++]);d>f;)h[f]=f++;for(f=0;d>f;f++)h[f]=h[g=r&g+a[f%c]+(b=h[f])],h[g]=b;(e.g=function(a){for(var b,c=0,f=e.i,g=e.j,h=e.S;a--;)b=h[f=r&f+1],c=c*d+h[r&(h[f]=h[g=r&g+b])+(h[g]=b)];return e.i=f,e.j=g,c})(d)}function k(a,b){var c,d=[],e=typeof a;if(b&&"object"==e)for(c in a)try{d.push(k(a[c],b-1))}catch(f){}return d.length?d:"string"==e?a:a+"\0"}function l(a,b){for(var c,d=a+"",e=0;e<d.length;)b[r&e]=r&(c^=19*b[r&e])+d.charCodeAt(e++);return n(b)}function m(c){try{return a.crypto.getRandomValues(c=new Uint8Array(d)),n(c)}catch(e){return[+new Date,a,(c=a.navigator)&&c.plugins,a.screen,n(b)]}}function n(a){return String.fromCharCode.apply(0,a)}var o=c.pow(d,e),p=c.pow(2,f),q=2*p,r=d-1,s=c["seed"+i]=function(a,f,g){var h=[],r=l(k(f?[a,n(b)]:null==a?m():a,3),h),s=new j(h);return l(n(s.S),b),(g||function(a,b,d){return d?(c[i]=a,b):a})(function(){for(var a=s.g(e),b=o,c=0;p>a;)a=(a+c)*d,b*=d,c=s.g(1);for(;a>=q;)a/=2,b/=2,c>>>=1;return(a+c)/b},r,this==c)};l(c[i](),b),g&&g.exports?g.exports=s:h&&h.amd&&h(function(){return s})}(this,[],Math,256,6,52,"object"==typeof module&&module,"function"==typeof define&&define,"random");
/*! console_hack.js | (c) 2015 Thomas Michael Edwards | Licensed under SugarCube's Simple BSD license */
!function(){for(var methods=["assert","clear","count","debug","dir","dirxml","error","exception","group","groupCollapsed","groupEnd","info","log","markTimeline","profile","profileEnd","table","time","timeEnd","timeline","timelineEnd","timeStamp","trace","warn"],length=methods.length,noop=function(){},console=window.console=window.console||{};length--;){var method=methods[length];console[method]||(console[method]=noop)}}();
}else{document.documentElement.setAttribute("data-init", "lacking");}
</script>
<style id="style-normalize" type="text/css">/*! normalize.css v3.0.3 | MIT License | github.com/necolas/normalize.css */html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}body{margin:0}article,aside,details,figcaption,figure,footer,header,hgroup,main,menu,nav,section,summary{display:block}audio,canvas,progress,video{display:inline-block;vertical-align:baseline}audio:not([controls]){display:none;height:0}[hidden],template{display:none}a{background-color:transparent}a:active,a:hover{outline:0}abbr[title]{border-bottom:1px dotted}b,strong{font-weight:700}dfn{font-style:italic}h1{font-size:2em;margin:.67em 0}mark{background:#ff0;color:#000}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sup{top:-.5em}sub{bottom:-.25em}img{border:0}svg:not(:root){overflow:hidden}figure{margin:1em 40px}hr{box-sizing:content-box;height:0}pre{overflow:auto}code,kbd,pre,samp{font-family:monospace,monospace;font-size:1em}button,input,optgroup,select,textarea{color:inherit;font:inherit;margin:0}button{overflow:visible}button,select{text-transform:none}button,html input[type=button],input[type=reset],input[type=submit]{-webkit-appearance:button;cursor:pointer}button[disabled],html input[disabled]{cursor:default}button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}input{line-height:normal}input[type=checkbox],input[type=radio]{box-sizing:border-box;padding:0}input[type=number]::-webkit-inner-spin-button,input[type=number]::-webkit-outer-spin-button{height:auto}input[type=search]{-webkit-appearance:textfield;box-sizing:content-box}input[type=search]::-webkit-search-cancel-button,input[type=search]::-webkit-search-decoration{-webkit-appearance:none}fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}legend{border:0;padding:0}textarea{overflow:auto}optgroup{font-weight:700}table{border-collapse:collapse;border-spacing:0}td,th{padding:0}</style>
<style id="style-init-screen" type="text/css">@-webkit-keyframes init-loading-spin{0%{-webkit-transform:rotate(0);transform:rotate(0)}100%{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}@-o-keyframes init-loading-spin{0%{-o-transform:rotate(0);transform:rotate(0)}100%{-o-transform:rotate(360deg);transform:rotate(360deg)}}@keyframes init-loading-spin{0%{-webkit-transform:rotate(0);-o-transform:rotate(0);transform:rotate(0)}100%{-webkit-transform:rotate(360deg);-o-transform:rotate(360deg);transform:rotate(360deg)}}#init-screen{display:none;z-index:500000;position:fixed;top:0;left:0;height:100%;width:100%;font:28px/1 Helmet,Freesans,sans-serif;font-weight:700;color:#eee;background-color:#111;text-align:center}#init-screen>div{display:none;position:relative;margin:0 auto;max-width:1136px;top:25%}html[data-init=lacking] #init-screen,html[data-init=loading] #init-screen,html[data-init=no-js] #init-screen{display:block}html[data-init=lacking] #init-lacking,html[data-init=no-js] #init-no-js{display:block;padding:0 1em}html[data-init=no-js] #init-no-js{color:red}html[data-init=loading] #init-loading{display:block;border:24px solid transparent;border-radius:50%;border-top-color:#7f7f7f;border-bottom-color:#7f7f7f;width:100px;height:100px;-webkit-animation:init-loading-spin 2s linear infinite;-o-animation:init-loading-spin 2s linear infinite;animation:init-loading-spin 2s linear infinite}html[data-init=loading] #init-loading>div{text-indent:9999em;overflow:hidden;white-space:nowrap}html[data-init=loading] #passages,html[data-init=loading] #ui-bar{display:none}</style>
<style id="style-font" type="text/css">@font-face{font-family:tme-fa-icons;src:url('data:application/octet-stream;base64,d09GRgABAAAAADLAAA8AAAAAWHgAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAABHU1VCAAABWAAAADsAAABUIIslek9TLzIAAAGUAAAAQwAAAFY+IEkIY21hcAAAAdgAAAG8AAAF3rob9jFjdnQgAAADlAAAABMAAAAgBtX/BGZwZ20AAAOoAAAFkAAAC3CKkZBZZ2FzcAAACTgAAAAIAAAACAAAABBnbHlmAAAJQAAAI6gAADv+gJOpzGhlYWQAACzoAAAAMwAAADYY1IZaaGhlYQAALRwAAAAgAAAAJAfCBClobXR4AAAtPAAAAJEAAAFMBfb/0WxvY2EAAC3QAAAAqAAAAKhjiHI5bWF4cAAALngAAAAgAAAAIAFjDA9uYW1lAAAumAAAAY0AAAL94+zEpHBvc3QAADAoAAACHAAAA11cG/YjcHJlcAAAMkQAAAB6AAAAhuVBK7x4nGNgZGBg4GIwYLBjYHJx8wlh4MtJLMljkGJgYYAAkDwymzEnMz2RgQPGA8qxgGkOIGaDiAIAJjsFSAB4nGNgZNZgnMDAysDAVMW0h4GBoQdCMz5gMGRkAooysDIzYAUBaa4pDA4vGF4EMgf9z2KIYg5imAYUZgTJAQDSIQumAHic7dTVbltRAETR7dpNCikzQ8rMzMxt/M39mHnsU1/TfZz5jFpaV7pXJunMDLAZmOqaZjD5y4Tx+uPTyeL5lG2L5zN+L94zG8+ztr7ulXH1fra4bvK9M79xiWW2sNXPbWeFHexkF7vZw172sZ8DHOQQhznCUY5xnBOc5BSnOcNZVjnHeS5wkUtc5gpX/f3r3OAmt7jNHe5yj/s84CGPeMwTnvKM57zgJa94zRve8o73fOAjn/jMF77yje/84Ce/WGPun1zi/2tlXKbp3Xyc44bFyZanSWokJDXOOjXSk/LUSXn+pEwCKTNBaqQqZU5IjX+XMjukTBEp80TKZJEyY6RMGylzR8oEkjKLpEwlKfNJyqSSMrOkTC8pc0zKRJMy26RMOSnzTsrkk7IDpGwDKXtByoaQsiukbA0p+0PKJpGyU6RsFyl7RmosQcrukbKFpOwjKZtJyo6Ssq2k7C0pG0zKLpOy1aTsNymbTsrOk7L9pNwBUi4CKbeBlCtByr0g5XKQckNIuSak3BVSLgwpt4aUq0PK/SHlEpFyk0i5TqTcKVIuFim3i5QrRso9I+WykXLjXOYNzP8BuAPUwHicY2BAAxIQyBz0PwuEARJsA90AeJytVml300YUHXlJnIQsJQstamHExGmwRiZswYAJQbJjIF2crZWgixQ76b7xid/gX/Nk2nPoN35a7xsvJJC053Cak6N3583VzNtlElqS2AvrkZSbL8XU1iaN7DwJ6YZNy1F8KDt7IWWKyd8FURCtltq3HYdERCJQta6wRBD7HlmaZHzoUUbLtqRXTcotPekuW+NBvVXffho6yrE7oaRmM3RoPbIlVRhVokimPVLSpmWo+itJK7y/wsxXzVDCiE4iabwZxtBI3htntMpoNbbjKIpsstwoUiSa4UEUeZTVEufkigkMygfNkPLKpxHlw/yIrNijnFawS7bT/L4vead3OT+xX29RtuRAH8iO7ODsdCVfhFtbYdy0k+0oVBF213dCbNnsVP9mj/KaRgO3KzK90IxgqXyFECs/ocz+IVktnE/5kkejWrKRE0HrZU7sSz6B1uOIKXHNGFnQ3dEJEdT9kjMM9pg+Hvzx3imWCxMCeBzLekclnAgTKWFzNEnaMHJgJWWLKqn1rpg45XVaxFvCfu3a0ZfOaONQd2I8Ww8dWzlRyfFoUqeZTJ3aSc2jKQ2ilHQmeMyvAyg/oklebWM1iZVH0zhmxoREIgIt3EtTQSw7saQpBM2jGb25G6a5di1apMkD9dyj9/TmVri501PaDvSzRn9Wp2I62AvT6WnkL/Fp2uUiRen66Rl+TOJB1gIykS02w5SDB2/9DtLL15YchdcG2O7t8yuofdZE8KQB+xvQHk/VKQlMhZhViFZAYq1rWZbJ1awWqcjUd0OaVr6s0wSKchwXx76Mcf1fMzOWmBK+34nTsyMuPXPtSwjTHHybdT2a16nFcgFxZnlOp1mW7+s0x/IDneZZntfpCEtbp6MsP9RpgeVHOh1jeUELmnTfwZCLMOQCDpAwhKUDQ1hegiEsFQxhuQhDWBZhCMslGMLyYxjCchmGsLysZdXUU0nj2plYBmxCYGKOHrnMReVqKrlUQrtoVGpDnhJulVQUz6p/ZaBePPKGObAWSJfIml8xzpWPRuX41hUtbxo7V8Cx6m8fjvY58VLWi4U/Bf/V1lQlvWLNw5Or8BuGnmwnqjapeHRNl89VPbr+X1RUWAv0G0iFWCjKsmxwZyKEjzqdhmqglUPMbMw8tOt1y5qfw/03MUIWUP34NxQaC9yDTllJWe3grNXX27LcO4NyOBMsSTE38/pW+CIjs9J+kVnKno98HnAFjEpl2GoDrRW82ScxD5neJM8EcVtRNkja2M4EiQ0c84B5850EJmHqqg3kTuGGDfgFYW7BeSdconqjLIfuRezzKKT8W6fiRPaoaIzAs9kbYa/vQspvcQwkNPmlfgxUFaGpGDUV0DRSbqgGX8bZum1Cxg70Iyp2w7Ks4sPHFveVkm0ZhHykiNWjo5/WXqJOqtx+ZhSX752+BcEgNTF/e990cZDKu1rJMkdtA1O3GpVT15pD41WH6uZR9b3j7BM5a5puuiceel/TqtvBxVwssPZtDtJSJhfU9WGFDaLLxaVQ6mU0Se+4BxgWGNDvUIqN/6v62HyeK1WF0XEk307Ut9HnYAz8D9h/R/UD0Pdj6HINLs/3mhOfbvThbJmuohfrp+g3MGutuVm6BtzQdAPiIUetjrjKDXynBnF6pLkc6SHgY90V4gHAJoDF4BPdtYzmUwCj+Yw5PsDnzGHQZA6DLeYw2GbOGsAOcxjsMofBHnMYfMGcdYAvmcMgZA6DiDkMnjAnAHjKHAZfMYfB18xh8A1z7gN8yxwGMXMYJMxhsK/p1jDMLV7QXaC2QVWgA1NPWNzD4lBTZcj+jheG/b1BzP7BIKb+qOn2kPoTLwz1Z4OY+otBTP1V050h9TdeGOrvBjH1D4OY+ky/GMtlBr+MfJcKB5RdbD7n74n3D9vFQLkAAQAB//8AD3icrXsLcFzlleZ//v+++nb37dfte/VotVrdrW5JltuKpO6WJVluPyXbsmOEbGRjO4KVjWPZlsM4QIU4IYGlgCE2yxqKIQkJg2GreKQCTCZb1CZkiswjzOwOmSTATNVWTZLdDUwSMrVDsomD23vOf69assFAqgbk+773P4//nPOdc/5mwNjFl8WjosbaWblmxiOmIlTGYXzb11M7Z2ohAMbZCcZ5iG9prZl4whfwGju05xtttitUdwXYEUgkbQtWga5lC+XBaqJI285qpb8dVEc8Gnm5L5QM/f58yAlB399a7dD0mWAmdAqaMvBmKPKX9TdDwSjod9yhx03FAPcvI6Gk2lV33XoXUtKgL8C6Wa0WSzXbVjhg6JoqIPShCK0FOvOuE48K1V4B1VUQAVevugmP7Fz2CmTzW5/8+ZGP/+Kp7h/8oI4MuOZ7M5B9IvujH2Wf+PnCAjzn8ZK6AieMKRcvXnxWWSWCzGARlPcqtqs21WZzEBFgYIVDAYWzVJIrXBlH+hXGlWNM00GAJmYZ8sKBzTJFVZVppijqDFMVdTIWLa0o5JrdaHusPZGIG1IjFhQGK2mAZEe56kJnR1bTY7ZT7eivFGODBTdma3pHtlCNDVbwmgMHx/aO4R8ffeet5/ZCG6TfuV03IaSJU3oIzKsGO9+5PV+BwU5xqnOQx1aO8fW71yvD9fPn55/fA22PmsaFvfSgwZ8wzPiFvZ2DUMnzJ2hHVDMmHucPsSRrq7UQo4DMAV/AW7CANw/Zru3NIx20bBEpXwukArlxxOPReibaG63/SyQyiftzcBy3k1HuOHgjEgFHnkYfh4VodDJC4138Ff8hv5PlWbrWmm2O6grNEgGNCWGnbFtRm1Z04gzQPPWvkqMWF4eWU8DB267Df+gNe84bBvfRpfNI5Ny5yAmHDh5/PPLuByMlekDS9DsRR73nWHetwBShSO5PqCBQONO4E2wGlSvYZG6gMzeQ09SWFZC0tWION3oOVVXGTbGM+hrAzQj0O25yoN8R8YzzRsaZdzLwhpsGPEm783hAJ9+kq286eDX5pn/VydDjvk7i8EuchU21JJ3DNOqFzeABmywPcNXxhu/wB+3whrqwVw7Cn1j8vPfdDH6O7PR3fDV/Cb85wua/waSit309grZJHHOhHEQ9CA7zTGVCUb0ZvXzc1lrRe5Af+4An0aSL9op0IU9y6vRFtAYGKy7KJGFbQrdg2dXqGAwWilld0zUy9xLqd6A/zeFuy7gzYFmBOwOhZ6NNhZakm8YTI7S1pyM1mM032V26qevXGlzZ8+TKvROlB/BBkO9ACDalB7OZuBnuC5tRcAItpalENNOfhajVH1A2a1HjbHZ4N4r54oWLz4qPoe4jrMo2sonapm5QRQBQ3XycKVxwRRxjQuVCnWc6mrzOZ5FvBiraOmia5FubYRpok8n0ioRTKOQMNbWiszxYWAFZrQ1sB+dDJTFYghzyiBN3oB857ndIAha4Se/+YGUtjAkXXUO2xPE2eoe3TWPeMOXmzNi+j9w1HghvVbSAmu4c6nFac6MgbzXFU2baDr1241+98TfHtU/9t7df+MzU4msmfPYj06Wbw8Gqohda0/FkSyiyvtPGG/FsMKq1pLqmPvndkye/+y+08eYIHEJZpFmJra2Nop/VWuKcCwPvgRhnGlOFps6iIdAEmFVAKh53jblZyBU6nAFdbfX03tGwioZ9oGnEyDSWTQCyFzhoR+s/jdjgWLmc3L2K21zEmXCsM5aDm4g9Ny5v0PZVb+dY9Rcd/sl5eTiPj0nTaeiU+BhhW2qbuzJcUy2Nc2gCrjBkxWCqZiArGgOuwSzjAlDb5L91XfpvfYbpij6ZRIUWYoVcLqC2+UqNLddsMrekY3GZztVl2uQjpl4xjedIM+Uybc/r5viShuHgcgXuwQtpuoMHz8utCe/s8S+Y/7xMaYu2DX1yDrez3lp3cyyKdop+HLcLi878Uh9SKOSlj73cOIUFRVKVKHhaSS9JP452RCcYoJ3w85bz8Ckp9VN4xeZj9atpH4FnPCV4OtiDNIVYCrWwsbauK81VxUlaQnA+riFBisoUsiU0LbQpASCmmRAwg1MNJoH19uQ6WpriUV1jIQjphA5QjosiTfiy1tF+kPJKMTFYpAu6lkx40odnTv7VjYtC/QtTJyGH9HmMnKamGrcaqmaagRsMUwR9WeLmwsQREvIRevSvYa8uVFXo9Sc0w5A8/Rp5+jcxhXLuYAOIx/pbY+ggFp0FV8lNoLNAEQvyDkwBZR9T1ZC6xR0qFgsybix3DJcR7iIGwCsCHHQM0nYKVSBXQZPnqG7KDZiqrn8K524gpN9ghAx42k4GsvF3nohnA0kbnglkC9mrl7h4Db2TommKcVE1QOPRd97K5WJxsKO5nIjHbHtx/og3kK8iWys1he/EkKlqCbFOB6iKQp5Q5Yp6DB0AsjmPvHEFSGsoFraPaVpI2zLc2lmudErjJ/eeQwbKPoRBZulcwhwXYc6i1SdiEpiCF+KrFOIrAzKaHdhQ79tw4MAGuJv4rt8sQQu80jloGnnDfNVJBa+vn1WjSg1d8NHrg44FbTgdJ5+T77yy/gDI5wY7633yTbI7+CdyMDyEL2paDd0BvZjyfIYXH2/H+aqjDfXUisgnk3rFYMePoyZBegWanQpM5hKdlUSU1JnoQH2iG1d90IYADi0JPV2/oxMEeB7apm+aBngFw/ObMjzHzv7dgzyOh48fHZnmO9c8Wv+2RAGwHiP20UNnzx46mvYxyaMixDpZX22lQqQgRDqG4kYcMo92cpypAOo0Ti+iSYXJRGc5l8wvQhPfqpE0SYa7nDwkeQyh26OOlbecqVumoCwJ8+mDm+9/5T4eOyOt+4wk8WjavYTIG+7nD5Li2cWv8zGkMYoz51q2u3Y1JQSwfcumSn9JUxW0CZIWQ5isqKCo8zoGFPybx/lyHD2w4AaCBw7Ap1HIxAaHyZlr1tXG1owMt7h5Ox5QmxF4Iv6vDhaQoTFAYADuYIlnLa7b7RwtiOBDtVK1dbyCMXXxn5azOIIKfLFKaQP9K3HKIMYEQosvhkIWH23TQ9wIpCq9M4WxycnJsQIUYrEJ/bPGuOZohfHVzdmMaAmHm418c7DU3xdoyYPebFktPJtpHu7fefjw4R0VHiNTa06ZUTPe09a1sdTUVNrYtbo3nth11VW7tBa1d/U1a1t71rdG2u1IJNkWDYdbUs0pnnFT+OloWzISsdsjqVpvy9prqrNjed41POfPx2+J7TIXaWP5Wgf5bvToBEvpppQYOXPOJoda4gTQE6TsNK8sAvUSSHBFygfnfM9wL+8aK/Bddv0tZ8SufyKZ7ml7s20iCWdsPpPu4YVaXuur/2M6WX8riReTE21vtPUAnn4iyTxdf0vJ+/QM0pwsUL4D5BmUBQEeXpaU4W6RtExzN1In7eT9qHPpIoUdqAzSrdyHIPo1JNRps1uioCWJyIm2U/JG8oO4aZMXozF8b4RupRd5JJv7Nn8ZeUyxjlrakhJHcwO2gHMUDgGLR0MmS0GrIoMRWos0K81LUnPZYgmkw6sM8HtCoQTaT9y0Wu3f/MZuCYfijhMPhUVQNdL2hY8kMroS/8UvEqqeSfC/xzPV07k3vsqyrL+2ykYnhJjEz45OLIdbu4ncrbrWhImzltU7oqqaXAEdMWiHxPsSdvuF70K6/xf6FejjL13YBvFVP+UXrkwnyelZjBcltoLypQIoEmsoiDUw4C2QFS/I/J6yx5ybWOOqaMad0kJlKo+ElAdLqvRTMqOsgucuM64j3hgHU1H1mIkQ084Oje3eXT1lZwL1nwaD0BZMNfFTcHpv+sf7v6LEo4oZMlRbFNqH9tb60nEN0UkQ0mYawZNpR878eFuD1lWsl/Jb9J5iMbPlDKnkh3raBmS66U1M9Jm5rKUmMel1dKLOcxrVSgf5dJqU4o0g0pJyTlV37x4bytpCATOG8VUT4+m9cPoURiakE34ZMes/wbB0Roun+2p7h9oLSlwzQqZq2eIr+xe2/Rhp5QF8hHn5Hh/FfM9ibs32UrNG+l22ZbrnJ8N+fERAcD6YCp6nuPc2Aq/vWXiMfzKaye/BDfzTLPwe33MT8ns4P/y0uiLBdyZw3qRvNvGZegjF6H+escXvreOnkD7zm7IkADTbJEkU4sdw1jmwzpTj42smHLB82ijenjfx9YsXkccR+B5+I1azGtQk+4maTpnLlsBL75E7O1IPea+mzfPmUwQt00FJoG+nPxN/zruZzZprTljyx2GpXiHdYWBZtcINeB+2xVP16/GT9euDwf00TbqgK5gK7QvCmfp/wPn15WDa3BcM1l/Hy8F9wZQ31nf4Q2IjjrXyG+BnzXnMmqXiTuB5CLa01gINjvb8mesSTwHuSAEtzm8anp+uvwbdprkfhUs0wCNIxH6TP1l/vf6aPDThK0TXI5I+tjj+SX/8wIcaPxWX4y+CqsCiEIiAIzhsKrgfh+6qv+4L4RETPl6/zqMKukki9AA96OseZb3Zk7UKVKxZKt65tpR1J9p1sTGgP5Z4ah+KEzl73R/xEfr+I8H5fchlN/Jr0n0c3fSGkrz+vbhd5m2ZWltThDeKUaKh3WTZXWauS+WomBdMkjGvOCRuT9YfcIZxk0x24/5cT3q8redxe8TpTsLn03b9LIaFo/I0eQ7uxtjQm6rffI4elnTcJfbwX/qRFyG+Vw+SaJdyFIpugk0WXCcnaZFo1323viNAWHZPvk1+ugfjTf2sbcPR5LDT442bhwPj6Z5z9qi9wr8B85Ji51yXb3tISxlpSUtaZEYnFX8ZbHI6C8vk4ll2h5/YdRQbM0CUbSmXHsd5rH5zWz7fBnc/5iA1NLANwyQZ2+5JjiYfQ4mle+BxJA1prT9g+770dv4zTz9RnTPp+JlY4DJKoroOucmyT4fnsGIeFC3H9EtmB+qnGyP6413tPvs4BhIwipskDKakeIg+KKTgbl92JBkkHn1J3c8t+9ia2vBKhMFkGBJtEjrGDIzKE1SeAgTJiDAVRYpKmSGwMlksJor5gUWgjKlXYS0gurS4neaYflXJnaWBUjDKNAVhkWoF1WhHz7uJ2PapE8NHJkulySPD62/qVmLapMq10a997JqvnphQarc8dO3UQ2smYr38pfOWszK6fTs+eBKfHy4j8t2uWNrWnbDx5CNfe+TkxrHVE/EEW4ynxM9H2FhtpAeE2tnGFUH1J4xXChxD5hACLNXbLgOA3WU353rI37Y44SipbwdxwED/mEC0rOmuIzmlGkw7SBzNxZ6NN3519+zXRhV1Uosp3TdtGD68s4eXJo8uzHVtjyXc85gC9MYmRh+euuaRk+vhAG43Tm3RLGW7Clp52Oesq3N7dKVjnW9KxCdWjyFvi/nUs+Ja5CnPxtn+2t4NnVwLrELw76JqDMz1MacMGJoR0I5RVsA1lR/DLEdonLJLQWnOMcSamKlrszLnWWZ3mzcVOjsrnYWynTfVNmQ6aQFxrWtL9SQtgjqsojbxf5lp+qquSF1rVGyk02qZZEEKRkPdlv9ff3LVQ6MTFMas8xSft3fNVbd+vqg1KaF5w7RwBsirUye24UVXDS3oIcj/nz+56mF6qQlUAQ++gGoNytcxFG7P98DWMXMoHIL/6l/Z7p1riv8ko2oiyiru129WsSrmUjO1XdtWc0Pr7miOoWOV9YUQ07WQPmsCisWYDge5puAUAI3NIk6EQACmaQ+BGRaAwOSemV1TH90+vnlDrZBNFOi/nEUlLL96lYx5VZLqB5zDQLFQzGm6KuUX89L6YqxRuaPsCwXYTlJE1EVJt9ycWTo8bereoW7Wv38ewfOzmgI/N42Kn53LatjTxUCv85zbEyg+Y5hTcDddq99M2ysc8/51lABfjZ++8KvSxvUlnpCj7U+mIG3vR8yhXSbXEbaB3cDmatdds4lrhi9Z8hskNo2hkI+RQHWN6fMIUwKGFZiNhDmCNq6BoR1gejCoTzNdD86woB6cPDh33YFr91w99dHJLePr1tp525NylKZkzJtthLplN+ADzhOxjpiN1trRPwb/vhKfqIcMg8Mr3DDqd38o4cM36y9KWa+Tsn7v4/ocj134Vcg2TZsf/ABFKH4tYwrtObZYYxoF3QiQC+PjATwUho5+W8MkQlOOqUDxnlMNjZpsfB8zjJCxZe2afKeTjXeuboqT2XcOlsACB6XROFhWch7AeNy/VsZfx4fO5Aj8EjTVRPjLdtrmTS1NX7Azce6kmjZnnHf+1iuBiG0duzsmQTiZPzfjEoTGAqZ7xqt/nmmai8gXOWb0/sG9z8vyyPNOZjKDf9DlRgmQR93keVlHOU/9RTkfH8W8ieTQzWpsc21DGRM0Xw4soAUWDEDPtMB0oS9I5qeXC0PhMySPyTWjuYFctn9JEgWLp6FSXdz71TeSgzuQBmnXVHPXGqWhIhXkF+H2lQXxVqiSO5OthN9CQQSazmBOhdycwSgoZRJvQ28Yz8SVltDiwd3PUxMLN9De1dWehinH5783RvA9xhpyoHgnWAfGvE3sqtqOFT25rGIoMB4GBa0NAaepg2KYyiwVijQqFKGtopEeUFFYgQCboj0jZ8cCk7U1Q2W3MBBLjMRi0SCKxO0od6gD6Muon6Q35JGLDZS9DEpfLNZTA4aqrmrD0rwHCAO8Cs/Ur4a3J0Lql9WU4RfBJiYySfg+cviqaczLvipt59LuhbjXflPdSuRLUUd/9VV422jRv6SF/NbehYrcQ1p2AZ6jd80L5+kSRwE3WV+OVGTs9GvnU6yLDbJsrZ2aE+iijskqPtuHgTAktgz0r+xtaUaslZRRH6FKlRJrBwO9bK+lef8YXipg7j8GSJjM+GRPmSApRv6n//T4VrH3qqbRaNxoqoxSNMfwD6MV18yPulftrX+xZ7gXeka7vMCPgf2aQ8+N4bPuaKz7lg2LIGjjTT3x4T4jvubPYKL+cFtPTxscwm0DA+yVNaMjbFNt/cE9k+sUpoxgas8Gu1qjhG7GqUu+oAFel8B2gTDcgt+54If2XXv1VVsmVvRkM4m4TnnrYCGLtt5foc4F2rWO/NrIbxENvBHUy0WJBYqEg8hbyklAxoATvupfHMCZ3wAHaASEAFz/Y7pUPh+ZumWK7z65G1KGftgMJro0NbIzrOvbm1sCuhL9tBGKtrof1aLaZkdRjS4zYhzSDTDVw4bldnrPGtubWgKGiH0adR1JuR9VI/qErSgB72HMk0emp2+anr6F7kfTydZ+zdKSO0EdDRuTqaip3xAIjapaLa1aWqg/kmqNQEiXzza3ZFbqId3euezR4Iiqbkj5j7ZEIeTX7X4n9vLvLmKL2mAXILVUp0WPoyLCVJVGQ+/yNlGhjP8PNLq4y9vNy9rPrn+eW36OaPmdX0nTF7EIpu9XPlvW1XMgOiHbSHIL1ji1nsbpBdbAyXtlTRwjSHuCqyJvkjfAVEiMe317oeLEURlNKa/CI7tfVLxLp5qb4tFwUFVYJ3R6/STHqy1Xi1R9RLvvd6lSPIba14rZoo6zwa3w/7L18OGzRwC+N7B52+HD2zYPfA8OP3iIH9kyjkd4Fdwj9x85skUPzfXhQd9cSN96mB+97yjgoYUXvZ7kxYu/UW7mL7Eo+rwKK9byTKWsSWWz6N8VBaZxB5ShgDJZHerscm0J6L1at2fNGPH4CqQNZ+gAGTeaPZVNBB52IJ7nt/uI3N/B0707Do+8vmEH37rpdTLX8eEDd47Xr564Y3aIj+67azM8Q4dwYHjpHbJoOu1/8OkH++lk4s59Y2Lo+tsevG1ukA/N3uHb9f9TbkFebNRET61I/GEuOEtdCkxKcdfISpPptmSn01kdVNF4Y4NjHF1rWnh0cxWZKImsJdKcKPPIkZR5RIoYkcJ7dh665dDOHqV/4jgc2ILXkYz77zgwypGsH1zKst/L+ir6nJVsPdtR2zaC4aQTZC9CR4p0jigDQ6gmexJcUeeXdbS0xY7WslzDdpPF8uryAPX0L+tqoVNFD5QrFi7rbKGXwYnkJGCpwra4XMZe1th6JZcOCL0VgV445HepqL+l5jVdKMHP1VeH89a/WtYaK2/9Z/g4noyFYduzjf6WpSS0FIKDRovrC4aaQ9ZArQ9b1r/K58P0Yhi/4Msl4WPhFbUuzCTBb1OitsjmCVsAn+Qs3eokTJ1FeEQlI1nGXNlfnbS8tcc/sYz4wU8vsbd+lr/UII5u7mncOYBJ+WKc+5jsETe/L03AXCfmN4IlTVnCOYiVSxyWr5h45up7d/Lpu568c7ey4zRcu6yjzk9P3Xvu3im5qb9yaf98ab2AwZIsy0Zrq6nXxkG22zi121ScGiC71IoiZwcZqlAmzUCmvaU5GgkkzaQfoNCjlKimWnxvGhtR5b4r0roYFX59BZLFsvVB5NMRIVAGQ65bJoBsRuaFbLJM/0n3nZCLlZaWYKj+efWy88WezKv+yiG5dKnN23mX2uUJbi5bY+Rc4XgxBrHXGnlYb637gwLPEuXVBmD1ViiIyzgRfl5f9NddvfoB9NDxw0clWD9KV0FbdhMMjzfc+H7uJXEG8fo6Ns4O1q5fU+KCCq16PhXG3JuJcczFw6GwEaLSBXkQwNwF4DgLs1AgHDqA2FToAXEgCDpj+jTudDaDgUmnGsaG9bWx1UOVctJGzBlDf2HJWgZyh1HHkeV53RK5WC6Gc8fr45AzKSByxwlWHShTsxydSgfVLhALUZsXOiS8w0TlVOdJ006bC4ZayA43j7cN9WCqeCgYDTvGJzKnKG0Jn7ou6KSC18Frs8FUk2Jch1frv65/kWLdMMbf2fWfDKac4HFdaYpb8HY9ZDXZhnEylEgHP7t2L6YMcO46M22b111HA113zoFBDJQUpy/WLx6B36K+MxQdmlHBKerm0BIJKqUu68GgoLY0VSpexdChJiDC1WpC9qwK1cQYpS7U0BW0JAzeMrX6P+hRI2Dy4z/hqqmb4gS3jG8GLT77P1Ue5E4wfOFTFoioAS8NYVYZhv9umJapaPV6hct6wHdkHiowcqVYnvUivt5Qa+3vK/X2dBXy2Uy6pclBE4pR4XkwxWHTtq93vH+tv0l2U6pFvbNRePWrv51uBFbBWmgHbw/upXv+0LnRc1AxL/RjLrVgmvx/yP0Fq1KJxarV2A+PHct2HDvWwbvxJIYX60/THfzHrcdGH7shQm/iC2l6E/fXRumtaPU/ybeyx+p34UkVL0LJv9PAUHOomzL1w8q9uZaYoV3SIOoujHBKKii60eKMxhJHXUMgTQW0InVqqErq22AbYN6BHOMkFCMtlpWLDDc/0NM23tYLZ1uGMX5ZrWfPtkQj+chQ61lZiH+gZSiai0Sbz4JhDbeswXd2PSVr8E/twqtr8KXdu690Q2KpI6jHMMuhBjdRdbG9iQslEae6YVhDV7gBdOiHgK4iKtSERkv4yOpAP8ZMpimmNqtSRuUFG50FDD2AeaYRNrasGS0P2LTwuGDncpRJNtZ5Fpev85SVhMY6T3ewBJrtjAFIs8XZi95eSXOXLJkW75wKaXmE7afkst1TsjBDJxP3v3I//kG6Z9R+ce7WnfcfrvHRo6fPnT46CpteTMJZ7yXKMb2XTlHieMpspgUYLz+k3UsJV/LFTWNH7vvT08eHlfWHHtx+69yLSbZMRhHWhDn2SG0oYCC3qE/B0qAKuZqPg+b5XkErlwWmYkKlMkNY2eLmUAqF3OJinmKjrPIhuK1/W/IJ6z8kh5K1D2aK+/UTWqOzkz1fC4xVOgKKKqgjZqKV9nhTGGOgUGnZjiK4Mq8jJFKOMwJ0UxSLdlO/Ymvrtq8H3/UG+nBNcG0e7Vh79xt/yOf37KklDMPYaeyc3LZ1y8hwT671KoP8BApooL9agOqYUm2FATeRptTcdeQGxexmC3pWyw2u5ZSr4l9xsLCKW+DaaeqxVskXZql+XdTggY9NDrcHk331MoTzqZSj3fGlCe3GxJQT6IsGjeBkQOGQO53v+VKSb9E1EVMQ5vKs2/R7axiimWAmiVCh4/MZ1eYrecvvMWx9oa71KppmNkVhBs6G6m+veHkw8amOFi0QFY4pTI7RrikRxSd1jgBaCeytDEHmYSsUN/HTEEyqQVQ6ppY4937ER/nPmMXaWK6W8TvQy1cj+s28wcIlS70LHqQsSoS5rB18abP70ubwv0VMqrRhJALnb2SJXZ76vg7pAPc9++oF2+s8XzLyZUMt/3ajhy35encPGy4n+lIy4Xvvou1JERMJFmTa8zqHldSwlaBa9k6VC63heDzM/3cYttfndDMiKlbIwCN7eV2F8FS61toUNZhCzHltUoKChwg/yah6WVnr8jIXJer+ultoizj14CWn/GfvvEU5uIjTdtnx8nw86K1TlzWF5QsXBhYXGlw+3rLk/5IB/G8+gzZuYUagPa8ByoUaWfiRIuA35I4CrJOMVariLtOCaKD+Ryq3gvWTwSDci1AAfVtQi7zzsmWE4F5Vq/+RPKDe8714vX5SVSVGuXjxa2K/iCyN42qyOkbLkXwt6FIjmt5sRsHC11VB2yANZQl1HL+GWjFC9Em4Vx7Q2oKTeB2+oKkeL3xEkBU015zWlri4VEBrpICIlwZ7Eso2mgSVKs8GLeJN5YsLnmn7Lh7/45KS6ncSg5I/Por8NcaWi7UW27Te2JeyTGPqPg3VS9j2CzJyeznjn1qaGXCrpsq8ro655n7+1zi3WwkBRkGuRl5e3eMyi6L0TvDJcnYwTnM14fWG5Xyh5nXVLya56BmNJRUi25oYoiGRJBGXdaO+Rb1Y9R861mlZYzodsf21K8/wZ1mC8I75Hr9viTsF+fsW5BzxTSO1IFQNz6DJvnC/lPv9L6Ab4KcvfJU6gC94y9NfMP31s7i5XY5RIn6LJqKRxjAKDuOVppiQA65ycUhaEvVeQya8dVuF6uCYKClVFADVGd5FyGt9RTWAAgg50ahiNFm2YkcCarHv3QTW/6Jna0TY0VA0FEpnMkbciKJ0RGSrrMN/XzzKfy7p3saOsq21cUl7FVQ2Dboqxg8D38S4hnxooL2bGRU1qurqAtP1Q1M7xzd3Sd4MKlx9aN7cxtWq/1OQAi25ohrK0s0ilVHwbgmKVNGWD1T/IMmcmd2u68h5MhPsLpW6Mf7ZEUPfceC+0zfhdXy9uTm5cQffujnZrMQFzmZdv+n0HyDOnl33Z4RjOcFoIL338N50IIpBxBEd9+2+7fV+vGGHQ5Y18NCTDw1EwkITYRu/JwZe9fPMI+IfxFUsyjbSqvKhAcwt168pdedsTBbTzZxTnRzRxQyV/if8uggP8y2VcpqWw7iyTmgJOy3GuEu5oK35P5xC0L6GZFag308hopD9/6r3KyoE7rKG5Tqi3D9z8s6TM/3+7mEeeCxiPDanxdWDjxmRxwKIeebmVFVePajGtTl5VaWLcGDdLdMVpbTvxD0n9pWUyvQtew1RfioQFOU/1vU/Lotg4KmyMEz9nnuM2OINTVu8ETPuuUeXPuNZUcFYEmd9rFRbYSxfVUjLiN9dFerqyvd2yKWFBEEB548Fup3m1PWnBQHUERnjyKYur0O1v1pBfvl30u2Hnj4EwydOw/CBOyd23vd4+YefpuUbvHb84elmO9HXD1P3Tq1f48YM5VZ17msH5/d1fPtmWQndeOwTd1EnZNeXbtwsoBRbcbJ29T3T0GbGDO+3J95aen6KxViWDVCHL8i5wsPAxPLfE1FDb55RmQnmCYgrEoijOyX+6KeDoE66Tt5ONjkSgheKBA9LqL6qpqchU0E7QaSYtJ3+irSVimrrmpLJU3ej0gsK6vTRXbdlEXtnb9u17Z9B+Un9m9Hg5rmoE93YF4zCPwZ31H9b/6f6b3cEgzvAgAIYO4IwfMe64Q03nOX3fXzD8Lo7brzrLtiCz85tCkajwb6N0b9LJD738MOfSxTs2x7mj3yGsEgjzzBYB9Xw2hGCYAZOzYWG2uR6nFlvxlJeEZfO732ziNsX84be4ffMGz7/gRmQb1dyTX8Q/dtArU8Hb8Wybmgod53NBlQOilxbg9mPCIstK3sTAzE7O5BMJuTKkvJgwfulBskXM0CBMymXLQrpkSoDMVmJ6aA2QjGG4SJkRk38g5sd61dtYGoQ4St+jHY+U23r4aVWOEjtseoMnDgvfwCEm2+hp6r/X91AK4zYkU3HMVEaxnR3qBfqPzn+/wHPnsOreJxjYGRgYABi1vIsoXh+m68M3MwvgCIMt5YoxkDp2P9f/2exVDAHAbkcDEwgUQAz1Qu/AHicY2BkYGAO+p/FwMBS9v/r/68sFQxAERQQDACh8QbyeJxdT0sVwzAMy49AkAxAkbT3UQiAITGAISmAYQiA9th4ttUs7Q568UeSlVidiwSkB3PUPg+ESd6ZD/+8v7HyrtzwghY89ZB6BcyrYqc6RZhw48YhaA1Wc/v1PQtdeXJ/HppUmFM597nvBVK7D+Z+E8/uQZLBgDyaz3Llvxx02S3c/Hv813JrznryZP4F+6lSfQAAAAAAAAAAUAC2ATABaAGyAfoCJAKwAzYDmgQSBFwExgUyBbQF/AZOBvwHRAe2B/YISgigCPIJGglCCWQJignACgAKQAp2CroLAAtGC4oL8gxcDPINng5iDuYPag/6EF4RIBGGEeQSShKYEyQTbhOyFAoUYhS+FVoVphYoFooXHBeGGFoYnhjGGOwZChlOGXgZrBneGhwaWhqgGtIbLhvyHHQc2B1QHZ4d/wABAAAAUwBtAAYAAAAAAAIAIAAwAHMAAAB2C3AAAAAAeJx1kN9q2zAUh39q0441YxcbjN3tXJWWEcc1lEGvWkLbXZeSu8JUV/6T2VKQlY48w95ifYa9zt6jd/vFESUUYiP5O5/O8ZEE4AP+QWH9nHKsWeEdozXv4A0uIu/Sf488IN9G3sMQPyLv0/+MfICv+BV5iI/4wz+owVtGM/yNrPBZfYm8g/fqW+Rd+svIA/Jd5D18UovI+/S/Ix9gqp4iD3GoniduvvR1WQU5mhxLlmap3C/FUdVWN6IXoXK+k3MpnA2maVySuza0ZlToUZ07292YctFov6k2eWp8VzsrJ0m6qa+NNV4H87Dq1j2WWQiFFN61chX7yNy7mclDUoUwPxuPN/tjAoc5lvCoUaJCgOCI9pjfDGk/BPfMEGaus2pYaDQ0GgtWVP1Kx/ico2BkaQ0zGnKCnHNL09KNuK451721rLqhLfmfht5vzdrmp7Sr3nUfC07YL92afU1r+wrd7/Dh5WwdHrmLjDawanUK3+9acPXqPML7Wq3NaHL6pL+1QHuGMd8t5/8PvPGO3QAAAHicbZLnlpswEIV9DRiwvZtseu89Ib333vvmBWRZYMVC0pHEEufpg8BO/kTncOfTaLgMOtPr97o17P1/baKPACEiDBAjQYohRhhjDevYhu3YwA7sxC7sxh7sxT7sxwEcxCEcxhEcxTEcxwmcxCmcxhmcxTmcxwVcxCVkuIwruIpruI4buIlbuI07uIt7uI8HeIhHeIwneIpneI4XeIlXeI03eIt3eI8P+IhP+Iwv+Ipv+I5N/OiF1hEz9JKxUrtFrDl1lWF9NR9QIikToRaVjUouKxvOmNBjLxnlhgo2DbnM1djLKrNGnGPScSUzItzGv93yPP2bSQSX84z9cqFQdJ56yZRmMhW8mLlJJSaBI0XYPDaZKDUviZmvr6DrNjJMi0WcK1MTM02mqpbZlJtEsNx5SI238jSodJtoS7qv+BpPw67IY9xU+dg5TXjROTWwdGrIOzWhT+uA0jolxqjaZrSOnCF2Nmq16651EYpMm1fakAul9SJQeR5QVYQlk1VkZ8SwoVNFIVjWnKQrlBGdMToftdoZjrs77DajqXKrS02YEFxbbtdWkG0x44JJVUS5aBqKSlJwmhDrmOF2Hv9Wqsy4TNqoKhfmSrrQKuNSL5nvPG6p0s0AkEWkSWVZMy1Kx3ljk03qLuZ14lTmB8gNGmByGrGfjLrhlhJV2f7SaIneNF1ypQNbybBUSgZswQaWEUNngeay1/sD4l/60HicY/DewXAiKGIjI2Nf5AbGnRwMHAzJBRsZWJ02MTAyaIEYm7mYGDkgLD4GMIvNaRfTAaA0J5DN7rSLwQHCZmZw2ajC2BEYscGhI2Ijc4rLRjUQbxdHAwMji0NHckgESEkkEGzmYWLk0drB+L91A0vvRiYGFwAMdiP0AAA=') format('woff')}</style>
<style id="style-core" type="text/css">html{font:16px/1 Helmet,Freesans,sans-serif}#store-area,tw-storydata{display:none!important;z-index:0}.no-transition{-webkit-transition:none!important;-o-transition:none!important;transition:none!important}:-webkit-full-screen{height:100%;width:100%}:-ms-fullscreen{height:100%;width:100%}:fullscreen{height:100%;width:100%}body::-ms-backdrop{background:0 0}:focus{outline:thin dotted}:disabled{cursor:not-allowed!important}body{color:#eee;background-color:#111;overflow:auto}a{cursor:pointer;color:#68d;text-decoration:none;-webkit-transition-duration:.2s;-o-transition-duration:.2s;transition-duration:.2s}a:hover{color:#8af;text-decoration:underline}a.link-broken{color:#c22}a.link-broken:hover{color:#e44}a[disabled],span.link-disabled{color:#aaa;cursor:not-allowed!important;text-decoration:none}area{cursor:pointer}button{cursor:pointer;color:#eee;background-color:#35a;border:1px solid #57c;line-height:normal;padding:.4em;-webkit-transition-duration:.2s;-o-transition-duration:.2s;transition-duration:.2s;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}button:hover{background-color:#57c;border-color:#79e}button:disabled{background-color:#444;border:1px solid #666}input,select,textarea{color:#eee;background-color:transparent;border:1px solid #444;padding:.4em}select{padding:.34em .4em}input[type=text]{min-width:18em}textarea{min-width:30em;resize:vertical}input[type=checkbox],input[type=file],input[type=radio],select{cursor:pointer}input[type=range]{-webkit-appearance:none;min-height:1.2em}input[type=range]:focus{outline:0}input[type=range]::-webkit-slider-runnable-track{background:#222;border:1px solid #444;border-radius:0;cursor:pointer;height:10px;width:100%}input[type=range]::-webkit-slider-thumb{-webkit-appearance:none;background:#35a;border:1px solid #57c;border-radius:0;cursor:pointer;height:18px;margin-top:-5px;width:33px}input[type=range]:focus::-webkit-slider-runnable-track{background:#222}input[type=range]::-moz-range-track{background:#222;border:1px solid #444;border-radius:0;cursor:pointer;height:10px;width:100%}input[type=range]::-moz-range-thumb{background:#35a;border:1px solid #57c;border-radius:0;cursor:pointer;height:18px;width:33px}input[type=range]::-ms-track{background:0 0;border-color:transparent;color:transparent;cursor:pointer;height:10px;width:calc(100% - 1px)}input[type=range]::-ms-fill-lower{background:#222;border:1px solid #444;border-radius:0}input[type=range]::-ms-fill-upper{background:#222;border:1px solid #444;border-radius:0}input[type=range]::-ms-thumb{background:#35a;border:1px solid #57c;border-radius:0;cursor:pointer;height:16px;width:33px}input:not(:disabled):focus,input:not(:disabled):hover,select:not(:disabled):focus,select:not(:disabled):hover,textarea:not(:disabled):focus,textarea:not(:disabled):hover{background-color:#333;border-color:#eee}hr{display:block;height:1px;border:none;border-top:1px solid #eee;margin:1em 0;padding:0}audio,canvas,progress,video{max-width:100%;vertical-align:middle}.error-view{background-color:#511;border-left:.5em solid #c22;display:inline-block;margin:.1em;max-width:100%;padding:0 .25em;position:relative}.error-view>.error-toggle{background-color:transparent;border:none;line-height:inherit;left:0;padding:0;position:absolute;top:0;width:1.75em}.error-view>.error{display:inline-block;margin-left:.25em}.error-view>.error-toggle+.error{margin-left:1.5em}.error-view>.error-source[hidden]{display:none}.error-view>.error-source:not([hidden]){background-color:rgba(0,0,0,.2);display:block;margin:0 0 .25em;overflow-x:auto;padding:.25em}.highlight,.marked{color:#ff0;font-weight:700;font-style:italic}.nobr{white-space:nowrap}.error-view>.error-toggle:before,.error-view>.error:before,[data-icon-after]:after,[data-icon-before]:before,[data-icon]:before,a.link-external:after{font-family:tme-fa-icons!important;font-style:normal;font-weight:900;font-variant:normal;line-height:1;speak:never;text-rendering:auto;text-transform:none;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}[data-icon]:before{content:attr(data-icon)}[data-icon-before]:before{content:attr(data-icon-before) "\00a0\00a0"}[data-icon-after]:after{content:"\00a0\00a0" attr(data-icon-after)}.error-view>.error-toggle:before{content:"\e81a"}.error-view>.error-toggle.enabled:before{content:"\e818"}.error-view>.error:before{content:"\e80d\00a0\00a0"}a.link-external:after{content:"\00a0\e80e"}</style>
<style id="style-core-display" type="text/css">#story{z-index:10;margin:2.5em}@media screen and (max-width:1136px){#story{margin-right:1.5em}}#passages{max-width:54em;margin:0 auto}</style>
<style id="style-core-passage" type="text/css">.passage{line-height:1.75;text-align:left;-webkit-transition:opacity .4s ease-in;-o-transition:opacity .4s ease-in;transition:opacity .4s ease-in}.passage-in{opacity:0}.passage ol,.passage ul{margin-left:.5em;padding-left:1.5em}.passage table{margin:1em 0;border-collapse:collapse;font-size:100%}.passage caption,.passage td,.passage th,.passage tr{padding:3px}@media (prefers-reduced-motion:reduce){.passage{-webkit-transition:opacity 0s;-o-transition:opacity 0s;transition:opacity 0s}}</style>
<style id="style-core-macro" type="text/css">@-webkit-keyframes cursor-blink{0%{opacity:1}50%{opacity:0}100%{opacity:1}}@-o-keyframes cursor-blink{0%{opacity:1}50%{opacity:0}100%{opacity:1}}@keyframes cursor-blink{0%{opacity:1}50%{opacity:0}100%{opacity:1}}.macro-append-insert,.macro-linkappend-insert,.macro-linkprepend-insert,.macro-linkreplace-insert,.macro-prepend-insert,.macro-repeat-insert,.macro-replace-insert,.macro-timed-insert{-webkit-transition:opacity .4s ease-in;-o-transition:opacity .4s ease-in;transition:opacity .4s ease-in}.macro-append-in,.macro-linkappend-in,.macro-linkprepend-in,.macro-linkreplace-in,.macro-prepend-in,.macro-repeat-in,.macro-replace-in,.macro-timed-in{opacity:0}.macro-type-cursor:after{-webkit-animation:cursor-blink 1s infinite;-o-animation:cursor-blink 1s infinite;animation:cursor-blink 1s infinite;content:"\2590";opacity:1}</style>
<style id="style-ui-dialog" type="text/css">html[data-dialog] body{overflow:hidden}#ui-overlay.open{visibility:visible;-webkit-transition:opacity .2s ease-in;-o-transition:opacity .2s ease-in;transition:opacity .2s ease-in}#ui-overlay:not(.open){-webkit-transition:visibility .2s step-end,opacity .2s ease-in;-o-transition:visibility .2s step-end,opacity .2s ease-in;transition:visibility .2s step-end,opacity .2s ease-in}#ui-overlay{visibility:hidden;opacity:0;z-index:100000;position:fixed;top:-50%;left:-50%;height:200%;width:200%}#ui-dialog.open{display:block;-webkit-transition:opacity .2s ease-in;-o-transition:opacity .2s ease-in;transition:opacity .2s ease-in}#ui-dialog{display:none;opacity:0;z-index:100100;position:fixed;top:50px;margin:0;padding:0}#ui-dialog>*{-webkit-box-sizing:border-box;box-sizing:border-box}#ui-dialog-titlebar{position:relative}#ui-dialog-close{display:block;position:absolute;right:0;top:0;white-space:nowrap}#ui-dialog-body{overflow:auto;min-width:280px;height:92%;height:calc(100% - 2.1em)}@media (prefers-reduced-motion:reduce){#ui-overlay.open{-webkit-transition:opacity 0s;-o-transition:opacity 0s;transition:opacity 0s}#ui-overlay:not(.open){-webkit-transition:opacity 0s;-o-transition:opacity 0s;transition:opacity 0s}#ui-dialog.open{-webkit-transition:opacity 0s;-o-transition:opacity 0s;transition:opacity 0s}}#ui-overlay{background-color:#000}#ui-overlay.open{opacity:.8}#ui-dialog{max-width:66em}#ui-dialog.open{opacity:1}#ui-dialog-titlebar{background-color:#444;min-height:24px}#ui-dialog-title{margin:0;padding:.2em 3.5em .2em .5em;font-size:1.5em;text-align:center;text-transform:uppercase}#ui-dialog-close{cursor:pointer;font-size:120%;margin:0;padding:0;width:3.6em;height:92%;background-color:transparent;border:1px solid transparent;-webkit-transition-duration:.2s;-o-transition-duration:.2s;transition-duration:.2s}#ui-dialog-close:hover{background-color:#b44;border-color:#d66}#ui-dialog-body{background-color:#111;border:1px solid #444;text-align:left;line-height:1.5;padding:1em}#ui-dialog-body>:first-child{margin-top:0}#ui-dialog-body hr{background-color:#444}#ui-dialog-body ul.buttons{margin:0;padding:0;list-style:none}#ui-dialog-body ul.buttons li{display:inline-block;margin:0;padding:.4em .4em 0 0}#ui-dialog-body ul.buttons>li+li>button{margin-left:1em}#ui-dialog-close{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}#ui-dialog-close{font-family:tme-fa-icons!important;font-style:normal;font-weight:900;font-variant:normal;line-height:1;speak:never;text-rendering:auto;text-transform:none;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}</style>
<style id="style-ui" type="text/css">#ui-dialog-body.settings [id|=setting-body]>div:first-child{display:table;width:100%}#ui-dialog-body.settings [id|=setting-label]{display:table-cell;padding:.4em 2em .4em 0}#ui-dialog-body.settings [id|=setting-label]+div{display:table-cell;min-width:8em;text-align:right;vertical-align:middle;white-space:nowrap}#ui-dialog-body.list{padding:0}#ui-dialog-body.list ul{margin:0;padding:0;list-style:none;border:1px solid transparent}#ui-dialog-body.list li{margin:0}#ui-dialog-body.list li:not(:first-child){border-top:1px solid #444}#ui-dialog-body.list li a{display:block;padding:.25em .75em;border:1px solid transparent;color:#eee;text-decoration:none}#ui-dialog-body.list li a:hover{background-color:#333;border-color:#eee}#ui-dialog-body.saves{padding:0 0 1px}#ui-dialog-body.saves>:not(:first-child){border-top:1px solid #444}#ui-dialog-body.saves table{border-spacing:0;width:100%}#ui-dialog-body.saves tr:not(:first-child){border-top:1px solid #444}#ui-dialog-body.saves td{padding:.33em .33em}#ui-dialog-body.saves td:first-child{min-width:1.5em;text-align:center}#ui-dialog-body.saves td:nth-child(3){line-height:1.2}#ui-dialog-body.saves td:last-child{text-align:right}#ui-dialog-body.saves .empty{color:#999;speak:none;text-align:center;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}#ui-dialog-body.saves .datestamp{font-size:75%;margin-left:1em}#ui-dialog-body.saves ul.buttons li{padding:.4em}#ui-dialog-body.saves ul.buttons>li+li>button{margin-left:.2em}#ui-dialog-body.saves ul.buttons li:last-child{float:right}#ui-dialog-body.settings div[id|=header-body]{margin:1em 0}#ui-dialog-body.settings div[id|=header-body]:first-child{margin-top:0}#ui-dialog-body.settings div[id|=header-body]:not(:first-child){border-top:1px solid #444;padding-top:1em}#ui-dialog-body.settings div[id|=header-body]>*{margin:0}#ui-dialog-body.settings h2[id|=header-heading]{font-size:1.375em}#ui-dialog-body.settings p[id|=header-desc],#ui-dialog-body.settings p[id|=setting-desc]{font-size:87.5%;margin:0 0 0 .5em}#ui-dialog-body.settings div[id|=setting-body]+div[id|=setting-body]{margin:1em 0}#ui-dialog-body.settings [id|=setting-control]{white-space:nowrap}#ui-dialog-body.settings button[id|=setting-control]{color:#eee;background-color:transparent;border:1px solid #444;padding:.4em}#ui-dialog-body.settings button[id|=setting-control]:hover{background-color:#333;border-color:#eee}#ui-dialog-body.settings button[id|=setting-control].enabled{background-color:#282;border-color:#4a4}#ui-dialog-body.settings button[id|=setting-control].enabled:hover{background-color:#4a4;border-color:#6c6}#ui-dialog-body.settings input[type=range][id|=setting-control]{max-width:35vw}#ui-dialog-body.list a,#ui-dialog-body.settings span[id|=setting-input]{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}#ui-dialog-body.saves button[id=saves-clear]:before,#ui-dialog-body.saves button[id=saves-export]:before,#ui-dialog-body.saves button[id=saves-import]:before,#ui-dialog-body.settings button[id|=setting-control].enabled:after,#ui-dialog-body.settings button[id|=setting-control]:after{font-family:tme-fa-icons!important;font-style:normal;font-weight:900;font-variant:normal;line-height:1;speak:never;text-rendering:auto;text-transform:none;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}#ui-dialog-body.saves button[id=saves-export]:before{content:"\e829\00a0"}#ui-dialog-body.saves button[id=saves-import]:before{content:"\e82a\00a0"}#ui-dialog-body.saves button[id=saves-clear]:before{content:"\e827\00a0"}#ui-dialog-body.settings button[id|=setting-control]:after{content:"\00a0\00a0\e830"}#ui-dialog-body.settings button[id|=setting-control].enabled:after{content:"\00a0\00a0\e831"}</style>
<style id="style-ui-bar" type="text/css">#story{margin-left:20em;-webkit-transition:margin-left .2s ease-in;-o-transition:margin-left .2s ease-in;transition:margin-left .2s ease-in}#ui-bar.stowed~#story{margin-left:4.5em}@media screen and (max-width:1136px){#story{margin-left:19em}#ui-bar.stowed~#story{margin-left:3.5em}}@media screen and (max-width:768px){#story{margin-left:3.5em}}#ui-bar{position:fixed;z-index:50;top:0;left:0;width:17.5em;height:100%;margin:0;padding:0;-webkit-transition:left .2s ease-in;-o-transition:left .2s ease-in;transition:left .2s ease-in}#ui-bar.stowed{left:-15.5em}#ui-bar-tray{position:absolute;top:.2em;left:0;right:0}#ui-bar-body{height:90%;height:calc(100% - 2.5em);margin:2.5em 0;padding:0 1.5em}#ui-bar.stowed #ui-bar-body,#ui-bar.stowed #ui-bar-history{visibility:hidden;-webkit-transition:visibility .2s step-end;-o-transition:visibility .2s step-end;transition:visibility .2s step-end}@media (prefers-reduced-motion:reduce){#story{-webkit-transition:margin-left 0s;-o-transition:margin-left 0s;transition:margin-left 0s}#ui-bar{-webkit-transition:left 0s;-o-transition:left 0s;transition:left 0s}}#ui-bar{background-color:#222;border-right:1px solid #444;text-align:center}#ui-bar a{text-decoration:none}#ui-bar hr{border-color:#444}#ui-bar-history [id|=history],#ui-bar-toggle{font-size:1.2em;line-height:inherit;color:#eee;background-color:transparent;border:1px solid #444}#ui-bar-toggle{display:block;position:absolute;top:0;right:0;border-right:none;padding:.3em .45em .25em}#ui-bar.stowed #ui-bar-toggle{padding:.3em .35em .25em .55em}#ui-bar-toggle:hover{background-color:#444;border-color:#eee}#ui-bar-history{margin:0 auto}#ui-bar-history [id|=history]{padding:.2em .45em .35em}#ui-bar-history #history-jumpto{padding:.2em .665em .35em}#ui-bar-history [id|=history]:not(:first-child){margin-left:1.2em}#ui-bar-history [id|=history]:hover{background-color:#444;border-color:#eee}#ui-bar-history [id|=history]:disabled{color:#444;background-color:transparent;border-color:#444}#ui-bar-body{line-height:1.5;overflow:auto}#ui-bar-body>:not(:first-child){margin-top:2em}#story-title{margin:0;font-size:162.5%}#story-author{margin-top:2em;font-weight:700}#menu ul{margin:1em 0 0;padding:0;list-style:none;border:1px solid #444}#menu ul:empty{display:none}#menu li{margin:0}#menu li:not(:first-child){border-top:1px solid #444}#menu li a{display:block;padding:.25em .75em;border:1px solid transparent;color:#eee;text-transform:uppercase}#menu li a:hover{background-color:#444;border-color:#eee}#menu a,#ui-bar-history [id|=history],#ui-bar-toggle{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}#menu-core li[id|=menu-item] a:before,#ui-bar-history [id|=history],#ui-bar-toggle:before{font-family:tme-fa-icons!important;font-style:normal;font-weight:900;font-variant:normal;line-height:1;speak:never;text-rendering:auto;text-transform:none;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}#ui-bar-toggle:before{content:"\e81d"}#ui-bar.stowed #ui-bar-toggle:before{content:"\e81e"}#menu-item-saves a:before{content:"\e82b\00a0"}#menu-item-settings a:before{content:"\e82d\00a0"}#menu-item-restart a:before{content:"\e82c\00a0"}#menu-item-share a:before{content:"\e82f\00a0"}</style>
<style id="style-ui-debug" type="text/css">#debug-bar{background-color:#222;border-left:1px solid #444;border-top:1px solid #444;bottom:0;margin:0;max-height:75%;padding:.5em;position:fixed;right:0;z-index:99900}#debug-bar>div:not([id])+div{margin-top:.5em}#debug-bar>div>label{margin-right:.5em}#debug-bar>div>input[type=text]{min-width:0;width:8em}#debug-bar>div>select{width:15em}#debug-bar-toggle{color:#eee;background-color:#222;border:1px solid #444;height:101%;height:calc(100% + 1px);left:-2em;left:calc(-2em - 1px);position:absolute;top:-1px;width:2em}#debug-bar-toggle:hover{background-color:#333;border-color:#eee}#debug-bar-hint{bottom:.175em;font-size:4.5em;opacity:.33;pointer-events:none;position:fixed;right:.6em;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;white-space:nowrap}#debug-bar-watch{background-color:#222;border-left:1px solid #444;border-top:1px solid #444;bottom:102%;bottom:calc(100% + 1px);font-size:.9em;left:-1px;max-height:650%;max-height:65vh;position:absolute;overflow-x:hidden;overflow-y:scroll;right:0;z-index:99800}#debug-bar-watch[hidden]{display:none}#debug-bar-watch div{color:#999;font-style:italic;margin:1em auto;text-align:center}#debug-bar-watch table{width:100%}#debug-bar-watch tr:nth-child(2n){background-color:rgba(127,127,127,.15)}#debug-bar-watch td{padding:.2em 0}#debug-bar-watch td:first-child+td{padding:.2em .3em .2em .1em}#debug-bar-watch .watch-delete{background-color:transparent;border:none;color:#c00}#debug-bar-watch-all,#debug-bar-watch-none{margin-left:.5em}#debug-bar-views-toggle,#debug-bar-watch-toggle{color:#eee;background-color:transparent;border:1px solid #444;margin-right:1em;padding:.4em}#debug-bar-views-toggle:hover,#debug-bar-watch-toggle:hover{background-color:#333;border-color:#eee}#debug-bar-watch:not([hidden])~div #debug-bar-watch-toggle,html[data-debug-view] #debug-bar-views-toggle{background-color:#282;border-color:#4a4}#debug-bar-watch:not([hidden])~div #debug-bar-watch-toggle:hover,html[data-debug-view] #debug-bar-views-toggle:hover{background-color:#4a4;border-color:#6c6}#debug-bar-hint:after,#debug-bar-toggle:before,#debug-bar-views-toggle:after,#debug-bar-watch .watch-delete:before,#debug-bar-watch-add:before,#debug-bar-watch-all:before,#debug-bar-watch-none:before,#debug-bar-watch-toggle:after{font-family:tme-fa-icons!important;font-style:normal;font-weight:900;font-variant:normal;line-height:1;speak:never;text-rendering:auto;text-transform:none;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}#debug-bar-toggle:before{content:"\e838"}#debug-bar-hint:after{content:"\e838\202f\e822"}#debug-bar-watch .watch-delete:before{content:"\e804"}#debug-bar-watch-add:before{content:"\e805"}#debug-bar-watch-all:before{content:"\e83a"}#debug-bar-watch-none:before{content:"\e827"}#debug-bar-views-toggle:after,#debug-bar-watch-toggle:after{content:"\00a0\00a0\e830"}#debug-bar-watch:not([hidden])~div #debug-bar-watch-toggle:after,html[data-debug-view] #debug-bar-views-toggle:after{content:"\00a0\00a0\e831"}html[data-debug-view] .debug{padding:.25em;background-color:#234}html[data-debug-view] .debug[title]{cursor:help}html[data-debug-view] .debug.block{display:inline-block;vertical-align:middle}html[data-debug-view] .debug.invalid{text-decoration:line-through}html[data-debug-view] .debug.hidden,html[data-debug-view] .debug.hidden .debug{background-color:#555}html:not([data-debug-view]) .debug.hidden{display:none}html[data-debug-view] .debug[data-name][data-type].nonvoid:after,html[data-debug-view] .debug[data-name][data-type]:before{background-color:rgba(0,0,0,.25);font-family:monospace,monospace;white-space:pre}html[data-debug-view] .debug[data-name][data-type]:before{content:attr(data-name)}html[data-debug-view] .debug[data-name][data-type|=macro]:before{content:"<<" attr(data-name) ">>"}html[data-debug-view] .debug[data-name][data-type|=macro].nonvoid:after{content:"<</" attr(data-name) ">>"}html[data-debug-view] .debug[data-name][data-type|=html]:before{content:"<" attr(data-name) ">"}html[data-debug-view] .debug[data-name][data-type|=html].nonvoid:after{content:"</" attr(data-name) ">"}html[data-debug-view] .debug[data-name][data-type]:not(:empty):before{margin-right:.25em}html[data-debug-view] .debug[data-name][data-type].nonvoid:not(:empty):after{margin-left:.25em}html[data-debug-view] .debug[data-name][data-type|=special],html[data-debug-view] .debug[data-name][data-type|=special]:before{display:block}</style>
</head>
<body>
	<div id="init-screen">
		<div id="init-no-js"><noscript>JavaScript must be enabled to play.</noscript></div>
		<div id="init-lacking"><p>Browser lacks capabilities required to play.</p><p>Upgrade or switch to another browser.</p></div>
		<div id="init-loading"><div>Loading&hellip;</div></div>
	</div>
	<tw-storydata name="未命名故事" startnode="1" creator="Twine" creator-version="2.8.1" format="SugarCube" format-version="2.36.1" ifid="00C6AC95-6977-4184-BEB4-95E61692DE5A" options="" tags="" zoom="1" hidden><style role="stylesheet" id="twine-user-stylesheet" type="text/twine-css">/* 进度条总设置 */
progress {
  	-webkit-appearance: none;  
           	-moz-appearance: none;  
          	appearance: none; 
  	border: none; 
 	height: 10px;    /* 进度条高度 */ 
	width: 150px;     /* 进度条宽度，用于细调，可删除 */ 
}

/* 进度条容器设置 */
progress::-webkit-progress-bar {  
	background-color: white;  /* 进度条容器背景色 */  
	border-radius: 0px;  /* 进度条容器圆角，0px就是方条 */   
	position: relative; 
	filter: drop-shadow(0 0 1px rgba(255, 215, 0, 0.8));   /* 进度条容器发光效果 */  
	border: 2px solid white; /* 进度条容器描边，建议描边跟背景色调一个颜色*/           
}

/* 进度条填充条设置 */  
progress::-webkit-progress-value {
	background-color: green;/* 进度条填充条背景色 */    
	border-radius: 0px; /* 进度条容器填充条，0px就是方条 */   
	border: none; /* 不给进度条填充条描边 */      
	overflow: hidden; /* 超出的部分隐藏起来 */  
	position: relative; 
        }  



/* 侧边栏的基本样式设置 */  
#ui-bar{  
    /* 侧边栏排版，这里是居中 */  
    text-align:center;  
    /* 侧边栏描边，冒号后分别是粗细 样式 颜色 */  
    border: 5px solid #f4eede;  
    /* 侧边栏四边的内边距 */  
    padding: 1px 1px 1px 1px;  
    /* 侧边栏最大宽度 */  
    max-width: 20em;  
    /* 侧边栏外边距，水平居中 */  
    margin: 0 auto;  
    /* 侧边栏内字体颜色 */  
    color:white;  
    /* 侧边栏背景色，带有透明度 */  
    background: rgba( 255, 255, 255, 0.25 );  
    /* 添加阴影效果，增强立体感 */  
    box-shadow: 0 8px 32px 0 rgba( 255, 255, 255, 0.37 );  
    /* 应用背景模糊效果，提升视觉效果 */  
    backdrop-filter: blur( 6px );  
    -webkit-backdrop-filter: blur( 6px ); /* 兼容性处理，针对旧版Safari */  
    /* 设置边框圆角 */    
    border: 1px solid rgba( 255, 255, 255, 0.18 );  
}   
  
/* 侧边栏收起时的样式 */  
#ui-bar-toggle{  
    /* 侧边栏收起时的最大宽度 */  
    max-width: 15em;  
    /* 侧边栏收起时的外边距，水平居中 */  
    margin: 0 auto;  
    /* 侧边栏收起时的字体颜色 */  
    color:#f4eede;  
}  
  
/* 侧边栏托盘中的按钮样式 */  
#ui-bar-tray button {  
    /* 透明背景 */  
    background-color:rgba(255, 255, 255, 0);  
    /* 透明边框 */  
    border-color:rgba(255, 255, 255, 0);  
    /* 字体颜色 */  
    color:#3CB371;  
    /* 边框圆角 */  
    border-radius:5px;  
}  
  
/* 侧边栏托盘中的按钮悬停效果 */  
#ui-bar-tray button:hover {  
    /* 悬停时保持透明背景 */  
    background-color:rgba(255, 255, 255, 0);  
    /* 悬停时保持透明边框 */  
    border-color:rgba(255, 255, 255, 0);  
    /* 悬停时字体颜色变黑色 */  
    color:black;  
    /* 边框圆角不变 */  
    border-radius:5px;  
}  




/* 字体发光 */
.faguang {
   text-shadow: #FC0000 1px 0 10px;
    }

/* 字体轻模糊 */
.mohu1 {
    text-shadow: rgb(255, 255, 255) 0em 0em 0.12em; 
    color: transparent;
    display: inline;
    }

/* 字体重模糊 */
.mohu2 {
    text-shadow: rgb(255, 255, 255) 0em 0em 0.2em; 
    color: transparent;
    display: inline;
    }

/* 字体左右震动 */
.zhendong{
          animation: rotate 0.3s ease infinite;
          display:inline-block;
      }
@keyframes rotate {
        0% { transform:translateX(0); }
        20% { transform:translateX(-2px); }
        60% { transform:translateX(2px); }
        80% { transform:translateX(-2px); }
        100% { transform:translateX(0); }
    }

/* 字体向左旋转90度，用来制作裂开效果 */
.xuanzhuan{
          animation: rotate 0.7s ease infinite;
          display:inline-block;
          animation-iteration-count:1;
          animation-fill-mode:forwards;
      }
@keyframes rotate {
        0% { transform:rotate(0); }
        20% { transform:rotate(20deg); }
        50% { transform:rotate(45deg); }
        80% { transform:rotate(65deg); }
        100% { transform:rotate(90deg); }
    }

/* 字体向右旋转90度，用来制作裂开效果 */
.xuanzhuan1{
          animation: rotate1 0.7s ease infinite;
          display:inline-block;
          animation-iteration-count:1;
          animation-fill-mode:forwards;
      }
@keyframes rotate1 {
        0% { transform:rotate(0); }
        20% { transform:rotate(-20deg); }
        50% { transform:rotate(-45deg); }
        80% { transform:rotate(-65deg); }
        100% { transform:rotate(-90deg); }
    }

</style><script role="script" id="twine-user-script" type="text/twine-javascript">/*这是返回用的*/
//關閉包包2.9版本
predisplay["Menu Return"] = function (taskName) {
	if (! tags().includes("noreturn")) {
		State.variables.return = passage();
	}
};
//錢

setup.AddMoney = function AddMoney (amount) {

	state.active.variables.money += amount;

	

	if (state.active.variables.money <= 0){

		state.active.variables.money = 0;

	}

}



//得到衣服



setup.GetClothes = function GetClothes (type) {

	let clothing = state.active.variables.clothes[type];



	if (clothing == null){

		return null;

	}



	return SugarCube.State.variables.items[clothing];

}



// 这与视频的工作方式非常相似，只是为了挑选



//根据需要使用短语。

setup.ChoosePhrase = function ChoosePhrase (options){

	let num = RandomInt(0, options.length - 1);

	let phrase = options[num];

	

	return phrase;

}



// 通过让链接的文本创建到其他区域的动态链接



//更改

setup.GoTo = function GoTo (label, location) {

	// <p>[[<<=setup.ChoosePhrase(_bad)>>|Bad Talk]]</p>

	let link = "<p>[[" + label + "|" + location + "]]</p>";

	

	return link;

}



setup.Pay = function Pay (itemNumber){

	let item = state.active.variables.items[itemNumber];

	

	if (item.cost <= state.active.variables.money){

		state.active.variables.money -= item.cost;

 

		state.active.variables.inventory[itemNumber] = true;

	}

}



//展示商店房间，方便购买衣服

setup.ShopItem = function ShopItem (itemNumber) {

	// 如果玩家已经拥有该物品，则该物品不会出现在商店中。

	if (state.active.variables.inventory[itemNumber]){

		return "";

	}

	

	let item = state.active.variables.items[itemNumber];

	

	// Check if they can afford the item

	if (state.active.variables.money >= item.cost){

		var canBuy = " [[买]]";

	} else {

		var canBuy = " 买";

	}

	

let result = '<div class="shop-item"><p onclick="SugarCube.setup.Pay(' + item.id + ')">' + item.description + item.cost + "钱" + canBuy + "</p></div>";

 

	return result;

}



setup.Equipped = function Equipped () {

	// 在它的原始状态下，如果mc没有胸罩，一个空的



//图像框会出现在它的位置。希望这能解决问题。

	if (SugarCube.setup.GetClothes("bra") == null) {

		var braImg = "";

	} else {

		var braImg = '<img style="width: 200px;" src="' + SugarCube.setup.GetClothes("bra").image + '"/>';

	}

	

return        '<div class="shop-item">' + SugarCube.setup.GetClothes("bottom").description + '</div>' + 
       '<div class="shop-item">' + SugarCube.setup.GetClothes("underwear").description + '</div>' + 
       '<div class="shop-item">' + SugarCube.setup.GetClothes("hand").description + '</div>' +
       '<div class="shop-item">' + SugarCube.setup.GetClothes("neck").description + '</div>' +
       '<div class="shop-item">' + SugarCube.setup.GetClothes("earring").description + '</div>' +
       '<div class="shop-item">' + SugarCube.setup.GetClothes("ankle").description + '</div>';

}



function IsWearing (currentItem){

	for (let item in state.active.variables.clothes){

		if (currentItem == state.active.variables.clothes[item]) {

			return true;

		}

	}

	

	return false;

}



setup.Wear = function Wear (itemNumber) {

	// 很多这样的var名称可能都是垃圾，但它们适用于



//暂时

	let item = state.active.variables.items[itemNumber];

	

	state.active.variables.clothes[item.type] = itemNumber.toString();

}



setup.Inventory = function Inventory () {

let inventory = "";





for (var item in state.active.variables.inventory) {

let currentItem = state.active.variables.items[item];

 

if (IsWearing(item) == false){



inventory += '<div class="package-item"><img style="width: 200px;" src="' + currentItem.image + '"/><p onclick="SugarCube.setup.Wear(' + currentItem.id + ')">' + currentItem.description + " [[取出|拿东西]]</p></div>";

}

}

	

	return inventory;

}</script><tw-tag name="widget" color="blue"></tw-tag><tw-tag name="noreturn" color="orange"></tw-tag><tw-tag name="header" color="green"></tw-tag><tw-tag name="PassageDone" color="purple"></tw-tag><tw-passagedata pid="1" name="开始" tags="" position="750,275" size="100,100">声明

这是一个传统剑与魔法的架空世界，传统且土失忆开局，传统且土乙女向文字游戏

==由于作者代码水平有限，背包装备系统目前还在画饼完全没用不必在意==，图裂也正常，剧情推进一般靠天数

有些地方虽然提供了选项，但并没有完善后续，我一般会在旁边说明，其余分歧只用看心情想选啥选啥

[[开始游戏]]


多次游玩且想跳过开局剧情请完成以下设置再进行跳转
你的名字是&lt;&lt;textbox &quot;$mc&quot; &quot;&quot;&gt;&gt;（这个暂时可以不写，剧情没提及）
抽取另一个名字:$jia
[[随机抽取]]

[[直达本次更新|入学2][$day = 9,$jiaoxuelou += 1,$weekDay = 2]]





[[代码测试]]
[[测试路径|学院卧室]]
[[测试路径2|开始炼药]]</tw-passagedata><tw-passagedata pid="2" name="开始游戏" tags="" position="750,475" size="100,100">你的眼前一片黑暗，身下柔软的触感包裹着你，你逐渐找回实感。

[[醒来][$energy -= 50,$month += 8]]

</tw-passagedata><tw-passagedata pid="3" name="醒来" tags="" position="625,475" size="100,100">“早上好。”一道柔和的声音彻底将你唤醒，你转头望去，被眼前的男性吸引了目光，如瀑的银发披散而下，两侧的长发缠绕着紫色缎带挽在脑后，他正坐在你的床前，手里拿着一张羊皮纸。

你对他没有任何印象。

[[早上好。]]
[[你是谁？]]</tw-passagedata><tw-passagedata pid="4" name="早上好。" tags="" position="500,375" size="100,100">“很高兴你能这么说...”他似乎还想说什么，但最终只是摇摇头，“倒是你睡了这么久，起床走走。”他向你伸出另一只手。


[[握住他的手]]
[[直接起床]]</tw-passagedata><tw-passagedata pid="5" name="你是谁？" tags="" position="500,500" size="100,100">“这个问题我先保留......”他微笑道，“倒是你睡了这么久，起床走走”。他向你伸出另一只手。


[[握住他的手]]
[[直接起床]] </tw-passagedata><tw-passagedata pid="6" name="握住他的手" tags="" position="325,475" size="100,100">你感受到一股暖流从交握的双手流向身体，你的精神好了些。&lt;font color=&quot;green&quot;&gt;+体力&lt;/font&gt;&lt;&lt;set $energy +=10&gt;&gt;
“希望这对你有所帮助。”神秘的男人朝你眨眨眼，确认你身体无恙后便松开你的手。

“那现在步入正题，”羊皮纸从他指尖脱离，在空中舒展最后漂浮在你们二人之间，你完全看不懂上面的文字，但隐隐约约从中感受到一种不可思议的力量笼罩着你，这让你有些不适。

“你还记得自己的名字吗。”


[[继续]]</tw-passagedata><tw-passagedata pid="7" name="直接起床" tags="" position="325,350" size="100,100">你没有理会他，径直下了床。他也没有恼，收回手继续好整以暇地看着你。

“那现在步入正题，”羊皮纸从他指尖脱离，在空中舒展最后漂浮在你们二人之间，你完全看不懂上面的文字，却能隐约从中感受到一种不可思议的力量笼罩着你，这让你有些不适。

“你还记得自己的名字吗。”


[[继续]]</tw-passagedata><tw-passagedata pid="8" name="继续" tags="" position="125,400" size="100,100">你下意识想回答却愣在原地，&lt;font color=&quot;#FF1493&quot;&gt;你发现自己对这具身体一无所知&lt;/font&gt;，冷意在你的脊骨窜动，你紧闭双眼试着拨开脑海中的迷雾，试图发掘有什么是历经毁灭仍执拗扎根在你的身体里的......

你似乎回忆起了————

&lt;font color=&quot;red&quot;&gt;你的名字是&lt;&lt;textbox &quot;$mc&quot; &quot;&quot;&gt;&gt;&lt;/font&gt;



[[继续|普通1]]</tw-passagedata><tw-passagedata pid="9" name="StoryInit" tags="" position="425,200" size="100,100">&lt;&lt;set $year = 1&gt;&gt;
&lt;&lt;set $month = 1&gt;&gt;
&lt;&lt;set $weekDay = 1&gt;&gt;
&lt;&lt;set $daysPassed = 0&gt;&gt;

&lt;&lt;set $Weather = &quot;&quot;&gt;&gt;
&lt;&lt;set $Season = &quot;&quot;&gt;&gt;
&lt;&lt;set $randomWeatherIndex = &quot;&quot;&gt;&gt;
&lt;&lt;set $currentWeather = &quot;晴天&quot;&gt;&gt;

&lt;&lt;set $state=0&gt;&gt; //状态
&lt;&lt;set $day =1&gt;&gt;//日
&lt;&lt;set $hour = 8&gt;&gt;//时
&lt;&lt;set $minute = 0&gt;&gt;//分
&lt;&lt;set $showMinute = 0&gt;&gt;

&lt;&lt;set $money to 500&gt;&gt;//钱
&lt;&lt;set $energy to 100&gt;&gt;//体力
&lt;&lt;set $energymax to 100&gt;&gt;//体力上限
&lt;&lt;set $yishi to 10&gt;&gt;//意识
&lt;&lt;set $Times = 1&gt;&gt;
&lt;&lt;set $mc = 1&gt;&gt;
&lt;&lt;set $jia = &quot;&quot;&gt;&gt;
&lt;&lt;set $fu = &quot;&quot;&gt;&gt;

//玩家属性
&lt;&lt;set $yaoli = 0&gt;&gt;
&lt;&lt;set $life = 100&gt;&gt;
&lt;&lt;set $body = 0&gt;&gt;
&lt;&lt;set $lie = 0&gt;&gt;
&lt;&lt;set $magic = 10&gt;&gt;
&lt;&lt;set $fly = 0&gt;&gt;
&lt;&lt;set $make = 0&gt;&gt;
&lt;&lt;set $int = 0&gt;&gt;
&lt;&lt;set $know = 0&gt;&gt;

/*剧情判定是否变量*/
&lt;&lt;set $shangpucishu = 0&gt;&gt;//进入商铺和交易的次数
&lt;&lt;set $machecishu = 0&gt;&gt;//与马车交互次数
&lt;&lt;set $jishecishu = 0&gt;&gt;//进入鸡舍次数
&lt;&lt;set $tianshu =0&gt;&gt;//游戏进行天数
&lt;&lt;set $senlin =0&gt;&gt;//森林
&lt;&lt;set $milu =0&gt;&gt;//初次进入森林选择次数
&lt;&lt;set $zhida =0&gt;&gt;//直达
&lt;&lt;set $jiaoxuelou = 0&gt;&gt;//首次入学

//数组
&lt;&lt;set $x = [0,1,2,3,4,5]&gt;&gt;

//个人剧情进入条件
&lt;&lt;set $buleidi = 0&gt;&gt;



&lt;&lt;set $clothes to {
   &quot;bottom&quot;: &quot;2&quot;,
	&quot;top&quot;: &quot;3&quot; ,
	&quot;underwear&quot;:1 ,
	&quot;hand&quot;:&quot;4&quot; ,
	&quot;ankle&quot;:&quot;50&quot; ,
	&quot;neck&quot;:&quot;90&quot; ,
	&quot;earring&quot;:&quot;70&quot; ,
	&quot;bra&quot;:null	
}&gt;&gt;
&lt;&lt;set $inventory to {
	1: true,
	2: true,
	3: true,
	4: true,
	70: true,
	90: true,
	50: true
	
}&gt;&gt;

&lt;&lt;set $items to {
  1 : {
	 &quot;id&quot; : &quot;1&quot;,
	 &quot;cost&quot; : 100,
	 &quot;type&quot; : &quot;neck&quot;,
     &quot;image&quot; : &quot;img/first/0.png&quot;,
	 &quot;description&quot; : &quot;水滴型吊坠&quot;,
	 &quot;attractiveness&quot; : 1
    },  
    
     2 : {
	 &quot;id&quot; : &quot;2&quot;,
	 &quot;cost&quot; : 100,
	 &quot;image&quot; : &quot;img/first/0.png&quot;,
	 &quot;type&quot; : &quot;bottom&quot;,
	 &quot;description&quot; : &quot;普通衣裙&quot;,
	 &quot;slutty&quot; : true,
	 &quot;attractiveness&quot; : 1
	 },
     
	3 : {
	 &quot;id&quot; : &quot;3&quot;,
	 &quot;cost&quot; : 200,
	 &quot;image&quot; : &quot;img/first/0.png&quot;,
	 &quot;type&quot; : &quot;top&quot;,
	 &quot;description&quot; : &quot;衣服3&quot;,
	 &quot;attractiveness&quot; : 2,
	 &quot;isXiao&quot; : true
	},
    
	4 : {
	 &quot;id&quot; : &quot;4&quot;,
	 &quot;cost&quot; : 50,
	 &quot;image&quot; : &quot;img/first/0.png&quot;,
	 &quot;type&quot; : &quot;hand&quot;,
	 &quot;description&quot; : &quot;占位&quot;,
	 &quot;attractiveness&quot; : 1 
	},
    
	5 : {
	 &quot;id&quot; : &quot;5&quot;,
	 &quot;cost&quot; : 250,
	 &quot;image&quot; : &quot;img/first/0.png&quot;,
	 &quot;type&quot; : &quot;top&quot;,
	 &quot;description&quot; : &quot;占位&quot;,
	 &quot;attractiveness&quot; : 1 ,
	 &quot;isDress&quot; : true
	},

	6 : {
	 &quot;id&quot; : &quot;6&quot;,
	 &quot;cost&quot; : 450,
	 &quot;image&quot; : &quot;img/first/0.png&quot;,
	 &quot;type&quot; : &quot;top&quot;,
	 &quot;description&quot; : &quot;占位&quot;,
	 &quot;attractiveness&quot; : 2,
	 &quot;ispron&quot; : true 
	},

	7 : {
	 &quot;id&quot; : &quot;7&quot;,
	 &quot;cost&quot; : 900,
	 &quot;image&quot; : &quot;img/first/0.png&quot;,
	 &quot;type&quot; : &quot;top&quot;,
	 &quot;description&quot; : &quot;占位&quot;,
	 &quot;attractiveness&quot; : 1
	},
    
	8 : {
	 &quot;id&quot; : &quot;8&quot;,
	 &quot;cost&quot; : 950,
	 &quot;image&quot; : &quot;img/first/0.png&quot;,
	 &quot;type&quot; : &quot;top&quot;,
	 &quot;description&quot; : &quot;占位 &quot;,
	 &quot;attractiveness&quot; : 2,
	 &quot;ispron&quot; : true 
	},

	9 : {
	 &quot;id&quot; : &quot;9&quot;,
	 &quot;cost&quot; : 1000,
	 &quot;image&quot; : &quot;img/first/0.png&quot;,
	 &quot;type&quot; : &quot;top&quot;,
	 &quot;description&quot; : &quot;占位&quot;,
	 &quot;ispron&quot; : true,
	 &quot;isduan&quot; : true 
	},
    
	11 : {
	 &quot;id&quot; : &quot;11&quot;,
	 &quot;cost&quot; : 500,
	 &quot;image&quot; : &quot;img/first/0.png&quot;,
	 &quot;type&quot; : &quot;hand&quot;,
	 &quot;description&quot; : &quot;草药&quot;,
	 &quot;attractiveness&quot; : 1,
	 &quot;isman&quot; : true
	},

	15 : {
	 &quot;id&quot; : &quot;15&quot;,
	 &quot;cost&quot; : 500,
	 &quot;image&quot; : &quot;img/first/0.png&quot;,
	 &quot;type&quot; : &quot;hand&quot;,
	 &quot;description&quot; : &quot;草药&quot;,
	 &quot;isxing&quot; : true
	},
    
	50 : {
	 &quot;id&quot; : &quot;50&quot;,
	 &quot;cost&quot; : 5,
	 &quot;image&quot; : &quot;img/first/0.png&quot;,
	 &quot;type&quot; : &quot;ankle&quot;,
	 &quot;description&quot; : &quot;占位&quot;
  	},
    
	70 : {
	 &quot;id&quot; : &quot;70&quot;,
	 &quot;cost&quot; : 50,
	 &quot;image&quot; : &quot;img/first/0.png&quot;,
	 &quot;type&quot; : &quot;earring&quot;,
	 &quot;description&quot; : &quot;占位&quot;  
	},
    
	90 : {
	 &quot;id&quot; : &quot;90&quot;,
	 &quot;cost&quot; : 50,
	 &quot;image&quot; : &quot;img/first/0.png&quot;,
	 &quot;type&quot; : &quot;neck&quot;,
	 &quot;description&quot; : &quot;占位&quot;	  
	},
    
}&gt;&gt;
&lt;&lt;include &quot;炼药变量&quot;&gt;&gt;
&lt;&lt;include &quot;药方列表&quot;&gt;&gt;
&lt;&lt;include &quot;战斗变量&quot;&gt;&gt;
&lt;&lt;include &quot;学校变量&quot;&gt;&gt;
&lt;&lt;include &quot;塞缪尔剧情变量&quot;&gt;&gt;</tw-passagedata><tw-passagedata pid="10" name="StoryCaption" tags="" position="325,200" size="100,100">&lt;&lt;nobr&gt;&gt;
&lt;&lt;timeWidget&gt;&gt;
&lt;&lt;if $state lte 0&gt;&gt;&lt;&lt;set $state = 0&gt;&gt;
	&lt;&lt;set $showstate = &quot;你十分清醒&quot;&gt;&gt;
&lt;&lt;elseif $state gte 5 and $state lt 10&gt;&gt;
	&lt;&lt;set $showstate = &quot;你感觉还行&quot;&gt;&gt;
&lt;&lt;elseif $state  gte 10 and $state lt 15&gt;&gt;
	&lt;&lt;set $showstate = &quot;你有点累了&quot;&gt;&gt;
&lt;&lt;elseif $state  gte 15 and $state lt 25&gt;&gt;
	&lt;&lt;set $showstate = &quot;你非常疲惫&quot;&gt;&gt;
&lt;&lt;elseif $state &gt;= 35&gt;&gt;
	&lt;&lt;set $showstate = &quot;你撑不住了&quot;&gt;&gt;
&lt;&lt;endif&gt;&gt;&lt;br&gt;
状态:$showstate&lt;br&gt;
体力&lt;progress min=&quot;0&quot; max=&quot;100&quot; @value=&quot;$energy&quot;&gt;&lt;/progress&gt;&lt;br&gt;
意识&lt;progress min=&quot;0&quot; max=&quot;10&quot; @value=&quot;$yishi&quot;&gt;&lt;/progress&gt;&lt;br&gt;
金钱:$money&lt;br&gt;
&lt;&lt;if $rouren gte 1 &gt;&gt;柔韧:$rouren&lt;br&gt;&lt;&lt;/if&gt;&gt;
学识:$know&lt;br&gt;
思维:$int&lt;br&gt;
力量:$body&lt;br&gt;
敏捷:$fly&lt;br&gt;
诡计:$lie&lt;br&gt;
护理:$make&lt;br&gt;
术法:$magic
&lt;&lt;/nobr&gt;&gt;</tw-passagedata><tw-passagedata pid="11" name="StoryMenu" tags="" position="525,200" size="100,100">[[状态|經驗]]

[[等待|等待改变时间]]

[[背包]]

[[返回|$return]]</tw-passagedata><tw-passagedata pid="12" name="时间变化" tags="widget" position="900,25" size="100,100">
&lt;&lt;widget &quot;timeWidget&quot;&gt;&gt;
&lt;&lt;nobr&gt;&gt;
&lt;&lt;set $weekDay = ($day % 7) + 4&gt;&gt;
&lt;&lt;if $weekDay &gt; 7&gt;&gt;
	&lt;&lt;set $weekDay -= 7&gt;&gt;
&lt;&lt;endif&gt;&gt;
&lt;&lt;switch $weekDay&gt;&gt;
	&lt;&lt;case 1&gt;&gt;&lt;strong&gt;&lt;font color=&quot;yellow&quot;&gt;周 一&lt;/font&gt;&lt;/strong&gt;
	&lt;&lt;case 2&gt;&gt;&lt;strong&gt;&lt;font color=&quot;yellow&quot;&gt;周 二&lt;/font&gt;&lt;/strong&gt;
	&lt;&lt;case 3&gt;&gt;&lt;strong&gt;&lt;font color=&quot;yellow&quot;&gt;周 三&lt;/font&gt;&lt;/strong&gt;
	&lt;&lt;case 4&gt;&gt;&lt;strong&gt;&lt;font color=&quot;yellow&quot;&gt;周 四&lt;/font&gt;&lt;/strong&gt;
	&lt;&lt;case 5&gt;&gt;&lt;strong&gt;&lt;font color=&quot;yellow&quot;&gt;周 五&lt;/font&gt;&lt;/strong&gt;
	&lt;&lt;case 6&gt;&gt;&lt;strong&gt;&lt;font color=&quot;yellow&quot;&gt;周 六&lt;/font&gt;&lt;/strong&gt;
	&lt;&lt;case 7&gt;&gt;&lt;strong&gt;&lt;font color=&quot;yellow&quot;&gt;周 日&lt;/font&gt;&lt;/strong&gt;
&lt;&lt;endswitch&gt;&gt;
&lt;&lt;if $minute &gt;= 60&gt;&gt;
    &lt;&lt;set $minute = $minute - 60&gt;&gt;
    &lt;&lt;set $hour += 1&gt;&gt;
    &lt;&lt;/if&gt;&gt;
    &lt;&lt;if $hour &gt;= 24&gt;&gt;
    &lt;&lt;set $hour = $hour - 24&gt;&gt;
        &lt;&lt;set $day += 1&gt;&gt;
        &lt;&lt;set $daysPassed += 1&gt;&gt;
        &lt;&lt;set $zt to &quot;faulse&quot;&gt;&gt;&lt;&lt;set $cd to &quot;faulse&quot;&gt;&gt;
    &lt;&lt;/if&gt;&gt;


&lt;&lt;if $day &gt; 30&gt;&gt;
    &lt;&lt;if $month is 4 or $month is 6 or $month is 9 or $month is 11&gt;&gt;
        &lt;&lt;set $day = 1&gt;&gt;
        &lt;&lt;set $month += 1&gt;&gt;
    &lt;&lt;/if&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $day &gt; 31&gt;&gt;
    &lt;&lt;if $month is 1 or $month is 3 or $month is 5 or $month is 7 or $month is 8 or $month is 10&gt;&gt;
        &lt;&lt;set $day = 1&gt;&gt;
        &lt;&lt;set $month += 1&gt;&gt;
    &lt;&lt;/if&gt;&gt;
    &lt;&lt;if $month is 12&gt;&gt;
        &lt;&lt;set $day = 1&gt;&gt;
        &lt;&lt;set $month = 1&gt;&gt;
        &lt;&lt;set $year += 1&gt;&gt;
    &lt;&lt;/if&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $day &gt; 28&gt;&gt;
    &lt;&lt;if $month is 2&gt;&gt;
        &lt;&lt;if ($year % 4 is 0 and $year % 100 is not 0) or ($year % 400 is 0)&gt;&gt;
            &lt;&lt;if $day &gt; 29&gt;&gt;
                &lt;&lt;set $day = 1&gt;&gt;
                &lt;&lt;set $month += 1&gt;&gt;
            &lt;&lt;/if&gt;&gt;
        &lt;&lt;else&gt;&gt;
            &lt;&lt;set $day = 1&gt;&gt;
            &lt;&lt;set $month += 1&gt;&gt;
        &lt;&lt;/if&gt;&gt;
    &lt;&lt;/if&gt;&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;set $formattedMinute = $minute&gt;&gt;
&lt;&lt;if $minute &lt; 10&gt;&gt;
    &lt;&lt;set $formattedMinute = &quot;0&quot; + $minute&gt;&gt;
&lt;&lt;endif&gt;&gt;

&lt;!-- 处理季节的情况 --&gt;
&lt;&lt;if $month is 1 || $month is 2 || $month is 3&gt;&gt;
 &lt;&lt;set $Season = &quot;春季&quot;&gt;&gt;
&lt;&lt;elseif $month is 4 || $month is 5 || $month is 6&gt;&gt;
&lt;&lt;set $Season = &quot;夏季&quot;&gt;&gt;
&lt;&lt;elseif $month is 7 || $month is 8 || $month is 9&gt;&gt;
&lt;&lt;set $Season = &quot;秋季&quot;&gt;&gt;
&lt;&lt;elseif $month is 10 || $month is 11|| $month is 12&gt;&gt;
&lt;&lt;set $Season = &quot;冬季&quot;&gt;&gt;
&lt;&lt;/if&gt;&gt; 

&lt;!-- 处理天气的情况 --&gt;

&lt;&lt;if $month &lt;= 3&gt;&gt; 
    &lt;!-- 春季：1月、2月、3月 --&gt;
    &lt;&lt;set $Weather = [&quot;晴天&quot;, &quot;多云&quot;, &quot;阴天&quot;, &quot;小雨&quot;, &quot;大雨&quot;, &quot;浓雾&quot;, &quot;薄雾&quot;]&gt;&gt;
&lt;&lt;elseif $month &lt;= 6&gt;&gt; 
    &lt;!-- 夏季：4月、5月、6月 --&gt;
    &lt;&lt;set $Weather = [&quot;晴天&quot;, &quot;多云&quot;, &quot;阴天&quot;, &quot;小雨&quot;, &quot;大雨&quot;, &quot;暴雨&quot;]&gt;&gt;
&lt;&lt;elseif $month &lt;= 9&gt;&gt; 
    &lt;!-- 秋季：7月、8月、9月 --&gt;
    &lt;&lt;set $Weather = [&quot;晴天&quot;, &quot;多云&quot;, &quot;阴天&quot;, &quot;小雨&quot;, &quot;大雨&quot;, &quot;浓雾&quot;, &quot;薄雾&quot;]&gt;&gt;
&lt;&lt;elseif $month &lt;= 12&gt;&gt; 
    &lt;!-- 冬季：10月、11月、12月 --&gt;
    &lt;&lt;set $Weather = [&quot;晴天&quot;, &quot;多云&quot;, &quot;阴天&quot;, &quot;小雪&quot;, &quot;大雪&quot;, &quot;暴雪&quot;]&gt;&gt;
&lt;&lt;/if&gt;&gt;

&lt;!-- 随机选择天气 --&gt;
&lt;&lt;if $daysPassed == 3&gt;&gt;
&lt;&lt;set $randomNumber to random(100)&gt;&gt;
    &lt;&lt;if $randomNumber &lt; 35&gt;&gt;
    &lt;&lt;set $currentWeather = &quot;晴天&quot;&gt;&gt;
    &lt;&lt;else&gt;&gt;
&lt;&lt;set $randomWeatherIndex = random(0, $Weather.length - 1)&gt;&gt;
&lt;&lt;set $currentWeather = $Weather[$randomWeatherIndex]&gt;&gt;
     &lt;&lt;/if&gt;&gt;
&lt;&lt;set $daysPassed = 0&gt;&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;print $Season&gt;&gt;
&lt;&lt;/nobr&gt;&gt;

&lt;&lt;nobr&gt;&gt;&lt;strong&gt;&lt;font color=&quot;sky blue&quot;&gt;今天的天气是：&lt;&lt;print $currentWeather&gt;&gt;&lt;/font&gt;&lt;/strong&gt;&lt;&lt;/nobr&gt;&gt;
第$year 年 $month 月 $day 日
时间：$hour:$formattedMinute
&lt;&lt;/widget&gt;&gt;</tw-passagedata><tw-passagedata pid="13" name="經驗" tags="noreturn" position="400,25" size="100,100">&lt;&lt;life&gt;&gt;

生命:$showlife
力量:$showbody
诡计:$showlie
术法:$showmagic
敏捷:$showfast
护理:$showmake

[[返回|$return]]</tw-passagedata><tw-passagedata pid="14" name="等待改变时间" tags="noreturn" position="525,25" size="100,100">[[休息半小时|$return][$minute+=30]]
[[休息1個小时|$return][$hour+=1]]
[[休息6個小时|$return][$hour+=6]]
[[休息一天|$return][$day+=1,$daysPassed += 1]]

[[返回|$return]]</tw-passagedata><tw-passagedata pid="15" name="noreturn" tags="noreturn" position="675,25" size="100,100"></tw-passagedata><tw-passagedata pid="16" name="普通1" tags="" position="125,525" size="100,100">你的名字是&lt;font color=&quot;red&quot;&gt;&lt;i&gt;$mc&lt;/i&gt;&lt;/font&gt;。

毫无疑问，你确认这个是自己的名字。

当你即将脱口而出之时，男人用食指轻抵在你的唇上。

“这是我给你的第一个忠告，也是最后一个，”他说，&lt;strong&gt;&lt;font color=&quot;red&quot;&gt;“不要告诉任何人你的真名。”&lt;/font&gt;&lt;/strong&gt;他捻了捻指尖，羊皮纸开始泛光，”......但你仍需一个名字去支付代价。“

&lt;&lt;set $randomNumber to random(5)&gt;&gt;&lt;&lt;if $randomNumber is 0&gt;&gt;&lt;&lt;set $jia = &quot;夏洛特&quot;&gt;&gt;“夏洛特。”&lt;&lt;elseif $randomNumber is 1&gt;&gt;&lt;&lt;set $jia = &quot;索菲娅&quot;&gt;&gt;“索菲娅。”&lt;&lt;elseif $randomNumber is 2&gt;&gt;&lt;&lt;set $jia = &quot;伊芙琳&quot;&gt;&gt;”伊芙琳。“&lt;&lt;elseif $randomNumber is 3&gt;&gt;&lt;&lt;set $jia = &quot;格蕾丝&quot;&gt;&gt;”格蕾丝。“&lt;&lt;elseif $randomNumber is 4&gt;&gt;&lt;&lt;set $jia = &quot;伊莎贝尔&quot;&gt;&gt;”伊莎贝尔。“&lt;&lt;elseif $randomNumber is 5&gt;&gt;&lt;&lt;set $jia = &quot;莉莉&quot;&gt;&gt;”莉莉。“&lt;&lt;/if&gt;&gt;

“如何？”

你不太清楚他的意思，你理解为你可能还是需要一个代号便于活动。


[[换一个]]
[[就这个吧]]</tw-passagedata><tw-passagedata pid="17" name="未命名片段 1" tags="widget" position="775,25" size="100,100">&lt;&lt;nobr&gt;&gt;
&lt;&lt;set $energy = Math.max(0, Math.min($energy, 100))&gt;&gt; // 能量值
&lt;&lt;set $max_energy = 100&gt;&gt;
&lt;&lt;set $bili_energy=($energy/$max_energy)*100&gt;&gt;
&lt;&lt;set $bili_energy=&quot;width:&quot;+$bili_energy+&quot;%&quot;&gt;&gt;

&lt;div id=&quot;energy&quot; class=&quot;sideframe_showstats&quot;&gt;
&lt;div id=&quot;energy1&quot; class=&quot;container_stat&quot;&gt;
&lt;div id=&quot;energy2&quot; class=&quot;bar_stat_blue&quot; @style=&quot;$bili_energy&quot;&gt;&lt;/div&gt;
&lt;div id=&quot;energy3&quot; class=&quot;bar_stat_text&quot;&gt;$energy/$max_energy&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;&lt;/nobr&gt;&gt;</tw-passagedata><tw-passagedata pid="18" name="就这个吧" tags="" position="75,650" size="100,100">&lt;&lt;type 50ms&gt;&gt;在你话语落下的瞬间，一束极强的光芒从纸上炸开，你不得不眯上眼睛，耳边弥漫起朦胧的呓语，或祈祷，或颂诗，你仿佛看到无数人披着白袍衣角翻飞，一层又一层，直到金色的绣线连绵成片，如同水流一般铺满所有石阶，你似乎也融入了其中，归于白色浪潮，归于漫无边际的安宁之中。

&lt;center&gt;&lt;strong&gt;&lt;font color=&quot;yellow&quot;&gt;&quot;$jia，契约成立。&quot;&lt;/font&gt;&lt;/strong&gt;&lt;/center&gt;&lt;&lt;/type&gt;&gt;

&lt;&lt;timed 8s t8n&gt;&gt;纸张变得透明，直至消失，你的意识也逐渐回拢，不经意和他对上眼神才发觉男人的目光似乎一直在你身上。

你来不及对突如其来的一切做出合适的反应，他便向你走来绕到身后，你没有对他的贴近感到不适，反而有被某种淡薄香味包裹的感觉。”你可以把这个当作一份礼物，“你脖子一凉，下意识伸手摸向前胸，是一串项链，他轻笑道，“用我们法师喜欢的说法，叫做命运的馈赠。”

而后他突然停留在了你的耳畔，你能感受到气流拂过你的发丝，”......它可以保护你，但不是永远。“

留下这句话后他便立即抽身走向房门，没等你追问就离开了，你追到门口四下张望，明明他前脚出门你后脚就跟上了，如此也找不到一点他的痕迹，仿佛他从未来过。

你检查了这条颈链，它并不显眼，自称法师的人将它送给你时似乎有很多复杂的情绪，上面有一颗透明的水滴型宝石，现在是晶莹的&lt;font color=&quot;blue&quot;&gt;蓝色&lt;/font&gt;。&lt;font color=&quot;green&quot;&gt;+体力&lt;/font&gt;&lt;&lt;set $energy +=10&gt;&gt;

不管怎么说，当务之急是先弄清楚自己的处境。&lt;&lt;/timed&gt;&gt;



[[返回房间]]
[[出去走走]]</tw-passagedata><tw-passagedata pid="19" name="换一个" tags="" position="225,650" size="100,100">”那......“

&lt;&lt;set $randomNumber to random(5)&gt;&gt;&lt;&lt;if $randomNumber is 0&gt;&gt;&lt;&lt;set $jia = &quot;夏洛特&quot;&gt;&gt;“夏洛特。”&lt;&lt;elseif $randomNumber is 1&gt;&gt;&lt;&lt;set $jia = &quot;索菲娅&quot;&gt;&gt;“索菲娅。”&lt;&lt;elseif $randomNumber is 2&gt;&gt;&lt;&lt;set $jia = &quot;伊芙琳&quot;&gt;&gt;”伊芙琳。“&lt;&lt;elseif $randomNumber is 3&gt;&gt;&lt;&lt;set $jia = &quot;格蕾丝&quot;&gt;&gt;”格蕾丝。“&lt;&lt;elseif $randomNumber is 4&gt;&gt;&lt;&lt;set $jia = &quot;伊莎贝尔&quot;&gt;&gt;”伊莎贝尔。“&lt;&lt;elseif $randomNumber is 5&gt;&gt;&lt;&lt;set $jia = &quot;莉莉&quot;&gt;&gt;”莉莉。“&lt;&lt;/if&gt;&gt;

&quot;如何？&quot;


[[换一个]]
[[就这个吧]]</tw-passagedata><tw-passagedata pid="20" name="出去走走" tags="" position="75,775" size="100,100">天气凉爽正处于秋天，你置身于一个村庄，你看见金色的麦草在零星几个门前堆放，现在是早晨，几个经过的孩童好奇地回头看你。

”嗨，小姑娘,“一个挎着篮子的中年女性向你打招呼，”女神保佑，几天没见你出门了，我都以为你出意外了。“她惊奇地看着你。”我是你的邻居，“你顺着她手指的地方望去，越过你的小屋旁那几块长满杂草的荒地后，你看到几栋挨着的房屋。

”很少有新的年轻人来我们这个没落的村庄了，“她啧啧称奇，眼神从上到下打量着你，”我叫凯蒂，你叫什么名字？“




[[假名]]
[[真名]]&lt;font color=&quot;red&quot;&gt;|慎重选择&lt;/font&gt;（后续未完，别选）</tw-passagedata><tw-passagedata pid="21" name="返回房间" tags="" position="250,900" size="100,100">你环顾这个小房间，虽然有些简陋但该有的都有，你用手晃了晃这些木头玩意儿，还算牢固。

你的所有家具都是木制的，床铺很柔软。


[[衣柜]]
[[镜子]]
[[床铺]]
[[桌子]]
[[厨房]]



[[出门|村庄]]</tw-passagedata><tw-passagedata pid="22" name="假名" tags="" position="125,900" size="100,100">在你说出名字的瞬间，你感觉空气凝滞了，但眨眼间便恢复正常，仿佛刚刚只是错觉。

”不错的名字，“凯蒂友好地称赞，”无论如何，欢迎你来到艾登瑟村。“

你和她开始攀谈。




[[问她关于你的印象]]
[[问她关于法师的印象|问法师]]
[[你没有什么想问的|没有了]]</tw-passagedata><tw-passagedata pid="23" name="真名" tags="" position="0,900" size="100,100">在你说出名字的瞬间，你感觉空气凝滞了，但眨眼间便恢复正常，仿佛刚刚只是错觉。

”不错的名字，“凯蒂友好地称赞，”无论如何，欢迎你来到艾登瑟村。“

你和她开始攀谈。



[[问她关于你的印象]]
[[问她关于法师的印象|问法师]]
[[你没有什么想问的|没有了]]</tw-passagedata><tw-passagedata pid="24" name="问法师" tags="" position="125,1025" size="100,100">你向她大致描述了法师的外貌。

”银发......？“凯蒂捏着她的围裙思索着，然后很自信地说，”如果按你所说，那他应该很显眼，可惜我没见过，如果你问村里其他人那也是这个回答。“

她捂嘴笑道，”我可是这村里最活络的老婆子。“


[[问她关于你的印象]]
[[没有了]]</tw-passagedata><tw-passagedata pid="25" name="马车开始" tags="" position="250,1525" size="100,100">你靠近了这匹枣红色的马，它朝你鼻子喷气，似乎不想你靠近。但从它的毛发上来看，它过得不错

你没看到有人在这附近，也许现在不是时候。


[[离开|村庄][$machecishu +=1]]</tw-passagedata><tw-passagedata pid="26" name="湖泊" tags="" position="250,1825" size="100,100">你来到了湖泊，你很惊奇一个小小的村庄竟然有这么大的湖泊，如果不是丰富的植被环绕，这会宽广到让你以为是海岸线，你垫起脚试图找到对岸，但你失败了。

你还在这发现了许多弃置的渔具，你用鞋给一串蟹笼挨个翻面，不一例外都破了好几个洞，草丛深处有几条木船，要么伤痕累累要么已经破烂不堪，你观察木头的断面，比起自然腐朽或者外力拗断，这更像是被啃食造成的，但啮齿动物绝对留不下这么凄惨的齿痕，你打了个哆嗦。

虽然是秋天，但这里的草丛依旧绿意盎然而且很深，也许你可以在这里探索，找到一些有用的东西。


[[探索湖泊][$minute += 30]](30min)
[[离开|村庄]]

</tw-passagedata><tw-passagedata pid="27" name="问她关于你的印象" tags="" position="0,1025" size="100,100">你询问她对于你何时到来是否有印象。

“一周前......还是前天，”凯蒂似乎有些记不清了，眼神有些疑惑，但很快她就从中脱出，“我记得在最近了，刚好那天也开始起雾。”





[[问她关于法师的印象|问法师]]
[[你没有什么想问的|没有了]]</tw-passagedata><tw-passagedata pid="28" name="探索湖泊" tags="" position="250,1925" size="100,100">你往前走了一段路钻入草丛之间，你发现了一些看起来有用的植物，但你不知道这是什么，也不知道有什么用。

暂且放进背包里吧。

（此处可循环，随机事件未时装）

[[继续探索|探索湖泊][$minute += 30,$energy -= 10, $weizhi += 1]](30min)
[[回到湖泊|湖泊]]
</tw-passagedata><tw-passagedata pid="29" name="没有了" tags="" position="50,1200" size="100,100">“我也有事要去忙活了，”凯蒂挥了挥手，“有空来我的鸡舍看看吧。”





[[返回房间]]
[[村庄]]</tw-passagedata><tw-passagedata pid="30" name="村庄" tags="" position="250,1325" size="100,100">你走在村里的小道上，这里活跃的不到百户人，迷雾笼罩着，只有稀薄的阳光投下来。村民们大部分时间可以自给自足，当物资匮乏或者多余的时候就去最近的镇子交易，总体上是一个远离喧嚣的平静村庄——至少看起来是这样的。

路边摆放着很多弃置的木板和货箱，盖着的布也积满了尘埃，但能想象曾经村庄摊贩云集的繁华模样。大部分村人都对你保持警惕，但也有少数人似乎是好奇心更高。

你朝西边望去，能看见一片宁静的湖泊，而在路的的尽头有一批枣红色的马正在马棚里休息。

（出现鸡舍选项后每日前往触发剧情）

[[向路人搭话][$minute += 10]](10min)（此处可循环）
[[回家|返回房间][$minute += 10]](10min)
[[商铺|商铺跳转][$minute += 10]](10min)
[[湖泊][$minute += 30]](30min)
&lt;&lt;if $machecishu eq 0&gt;&gt;[[靠近马|马车开始][$minute += 10]](10min)&lt;&lt;/if&gt;&gt;&lt;&lt;if $machecishu gte 1&gt;&gt;[[马车|马车][$minute += 10]](10min)&lt;&lt;/if&gt;&gt;
&lt;&lt;if $day &gt;= 2&gt;&gt;[[鸡舍|鸡舍跳转不同段落][$minute += 20]](20min)&lt;&lt;/if&gt;&gt;
&lt;&lt;if $senlin &gt;= 1&gt;&gt;[[森林|森林跳转不同段落][$minute += 50]](50min)&lt;&lt;/if&gt;&gt;
&lt;&lt;if $zhida == 1&gt;&gt;[[跳过养成下一节剧情直达键|出村1]]&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="31" name="商铺" tags="" position="100,1575" size="100,100">这里面琳琅满目，售卖的东西种类超出了你的想象，但对商品的维护着实不尽人意，你似乎理解为什么这个店铺如此破落了。

店主正对着一本书昏昏欲睡。



[[看看商品]]
[[回到村庄|村庄]]</tw-passagedata><tw-passagedata pid="32" name="看看商品" tags="" position="25,1575" size="100,100">&lt;&lt;=setup.ShopItem(1)&gt;&gt;&lt;&lt;=setup.ShopItem(5)&gt;&gt;
&lt;&lt;=setup.ShopItem(6)&gt;&gt;&lt;&lt;=setup.ShopItem(7)&gt;&gt;
&lt;&lt;=setup.ShopItem(8)&gt;&gt;&lt;&lt;=setup.ShopItem(9)&gt;&gt;





[[离开|商铺]]</tw-passagedata><tw-passagedata pid="33" name="布雷恩开始" tags="" position="100,1500" size="100,100">你不确定这里面乌漆嘛黑到底是干什么的，但它挂出的招牌又让你确认它的职能，你走了进去，试图找到可以照明的东西。

”哦，新的客人？“你身旁的布蠕动起来，这把你吓了一跳立即退到门口，只见这块布翻动了几下才露出人影，那人带着一副眼镜，微卷的深色头发像一滩海草堆在头上，你无法从外貌上分辨他的年龄，只能听出他的声音有些低沉。
”啊，是你......价格都在上面了，早晚都是八点——“他一边打哈欠一边拉出一把吱呀作响的软椅，”——都是八点开和关，请吧。“之后他便不再说话，点亮油灯，开始读一本旧书。

借着油灯的光，你看清了屋子里的摆设。


[[继续|商铺][$shangpucishu += 1]]
</tw-passagedata><tw-passagedata pid="34" name="衣柜" tags="" position="375,625" size="100,100">虽然衣服通过背包就可以更换，但如果是贵重的首饰就只能存放在衣柜里呢。

你正穿戴着一条水滴型宝石项链，现在是晶莹的&lt;font color=&quot;blue&quot;&gt;蓝色&lt;/font&gt;。


[[离开|返回房间]]</tw-passagedata><tw-passagedata pid="35" name="镜子" tags="" position="425,950" size="100,100">这是一个比你还要高很多的全身镜，你仔细观察才发现外围箍了一圈雕刻着花纹的红木，你有些好奇这样的屋子为什么配了个这么大的镜子。

你看向镜子里的自己，没有什么特别的。



[[离开|返回房间]]</tw-passagedata><tw-passagedata pid="36" name="床铺" tags="" position="450,800" size="100,100">用于睡觉休息睡觉

[[作弊意识鉴定减一|床铺][$yishi -= 1]]

[[睡觉|睡觉跳转不同段落][$tianshu +=1,$hour +=8,$energy +=80]](8h)
</tw-passagedata><tw-passagedata pid="37" name="桌子" tags="" position="425,1050" size="100,100">大概两臂宽的书桌，带了两个抽屉，如果有什么重要的文件或物品可以存放在这里。


现在还空空如也


[[离开|返回房间]]</tw-passagedata><tw-passagedata pid="38" name="背包" tags="noreturn" position="275,25" size="100,100">&lt;p&gt;你正穿著:&lt;/p&gt;

&lt;&lt;=setup.Equipped()&gt;&gt;



&lt;p&gt;行李中有:&lt;/p&gt;

&lt;&lt;=setup.Inventory()&gt;&gt;

[[返回|$return]]</tw-passagedata><tw-passagedata pid="39" name="买" tags="noreturn" position="100,50" size="100,100">占位


[[返回|$return]]</tw-passagedata><tw-passagedata pid="40" name="拿东西" tags="noreturn" position="100,175" size="100,100">

[[返回|$return]]</tw-passagedata><tw-passagedata pid="41" name="马车" tags="" position="350,1600" size="100,100">你看见一个中年男人坐在马厩屋檐下的椅子上，看见你的靠近，他打了个招呼。

“嗨，新人，我叫博斯，”他打了个嗝，“如果你想从这个鸟不拉屎的村庄到别处去，可以来找我。”

你闻到极淡的酒味，“你喝酒了？”你皱眉问他，

“喂喂，工作期间我可不会干这种事，”博斯笑了，拿出一个像酒壶的东西晃了晃，里面是空的，“不过我的饭碗也没什么可丢的了。”枣红马也配合地嘶鸣。

[[离开|村庄]]</tw-passagedata><tw-passagedata pid="42" name="厨房" tags="" position="425,1125" size="100,100">你掀开帘子，这后面有一个小小空间，灶台上有一口泛着诡异黑光的锅，你对它是否真的可以用来做菜表示怀疑。


[[开始炼药]]
[[离开|返回房间]]</tw-passagedata><tw-passagedata pid="43" name="日常醒来" tags="" position="550,875" size="100,100">



[[起床|返回房间]]</tw-passagedata><tw-passagedata pid="44" name="睡觉跳转不同段落" tags="" position="550,650" size="100,100">&lt;&lt;if $yishi &gt;= 8 &amp;&amp; $yishi &lt;= 10&gt;&gt;
&lt;&lt;goto&quot;睡觉场景1&quot;&gt;&gt;
&lt;&lt;elseif $yishi &gt; 4 &amp;&amp; $yishi &lt;= 7&gt;&gt;
&lt;&lt;goto&quot;睡觉场景2&quot;&gt;&gt;
&lt;&lt;elseif $yishi &gt; 1 &amp;&amp; $yishi &lt;= 4&gt;&gt;
&lt;&lt;goto&quot;睡觉场景3&quot;&gt;&gt;
&lt;&lt;elseif $yishi &lt;= 1&gt;&gt;
&lt;&lt;goto&quot;睡觉场景4&quot;&gt;&gt;
&lt;&lt;/if&gt;&gt;
</tw-passagedata><tw-passagedata pid="45" name="睡觉场景1" tags="" position="700,625" size="100,100">你一夜无梦，睡了个好觉。



[[继续|日常醒来]]</tw-passagedata><tw-passagedata pid="46" name="睡觉场景2" tags="" position="700,700" size="100,100">你的脑嗨有些混沌，但你还可以抵抗



[[继续|日常醒来]]</tw-passagedata><tw-passagedata pid="47" name="睡觉场景3" tags="" position="700,775" size="100,100">3




[[继续|日常醒来]]</tw-passagedata><tw-passagedata pid="48" name="睡觉场景4" tags="" position="700,850" size="100,100">4




[[继续|日常醒来]]</tw-passagedata><tw-passagedata pid="49" name="鸡舍跳转不同段落" tags="" position="525,1225" size="100,100">&lt;&lt;if $jishecishu eq 0&gt;&gt;
&lt;&lt;goto&quot;鸡舍开始场景&quot;&gt;&gt;
&lt;&lt;elseif $day == 3 &amp;&amp;$jishecishu &gt;= 1&gt;&gt;
&lt;&lt;goto&quot;背景介绍&quot;&gt;&gt;
&lt;&lt;elseif $jishecishu &gt;= 1&gt;&gt;
&lt;&lt;goto&quot;鸡舍场景1&quot;&gt;&gt;
&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="50" name="鸡舍开始场景" tags="" position="525,1350" size="100,100">凯蒂在篱笆后热情地和你打招呼，“我就知道你会来，”她绕过几只鸡向你走来，她看着你，眼神流露出怀念，“我的儿女也和你差不多大，但她们早就出去各找各的路了。”

凯蒂恢复过来，“如果你缺钱，就来这帮工吧，”然后带着你进去，向你展示她的鸡舍，你看见几十只圆滚滚的鸡正到处扒拉，“一群活泼的东西，我腰板不行，撵起来天都黑了，”凯蒂又推开另一块篱笆，“这些是下蛋的母鸡，可爱吗？”

“平时只有喂喂鸡，放它们到林地去，确保它们别乱跑，日落再赶回来，对你们年轻人来说就是动动手指的事，”凯蒂笑着，“没事来这逛逛也行。”

你有些感动。

现在你可以在凯蒂的鸡舍帮工了。

[[返回村庄|村庄][$jishecishu += 1]]
[[照看鸡群][$jishecishu += 1]]</tw-passagedata><tw-passagedata pid="51" name="鸡舍场景1" tags="" position="525,1425" size="100,100">你来到鸡舍，凯蒂向你打招呼，随后她递给你一杯茶，“如果你想放牛奶或糖，屋子里有，不过我还是建议这种茶最适合什么都不加，这可是以前村里的特产。”

她的热情温暖了你。



[[照看鸡群|照看鸡群][$hour += 1,$energy -= 10]](1h)
[[回到村庄|村庄][$jishecishu += 1]]</tw-passagedata><tw-passagedata pid="52" name="向路人搭话" tags="" position="350,1225" size="100,100">&lt;&lt;nobr&gt;&gt;
&lt;&lt;set $x = [0,1,2,3,4,5,6]&gt;&gt;
&lt;&lt;set _unknown = $x.pluck()&gt;&gt;
&lt;&lt;if  _unknown is 0&gt;&gt;
你走向一个看起来不是很忙的中年男人，没等你靠近多少他便开始自言自语，“这里早就毁了，”面色阴沉的男人对你挥挥手，像是看到什么不祥之物，“所有人都让我们等死，我们自己也在等死而已。”

&lt;&lt;elseif  _unknown is 1&gt;&gt;
“......我们一直聆听神的旨意，守在这里。”你看见花胡子老人手中正摩挲着一个木制徽章，形状似乎是一个散射性的圆，边缘光滑富有光泽，看起来已经被把玩了很久，他笑着说，“财富、灾难、爱和死亡都曾踏足过这里，小姑娘，你会带来什么呢？”

你有些不明所以，朝老人点点头后就离开了。

&lt;&lt;elseif  _unknown is 2&gt;&gt;
村里的年轻人非常少，看起来都是游手好闲的模样，三五个聚集起来朝你所在的地方瞟，这让你有些不适，你最好离他们远一点。

&lt;&lt;elseif  _unknown is 3&gt;&gt;
“你到底是怎么过来的？”一个稍显臃肿的妇女并不反感你的搭话，“那些个大头兵每周都来一次，不是收各种各样的税，就是挨家挨户点人头，这么小的村也值得？连蚊子都不飞！“妇女压低声音凑近，“而你一点风声都没有就进来了，你说实话，你是不是哪个贵族的孩子出来逃难了？”你看着她一脸八卦的表情，搪塞了几句就离开了。

&lt;&lt;elseif  _unknown is 4&gt;&gt;
你看到一个小孩用缠着绷带的手抵在胸前，嘴里念念有词，你凑近了听，她似乎在进行某种祷告。随即女孩发现了你，“新...新面孔！”她表现得很震惊，然后马上向你发问：“你知不知道多伦多亚？”

你仔细回忆了一下，然后摇摇头，“我听母亲说世界上最大的神殿就在那里，”她腼腆地举起手比划，眼中充满喜悦，仿佛只是知晓那座建筑的存在就是一种巨大的快乐，“真希望有一天能去看一看。”

你鼓励了小女孩，然后离开。

&lt;&lt;elseif  _unknown is 5&gt;&gt;
“你说雾？”一个拄着锄头的矮小妇女说，“啊，从我出生就这样了，当然，也许从我父亲的父亲出生的时就是这样了，不过你要是问哪些什么都不干的老人，也许他们知道更多，”她摆出祈祷的姿势，“现在还只是秋天，等冬天雾会更深。”

&lt;&lt;elseif _unkonwn is 6&gt;&gt;
你听到一群农夫在聊天，“我在镇子听人说，我们国家派兵把隔壁国家的龙屠了。”
“不就去年复苏的那只吗，这都多久的事了，你才知道？”
“估计是又馋奖金了，喝酒做梦呢，你别理他。”
“你说我们这附近会不会也有龙。”
“龙？“你听到嘲笑声，”对于我们这种人，龙更像传说生物呢。”
&lt;&lt;/if&gt;&gt;
&lt;&lt;/nobr&gt;&gt;




[[返回|村庄]]</tw-passagedata><tw-passagedata pid="53" name="bodywidgets" tags="widget" position="975,25" size="100,100">//状态
&lt;&lt;widget &quot;bodywidgets&quot;&gt;&gt;&lt;&lt;nobr&gt;&gt;
&lt;&lt;if $life &gt;=100 &amp;&amp; $life &lt;=200&gt;&gt;
    &lt;&lt;set $showlife=&quot;普通&quot;&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;set $life = 100&gt;&gt;
&lt;&lt;set $body = 0&gt;&gt;
&lt;&lt;set $lie = 0&gt;&gt;
&lt;&lt;set $magic = 0&gt;&gt;
&lt;&lt;set $fast = 0&gt;&gt;
&lt;&lt;set $make = 0&gt;&gt;
&lt;&lt;/nobr&gt;&gt;
&lt;&lt;/widget&gt;&gt;</tw-passagedata><tw-passagedata pid="54" name="PassageFooter" tags="" position="1300,275" size="100,100">&lt;&lt;for ;$Times != $day;$Times=$day&gt;&gt;
&lt;&lt;set _AA=$day-$Times&gt;&gt;
&lt;&lt;set $magic+=1*_AA&gt;&gt;/*数字是每过一个小时会消耗or增加的值*/
&lt;&lt;if $Times == 30|| $Times == 31&gt;&gt;
&lt;&lt;break&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;/for&gt;&gt;

 &lt;&lt;for ;$enemyadd != $fightNumbe;$enemyadd=$fightNumbe&gt;&gt;
 &lt;&lt;set _AA=$fightNumber-$enemyadd&gt;&gt;
 &lt;&lt;set $enemy_attack+=10*_AA&gt;&gt;
 &lt;&lt;/for&gt;&gt;

&lt;&lt;if $energy &gt; $energymax&gt;&gt;
&lt;&lt;set $energy = $energymax&gt;&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;if $energy &lt;= 0&gt;&gt;
&lt;&lt;goto&quot;体力耗尽&quot;&gt;&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;if $alchemySkill &gt; 100&gt;&gt;
&lt;&lt;set $alchemySkill = 100&gt;&gt;
&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="55" name="体力耗尽" tags="" position="2050,650" size="100,100">&lt;&lt;set $energy = 1&gt;&gt;
你没有体力了。

你两眼一黑



[[继续|体力耗尽2]]</tw-passagedata><tw-passagedata pid="56" name="体力耗尽2" tags="" position="2050,800" size="100,100">你醒来了，你发现自己回到了房间，应该是谁帮助了你。



[[继续|学院卧室]]</tw-passagedata><tw-passagedata pid="57" name="实验片段" tags="" position="875,475" size="100,100">&lt;&lt;set _choice = 0&gt;&gt;
&lt;&lt;link &#39;分支一&#39;&gt;&gt;
&lt;&lt;set _choice = 1&gt;&gt;
&lt;&lt;redo &#39;choice&#39;&gt;&gt;
&lt;&lt;/link&gt;&gt; &lt;br&gt;11 &lt;br&gt;

&lt;&lt;link &#39;分支二&#39;&gt;&gt;
&lt;&lt;set _choice = 2&gt;&gt;
&lt;&lt;redo &#39;choice&#39;&gt;&gt;
&lt;&lt;/link&gt;&gt; &lt;br&gt;11&lt;br&gt;

&lt;&lt;do tag &#39;choice&#39;&gt;&gt;
  &lt;&lt;if _choice === 1&gt;&gt;
  你选择了分支1
  &lt;&lt;elseif _choice === 2&gt;&gt;
  你选择了分支2
  &lt;&lt;else&gt;&gt;
  请选择分支
  &lt;&lt;/if&gt;&gt;
&lt;&lt;/do&gt;&gt;</tw-passagedata><tw-passagedata pid="58" name="未命名片段 2" tags="" position="925,475" size="100,100">&lt;button id=&quot;button_A&quot;&gt;A&lt;/button&gt;
&lt;button id=&quot;button_B&quot;&gt;B&lt;/button&gt;
&lt;p id=&quot;description&quot;&gt;这是一段说明文字&lt;/p&gt;

&lt;&lt;script&gt;&gt;
// 定义 A 按钮的点击事件处理函数
$(document).on(&#39;click&#39;, &#39;#button_A&#39;, function() {
  // 在 1 秒内让 B 按钮和说明文字消失
  $(&#39;#button_B&#39;).fadeOut(1000);
  $(&#39;#description&#39;).fadeOut(1000);
});

// 定义 B 按钮的点击事件处理函数
$(document).on(&#39;click&#39;, &#39;#button_B&#39;, function() {
  // 延迟 3 秒后让 A 按钮和说明文字消失
  setTimeout(function() {
    $(&#39;#button_A&#39;).fadeOut(0);
    $(&#39;#description&#39;).fadeOut(0);
  }, 3000);
});
&lt;&lt;/script&gt;&gt;</tw-passagedata><tw-passagedata pid="59" name="测试" tags="" position="975,475" size="100,100">前提建议

&lt;div id=&quot;choices&quot;&gt;
   &lt;&lt;link&quot;A&quot;&gt;&gt;
      &lt;&lt;replace &quot;#choices&quot;&gt;&gt;
         &lt;br&gt;
         第一段描述&lt;br&gt;
         &lt;span class=&quot;talk&quot;&gt;另一段第一段描述&lt;/span&gt;&lt;br&gt;
         [[text]]
      &lt;&lt;/replace&gt;&gt;
   &lt;&lt;/link&gt;&gt;
   &lt;br&gt;
   &lt;&lt;link&quot;B&quot;&gt;&gt;
     &lt;&lt;replace&quot;#choices&quot;&gt;&gt;
        &lt;br&gt;
        第二段描述&lt;br&gt;
        &lt;span class=&quot;talk&quot;&gt;另一段第二段描述&lt;/span&gt;&lt;br&gt;
        [[text]]
      &lt;&lt;/replace&gt;&gt;
   &lt;&lt;/link&gt;&gt;
&lt;/div&gt;   </tw-passagedata><tw-passagedata pid="60" name="text" tags="" position="1000,625" size="100,100">nothing

[[啊]]&lt;&lt;include &quot;床铺&quot;&gt;&gt;</tw-passagedata><tw-passagedata pid="61" name="啊" tags="" position="1100,475" size="100,100"></tw-passagedata><tw-passagedata pid="62" name="PassageDone" tags="" position="1200,25" size="100,100">实验性文本</tw-passagedata><tw-passagedata pid="63" name="继续询问" tags="" position="100,1800" size="100,100">&lt;br&gt;他已经转身回到店铺，你整理了一下衣服也跟着进去，这是一个问话的好时机。

（按顺序选取即可）
&lt;br&gt;

&lt;div id=&quot;choices&quot;&gt;
   &lt;&lt;link&quot;商店的物品可以免费吗&quot;&gt;&gt;
      &lt;&lt;replace &quot;#choices&quot;&gt;&gt;
         &lt;br&gt;
         “这个问题多余了，反正迟早都是你的。”他靠在墙上，引得灰尘簌簌落下，“只要你想。”&lt;br&gt;
         [[继续询问]]
      &lt;&lt;/replace&gt;&gt;
   &lt;&lt;/link&gt;&gt;
   &lt;&lt;link&quot;老家伙是谁&quot;&gt;&gt;
     &lt;&lt;replace&quot;#choices&quot;&gt;&gt;
        &lt;br&gt;
        “明知故问？”他理了理头发，然而并没有起到整洁的效果，“啊，也对，外貌上看起来不是个老头。”&lt;br&gt;
        [[继续询问]]
      &lt;&lt;/replace&gt;&gt;
   &lt;&lt;/link&gt;&gt;
   &lt;&lt;link&quot;他的眼镜多少度&quot;&gt;&gt;
       &lt;&lt;replace &quot;#choices&quot;&gt;&gt;
        &lt;br&gt;他似乎叹了口气，直接把眼镜摘下挂到你的鼻梁上，尺寸不符合你的头宽只能歪歪扭扭搭在脸上，你扶好镜架后确认——这只是一副平光镜。&lt;br&gt;
        [[继续询问]]
    &lt;&lt;/replace&gt;&gt;
&lt;&lt;/link&gt;&gt; 
&lt;&lt;link&quot;他的名字是什么&quot;&gt;&gt;
       &lt;&lt;replace &quot;#choices&quot;&gt;&gt;
        &lt;br&gt;他突然笑了，嘴型微动，你的心脏漏跳一拍，有什么艰涩的东西划过你的大脑。
        
      &lt;&lt;type 80ms&gt;&gt; &lt;font color=&quot;yellow&quot;&gt;&lt;i&gt; “言灵&lt;sub&gt;wōrd-wyrdlic&lt;/sub&gt;。”&lt;/i&gt;&lt;/font&gt;&lt;&lt;/type&gt;&gt;
        
&lt;&lt;timed 3s t8n&gt;&gt;简单的几个音节落入耳中，你的心情霎时变得沉重，一股压力突如其来迫使你屏住呼吸。
“感受到了吗，刚刚和现在。”
他慢条斯理地拉出他那把椅子坐在你身前，仰视着你，开始说些你完全不明白的东西。

“真名是解放言灵的最强模因......所以在这个世界上，不乏一些老东西，怪东西，或者脏东西......有时候名字本身比它们自己还要罪孽深重。”

“而我，是其中之一。”他看向你的眼睛，隔着镜片你似乎看到一束光从他细长的瞳孔中一闪而过，你感到毛骨悚然，“为了你的安全着想，对于我的真名不知道为好，但至少现在，我和你是一条路上的。”

&lt;br&gt;

  [[继续询问]]&lt;&lt;/timed&gt;&gt;
    &lt;&lt;/replace&gt;&gt;
&lt;&lt;/link&gt;&gt; 
 &lt;&lt;link&quot;他是否知道你的名字（选择该选项则片段结束）&quot;&gt;&gt;
       &lt;&lt;replace &quot;#choices&quot;&gt;&gt;
        &lt;br&gt;“很遗憾，我不知道，也不想知道，”他似乎感到了厌倦，一丝难以捉摸的神情浮现在他脸上，他起身走到屋子内侧。
        
        “自求多福吧，在有的人眼里，隐藏真名就像孩童耍赖。”他消失在门后。

看他的态度，在这之后你也无法从他这多问到什么了，你得到了一点讯息，但你还是不明白银发法师为何又让你选择另一个名字，你还远不足以触碰真相。&lt;br&gt;
[[离开|村庄][$zhida += 1]]
    &lt;&lt;/replace&gt;&gt;
&lt;&lt;/link&gt;&gt; 
&lt;/div&gt;   </tw-passagedata><tw-passagedata pid="64" name="布雷恩1" tags="" position="100,1700" size="100,100">“我记得上个月确实有收到文书......”

“不是有写巴塞洛城吗...”

“是你蠢还是我蠢...”

“怎么可能，这可是禁地谁有权力批准...“

看来这群人因为你产生了矛盾，也许可以趁此机会先躲过一劫，就在你思索如何脱身的时候，你的身体突然被一股大力揽了过去，
&lt;&lt;linkreplace &quot;继续&quot; &gt;&gt;
“她是我侄女，在老家干不下去，来投奔我了。”

你听着这突如其来的设定愣住了，而其他人仿佛被下咒，霎时间所有议论都停了下来。

&lt;font color=&quot;yellow&quot;&gt;“她是我侄女。”&lt;/font&gt;他又重复了一遍，你在他臂膀下一阵哆嗦，你感受到他的手臂突然施力，把你紧紧压向他的身体。

“各位......”他揽着你转了一圈，让站在远处看热闹的村人也能看见你们二人，你觉得自己像被他夹在胳膊下的小鸡，“虽然有些迟了。”

&lt;font color=&quot;yellow&quot;&gt;“回家吧，夜晚可是很危险的。”&lt;/font&gt;

你瞪大眼睛，无论是平民还是士兵都像上了发条的玩具，面无表情地一个接一个退出舞台，刚刚还摩肩接踵的村子变得空空荡荡，那些人仿佛失去灵魂的模样让你心中恶寒，这是人能做到的吗？

&lt;font color=&quot;#FF1493&quot;&gt;除了你，所有人的认知似乎发生了扭曲。&lt;/font&gt;

他低头端详了你一会，突然嗤笑出声松开了你，“那个老家伙已经衰弱至此了？”你立刻意识到他的话语另有所指。

[[继续|继续询问]]
&lt;&lt;/linkreplace&gt;&gt;</tw-passagedata><tw-passagedata pid="65" name="商铺跳转" tags="" position="75,1375" size="100,100">&lt;&lt;if $shangpucishu eq 0&gt;&gt;
&lt;&lt;goto&quot;布雷恩开始&quot;&gt;&gt;
&lt;&lt;elseif $senlin == 1 &amp;&amp;$shangpucishu &gt;= 1&gt;&gt;
&lt;&lt;goto&quot;布雷恩1&quot;&gt;&gt;
&lt;&lt;elseif $shangpucishu &gt;= 1&gt;&gt;
&lt;&lt;goto&quot;商铺&quot;&gt;&gt;
&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="66" name="森林" tags="" position="225,1675" size="100,100">占位，




[[返回|村庄][$senlin += 1]]</tw-passagedata><tw-passagedata pid="67" name="照看鸡群" tags="" position="525,1525" size="100,100">&lt;&lt;nobr&gt;&gt;
&lt;&lt;set $x = [0,1,2,3]&gt;&gt;
&lt;&lt;set _unknown = $x.pluck()&gt;&gt;
&lt;&lt;if _unknown is 0&gt;&gt;
鸡群花色多种多样，橙色的，棕色的，黑白斑点的......虽然很活泼好动，但这在你的掌握之中。

你可以尽情抚摸这些鸡，你感到心情放松

&lt;&lt;elseif _unknown is 1&gt;&gt;
你捡到了几枚蛋，你把这些放进装鸡蛋的篮子，看着堆叠起来有小山一座高的蛋框，你的心中升起淡淡的成就感。

&lt;&lt;elseif _unknown is 2&gt;&gt;
凯蒂靠近你，给了你几块从镇子的集市上摆摊时买的树莓饼干。

&lt;&lt;elseif  _unknown is 3&gt;&gt;
你看着走来走去的鸡，脑海中浮现起好几种鸡肉烹饪的菜式。你晃晃脑袋，把这些想法赶了出去。
&lt;&lt;/if&gt;&gt;
&lt;&lt;/nobr&gt;&gt;


[[继续帮忙|照看鸡群][$hour += 1,$energy -= 10]](1h)
[[返回村子|村庄]]
</tw-passagedata><tw-passagedata pid="68" name="背景介绍" tags="" position="650,1325" size="100,100">你又一次来到鸡舍，只见凯蒂在那焦急地打转。

“有只鸡不见了，唉，那可是下蛋的母鸡，这滑溜的畜生！”凯蒂在原地踱步，“可能......啊，不会去到森林那边了吧！”你清晰地看到她的表情从烦闷变得忧心忡忡，你不禁有些好奇。
&lt;&lt;linkreplace &quot;继续&quot; &gt;&gt;
“你问森林怎么了？”听到你的问题，凯蒂眼神有些闪烁，一阵沉默后她向你讲述了村子的过往，于是你的心中形成了较为清晰的图景。

艾登瑟村曾经在这周边也算小有名气——凭借得天独厚的地形和气候，产出的农作物和工艺品质量都不错，最重要的一点是这里的森林——是兽人的聚集地之一.

兽人作为千年前希波战争后为数不多对人类友善的种族，他们比一般人类气力敏捷上要强得多，加上狩猎技巧与生俱来，他们经常用森林深处得到的稀有植物，甚至是魔族残骸跟村民交换粮食，村人再将这些战利品交易出去，因此在当时很多稀有的物品都能在艾登瑟村找到。
&lt;&lt;linkreplace &quot;继续&quot; &gt;&gt;
直到一场突如其来的异变，在夜半更深时不知从何处弥漫起的大雾，先是笼罩整个森林，然后沿着道路扩散进艾登瑟村，遮蔽天空伸手不见五指，于是伴随黎明的不是太阳，而是划破天空的惨叫，恐慌和浓重的腥气。

反应过来的人拖家带口躲进远离村庄的山里等待救援，好在雾只是堪堪漫过村子就停下蔓延的脚步，零星几个不明所以的村民冒险进入雾中寻找家眷或财产，进去了就没再回来。

即便是后面神殿派来的红牧师也对这种奇异现象也一筹莫展，聚集起来的中央学者们也发表了统一意见——这是在各个种族历史记载上都是从未被记录过的灾难。
&lt;&lt;linkreplace &quot;继续&quot; &gt;&gt;
直到雾散了，村子里一如往常仿佛什么都没发生，一扇门窗都没遭到破坏，仅有那些没来及疏散的村民，以及森林中庞大的兽人族群销声匿迹。

更惊人的是，其实不仅是艾登瑟村，而是安布赛德国境内好几个兽人聚集的地区都发生了同样的事情，如此针对性的大批量谋杀，也让整个人类族群惴惴不安，在首都格兰切斯特甚至引发了政变，直到当时的国王——也是现今国王的父亲，以雷霆手段压制了叛乱，宣称魔族是罪魁祸首，大幅提高灵魂派法师的配备和驻军以向国民担保，才些微压下这场无妄之灾的势头。

这场诡异的大雾也有了自己的名字——欧科之变。
&lt;&lt;linkreplace &quot;继续&quot; &gt;&gt;
自此之后，艾登瑟村周边的百姓视这片森林为不祥之地，耕田也被认为是遭到了魔鬼的诅咒。

对于这种说法，神殿表示更重要的是让受难民众重新回到女神的庇佑拔除来自魔界的污秽，而当时的法师塔的权威——七人众首席维泽尔不置可否，只是警醒人们最好不要靠近，但这样的结果显而易见——艾登瑟村在几个月内迅速衰落了。

&lt;&lt;linkreplace &quot;[[继续|背景介绍2]]&quot; &gt;&gt;
&lt;&lt;/linkreplace&gt;&gt;
&lt;&lt;/linkreplace&gt;&gt;
&lt;&lt;/linkreplace&gt;&gt;
&lt;&lt;/linkreplace&gt;&gt;
&lt;&lt;/linkreplace&gt;&gt;</tw-passagedata><tw-passagedata pid="69" name="背景介绍2" tags="" position="650,1375" size="100,100">“但他们也知道，不管事实如何，总会沦落到这地步，只是快和慢的区别罢了。”

至于缘由如何就不是平民百姓可以求得的了，直到当事人相继离世、重大的打击迫使年轻人更在意眼前的生计，那场雾便淡出人们的视野。
&lt;&lt;linkreplace &quot;继续&quot; &gt;&gt;
“这还是从我奶奶那边听来的，她年轻时，这个村子还很富饶，人比现在多得多，直到那一天起雾了，连夜跑进山里才幸存下来一些人，兽人在这里绝迹了，你能想象到吗，那么多兽人.....那么多朋友......”

凯蒂陷入了回忆，“我刚刚记事时这里还有重兵把守，每年春天......还是夏天，一圈圈的人围着村子水泄不通，我可是真见过城里的大人物“

”他们还在我的屋子住过，什么法师骑士，英俊的亮闪闪的，我的父母亲为了招待他们，啧啧，吃得比过丰收节还好......小时候不明白，但现在回忆起来，那确实是段无知但快乐的时光。”凯蒂语气带着笑意，但很快眼睛又紧紧闭上。
&lt;&lt;linkreplace &quot;继续&quot; &gt;&gt;
“虽然后来一直相安无事，更多人是忍受不了的，离开村子寻找出路，有的人舍不得走就留下来了，哪怕天气转凉又会起雾......比如我，”凯蒂停下来喘了口气，开始敲她的老腰，“一转眼都过了这么久.....”

“所以小姑娘你怎么来这里的村子，虽然现在平静多了，那也不是想来就能来的，”凯蒂努努嘴，牵起面庞上的皱纹，“大人物对经历过欧科事件的地方管控还是很严格的.....”

“不过你不用讲，”凯蒂摆摆手，露出一副胸有成竹的表情拿起食盆，“每个人总有些......不能说的身世嘛！”
&lt;&lt;linkreplace &quot;继续&quot; &gt;&gt;
你内心稍安，她似乎自己在脑海里形成一套说法——至少你不用为没有记忆的事情多操心了。

你远远望去森林，半人高的灌木后挺拔的树木几乎遮蔽了你的所有视野，你握住胸前的项链，感受它给予你的莫名安全感，也许明天你可以去那边逛一逛——就当是帮凯蒂找她那珍贵的蛋鸡。
&lt;&lt;linkreplace &quot;[[继续|照看鸡群][$senlin += 1]]&quot; &gt;&gt;
&lt;&lt;/linkreplace&gt;&gt;
&lt;&lt;/linkreplace&gt;&gt;
&lt;&lt;/linkreplace&gt;&gt;
&lt;&lt;/linkreplace&gt;&gt;</tw-passagedata><tw-passagedata pid="70" name="森林跳转不同段落" tags="" position="375,1475" size="100,100">&lt;&lt;if $senlin ==1&gt;&gt;
&lt;&lt;goto&quot;森林冒险&quot;&gt;&gt;
&lt;&lt;elseif $senlin &gt;= 2&gt;&gt;
&lt;&lt;goto&quot;森林&quot;&gt;&gt;
&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="71" name="森林冒险" tags="" position="475,1700" size="100,100">没有现成的路通向森林，于是你朝着视野里它的方向行进，一开始还能看见零星的人类活动痕迹，比如插进泥土里的旗帜破破烂烂，只剩下半边框架的马车拱顶，之后越走草木越深，你感到气温都更低了。

终于你来到森林边境，没走几步就被半人高的杂草如蛛网般密布的藤曼挡住去路，连往里走一步都困难。

看来你需要一把用于除草的镰刀才能继续，凯蒂那应该会有。


[[继续|森林冒险2]]</tw-passagedata><tw-passagedata pid="72" name="森林冒险2" tags="" position="475,1725" size="100,100">凯蒂听到你的来意后十分震惊，“如果你有什么意外......”她欲言又止，你表示不用太担心，“那你无论如何要在黄昏前回来，”凯蒂边说边从木门后翻出一把镰刀递给你，沉默一会又嘱咐道：“小心一点，孩子，实在不行就赶快回来吧。”

你朝她挥手告别，走向森林。


[[再次前往森林|森林冒险3]]</tw-passagedata><tw-passagedata pid="73" name="森林冒险3" tags="" position="475,1750" size="100,100">你护住自己的衣服不被割破，用镰刀在疯长的植物中劈开一条小路，小心翼翼地往里走。

&lt;&lt;linkreplace &quot;继续&quot; &gt;&gt;
你凭着直觉选择方向，择下长条藤曼绑在路过的树干上作为标记。

虽然你还记挂着凯蒂的母鸡，但很遗憾，你一路上甚至没听到任何一个物种的叫声，只有树叶窸窸窣窣，像是深渊巨口将你吞吃入腹前发出的嘲笑。

&lt;&lt;linkreplace &quot;继续&quot; &gt;&gt;
随着时间流逝，植被的颜色从绿变深碧，再到幽蓝，你不知道你走了多久，也许走出了几百米，也许是几千米，穿行在几十米高的密林里，你已然丧失了判断时间的能力，因为你根本看不到天空。

你靠着模糊的光斑判断是否可以下脚，拿着镰刀的手腕生疼，你感到非常疲惫。

你甚至不知道是什么支撑你走下去的，你转头看向自己走过的路，不可避免地起了返回的念头。

[[返回|森林冒险4]]
[[深入|森林冒险4]]
&lt;&lt;/linkreplace&gt;&gt;
&lt;&lt;/linkreplace&gt;&gt;

</tw-passagedata><tw-passagedata pid="74" name="森林冒险4" tags="" position="475,1775" size="100,100">在你做好决定的下一刻，以你为中心散发出柔和光芒，光源来自于你的项链，一圈圈波纹荡开在空气中，&lt;font color=&quot;#FF1493&quot;&gt;你的认知似乎发生了扭曲。&lt;/font&gt;

不知何时你的面前出现了两条路。

[[第一条路|森林5][$milu +=1]]
[[第二条路|森林5][$milu +=1]]</tw-passagedata><tw-passagedata pid="75" name="森林5" tags="" position="475,1800" size="100,100">你不知道这条路是否正确，只管往前走，时间飞速流逝，无尽的黑暗笼罩着你，等你走到尽头，又出现了更多的路......


[[第一条路|森林5][$milu +=1]]
[[第二条路|森林5][$milu +=1]]
[[第三条路|森林5][$milu +=1]]
[[第四条路|森林5][$milu +=1]]
&lt;&lt;if $milu &gt;= 3&gt;&gt;[[第五条路|森林5][$milu +=1]]
[[第六条路|森林5][$milu +=1]]&lt;&lt;/if&gt;&gt;
&lt;&lt;if $milu &gt;= 7&gt;&gt;[[第七条路|森林5][$milu +=1]]
[[第八条路|森林5][$milu +=1]]&lt;&lt;/if&gt;&gt;
&lt;&lt;if $milu &gt;= 12&gt;&gt;[[???|森林6][$milu +=1]]&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="76" name="森林6" tags="" position="475,1825" size="100,100">终于，你拖着筋疲力尽的身子来到一片宽阔的草地，这里盛开着拇指大小的纯白花朵，草丛只到你的脚踝，脆嫩欲滴散发着荧光照亮这片区域。

然后你震惊地发现——你的上方，原本应该是天空所在的位置——竟是和你脚下如出一辙的绿地。

&lt;&lt;linkreplace &quot;继续&quot; &gt;&gt;
朦胧的声音在你脑海中回荡，&lt;strong&gt;&lt;font color=&quot;yellow&quot;&gt;“灵魂，脆弱的，覆手即散...”&lt;/font&gt;&lt;/strong&gt;

无数光点忽然从你脚下翩跹而起，奇妙的小生物越来越多，纷纷扬扬如雪花一般飘落在你的身上，当你捧起双手，它们也随之落入手心，你感受到一股清新的气息从身体深处迸发。

&lt;&lt;linkreplace &quot;继续&quot; &gt;&gt;
&lt;strong&gt;&lt;font color=&quot;yellow&quot;&gt;“美丽的露珠，太阳暂别...”
“美丽的露珠，印记不灭...”&lt;/font&gt;&lt;/strong&gt;

点点光芒围着，这些字句有着奇妙的韵律，你仿佛浸入温暖的海潮，浪花拂过脸庞带来些微痒意，让你昏昏欲睡。

&lt;&lt;linkreplace &quot;继续&quot; &gt;&gt;
&lt;strong&gt;&lt;font color=&quot;yellow&quot;&gt;“血与灵，灵与血，契约于此刻交汇...”&lt;/font&gt;&lt;/strong&gt;

它们汇聚出的光融入你的身体，你的认知似乎发生了扭曲。

你好像迈进古老亘长的时光，季节交错纵横，流水泠泠秋叶铺满台阶，被火燎烧的枝桠低垂，你处在这中心步态蹒跚，低头看见自己四肢上的血污凝固发黑。

你动了起来，又摔倒在地，再支撑起身体，再坠落......一次又一次，直到你可以用手指触碰到那荆棘掩盖下的灰白色棺柩。
&lt;&lt;linkreplace &quot;继续&quot; &gt;&gt;
&lt;strong&gt;&lt;font color=&quot;yellow&quot;&gt;“再会，再会，亲爱的旅人...”&lt;/font&gt;&lt;/strong&gt;

吟唱从远方浮现，你生出疑惑，还会再见吗？那会是什么时候？

但很快你沉溺在了这片柔软之中，闭上双眼，再睁开，周而复始。
&lt;&lt;linkreplace &quot;继续&quot; &gt;&gt;
你任由意识带着你漂流，最终你坐在一片草地上，背靠一棵巨大的树，发丝被带着氤氲湿气的风晕染，阳光纯净而安宁。

你似乎正在和谁说话，那个人笑着回应你，手上打理着你的裙摆，将你随意蹬下的鞋摆好，你看着他的嘴唇上下开合，却听不见任何声音......但即便如此......

你也觉得这个画面分外令人怀念......
&lt;&lt;linkreplace &quot;继续&quot; &gt;&gt;
直到有谁拍了拍你的脸。


&lt;&lt;linkreplace &quot;[[继续|森林7][$day += 3]]&quot; &gt;&gt;
&lt;&lt;/linkreplace&gt;&gt;
&lt;&lt;/linkreplace&gt;&gt;
&lt;&lt;/linkreplace&gt;&gt;
&lt;&lt;/linkreplace&gt;&gt;
&lt;&lt;/linkreplace&gt;&gt;
&lt;&lt;/linkreplace&gt;&gt;
&lt;&lt;/linkreplace&gt;&gt;</tw-passagedata><tw-passagedata pid="77" name="森林7" tags="" position="475,1850" size="100,100">“醒了吗，”见你没反应又开始掐，“醒一醒，”你为了从不适中脱出而睁开眼睛，看到张只有一丝熟悉的脸庞。

“怎么，哼哼唧唧像只猫儿似的，被这里的精灵耍了？”那个商铺老板在正上方看着你，你听出他语气里的几分戏谑，“呼，看来做了个好梦？”你还未完全从睡意中脱出，不明所以地看着他。

&lt;&lt;linkreplace &quot;继续&quot; &gt;&gt;
“那个女人来街上又是喊，又是找人帮忙的，”他慢条斯理地一个字一个字往外蹦，“现在整个村都知道一位无知女性在森林里失踪了。”

你猛地清醒过来，发现自己正身处森林外围浅层，树木稀疏，而你躺在开辟不久的小路上，星星一闪一闪挂在天空。

&lt;&lt;linkreplace &quot;现在什么时候了&quot; &gt;&gt;

“嗯......”男人屈起手指轻点下巴，“两天后，三天后？”

......信息量有点大，你有些提不起劲思考下一步做什么，然后才缓慢想起那只母鸡还没找到，你希望它没事。

“哈，醒来就起来准备一下，麻烦已经等着了——”只见他忍住了一个哈欠，然后可以说是用绅士且标准的礼仪姿势向大脑放空的你伸出胳膊，“不，该说终于等到了。”

&lt;&lt;linkreplace &quot;[[继续|森林8][$senlin += 1]]&quot; &gt;&gt;
&lt;&lt;/linkreplace&gt;&gt;
&lt;&lt;/linkreplace&gt;&gt;
&lt;&lt;/linkreplace&gt;&gt;</tw-passagedata><tw-passagedata pid="78" name="森林8" tags="" position="475,1875" size="100,100">你感觉身体没有力气，捞住他的手臂半挂在他身上。

他倒游刃有余地拖着你往村子走，你依稀看见远方有连绵的光点，等走到和村子差不多接壤的地方你看清了——那是火把，而举着火把的是身穿陌生铠甲的士兵，大约有十来个。

男人稍微走在你前面靠近人群，周围人议论纷纷，你觉得有些大事不妙，如果现在做出太大的举动可能会引起更糟糕的后果。

你感受到为首的士兵盯向你。
&lt;br&gt;
&lt;div id=&quot;choices&quot;&gt;
   &lt;&lt;link&quot;缩到身后&quot;&gt;&gt;
      &lt;&lt;replace &quot;#choices&quot;&gt;&gt;
         &lt;br&gt;
        你赶忙缩到商铺老板身后，然后听见他微不可闻的笑声。
你探出头观察对面的士兵，发现他们的表情出奇地一致，疑惑又扭曲，&lt;br&gt;
         [[继续|布雷恩1]]
      &lt;&lt;/replace&gt;&gt;
   &lt;&lt;/link&gt;&gt;
   &lt;br&gt;
   &lt;&lt;link&quot;盯回去&quot;&gt;&gt;
     &lt;&lt;replace&quot;#choices&quot;&gt;&gt;
        &lt;br&gt;
       你抬起眼盯回去，士兵似乎被什么吓到，移开了视线。
你发现他们的表情出奇地一致，疑惑又扭曲。&lt;br&gt;
        [[继续|布雷恩1]]
      &lt;&lt;/replace&gt;&gt;
   &lt;&lt;/link&gt;&gt;
&lt;/div&gt;   
&lt;br&gt;</tw-passagedata><tw-passagedata pid="79" name="代码测试" tags="" position="850,475" size="100,100"></tw-passagedata><tw-passagedata pid="80" name="出村1" tags="" position="400,2100" size="100,100">&lt;&lt;set $day += 1&gt;&gt;&lt;&lt;set $hour = 8&gt;&gt;“那天晚上鸡就自己回来了”，凯蒂看起来很内疚，“一开始就不应该让你去，幸好你没出事......”

你花了一些时间安慰她，很快笑容又出现在她脸上。

你在这个村庄平安无事地过了几天，但再次拜访商铺老板他都是那副恹恹的表情。

这一天你照常来到鸡舍帮忙，在入口栅栏处看到一张小纸条，‘我去村头找安娜了’。看来凯蒂今天不在家.

你照常帮忙干活，突然看到一个筋瘦的男人从荒原跑回村子，口中不知在叫嚷什么，距离太远你听不清，但能隐隐约约察觉到有什么大事要发生。

很快路上的人越来越少，村人都陆陆续续躲进了屋子，你不知道即将到来什么，好奇心促使着你抱着鸡蹲在草垛后面。

很快你脚下的尘土开始飞扬，你听见密不透风的马蹄声由远及近，你的心脏狂跳几乎跃出胸膛，你捂住嘴尽量降低自己的存在感，尽管你不知道这有没有用。
&lt;&lt;linkreplace &quot;继续&quot; &gt;&gt;
这几分钟漫长得像过去一个世纪——结果是他们真的停在了这小农场门前，你听见金属碰撞的当啷声在离你很近的地方响起，你想幸好凯蒂不在家，不然她大概会吓昏过去，当然，你自己的状况也没好到哪去......

就在你还抱有一丝侥幸心理的时候，鸡挣脱怀抱咯咯叫着从草垛后跑了出去。

——这下你无法再欺骗自己，他们不可能没有发现你，你开始回想你遇到的那几个奇奇怪怪的人，或者这条项链——但没有任何转折出现。

死寂依然在蔓延，你感到如芒在背，而且如果你没会错意，他们是在等你自己出来。

&lt;div id=&quot;choices&quot;&gt;
   &lt;&lt;link&quot;走出来&quot;&gt;&gt;
      &lt;&lt;replace &quot;#choices&quot;&gt;&gt;
         &lt;br&gt;
         你勉强直起身，所有人立刻看向了你，来自众人眼神的压迫感迫使你迈出了第一步，同时你也意识到，哪怕你什么都不干，事情也会挨个找上门来。

这些士兵和前几日的装束不大一样，一共只有十个出头，但装备精良带着马匹，半包围盔甲外的罩袍上印着纹章，这支骑兵小队迅速散开为你空出一条路，而路的尽头，全副武装的高大男人正骑在马上等着你。&lt;br&gt;
         [[继续|出村2]]
      &lt;&lt;/replace&gt;&gt;
   &lt;&lt;/link&gt;&gt;
   &lt;&lt;link&quot;跑回屋内&quot;&gt;&gt;
     &lt;&lt;replace&quot;#choices&quot;&gt;&gt;
        &lt;br&gt;
       你失败了，在你转身欲跑的瞬间，离你最近的两个士兵立即上前把你架起来。这下由不得你想不想了，你目瞪口呆地被双脚凌空搬到骑着黑马的高大男人身旁。&lt;br&gt;               [[继续|出村2]]
      &lt;&lt;/replace&gt;&gt;
   &lt;&lt;/link&gt;&gt;
   &lt;/div&gt;   
   
   &lt;&lt;/linkreplace&gt;&gt;
</tw-passagedata><tw-passagedata pid="81" name="出村2" tags="" position="400,2150" size="100,100">这些士兵和前几日的装束不大一样，一共只有十个出头，但装备精良带着马匹，半包围盔甲外的罩袍上印着纹章，在这支骑兵面前你别无选择，同时你也意识到哪怕你什么都不干，事情也会找上门来。

“抬头。”那人由上至下向你命令，他的声音比想象中的年轻。

你决定
&lt;div id=&quot;choices&quot;&gt;
   &lt;&lt;link&quot;抬头&quot;&gt;&gt;
      &lt;&lt;replace &quot;#choices&quot;&gt;&gt;
         &lt;br&gt;
         你依言照做，看着他解下头盔随手丢到旁边一个士卒手里。

“农夫？”，忽如其来的提问让你下意识看向他的眼睛，立刻就惊讶于那面具下是如此一张清隽的脸庞，黑发柔软落在额角，更显得五官立体。

你恍惚间甚至忘了紧张，直到他双眼微眯，蓝色瞳孔变得狭长黯淡，你这才反应过来，眨眨眼错开他的视线。&lt;br&gt;


         [[继续|出村3]]
      &lt;&lt;/replace&gt;&gt;
   &lt;&lt;/link&gt;&gt;
   &lt;&lt;link&quot;不抬&quot;&gt;&gt;
     &lt;&lt;replace&quot;#choices&quot;&gt;&gt;
        &lt;br&gt;
       你用身体动作表示了拒绝。很快你听到叮咛一声，随即你的脖颈感受到一阵酥麻，你用余光瞥见了，一把长剑散发寒意离你的肌肤只有几寸。

即使你不想暴露自己的心境，但你的肩膀还是出于本能地颤抖起来，他看起来不是很有耐心。

最后你还是老实照做，男人柔软的黑发落在眼眶上，你看不清他的表情，只觉他的目光在你脸上巡游，你更加感到不自在。&lt;br&gt;


[[继续|出村3]]
      &lt;&lt;/replace&gt;&gt;
   &lt;&lt;/link&gt;&gt;
   &lt;/div&gt; </tw-passagedata><tw-passagedata pid="82" name="出村3" tags="" position="400,2200" size="100,100">“带路，”此言一出，其他士兵都显露出了惊讶，但动作毫不耽搁，“$jia，你去过那个森林。”

你听见那个名字用他的嗓音念出来，心跳更快了。
&lt;div id=&quot;choices&quot;&gt;
   &lt;&lt;link&quot;瞪他&quot;&gt;&gt;
      &lt;&lt;replace &quot;#choices&quot;&gt;&gt;
         &lt;br&gt;
      说实话，你对这几日一连串的遭遇感到恼火，但对于你的情绪输出他依旧面无表情。

然后他突然向你伸出手——揪住了你的衣领。你没来得及反应，在你众人的惊呼间下一秒你就被扶着肩掉了个方向上了马坐在他身前。

你惊魂未定，抚平自己领子的同时平复呼吸。&lt;br&gt;


         [[继续|出村4]]
      &lt;&lt;/replace&gt;&gt;
   &lt;&lt;/link&gt;&gt;
   &lt;&lt;link&quot;顺从&quot;&gt;&gt;
     &lt;&lt;replace&quot;#choices&quot;&gt;&gt;
        &lt;br&gt;
       “......好。”你心里清楚你现在没有拒绝的权力。
       
       然后他突然向你伸出手——揪住了你的衣领。你没来得及反应，在你众人的惊呼间下一秒你就被扶着肩掉了个方向上了马坐在他身前。

你惊魂未定，抚平自己领子的同时平复呼吸。&lt;br&gt;


[[继续|出村4]]
      &lt;&lt;/replace&gt;&gt;
   &lt;&lt;/link&gt;&gt;
   &lt;/div&gt; </tw-passagedata><tw-passagedata pid="83" name="出村4" tags="" position="400,2250" size="100,100">“向后靠，不要抓马的鬓毛。”身后传来声音。

&lt;div id=&quot;choices&quot;&gt;
   &lt;&lt;link&quot;适应&quot;&gt;&gt;
      &lt;&lt;replace &quot;#choices&quot;&gt;&gt;
         &lt;br&gt;
     你决定不要想太多，权当是少添麻烦，调整成舒服的姿势窝进后方人的怀里。

“走，”你听见他驱使马时的低沉嗓音，夹杂在他的呼吸中掠过你的发顶。
马儿开始动了，更高的视野让你仿佛被灰蓝色天空深拥，自由本就辽阔无垠，浓郁的草木香裹在风中扑面而来，你发出一声惊呼，感到新奇和激动，在路途与颠簸中你的面颊有些发烫。&lt;br&gt;


         [[继续|出村5]]
      &lt;&lt;/replace&gt;&gt;
   &lt;&lt;/link&gt;&gt;
   &lt;&lt;link&quot;僵硬&quot;&gt;&gt;
     &lt;&lt;replace&quot;#choices&quot;&gt;&gt;
        &lt;br&gt;
     你努力保持姿态，试图无视来自后方的心跳，或者说，你和他二人之间的心跳本就密不可分，甚至胸腔的震动都随着相接的部分传来，引得你脊骨发麻。他的手臂越过你拿起缰绳，然后默默地配合你调整姿势。
     “走，”你听见他驱使马时的低沉嗓音，夹杂在他的呼吸中掠过你的发顶。
     马儿开始动了，更高的视野让你仿佛被灰蓝色天空深拥，自由本就辽阔无垠，浓郁的草木香裹在风中扑面而来，你发出一声惊呼，感到新奇和激动，在路途与颠簸中你的面颊有些发烫。&lt;br&gt;


[[继续|出村5]]
      &lt;&lt;/replace&gt;&gt;
   &lt;&lt;/link&gt;&gt;
   &lt;/div&gt; </tw-passagedata><tw-passagedata pid="84" name="出村5" tags="" position="400,2300" size="100,100">你看到自己劈开的小路，已经几乎又被杂草覆盖，男人微微抬起手臂，很快整个队伍停在了小路入口。青年轻踩马背，转眼间就落到了草地上。

你独自一人在马上，这匹马又壮又高，你无法想象在这种高度，刚刚自己是怎么被一只手拎上来的。

他朝你的方向侧身，你一咬牙准备扶着他的肩膀跳下来，在你重心传递到他身上后，青年立刻伸出手臂勾了一下你的腿弯便平稳地把你放下来，你重新站在坚实的土地上，有些不适应。

他看着那条小路沉默不语，“你是从这里进去的？”你点头表示肯定。

一阵风吹来，他用中指和食指夹住飘在空中的落叶，流光从他手心一簇而过，这又是什么魔法。
&lt;&lt;linkreplace &quot;继续&quot; &gt;&gt;
“我们进去，”他很快便跟离他最近的两个士兵——以及你发话，“你走在前面。”

已经开过道就轻松得多，你稳稳当当地走在前面，忙于赶路即便无人说话也不觉得窘迫，十来分钟后你看到尽头，但今天你的项链没有任何反应，眼前也没有岔路，更别说那些发光的小生物。

“警戒！”就在你想该如何描述的时候，他的神情严肃起来，其他人也围拢过来。

你被他突如其来的警觉吓到，森林里依旧寂静如常，除了你们几个外来者没有任何动物的鸣叫，紧绷气氛之下你没有注意到你刚刚踩过的藤曼颜色正在急剧变化。

“过来！”青年朝你喊道，你震惊地发现，森林起雾了。



[[继续|出村6]]
&lt;&lt;/linkreplace&gt;&gt;


</tw-passagedata><tw-passagedata pid="85" name="出村6" tags="" position="400,2350" size="100,100">从稀薄到能够遮蔽视野，仅在眨眼间就完成，简直就像是全程一直如影随形的野兽终于露出獠牙，与此同时有什么东西缠上了你的腿，在你行动受阻低头去看的功夫间又迅速爬上了你的腰，连他向你伸出的手都慢了一步。

你被袭击了，藤曼拖拽着你向森林深处飞速前进，你感觉自己五脏六腑都移位了，今天一整天都处于完全被动的状态，哪怕你有一百个不愿意，望着前方快要消失的身影，此时此刻也要喊出那句台词——

&lt;&lt;linkreplace &quot;救命！&quot;&gt;&gt;救命！

在你即将消失的视野中，他降低重心的动作给你一种奇异的迟滞感，很快“嘭”的一声在森林响彻，霎时间草木飞扬，他在这纷乱中消失不见，但如果你没看错他原本站着的地方留下了坑，须臾间他再次出现在你的视野，而此刻他离你仅有不到十米。

他向你爆冲而来的身影让你心脏几乎停跳，不禁觉得他大概率会把你和这藤曼一起拿剑砍掉，求生的意志在此刻达到顶峰，庞大外力挤压你的肺部，你仍用尽全力，朝着不知是束缚你的藤曼还是以惊人速度追击的恐怖男人大喊——

&lt;&lt;linkreplace &quot;停下！&quot;&gt;&gt;&lt;font color=&quot;yellow&quot;&gt;停下！&lt;/font&gt;

音节落下，你却感觉时间被无限拉长，漫长到你的意识离散，变成线，再变成点，一股极其浓烈的情绪笼罩住你，你的一半告诉你需要遏制，如果放任膨胀会将一切导向无法逆转的结局，而你的另一半却习以为常，这只是你的一部分，也是组成世界的媒介——


[[继续|出村7]]
&lt;&lt;/linkreplace&gt;&gt;
&lt;&lt;/linkreplace&gt;&gt;
</tw-passagedata><tw-passagedata pid="86" name="出村7" tags="" position="400,2400" size="100,100">“$jia！”一道声音如惊雷乍起唤回你的意识，你抬眼看去他不知为何速度慢了许多，正怒视着你，“发什么呆！”

藤曼对你的束缚轻了很多，你挣扎着从中脱出，来不及看它们跑到哪里你依然保持着一个极快的速度滑行翻滚，随时都有可能撞树上。

你立刻伸出手去抓任何你够得到的东西，但大部分只是脆弱的草茎，在地上打了好几个滚直到他抓住你的手腕才停下，你感觉自己浑身上下都快散架，手心又烫又痛。

你大口吸气缓解不适，你的衣服被叶片割出口子，皮肤上布满细小的划痕，这几秒内发生的事情够你消化一段时间了。

你往身后看，那里正有一个陡坡，如果你没及时停下后果不堪设想。

就在你心中充满劫后余生的庆幸时，一件衣料落到你身上，那是他的披风。
&lt;&lt;linkreplace &quot;继续&quot; &gt;&gt;
“还能动吗，”青年站在你面前，你小幅度活动着四肢确认伤势，但他没有等你回答，而是转头跟另外两个人说道，“你们去牵匹马来。”

此时此刻四周只剩下你们看个人，他凝视着你。

“我会带你离开这个村子，去往顿城，在那里你要接受检查。”微风吹动他的刘海，跟你比起来他几乎毫发无损，“如果你有什么想说的，现在是最好的时机。”尽管他全程面无表情，但你听出来了，这不是协商而是通知。

&lt;&lt;linkreplace &quot;询问为什么&quot; &gt;&gt;你询问为什么。

“这片森林有禁制，”他垂眸坐到离你几米远的地方，“虽然只是简单的障眼法，单纯让人找不到路，但你.....”

“但你那把小破镰刀每一刀都砍在了正确的方向，这次也一样，”他似乎回想起了什么，面色冷峻，“法术还在运作，而你身上没有任何法力气息却视若无物，不管这是你的天赋.....还是诅咒，”说到最后，他别有深意地看向你，“你自己也需要那个答案。”

&lt;div id=&quot;choices&quot;&gt;
   &lt;&lt;link&quot;谢谢夸奖&quot;&gt;&gt;
      &lt;&lt;replace &quot;#choices&quot;&gt;&gt;
         &lt;br&gt;谢谢夸奖。
    “不用谢，你确实比许多饭桶表现得都好。”不管你在想什么，他都毫无波澜地回答。&lt;br&gt;


         [[继续|出村8]]
      &lt;&lt;/replace&gt;&gt;
   &lt;&lt;/link&gt;&gt;
   &lt;&lt;link&quot;我什么都没做&quot;&gt;&gt;
     &lt;&lt;replace&quot;#choices&quot;&gt;&gt;
        &lt;br&gt;我什么都没做。
    “这句话留到后面在说吧。”不管你在想什么，他都毫无波澜地回答。&lt;br&gt;


[[继续|出村8]]
      &lt;&lt;/replace&gt;&gt;
   &lt;&lt;/link&gt;&gt;
   &lt;/div&gt;
   &lt;&lt;/linkreplace&gt;&gt;
&lt;&lt;/linkreplace&gt;&gt;
</tw-passagedata><tw-passagedata pid="87" name="出村8" tags="" position="400,2450" size="100,100">......也许可以向他告知你失忆的情况，毕竟哪怕隐瞒你也想不到有什么利益可图。

&lt;&lt;linkreplace &quot;关于失忆&quot; &gt;&gt;你说了自己没有记忆这件事。

“......”这可能是第一次他正眼看你，他保持安静时没有了剑拔弩张的气氛，像一个会在某条街上与你擦肩而过的英俊青年，一眼便引得人念念不忘。

“我会保密，”他垂眸说道，“这件事不要轻易告诉别人。”

过了一会你听到了脚步声，先前出去的士兵牵了一匹马过来。

“佩雷斯顿，”这次他终于不用抓你的领子了，可以正常地扶你上马，自己则牵着缰绳屹立在一片绿意之中，”那是我的名字。”

“姑且是一名骑士。”


[[继续|出村9]]
&lt;&lt;/linkreplace&gt;&gt;</tw-passagedata><tw-passagedata pid="88" name="出村9" tags="" position="400,2500" size="100,100">等走出森林，留在外面的士兵正严阵以待。

“走了。”佩雷斯顿放话，牵起你骑着的那匹马走在前头，其他人面面相觑，很快也牵着各自的马匹跟在后面。

你觉得佩雷斯顿很受信任，森林里发生了什么没有任何人表示疑问和质疑。

同时不出你所料的是——你又一次看见前方人头攒动。你想从人群中找到你那位便宜叔叔，但你失败了。
&lt;&lt;linkreplace &quot;继续&quot; &gt;&gt;
“不用怕，我亲爱的侄女，后会有期。”突然声音从你脑海中响起，你似乎可以看到他嘴角勾起的模样。

你想起那神乎其神篡改他人记忆的能力，以及他的神秘程度，他的境遇应该会比你好得多。

你看见了凯蒂，她已经回来了，她朝你招手看起来很兴奋，貌似还在鼓励你，你笑着点头回应她。

剩下绝大部分人你都没有印象，他们神情各异议论纷纷，你收回目光挺直腰杆，转而去注视走在前面的那个身影。
&lt;&lt;linkreplace &quot;继续&quot; &gt;&gt;
很快你们横穿了这个小村庄，你看着艾登瑟村慢慢变成遥远的点，你感觉未来会有很多麻烦接踵而来。

“你以后还会回来的，”佩雷斯顿突然说，他迈开修长的腿蹬上马又一次坐在你身后，“所以，现在别乱动，姿势摆好点。”

随后他轻拍马的侧面，整支队伍开始骑马加速。


[[继续|出村10]]
&lt;&lt;/linkreplace&gt;&gt;
&lt;&lt;/linkreplace&gt;&gt;

</tw-passagedata><tw-passagedata pid="89" name="出村10" tags="" position="400,2550" size="100,100">路上大约花了几个小时，途径一道不算太长的峡谷，但峭壁纵深极高还有几条非常浅的溪流，佩雷斯顿告知你此行是要先与大部队汇合。

期间有过休息，大部分时间你都在闭目养神，森林那一遭让你感到疲惫。

终于路上的行人开始增多，大多穿着粗布制成的束腰外衣，也有一些人穿着考究，面料装饰图案复杂华丽。

他们对士兵的到来似乎习以为常，因此你一个独身女性在这支队伍中也没有特别引人注目。

你还看见许多商贩聚集，贩卖的东西种类繁多，从日常吃穿，形状奇怪的金属制品到你看不懂封皮的书，队伍穿过高高的拱门后，径直往小城中心最高的建筑前进。
&lt;&lt;linkreplace &quot;继续&quot; &gt;&gt;&lt;&lt;set $hour += 8&gt;&gt;
在人群中漫行了十几分钟，你们来到这个边缘小镇上唯一的驿站，你下了马看着马厩被填满，趁着这一会的功夫你看向四周。

这里的建筑由几栋大木屋连通而成，虽然占地不大，但有一个小广场，现在旅人正多而显得有些拥挤。

“莫妮卡，辛苦了。”只见佩雷斯顿抚摸着黑马的脖子，手里多了一根胡萝卜，而他的同僚则是一脸虽然习以为常，但还是难以言喻的表情。

喔，对动物温柔过对人那种吗，你开始了想象，但如果是他倒也正常？

毕竟你暂时只被他用剑架过脖子，还无法想象那只手落到人脑袋是什么情况。

这里空气清新缓解了你的心情，你看着莫妮卡慢条斯理地啃完萝卜，随即佩雷斯顿给一直站在一边旁观他喂马的你一个跟上的眼神，


[[继续|出村11]]
&lt;&lt;/linkreplace&gt;&gt;

</tw-passagedata><tw-passagedata pid="90" name="出村11" tags="" position="400,2600" size="100,100">屋内有一个长吧台把空间分成了两部分，你跟随他进了房子，“长官！”一个干练的男人立刻迎上来，“您平安归来了。”

“鲁迪？怎么是你。”佩雷斯顿扶着佩剑，“法师呢？” 

“听您临时改道去边境几处村落巡视，维伦大人修补完结界后就带着其他人先去下一个城了......”被称为鲁迪的侍从露出了礼貌而不失尴尬的笑容。

“......他们走了多久。”佩雷斯顿的表情肉眼可见地阴沉下来，连带着旁边的你都感到寒毛倒竖。
&lt;&lt;linkreplace &quot;继续&quot; &gt;&gt;
“已经快一天了。”你觉得鲁迪的笑容更勉强了。

“啧，一群***，”佩雷斯顿冷笑，有什么词汇飞快地从你耳中窜过，但你没听清，“离这里最近带有传送阵的地区在哪？”

“哦哦，”鲁迪立刻从身上挂着的袋子里抽出一叠纸，摊开在桌上。.

“维利城有，不过这几十年里的巡视路线都没有途径这里，如果也没有大型商队的话，队传送阵可能很久没用过了，”他继续研究着地图，开始讲解。

“这条路比较安全，很少魔兽出没的记录，而且如果现在出发深夜能够抵达城镇间的一个驿站，黎明再出发大概中午就能到。”
&lt;&lt;linkreplace &quot;继续&quot; &gt;&gt;
鲁迪语毕，你察觉到佩雷斯顿的视线往你这边来，于是你朝他点头示意自己听懂了，得到回复后佩雷斯顿重新转向鲁迪，“你会回复术？”

“对，对的，有幸在神殿进修过，”鲁迪说这句的时候稍微挺直了腰。

“这里有伤者。”佩雷斯顿说完便走向门外。

“小姐你受伤了吗，”室内只余两人，鲁迪立刻会意，露出安抚的笑容，“请把手给我。”
&lt;&lt;linkreplace &quot;继续&quot; &gt;&gt;
你抖开披风向他伸出手，他托住你的手背，另一只手按在你的手腕。

忽然间你的心跳加快，被触碰到的地方开始发烫，血液仿佛躁动起来被引导去往某个地方，你感到口干舌燥，但这种感觉并不违和。

“幸好只是一些擦伤。”一段时间后鲁迪松开手，你摸着自己的手臂，惊讶地发现自己全身上下的伤口都愈合了，这个术法的疗愈效果比你想象中要好得多。
&lt;&lt;linkreplace &quot;继续&quot; &gt;&gt;
“您现在可以去外面等待了，佩雷斯顿长官应该已经安排好一切了，”鲁迪双手交叉放在胸前微微欠身，你这才注意到他的衣服上纹着一个散发光芒的太阳图章。

“愿女神保佑你，愿太阳福泽下人类之子血脉相连。”

你向鲁迪道完谢后也走出门外，正准备寻找佩雷斯顿的身影，却不成想一抬头就撞进他的眼里，他卸下了盔甲正站在一辆马车旁远远看着你。


[[继续|出村12]]
&lt;&lt;/linkreplace&gt;&gt;
&lt;&lt;/linkreplace&gt;&gt;
&lt;&lt;/linkreplace&gt;&gt;
&lt;&lt;/linkreplace&gt;&gt;</tw-passagedata><tw-passagedata pid="91" name="出村12" tags="" position="400,2650" size="100,100">看来是不用骑马了，你走向佩雷斯顿，然后看向马车，看向周围，最后看向在人群中格外显眼的男人。

&lt;&lt;linkreplace &quot;只有我们？&quot; &gt;&gt;只有我们？

“他们还有任务。”佩雷斯顿简短地回答，脸上一如既往得没什么表情，你有些惊讶，但来不及多想，借着他给你的力道上了车。

他随后也上了车，身着一袭浅色单衣更加突显身材挺拔，只是对比起你来穿得也太少了。

[[不摸摸莫妮卡吗]]
[[不跟其他人告别吗]]
&lt;&lt;/linkreplace&gt;&gt;</tw-passagedata><tw-passagedata pid="92" name="不摸摸莫妮卡吗" tags="" position="325,2675" size="100,100">
你想起那匹漂亮的黑马，回想它啃胡萝卜的样子，不知道是不是主人管得好的原因，它对你这个陌生人也很温驯，佩雷斯顿挑了一下眉毛，“不用，我们很快会再见的。”



[[不跟其他人告别吗]]
[[继续|出村13]]</tw-passagedata><tw-passagedata pid="93" name="不跟其他人告别吗" tags="" position="475,2675" size="100,100">“没必要，解决完你的事我就会回去汇合。”他放下佩剑，把一个袋子放在车厢地板，里头有食物，地图......还有一些看上去是女士用的衣服。




[[不摸摸莫妮卡吗]]
[[继续|出村13]]</tw-passagedata><tw-passagedata pid="94" name="出村13" tags="" position="400,2750" size="100,100">马车动了，重新进入林间小道。

“这个，”佩雷斯顿面不改色地丢来一个不明物体，你差点没接住，仔细一看原来是个皮革袋，此刻正沉甸甸地在你手里，“尽快喝掉。”

你打开软塞，果香扑鼻——是葡萄汁，惊讶混杂着些许的难为情，你下意识地问佩雷斯顿要不要喝，他只是朝你摆摆手。

于是配合着果汁，你开始吃带上车的食物，很快饱腹感浮了上来，你扎好口袋看向对面正在闭目养神的青年，犹豫再三后问道。

&lt;div id=&quot;choices&quot;&gt;
   &lt;&lt;link&quot;我要做什么检查&quot;&gt;&gt;
      &lt;&lt;replace &quot;#choices&quot;&gt;&gt;
         &lt;br&gt;
   佩雷斯顿睁开眼睛，随着他双眸一起点亮的还有车厢内的油灯，暖黄色的光晕染隐去他原本的瞳色，只余眼底波光流转。

“你可以看作是身体检查，拥有魔法天赋的人是少数，如果检查后是你的才能，无论高低你都可以接受专门的教育，如果是其他原因......神殿会负责你。”&lt;br&gt;


         [[继续询问|出村13]]
      &lt;&lt;/replace&gt;&gt;
   &lt;&lt;/link&gt;&gt;
   &lt;&lt;link&quot;关于灵魂派&quot;&gt;&gt;
     &lt;&lt;replace&quot;#choices&quot;&gt;&gt;
        &lt;br&gt;“......”佩雷斯顿安静了片刻，这是你第一次见他沉默，“只是法师中的一个流派，其余我无话可说。”&lt;br&gt;


[[继续询问|出村13]]
      &lt;&lt;/replace&gt;&gt;
   &lt;&lt;/link&gt;&gt;
      &lt;&lt;link&quot;关于信仰&quot;&gt;&gt;
      &lt;&lt;replace &quot;#choices&quot;&gt;&gt;
         &lt;br&gt;“圣血教，我们信仰血之女神瑞德米拉德，于万年前击退魔族，同时将人类的死敌吸血种灭绝，人类因此第一次迎来属于自己的黑夜，瑞德米拉德将这个特殊技艺授予了十二个人，他们便是建立圣血教的门徒......”佩雷斯顿似乎觉得自己说得太多了，“总之，你用眼睛能看见的神殿所有术式都是基于驱动血液或造血完成的，掌握血液即掌握全部，”

“而这个技艺可以施加在任何拥有‘血液’的种族。”&lt;br&gt;


         [[继续询问|出村13]]
      &lt;&lt;/replace&gt;&gt;
   &lt;&lt;/link&gt;&gt;
   &lt;&lt;link&quot;关于言灵&quot;&gt;&gt;
     &lt;&lt;replace&quot;#choices&quot;&gt;&gt;
        &lt;br&gt;这个想法只是浮现，你的大脑就如同被重击般剧烈疼痛，但幸好只是一瞬间，你的表情失控没有持续太久，佩雷斯顿只是看着你，没有发出疑问——现在最好不要向他提起这个词。&lt;br&gt;


[[......|出村14]]（选择该选项则片段结束）
      &lt;&lt;/replace&gt;&gt;
   &lt;&lt;/link&gt;&gt;
   &lt;/div&gt;</tw-passagedata><tw-passagedata pid="95" name="出村14" tags="" position="400,2825" size="100,100">旅途重回安静，你瞥见对面的青年重新闭上双眼，你重新整理斗篷调整姿势，低头时你看见那条项链散发着极淡的光，而在你发现后慢慢暗淡。

经过一段长时间的等待，你们顺利到达驿站。



[[继续|中途驿站][$hour += 8,$minute += 10]]</tw-passagedata><tw-passagedata pid="96" name="开始炼药" tags="" position="1175,625" size="100,100">目前你可以将三个草药合成一瓶药剂，药剂成品质量如何取决于你的熟练程度

你现在的水平是&lt;font color=&quot;yellow&quot;&gt;&lt;&lt;if $lianyaocishu &lt;= 20 &gt;&gt;初学者&lt;&lt;elseif $lianyaocishu &gt; 20 &amp;&amp;$lianyaocishu &lt;= 50&gt;&gt;信手掂来&lt;&lt;elseif $lianyaocishu &gt; 50 &amp;&amp;$lianyaocishu &lt;= 100&gt;&gt;专业人士&lt;&lt;elseif $lianyaocishu &gt;100 &amp;&amp;$lianyaocishu &lt;= 500&gt;&gt;大师&lt;&lt;elseif $lianyaocishu &gt;500&gt;&gt;&lt;&lt;/if&gt;&gt;&lt;/font&gt;

你现在拥有：
&lt;font color=&quot;green&quot;&gt;$qianma.dis($qianma.shu)
$longlin.dis($longlin.shu)
$zizhui.dis($zizhui.shu)
$fupen.dis($fupen.shu)
$diedou.dis($diedou.shu)
&lt;/font&gt;


&lt;&lt;nobr&gt;&gt;
&lt;&lt;set $yaoAll = $qianma.shu + $longlin.shu + $zizhui.shu + $diedou.shu + $fupen.shu&gt;&gt;
你现在一共拥有&lt;font color=&quot;green&quot;&gt;&lt;&lt;print $yaoAll&gt;&gt;&lt;/font&gt;株草药&lt;br&gt;
&lt;&lt;if $yaoAll &gt;= 3&gt;&gt;
[[开始炼药|炼药2][$lianyaocishu += 2,$hour += 3,$energy -= 30]](3:00)&lt;font color=”green”&gt;++制药技巧&lt;/font&gt;&lt;font color=”red”&gt;--体力&lt;/font&gt;
&lt;&lt;else&gt;&gt;
你持有的药草太少，还不足以进行炼药。
&lt;&lt;/if&gt;&gt;
&lt;&lt;/nobr&gt;&gt;


[[离开|魔药教室]]






[[测试|开始炼药][$lianyaocishu += 10]]
[[作弊|增加原料]]</tw-passagedata><tw-passagedata pid="97" name="none1" tags="" position="1275,825" size="100,100">:: 选择材料
你可以选择三种材料来炼制药水。请选择第一种材料：

[[荨麻根-&gt;none2][$material1 to &quot;荨麻&quot;]]
[[毒草-&gt;none2]]
[[龙鳞粉-&gt;none2]]

</tw-passagedata><tw-passagedata pid="98" name="魔药商店" tags="" position="2125,1900" size="100,100">


&lt;&lt;nobr&gt;&gt;
&lt;&lt;if $qianma.yaoshu &gt;0 &gt;&gt;[[出售荨麻根提取液|卖东西结算][$qianma.yaoshu -= 1]]&lt;&lt;/if&gt;&gt;&lt;br&gt;
&lt;&lt;if $qianma.yaoshu &gt;= 10&gt;&gt;[[出售10瓶荨麻根提取液|卖东西结算][$qianmayao -= 10]]&lt;&lt;/if&gt;&gt;&lt;br&gt;
&lt;&lt;if $qianma.yaoshu &gt;= 50&gt;&gt;[[出售50瓶荨麻根提取液|卖东西结算][$qianmayao -= 50]]&lt;&lt;/if&gt;&gt;&lt;br&gt;
&lt;&lt;if $qianma.yaoshu &gt;= 100&gt;&gt;[[出售100瓶荨麻根提取液|卖东西结算][$qianmayao -= 100]]&lt;&lt;/if&gt;&gt;&lt;br&gt;
&lt;&lt;/nobr&gt;&gt;


[[作弊+10|魔药商店][$qianma.yaoshu += 10]]</tw-passagedata><tw-passagedata pid="99" name="卖东西结算" tags="" position="2050,1775" size="100,100">

[[魔药商店]]</tw-passagedata><tw-passagedata pid="100" name="学院中" tags="" position="1675,1175" size="100,100">&lt;&lt;if 7 &lt;= $hour&amp;&amp; $hour &lt; 17&gt;&gt;
维尔弗兰的太阳交融在蓝天之中，光芒穿过远方的树林倾泻而下犹如一幅沙画。

站在阶梯面朝高处时，左侧那座位于学院心脏地带的巨大建筑便是泰西亚图书馆，庄严肃穆，右侧是返回卧室的路，会经过一个热闹喧哗的广场。学生来来往往，你加入其中，成为她们中的一员。

如果你想去教学楼，那么你应该先前往阶梯低处。
&lt;&lt;elseif 0&lt;= $hour&amp;&amp; $hour &lt;7&gt;&gt;
已经很晚了，银河铺满维尔弗兰的天空，澄澈清晰得你可以看见数以亿计的星星，但你没有找到月亮。

除了图书馆还灯火通明外没有学生活动的痕迹，虽然维尔弗兰不对学生的夜间行为做出要求，但防止打扰到你的同学，还是早点休息比较好。
&lt;&lt;elseif 17&lt;= $hour&amp;&amp; $hour &lt;22&gt;&gt;
夜幕降临，学生们显得更加兴奋，你目光所及的区域许多团体三三两两围在一起做什么实验。

阶梯散发着微弱但莹润的光芒，毕竟制造阶梯所用的材料似乎非同寻常。
&lt;&lt;else&gt;&gt;
已经很晚了，银河铺满维尔弗兰的天空，澄澈清晰得你可以看见数以亿计的星星，但你没有找到月亮。

除了图书馆还灯火通明外没有学生活动的痕迹，虽然维尔弗兰不对学生的夜间行为做出要求，但防止打扰到你的同学，还是早点休息比较好。
&lt;&lt;/if&gt;&gt;






[[往阶梯高处走|学院高]]

[[洛夫他广场][$minute += 5]](0:05)
[[泰西亚图书馆][$minute += 10]](0:10)
[[喷泉][$minute += 3]](0:03)
[[直达卧室|学院卧室][$minute += 15]](0:15)

[[往阶梯低处走|学院低][$minute += 8]](0:08)</tw-passagedata><tw-passagedata pid="101" name="泰西亚图书馆" tags="" position="1550,1100" size="100,100">建设中




[[离开|学院中]]</tw-passagedata><tw-passagedata pid="102" name="维瑟之林" tags="" position="1650,1625" size="100,100">一道看不到尽头的黑色铁门将其与外界阻隔，这上面似乎有禁制，你只是站在围栏外都能感受到扑面而来的魔法气息，很难想象这深处会有什么。你沿着铁门往西走了一段，居然发现一扇用锁铐住的门。

你翻来覆去研究这把锁，它将铁链牢牢地固定在铁门上，貌似平平无奇，如果你的诡计技巧足够，也许就可以打开这扇门。




[[离开|学院低][$minute += 10]](0:10)
&lt;&lt;if $lie &gt;= 5&gt;&gt;[[撬锁|维瑟之森里][$minute += 5]](0:05)&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="103" name="喷泉" tags="" position="1800,1075" size="100,100">这大概是一个半径五米的大型喷水池，没有任何装置，似乎纯粹依靠魔法，不知道是谁在维持这个喷泉。

周围则被绿地树木环绕，组成一个公园，你感受到各种各样的精灵栖息在这里，当空闲时你可以选择躺在草地或者长椅，非常适合休息。

你往喷泉里看，发现了不少的钱币，也许许愿时投下一枚硬币，精灵会帮你实现愿望。


[[消遣|喷泉][$minute += 15,$energy += 5]](0:15)
[[奥梅拉斯大阶梯|学院中]]</tw-passagedata><tw-passagedata pid="104" name="神殿" tags="" position="2100,400" size="100,100"></tw-passagedata><tw-passagedata pid="105" name="出村15" tags="" position="500,2800" size="100,100">随后你找到了王城，虽说是王城但更像是标记近几百年王室成员的居住地，你在三四个地方都发现了同样的标记，而现在被称为王城的巴克诺尼城正处于大陆的中心位置。

你在地图偏西发现了一片月牙形的湖，那里注释写着一段话‘精灵，不好说话的那种’，看到精灵你想起凯蒂说与你的往事，果不其然，经过一番倒腾你找到了目前仍存的兽人聚集地，不知道现如今兽人族是什么情况。
&lt;&lt;linkreplace &quot;继续&quot; &gt;&gt;
就在你开始数地图上分别有多少精灵兽人聚集地的时候，一直保持安静的佩雷斯顿突然抬起头。
&lt;&lt;linkreplace &quot;怎么了？&quot; &gt;&gt;
他神情严肃，没有回答，起身打开车门半个身子露出去向车夫喊到，“停车！”

你听见马匹因车夫勒紧缰绳而嘶鸣，哐当一声颠簸袭来，你握紧座椅才没有被甩到马车另一边。

佩雷斯顿走下马车，你也跟着想下去看看情况，他伸出手搭在门框刚好挡住你的去路。

“不要动，不要说话。”他目光注视前方，用只有你们二人才听得清的声音说。

你扶着门框感到不解，但还是照他的话去做，拉紧斗篷站在了马车门口。
&lt;&lt;linkreplace &quot;继续&quot; &gt;&gt;
“佩雷斯顿长官，久仰。”来人声音柔美，瞬息间出现在佩雷斯顿前方，你感受到一股香风袭来，你明明在车内，却闻到一抹腥且迅速被粘稠的甜味覆盖。

你稍微偏过头，能依稀看到她的身影，那人微微欠身礼数周全，全身上下都被红黑色衣料覆盖，红是主色调，鲜辛炽烈有如血液奔涌灼人眼球，而她的相貌隐藏在斗篷之下。

你发现她的胸前印着的纹章和从鲁迪身上看到的很像，是散发着光芒的太阳，这让你想起前不久听到的一个词——红牧师。
&lt;&lt;linkreplace &quot;继续&quot; &gt;&gt;
“哦？”佩雷斯顿一摆先前那副生人勿近的气场，露出了困惑的神情，黑发遮住半阖的双眸，语气起伏身体晃动都恰到好处，你看过去完全不觉得在作假。

“我不记得这次跟神殿有协作，找我何事。”

“听说雾区出现了新的遗民，我等敬遵教会，带她去接受洗礼。”

“原来如此，但我会亲自带她去。”佩雷斯顿的语气困惑但不失坚定，俨然一副正义凛然的样子，但你觉得他只是懒得再说废话了，“那是我的任务。”

“......抱歉，是我打扰了，”女子也不执着，再次躬身行礼，“替我向大团长问好，女神保佑，祝您一路顺风。”随后如鬼魅般消失在荒野中。





[[继续|出村16]]
&lt;&lt;/linkreplace&gt;&gt;
&lt;&lt;/linkreplace&gt;&gt;
&lt;&lt;/linkreplace&gt;&gt;
&lt;&lt;/linkreplace&gt;&gt;</tw-passagedata><tw-passagedata pid="106" name="出村16" tags="" position="500,2750" size="100,100">插曲过后一切又步入正轨，你坐在车上没忍住发问。
&lt;&lt;linkreplace &quot;态度这么好？&quot; &gt;&gt;
态度这么好？

你听到佩雷斯顿轻轻啧了一声，脸上难以言喻的神情一闪而过，“只是不想惹上麻烦。”

“倒是你，神殿已经知晓了你的行迹。”
&lt;&lt;linkreplace &quot;会有什么后果吗？&quot; &gt;&gt;
会有什么后果吗?

他的手随意搭在膝上，另一只手托着下巴，“取决于你，有的人进去了就不会再出来了。”

也许佩雷斯顿和神殿有着某种渊源，但你问的话想必对面的青年也绝对不会回答你。
&lt;&lt;linkreplace &quot;继续&quot; &gt;&gt;
之后的路上，哪怕是大清早你也因为久坐而犯困，逐渐的，你感受到车轮碾过的路越来越平坦，车窗外的树林也变得更加有条理，你意识到目的地应该快了。

果不其然，在马车转了个弯后，一个巨大的城门出现在你眼前，灰白色的城墙虽然布满划痕也不掩其恢弘的气势，车马行人正排着长队等待进城。
&lt;&lt;linkreplace &quot;继续&quot; &gt;&gt;
只见佩雷斯顿长腿一迈就下了车，直接拎起你落到平地后便越过焦急排队的众人直直往进行检查的官兵走去。

你连忙跟上，在一众审阅的目光中穿梭。
&lt;&lt;linkreplace &quot;不用排队吗？&quot; &gt;&gt;
不用排队吗？

佩雷斯顿督了你一眼，你以为他嘴里要蹦出什么刻薄的话，但他貌似在认真地回答，“如果你想排我不拦你。”

说着从衣兜中拿出了什么，对着几个迎面而来的士兵展示，因为察觉你们二人过于靠近而主动阻拦的士兵顿时瞪大双眼，甚至面露惊骇。
&lt;&lt;linkreplace &quot;继续&quot; &gt;&gt;
“骑......骑士？！”他们几人面面相觑，“维利城怎么了吗？”

“不，只是来借用传送阵。”

“传送阵，但......”一个年轻的士兵面露犹豫，口中念念有词立刻被另一个人捂住了嘴。

“这些事让骑士团的大人物自己解决就行，哪轮得到我们这些小的说道。”健壮的男人拉下年轻的士兵，“您沿着主道直走就行。”

连你也看得出这些人在隐瞒什么，但佩雷斯顿没有任何追究的想法，只是大踏步走入城中，“走吧。”
&lt;&lt;linkreplace &quot;继续&quot; &gt;&gt;
你跟着进城视野立刻豁然开朗，行人如织车水马龙，整齐的房屋鳞次栉比，你甚至看到年轻的男女在街上跳舞，但坏处是人太多你一晃神就摸不着佩雷斯顿的背影。

你不停在人群中穿梭以免离佩雷斯顿太远，就在你扭腰避开别人的篮子时你狠狠撞上前面人宽阔的背部，是佩雷斯顿停下来了。
&lt;&lt;linkreplace &quot;你干什么！&quot; &gt;&gt;
你干什么！

“......忘记你是女性。”他皱了一下眉，“跟不上就喊我。”

不是女性，那是什么，弱小的货物吗。你摸着被撞到的鼻子回想了过去种种，好像不无可能。但他的脚步确实慢了许多，你可以紧跟在他背后不被人群挤来挤去。




[[继续|出村17][$hour += 1]]
&lt;&lt;/linkreplace&gt;&gt;
&lt;&lt;/linkreplace&gt;&gt;
&lt;&lt;/linkreplace&gt;&gt;
&lt;&lt;/linkreplace&gt;&gt;
&lt;&lt;/linkreplace&gt;&gt;
&lt;&lt;/linkreplace&gt;&gt;
&lt;&lt;/linkreplace&gt;&gt;
&lt;&lt;/linkreplace&gt;&gt;</tw-passagedata><tw-passagedata pid="107" name="出村17" tags="" position="500,2700" size="100,100">直到走到空旷的地方你终于长舒一口气，但很快你发现这个地方有些与众不同，你感受到空气中有种细微的颤动，似雾似雨，但稍不留心这个触感就会荡然无存。

你随着佩雷斯顿走过这条街，颤动的感觉也愈发明显，路的尽头又分叉出多条路，中央是一个宽阔的圆形广场，停几十辆马车都绰绰有余，而广场中央矗立着女神像，大概三楼那么高，烈日之下你看不清她的形貌，而脚下则是大片拼花地砖。
&lt;&lt;linkreplace &quot;继续&quot; &gt;&gt;
佩雷斯顿环顾四周，然后径直往女神像左手边走，来到一个绘制了金色图案的古朴门前并开始摇铃，但无人回应，你端详了片刻，感觉这个纹路像一棵巨大的树。

“谁啊？”终于有一个小厮模样的人从门旁的接待台钻出，掀开帷布。
&lt;&lt;linkreplace &quot;继续&quot; &gt;&gt;
“这里的负责人呢。”佩雷斯顿说着，展示了一直握在手上的徽章。

“找霍顿先生？”小厮疑惑地盯着看了会，然后大惊失色翻身跃出柜台，反应和城门守卫如出一辙，“他...他在酒馆吧，我现在就找他过来！”

于是你站在街边的屋檐阴影下和佩雷斯顿一起等待。
&lt;&lt;linkreplace &quot;问门上的纹路&quot; &gt;&gt;
问门上的纹路

“奥西里斯之树，自认是正派的法师会使用这种纹章。”

你试着辨认是何种树种，但你没有掌握这方面的知识。

“也是宣誓效忠皇室的法师标配。”
&lt;&lt;linkreplace &quot;继续&quot; &gt;&gt;
你注意烈日下有两个点往这边走来。

“多少货物？”，来人斜睨着眼开始打量，“人，就两个？”

“霍顿先生，不是普通人，是骑士...”小厮拉住他的衣袖解释道，被称为霍顿的男人拽着腰带，不以为意，“一个不知打哪来的骑士，和一个乡下丫头，这就想要我开传送阵，当我这是过家家？”
&lt;&lt;linkreplace &quot;继续&quot; &gt;&gt;
你想起最初那位银发法师，虽然你对他的印象已经模糊，但大概也是个十分标致的男性，眼前这人大腹便便又傲慢的模样让你对法师这个群体有了新的认识。

思至此时你发现自己已经完全想不起那个人的脸了，一丝一毫都没剩下，你摸上那个项链，坚硬的触感还可以提醒你那不是幻觉。
&lt;&lt;linkreplace &quot;继续&quot; &gt;&gt;
“这种差事，我......”

“霍顿.肯斯特，三十岁不到便掌握传送术进阶中级，得恰斯卡大师的青睐收入门下，真是风光的过去，但不到半年就主动退学，回归故里担任法术驿员。”

佩雷斯顿突然打断那人，自顾自地开始说起来，“好巧不巧我跟那位有一面之缘，不知你的恩师听到你的近况会作何感想。”

霍顿脸色大变，一些看热闹而围过来的人也开始小声议论，你依稀听出这人仗着自己曾师从高门眼高于顶，干活纯属看人下菜，你意识到可能是佩雷斯顿被看扁了。






[[继续|出村18]]
&lt;&lt;/linkreplace&gt;&gt;
&lt;&lt;/linkreplace&gt;&gt;
&lt;&lt;/linkreplace&gt;&gt;
&lt;&lt;/linkreplace&gt;&gt;
&lt;&lt;/linkreplace&gt;&gt;
&lt;&lt;/linkreplace&gt;&gt;</tw-passagedata><tw-passagedata pid="108" name="出村18" tags="" position="500,2650" size="100,100">“或者我也可以亲自送你去首都见你老师一面，你们应该很久没见了，”佩雷斯顿把玩着那个代表骑士团的徽章，“要还是不要。”

人群议论纷纷，那人显然被戳了痛处，脸上一阵青一阵白，双手紧攒，“你......你怎么知道这些？你到底是谁？”

“你有什么资格向我提问，”像是听到什么天大的笑话，佩雷斯顿笑了，他一字一句，缓慢而清晰有力，“要，还是不要。”
&lt;&lt;linkreplace &quot;继续&quot; &gt;&gt;
“你要去哪，如......”霍顿满脸通红，拿过小厮递来的木杖。

“你去过的，你的母校。”佩雷斯顿再次打断他，指尖不知何时出现一枚闪闪发光的金币，拇指轻轻一弹，金币弹跳几次便划着圈精准滚到那人脚边。
&lt;&lt;linkreplace &quot;你怎么知道这些的？&quot; &gt;&gt;
你怎么知道这些的？

“出发时我发了信，昨晚回信到了。”佩雷斯顿敲敲你的肩膀，带你站到了广场中央。
&lt;&lt;linkreplace &quot;你谁都会调查吗？&quot; &gt;&gt;
你谁都会调查吗

“......”他的目光在你脸上停留，片刻后移开视线，“我查不到你的。”
&lt;&lt;linkreplace &quot;继续&quot; &gt;&gt;
在交谈之间，你看见广场另一头霍顿气喘吁吁，似乎筋疲力尽，只有在小厮搀扶下才能勉强起身。

传送术似乎是一个消耗极大的术法。

来不及多想，你的眼前很快被金光覆盖，你注意到原来整个广场都是法阵，陌生事物袭来让你本能地畏缩，佩雷斯顿突然伸手拉了一下你的兜帽，所以当光芒即将刺痛双眼之际，你被他的这一拽带动着低下头，只觉得帽子贴头皮贴得发紧。

这股力量转瞬即逝，你心下了然。
&lt;&lt;linkreplace &quot;到了？&quot; &gt;&gt;
到了？

你缓缓抬头，发现二人正身处一个绿荫环绕的树林，远方有许多方顶建筑，确实是学校的氛围。

直到一个坐在远方花坛旁身着素色长袍的女子注意到传送阵上的你们，她面露惊讶，下一秒就出现在你们眼前。

“您二位这是？”





[[继续|出村19]]
&lt;&lt;/linkreplace&gt;&gt;
&lt;&lt;/linkreplace&gt;&gt;
&lt;&lt;/linkreplace&gt;&gt;
&lt;&lt;/linkreplace&gt;&gt;
&lt;&lt;/linkreplace&gt;&gt;</tw-passagedata><tw-passagedata pid="109" name="出村19" tags="" position="500,2600" size="100,100">“龙语骑士团佩雷斯顿，”他说着，单手解下腰间的佩剑，退下朴素的剑鞘，银白的剑身下似乎有流光闪烁，“整出执行任务期间，事发突然，需要你的协助，达莉亚女士。”

你没见他摆弄过这把剑，所以一路上都忽略了它的存在，但说来奇怪，这把剑体积不小倒也显眼，没道理你不会注意到它。
&lt;&lt;linkreplace &quot;继续&quot; &gt;&gt;
“佩雷斯顿...您就是那位......”女人注视着，脸上浮现柔和的笑容，“这个术式散射无法作假，真是一把漂亮的迅捷剑，”女人由衷地赞叹。

“欢迎您莅临，佩雷斯顿阁下，我是这片地区的招生官达莉亚，负责指导新生。”

“我希望她能接受测试。”佩雷斯顿微微侧身，于是站在他身后的你被推入事件中心。

“现在对外开放招收的测试时间已经截至了......”

“只是截至，不是不能。”

“这......”达莉亚沉吟道，“如果这位小姐资质可以的话，当然。”
&lt;&lt;linkreplace &quot;继续&quot; &gt;&gt;
也许你沾了佩雷斯顿的光，迈进干净整洁的石径上时你这样想，但很快收回心思，如果你不集中主意很可能就跟不上她。

“只要是进行测试的都要记录在册”，穿过几个回廊后她推开一扇门，里边非常宽敞，中间是几米宽的长书桌，左右两边都有一个大书架，各色书籍整整齐齐码放在上面。

一本红色封皮的书从桌面上摇摇晃晃地飞起来，“别闹，来看一下这个孩子。”
&lt;&lt;linkreplace &quot;继续&quot; &gt;&gt;
你很难用张牙舞爪去形容一本书，但它确实如此，它不停翻动书页却发出撕破纸张的声音，不知道地还以为办公室被打砸了。

“咕咕咕咕咕咕咕......”像你按捺下捂住耳朵的冲动，什么时候啄木鸟凿木头能发出爆破音了。

“好了别闹！”招生官一只手狠狠拍向它，它摊开着在空中滴溜溜转了几圈。

随后一面完全空白的书页朝向你，你瞪大眼睛，源源不断的白光吸住你的目光，大脑一片空白，你发现自己无法转移视线。
&lt;&lt;linkreplace &quot;继续&quot; &gt;&gt;
“你好你好！”你被这玩意的突然出声吓了一条，页面开始浮上文字，你根本无法辨别，看上去单纯像是叠加几层的符号，“$magic？！！”

“这个程度的话，学习初级魔法是没有问题的，等过几年也就能接触中级了，”女人看起来很高兴，“让我想想......比如魔导具之类的，在日常生活中非常好用。”




[[继续|出村20]]
&lt;&lt;/linkreplace&gt;&gt;
&lt;&lt;/linkreplace&gt;&gt;
&lt;&lt;/linkreplace&gt;&gt;
&lt;&lt;/linkreplace&gt;&gt;</tw-passagedata><tw-passagedata pid="110" name="出村20" tags="" position="500,2550" size="100,100">“不止这个，她还需要探查一次灵魂。”

“抱歉，我对灵魂派并不精通。”

“但是魔具可以。”佩雷斯顿说着看向那本书。

“咕呱，我不会。”这本书立刻口吐人言。
&lt;&lt;linkreplace &quot;继续&quot; &gt;&gt;
“......”女人无言地拉开抽屉，拿出一个盒子，从那木盒的质感上看起来似乎十分昂贵。

她从中小心翼翼拿出一块巴掌大的黑色石头，上面密密麻麻刻满符文，第一眼望过去有些骇人。
&lt;&lt;linkreplace &quot;继续&quot; &gt;&gt;
“伸出手。”你依言照做，盈润的触感落在手心，你没感到任何不适，你觉得这只是单纯的一块石头。

“......没有反应，她身上没有任何灵魂外泄的迹象。”女人长舒一口气，发表了结论。
&lt;&lt;linkreplace &quot;继续&quot; &gt;&gt;
你抬头看向佩雷斯顿，他·的眼神让你仿佛重新回到在鸡舍前第一次见面，那冷漠且审视的目光让你再次体会到如芒在背的感觉，你背过身去。

你无法得知佩雷斯顿此刻的想法，更不用说下一步动作，这一切有如他所愿吗，或者说从一开始他所期待的到底是什么，紧张漫上你的心口。
&lt;&lt;linkreplace &quot;继续&quot; &gt;&gt;
“校内应该有传送阵可以直达银羽宫。”

“为什么要提起这个...”

“我需要带她去首都的维尔弗兰。”





[[继续|出村21]]
&lt;&lt;/linkreplace&gt;&gt;
&lt;&lt;/linkreplace&gt;&gt;
&lt;&lt;/linkreplace&gt;&gt;
&lt;&lt;/linkreplace&gt;&gt;</tw-passagedata><tw-passagedata pid="111" name="出村21" tags="" position="500,2500" size="100,100">达莉亚面露惊骇，连一直制造噪音的书都停下了翻页，你不知道为什么整个房间都陷入了寂静。

“她还不足以，“她困惑地扶住额头，”不，那里不是平民可以......”

佩雷斯顿只是保持沉默就阻断了她的话头。

“......为何您如此坚持，”她眉头紧皱，“我只希望您不要伤害到这个孩子，她才刚接触魔法，无论现在如何未来都大有可为。”

“......但现在你和她都无权拒绝。”

“虽然我无权过问，但作为老师我需要一个理由。”

“你只用把原因归咎于我。”

你感受到两个人间隐隐对峙的气氛，最后显然讨论无果，达莉亚选择让步，她叹着气把还飘在空中的书本抓住放在桌上，“但想必阁下也清楚，维尔弗兰不是想去就去的，哪怕是您也需要走正规渠道获得通行证后，我才能带您去。”
&lt;&lt;linkreplace &quot;继续&quot; &gt;&gt;
“我了解。”

听到佩雷斯顿的回复，达莉亚屈起手指敲了敲红色书本的封皮，很快一男一女两个学生模样的人推开了门，“老师你找我们？”

“你是，天呐！”其中一位似乎认出了佩雷斯顿，但很快抬手掩住嘴巴。

“是用哪种魔法可以让金属达到破坏龙族鳞片的程度？还是靠炼金术？”

“好啦，不要大惊小怪，”达莉亚每个脑袋都拍了一下，“带这位先生去联络厅。”
&lt;&lt;linkreplace &quot;继续&quot; &gt;&gt;
他们热情地凑上来，脸上挂着笑容，“请跟着我们走。”

你看着他们走出门外，希望佩雷斯顿至少跟她们多说几句。






[[继续|出村22]]
&lt;&lt;/linkreplace&gt;&gt;
&lt;&lt;/linkreplace&gt;&gt;</tw-passagedata><tw-passagedata pid="112" name="出村22" tags="" position="500,2450" size="100,100">现在室内只剩下了你和达莉亚，她微微勾起嘴角，“你应该有很多问题吧。”

&lt;div id=&quot;choices&quot;&gt;
   &lt;&lt;link&quot;关于她&quot;&gt;&gt;
      &lt;&lt;replace &quot;#choices&quot;&gt;&gt;
         &lt;br&gt;
         你向这位看上去十分年轻的女士问好，她立刻回复了你。
         
         “我也很高兴认识你。”
         
         “如你所见，我叫达莉亚，在这担任教师，研究方向与精灵相关，这世界上大大小小的的精灵可能超乎你的想象，有和人类长得相似的，有只有一粒米那么大的，甚至还有藏在书里的，”达莉亚笑盈盈，又敲了敲红色封皮的书本，“比如这位。”
&lt;br&gt;
         [[继续询问|出村22]]
      &lt;&lt;/replace&gt;&gt;
   &lt;&lt;/link&gt;&gt;
   &lt;&lt;link&quot;关于魔法教育&quot;&gt;&gt;
     &lt;&lt;replace&quot;#choices&quot;&gt;&gt;
        &lt;br&gt;
        “虽然我很想告诉你魔法的授予是平等的，所有人都能平等地分享这份力量，但事实上是一百个人中偶尔能诞生一位受眷顾的孩子，但一千个拥有才能的人里只有一位能触碰到魔法的边际......”
        
        达莉亚不禁苦笑，“而且魔法天赋极其依靠血脉的传递，岁月积淀下来的王公贵族无一例外都是强大血脉的代表，对元素有天然的亲和性，

她欲言又止，“可能这也是女神的旨意吧。”&lt;br&gt;
       [[继续询问|出村22]]
      &lt;&lt;/replace&gt;&gt;
   &lt;&lt;/link&gt;&gt;
   &lt;&lt;link&quot;关于维尔弗兰&quot;&gt;&gt;
       &lt;&lt;replace &quot;#choices&quot;&gt;&gt;
        &lt;br&gt;“而维尔弗兰是一片宏伟而美丽......不，说它自成一个宇宙也不为过，毕竟它是源头，甚至可以说是整个大陆魔法体系的源头之一，”“除了传送阵，它对外唯一的入口就在首都巴克诺尼的银羽宫，但那个入口也是术法构成的，谁也不知道它真正座落在哪里。”

“我实在无法理解佩雷斯顿阁下为什么坚持要送你去那里，”你看见达莉亚眼中的担忧，“......我见过很多学生面对天才自惭形秽，但你要记住，魔法的修行，即便是天才中的天才也容易一朝陨落。”

“这样一提再提是不是听起来像古板的老师，但无论何时，你都要想清楚自己想做的事。”

你大概理解了，你一个资质平平的人进入维尔弗兰，不亚于把一只小老鼠丢进怪物堆，而且还是一堆出生高贵的怪物。&lt;br&gt;
        [[继续询问|出村22]]
    &lt;&lt;/replace&gt;&gt;
&lt;&lt;/link&gt;&gt; 
 &lt;&lt;link&quot;关于佩雷斯顿（选择该选项则片段结束）&quot;&gt;&gt;
       &lt;&lt;replace &quot;#choices&quot;&gt;&gt;
        &lt;br&gt;“你不知道吗？”她看起来很惊讶，你表示你是从一个非常偏远的村庄来的，“这些要展开就说来话长了。”

“他现在，算是皇帝陛下身边的红人了，”“我第一次听说他的名字还是十几年前，他作为普通士兵却带领十几人的小队，在东方与邻国接壤的峡谷击退兽潮，后来也是胜仗不断，被一路提携，如今也是军功赫赫了吧，我在一些宴会上见过他出席，但这还是第一次和他面对面的打交道。”

“说实话我也好奇佩雷斯顿阁下的年纪，他看起来和我的一些学生差不多。”&lt;br&gt;
[[继续|出村23]]
    &lt;&lt;/replace&gt;&gt;
&lt;&lt;/link&gt;&gt; 
&lt;/div&gt;   


</tw-passagedata><tw-passagedata pid="113" name="出村23" tags="" position="500,2400" size="100,100">话音刚落，当事人就推门进来递来一张薄如蝉翼的纸，语气淡淡，“已经拿到了。”

你不知道他什么时候达到门口的......这个房间有隔音功能吗？
&lt;&lt;linkreplace &quot;继续&quot; &gt;&gt;
“哼...”达莉亚将小纸翻了个面，纸张碎裂化成流光消失在空中，“不要后悔。”

这句话是对你说的。你看向达莉亚，一路上她都对你很和蔼，这让你想起凯蒂。
&lt;&lt;linkreplace &quot;点头&quot; &gt;&gt;
你向她点头

“那就不劳烦你们再移步了，就在这吧。”达莉亚闭上双眼，她的褐色长发在背后无风自动。

你和佩雷斯顿脚下各自出现了一个浅白色的轮廓，随后内里逐渐被点和线填充，编织成繁复纹路，在光芒乍起的前一刻，你闭上双眼。




[[继续|入校][$minute += 30]]
&lt;&lt;/linkreplace&gt;&gt;
&lt;&lt;/linkreplace&gt;&gt;</tw-passagedata><tw-passagedata pid="114" name="中途驿站" tags="" position="400,2950" size="100,100">驿站四周环绕着茂密的树林，主屋由粗糙的木梁支撑，墙面上的划痕油渍在昏黄灯光下一时难以分辨，尽管这里非常简陋，但温暖炉火散发出的木炭香让你感到安心。
&lt;&lt;if $hour &lt;2&gt;&gt;
这里有一个不大的吧台，一个脸上带疤的男人正站在后面接待客人，也许你可以在入睡前的短暂时间和他聊聊。

佩雷斯顿不知去哪了。




[[与老板聊聊][$minute += 15]](0:15)
[[消磨时间|中途驿站][$minute += 30]](0:30)
[[去睡觉]]
&lt;&lt;else&gt;&gt;
现在已经很晚了，连老板也昏昏欲睡，佩雷斯顿披着夜色归来，看见你还在楼下时脸上的惊讶一闪而过，“赶紧去睡觉，明天还有路要走。”



[[去睡觉]]
&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="115" name="与老板聊聊" tags="" position="350,3075" size="100,100">你只是坐到柜台旁，还没想好开场白，驿站老板就放下手中的酒杯和你攀谈起来。

“欢迎你，亲爱的，你想来点什么吗，或许我可以用一杯酒换你告诉我你的名字？”没等你回答，粗犷的男人开始侃侃而谈，“只是玩笑，恕我冒犯，自我不当佣兵以来就没见过你这样小姐，你看起来相当年轻啊，十八？二十？二十二？我在你这个年纪已经混得顺风顺水，并且以为这种生活能一直持续下去，现在嘛......为什么不听听我这个老佣兵的故事，你不也是觉得无聊才坐到这儿的吗，也许你能得到一些忠告。”
“虽然好的土地都被该死的贵族霸占了，但你能做的事情还多得多，特别是打仗的时候，去深山里找宝藏，坐船飘洋过海倒货，给领主们卖命......这人间美妙得到处都是地狱，当然最刺激的还是去赌场，越大的赌场越刺激，谁不喜欢以一搏百呢？当然我是在说出老千，那一夜暴富的滋味，啧啧·，如果你足够强大，你还可以给所有人点厉害瞧瞧，要不要我传授你几招？”

“哦不，算了算了，”他哈哈大笑。

“你的男伴看起来不好惹。”







[[返回|中途驿站]]</tw-passagedata><tw-passagedata pid="116" name="去睡觉" tags="" position="475,3075" size="100,100">你上到二楼一间窄小的客房，除了床和一张桌子外什么都没有，但好消息是澡堂没有别人，你得以清洗自己并换上新的衣服.

虽然是惊心动魄的一天但身体的疲惫更加严重，你在你的单间沉沉睡去，闭眼前抽空想了想隔壁的佩雷斯顿在干什么。

而再次睁眼时，天边开始微微亮时，敲门声不绝于耳。





[[再次启程|出村14.1][$hour += 8]]</tw-passagedata><tw-passagedata pid="117" name="出村14.1" tags="" position="500,2875" size="100,100">你差不多习惯了佩雷斯顿的旅行做派，那就是能不说话就不说话，你也乐得清闲，而且你现在有事可做——那就是研究这张地图。
&lt;&lt;linkreplace &quot;继续&quot; &gt;&gt;
这是一大张黄褐色亚麻纸，边缘上的水印是一个流利的字母M，你借着上午的晨光在腿上将其展开一半。

艾里安德——即你所在的国家，作为版图上面积最大的国家，它的地图分为深色和浅色，深色说明该地有魔界生物出没，而浅色则较为安全布满城镇。整体上看地域南北方向狭长，覆盖多种地带，与许多国家交界。
&lt;&lt;linkreplace &quot;继续&quot; &gt;&gt;
你凭借昨天的记忆找到了自己所在的区域。

你正处于这个国家的南方地块边缘，也许艾登瑟村的南方已经没有别的村子了，而现在你正北上穿越平原和群山形成的深谷，而顿城在偏东的位子，你沿着国界线看，顿城再往东就是别的国家了。
&lt;&lt;linkreplace &quot;继续&quot; &gt;&gt;
你注意到纸上有写注释，字体工整流畅。你慢慢看过去并开始理解这些特殊符号的意义。

多伦多亚在地图上最为突出，有一个印刷上去的太阳符号，显眼程度超过了王城。

那里是圣血教最初，也是最伟大的神殿——或者说是教皇的所在地，处于地图西北方，从多伦多亚再往北越过几个城市就是被终年极寒的雪原冰山，往西则是大海，

你目测比较了一下距离，思考如果没有传送阵，从艾登瑟村出发去多伦多亚得花费半年还是一年。




[[继续|出村15]]
&lt;&lt;/linkreplace&gt;&gt;
&lt;&lt;/linkreplace&gt;&gt;
&lt;&lt;/linkreplace&gt;&gt;</tw-passagedata><tw-passagedata pid="118" name="入校" tags="" position="600,2025" size="100,100">这一次传送感觉似乎不太一样，迷离惝恍的，你耳边只有自己的呼吸声，感受不到时间，或者说从一开始就不存在时间的概念，你的意识浸泡在温水中慢慢上浮。

&lt;&lt;linkreplace&quot;睁开眼睛&quot;&gt;&gt;你孤身一人站在陌生的回廊，金色烛台的排布犹如漫开的水纹，这让你想起点缀在白色雏菊中的花蕊，你的五感应该不起作用，但你闻到了乳香，里面掺杂着丝丝苦味，你开始呼叫，但无人回应，你的声音在没有尽头的厅堂回荡。

你的身前身后都是高耸的拱券，在遥不可及的远方光与尘埃共舞，那会是东方吗。

&lt;&lt;linkreplace&quot;走起来&quot;&gt;&gt;你迈开双脚，亚麻色的衣摆在你身后拖曳，你抬头看向穹顶，冰冷笔触来源于万年前消弭的光辉，灾厄与新生皆被忠实记录，那正张开饕餮大口的巨兽，它有一对羊角，它有三对翅膀，它的獠牙被锁链扣住，它的血肉予谁作为赌注，远古的龙沉寂于火焰，轻歌低吟消散于风霜，生命究竟因何而诞生。

最终你走下石阶，赤脚进入圣者的花园，你跨过的圣柱会成为你的画框，一片叶子落下凝结成油彩，预示千千万万棵树的命运，在馥郁繁奢的画布中央你是最后一幕。

&lt;&lt;linkreplace&quot;走向水池&quot;&gt;&gt;你看见你的倒影，看见血液奔流不息，看见肌腹牵绕攀附，看见骨骼气泡破裂，你看见你在飞速变化，于是你轻轻抚上自己灰金色的长发，尾端被池水沾湿，你便用手指撑开舒张，编制成一绺一绺。

睫毛在苍白的皮肤上投下阴影，玻璃般的瞳孔凝视自己，你看着自己嘴唇上下翕动。

&lt;&lt;linkreplace&quot;“找到你了”&quot;&gt;&gt;&lt;font color=&quot;yellow&quot;&gt;“找到你了。”&lt;/font&gt;

你如是说道。





[[继续|入校2]]
&lt;&lt;/linkreplace&gt;&gt;
&lt;&lt;/linkreplace&gt;&gt;
&lt;&lt;/linkreplace&gt;&gt;
&lt;&lt;/linkreplace&gt;&gt;</tw-passagedata><tw-passagedata pid="119" name="入校2" tags="" position="650,2175" size="100,100">已经不是第一次这样醒来了，你试探着活动手指，用指腹感受身下柔韧的布料，你意识到自己似乎又睡过去了。

&lt;&lt;linkreplace&quot;醒来&quot;&gt;&gt;强烈的白光落入眼眶，你被激得偏过头眯起眼睛去适应，这次你躺在一个木制长椅上，而周围郁郁葱葱，温度适宜，让人完全感受不到秋天的萧瑟，你的头似乎顶到了什么东西，你猜测是长椅的把手，但触感不太像。

直到一个人影从你视野上方倾斜而来，你才意识到你顶到了谁的大腿。

视线缓缓上移，比起面貌，你先注意到了那人领结上非常醒目的黄色宝石。

“啊，嗨？”

留着栗棕色短发的青年观察着你的状态，“一时半会你我都脱不了身，只能让你睡我的外套了。”

你刚想说话，他又兴致勃勃地开口，“不过话说回来，我的地图怎么样？”

&lt;&lt;linkreplace&quot;M?&quot;&gt;&gt;M?

他看起来是得到了满意的反应，露出笑容，“很高兴你注意到了，我叫维伦。”

&lt;&lt;linkreplace&quot;那不应该是W吗&quot;&gt;&gt;那不应该是W吗？

“不觉得倒过来才是正确符号这样很惊喜吗？”维伦耸耸肩，笑容更盛，“法师最重要的是给自己添加神秘感嘛。”
&lt;div id=&quot;choices&quot;&gt;
   &lt;&lt;link&quot;表示赞同&quot;&gt;&gt;
      &lt;&lt;replace &quot;#choices&quot;&gt;&gt;
         &lt;br&gt;
        
“真不错！我第一眼看你就知道我们会很投缘！”
&lt;br&gt;
         [[询问现在的状况]]
      &lt;&lt;/replace&gt;&gt;
   &lt;&lt;/link&gt;&gt;
   &lt;&lt;link&quot;表示一般&quot;&gt;&gt;
     &lt;&lt;replace&quot;#choices&quot;&gt;&gt;
        &lt;br&gt;
       “诶诶，不要急着下结论，等你成为法师的时候感受一下就好了。”&lt;br&gt;
        [[询问现在的状况]]
      &lt;&lt;/replace&gt;&gt;
   &lt;&lt;/link&gt;&gt;
   &lt;/div&gt;
 &lt;&lt;/linkreplace&gt;&gt;
&lt;&lt;/linkreplace&gt;&gt;
&lt;&lt;/linkreplace&gt;&gt;


</tw-passagedata><tw-passagedata pid="120" name="询问现在的状况" tags="" position="650,2250" size="100,100">“怎么说呢，你可能是因为第一次接触到太浓郁的魔力而晕过去，不过也幸好你晕了这一会，不然我也找不到机会和你说话，”维伦靠上椅背，“啊哈哈，佩雷斯顿脚程是有够快的，我可是连夜加班加点才赶上。”

“他没有把你交给神殿，也不是纠察队，直奔学院就算了，甚至都到维尔弗兰了，虽然说很有他的风格......”维伦露出苦笑。

“呜啊......连我都非常好奇。”

&lt;&lt;linkreplace &quot;继续&quot; &gt;&gt;你还在消化信息，这个男人突然弓起身子，双臂支撑在膝盖上，神情严肃，“虽然你我素不相识，但我接下来说的话......你要听好，不需要现在就理解。”

“如果你留在边境那么这些你永远不需要接触到......这个国家没有表面上看着的和谐，维尔弗兰自己本身也是一种势力，并且是唯一能同时制约其他势力的地方。”

&lt;&lt;linkreplace &quot;继续&quot; &gt;&gt;“那家伙的直觉准得惊人，如果我没猜错......他希望你可以留在这，直到你有自己做出选择的能力。”

你觉得维伦话里有话。

很快维伦的表情重归灿烂，“意思是如果你拥有维尔弗兰的免死券，哪天你被不知道是谁追杀，往这跑就对了。”

“无论是神殿，皇室，联盟还是其他。”

&lt;&lt;linkreplace &quot;询问佩雷斯顿为什么要这么做&quot; &gt;&gt;“我也想知道，”维伦看上去很无可奈何，“我和他共事那么多年，他从来不按常理办事，偏偏他还总是对的，冷静地像个疯子。”

“现在佩雷斯顿已经一个人和贵族对峙去了，虽然不至于砍人，但希望他不会拿剑出来恐吓啊......”

“开玩笑的，”维伦站了起来，“准备好了吗，我们要去被找茬了。”




[[继续|入校3]]
&lt;&lt;/linkreplace&gt;&gt;
&lt;&lt;/linkreplace&gt;&gt;
&lt;&lt;/linkreplace&gt;&gt;</tw-passagedata><tw-passagedata pid="121" name="入校3" tags="" position="650,2300" size="100,100">你也跟着起身，环顾四周，这里似乎是个巨大的温室，不同品种的花竞相开放，你依稀感到魔力在此间流动。

维伦带着你走过鹅卵石小径，一个美丽的银白色宫殿屹立在苍穹之下，你几乎可以想象如果是在夜晚，它会是多么璀璨的一颗星辰。

&lt;&lt;linkreplace &quot;继续&quot; &gt;&gt;“银羽宫，漂亮吧，”在这情况下，维伦还留有余力兴奋地给你介绍。

“那可是相当久的历史了，还在希波战争以前的一个君主，得到其他国家进献的银羽鸟，那可是和独角兽并驾齐驱的魔法生物，为了世世代代圈养限制它，相当奢侈地起草建设，结果还没建好鸟跑了，连自己也被亲兄弟政变下台了。”他摊开手掌在自己脖子上比划了一下。

“后来被维尔弗兰接手，经过改建变成现在的模样，现在相当于维尔弗兰的对外接口了。”

你们很快穿过银羽宫外侧的拱门，室内富丽堂皇令人目不暇接，十余幅锦缎长旗上纹着不同的图案，整齐地挂在圆形大堂。

&lt;&lt;linkreplace &quot;继续&quot; &gt;&gt;你被这些装潢吸引了目光，直到维伦推开一扇门，宽敞的议事厅内用豪华的挂毯装饰，空气中弥漫着松木和香料的气味，长桌两侧，许多身着华贵衣袍的人围坐一起，有男有女，他们的目光时而交汇，语气低沉，佩雷斯顿身形醒目，只是穿着布衣端坐着，与这个场景格格不入。

但很快他不会是独自一人了，一身平民装束的你被维伦引导着，绕了半圈坐到一个空位上，处于佩雷斯顿的斜对面，从始至终佩雷斯顿都没有看向你，而原本还在交流的领主们都停了下来，视线聚焦于你身上，一时间议事厅静得连根针落地都清晰可闻。

如此大阵仗让你不禁心跳加速，你挺直脊背双手交叠放在膝上，你感受到自己已然成为众矢之的。

&lt;&lt;linkreplace &quot;继续&quot; &gt;&gt;维伦在你声旁小声嘀咕，“你们真是赶上好时候了，一些贵族老爷们正开会呢。”

你这才注意到维伦并没有入座，而是站在你的座位旁，他微笑着，“这里面术式太复杂了，如果我想维持隔音术只能这么做啦。”



[[继续|入校4][$minute += 30]]
&lt;&lt;/linkreplace&gt;&gt;
&lt;&lt;/linkreplace&gt;&gt;
&lt;&lt;/linkreplace&gt;&gt;</tw-passagedata><tw-passagedata pid="122" name="入校4" tags="" position="650,2350" size="100,100">“如我所言，”佩雷斯顿率先打破局面，语气平稳而有力，“我希望她可以就读维尔弗兰。”

这句话宛若一颗巨石落入浑水，扰乱原本平静的水面，暗流之下沙石涌动。

&lt;&lt;linkreplace &quot;继续&quot; &gt;&gt;“$jia，甚至只有名没有姓，来路不明的孤女，”一个相貌端庄的男人首先发话，把矛头转向先前一直保持安静的人，“佩雷斯顿阁下，你是想挑战皇帝陛下的权威吗？”

那人看着一脸斯文，嘴上却像喊宠物一样称呼你的名字。

“这只是我的个人意愿，并没有挑战陛下的意思”佩雷斯顿露出礼貌的笑容，只是这种笑在与他对峙的人眼里多半是挑衅，“不过陛下本人现在就在维兰斯堡，我不介意稍后入宫汇报时带上您一起。”

“这家伙都还没成为贵族，就急着塞人，你说这会不会有什么私情，这样至少能解释他们脸上那股臭气...”“那可笑的衣裳，这场面简直让人想要呕吐......”你听到混杂在人群中的刻薄话，你看向佩雷斯顿，他依旧面无波澜。

“嗯嗯，这里所有人你都不用在意，”维伦的声音响起。

&lt;&lt;linkreplace &quot;继续&quot; &gt;&gt;“只有你最左边那位，坐在上首的安德鲁斯伯爵，”你因为维伦的话而转移注意力，你发现被称为安德鲁斯伯爵的中年男人并没有参与贵族的讨论，只是冷冷地低下头。

“首都巴克诺尼这块领地，是他祖上归还给国王的，后面还协助维尔弗兰建设银羽宫，是少有的历史悠久且保持和王室以及维尔弗兰都交好的家族了，虽然不是领地最多的领主，但现在这张桌上是话语权最大的了。”

当你和维伦在隔音术下交谈时，其他人还在围绕着佩雷斯顿议论，没人注意到你们两个。

&lt;&lt;linkreplace &quot;继续&quot; &gt;&gt;“维尔弗兰能到如今崇高的地位，全靠各位几千年来的维护，国王陛下不曾改变，连神殿也无法......”

“格朗特大人，谨言。”

“在座各位都是承袭女神恩惠的高贵血统，实在无法认同给一个平平无奇的乡下人开先例。”

“说到底这个会就不应该开......”




[[继续|入校5]]
&lt;&lt;/linkreplace&gt;&gt;
&lt;&lt;/linkreplace&gt;&gt;
&lt;&lt;/linkreplace&gt;&gt;</tw-passagedata><tw-passagedata pid="123" name="随机抽取" tags="" position="750,200" size="100,100">&lt;&lt;set $randomNumber to random(5)&gt;&gt;&lt;&lt;if $randomNumber is 0&gt;&gt;&lt;&lt;set $jia = &quot;夏洛特&quot;&gt;&gt;“夏洛特。”&lt;&lt;elseif $randomNumber is 1&gt;&gt;&lt;&lt;set $jia = &quot;索菲娅&quot;&gt;&gt;“索菲娅。”&lt;&lt;elseif $randomNumber is 2&gt;&gt;&lt;&lt;set $jia = &quot;伊芙琳&quot;&gt;&gt;”伊芙琳。“&lt;&lt;elseif $randomNumber is 3&gt;&gt;&lt;&lt;set $jia = &quot;格蕾丝&quot;&gt;&gt;”格蕾丝。“&lt;&lt;elseif $randomNumber is 4&gt;&gt;&lt;&lt;set $jia = &quot;伊莎贝尔&quot;&gt;&gt;”伊莎贝尔。“&lt;&lt;elseif $randomNumber is 5&gt;&gt;&lt;&lt;set $jia = &quot;莉莉&quot;&gt;&gt;”莉莉。“&lt;&lt;/if&gt;&gt;

确定代号后每日增加1点术法，月末不生效。

[[换一个|随机抽取]]
[[设置完成返回|开始]]</tw-passagedata><tw-passagedata pid="124" name="入校5" tags="" position="650,2400" size="100,100">“如果我说她有筹码呢。”佩雷斯顿站起身，于此同时还将他的佩剑褪出刀鞘——然后像切豆腐一样深深扎进桌子。

“我的天......这个桌子可是一块整的精炼魔导石啊......”你听见一旁的维伦倒吸一口冷气，十分之肉疼。

&lt;&lt;linkreplace &quot;继续&quot; &gt;&gt;剑身不似骨质也不似金属，剑柄用料轻薄没有过多装饰，纹路呈细腻的波浪形，一系列设计使整一把长剑显得轻盈不失威严，你凝神观察，隐约能感受其朴实无华外表下蕴藏的力量，突然间你的世界寂静了，冰冷的风刮过你的皮肤，龙啸声排山倒海而来像钢针一样扎进你的大脑，仿佛是一种警告，你没有忍住痛苦在座位上哆嗦了一下，但其他人面色如常，除了维伦投来关切的目光没有人注意到你的异样。

你向维伦摇摇头，莫名的恐惧在胸膛肆意生长，你收回目光。

&lt;&lt;linkreplace &quot;继续&quot; &gt;&gt;“万年后首次苏醒的龙，这是用它最长的牙，请哈德兰的矮人锻造的剑，”佩雷斯顿抱臂而立，语气少有地慎重，“也是龙唯一留下的遗迹。”

“龙是无法被杀死的......你现在可能无法体会这把剑的分量，”维伦的语气里隐隐透着一股狂热，“这代表着绝对的力量，甚至是未来对整片大陆的影响力......”

你想这算不算也是一种拿剑恐吓别人的方式。

“这就是那把他自作主张锻造然后才带回国内的？”

“皇帝陛下还同意了不是吗，这把剑就顺理成章地是他的了......”

“陛下确实不是繁文缛节的人.......”

“这家伙在示威吗，可笑！”

&lt;&lt;linkreplace &quot;继续&quot; &gt;&gt;原本满堂喧闹的会议室到处皆是窃窃私语，你注意到安德鲁斯伯爵深吸一口气，挥了挥手，示意大家安静，“我们今天偶然聚集在这，不过是决定一个人的去留，”他的目光扫过每一位贵族，最终停留在你的方向。

“你又是怎么想的，霍斯提亚家的大公子，”




[[继续|入校6]]
&lt;&lt;/linkreplace&gt;&gt;
&lt;&lt;/linkreplace&gt;&gt;
&lt;&lt;/linkreplace&gt;&gt;</tw-passagedata><tw-passagedata pid="125" name="入校6" tags="" position="650,2450" size="100,100">所有人的目光投向你——或者说你身后的人。

“安德鲁斯大人，我在这只是宫廷法师维伦的身份。”维伦微笑着，应对自如，“不过我很期待这位小姐未来能成为我的学妹。”

“好，好，”安德鲁斯领主抚掌大笑，他站了起来，与佩雷斯顿并肩。

&lt;&lt;linkreplace &quot;继续&quot; &gt;&gt;“何必为难，国王陛下身边能出现佩雷斯顿这样如此优秀的年轻人，我们应该感到高兴。”

“虽然现在他只是骑士，但只要按照这个势头下去，皇帝陛下必然会给予应有的赏赐，”他亲昵地拍了拍佩雷斯顿的肩膀，“期待你加入我们的那天。”

“但既然赌上了，也不要扫各位的兴，”你听到安德鲁斯伯爵的话锋一转，你屏住呼吸。

&lt;&lt;linkreplace &quot;继续&quot; &gt;&gt;自你落座后讨论的焦点就不在你的身上，贵族的嫌恶也大都转瞬即逝——因为根本没人把你放在眼里。

“赌，那就赌这位小姐，能否在第一学期后通过德文班的筛选，”此言一出，众宾哗然，许多人止不住地摇头，“如是失败，这柄剑就交由我们处理。”

他露出惋惜的表情，但你还没反应过来。

“那是为纪念伟大创始人之一德文斯尔女士，以她为命名的班级，一年的几百名新生里只取寥寥前十五名，”维伦欲言又止，“你......你无需对此感到太大压力......”

“既然你备受二位的信任，想必是有什么过人之处。”安德鲁斯伯爵又贴心地补上几句。

&lt;&lt;linkreplace &quot;看向人群&quot; &gt;&gt;仿佛心有灵犀，你与佩雷斯顿在众人的喧嚷间目光相接，你难以复述这几天的经历，你像掉进奇异的兔子洞，这个人一路带你狂奔，从荒野到平原，从边陲村庄到王国首都。

他突然对你笑了，你看见他嘴唇翕动，距离太远你无法确认他是否发出了声音，周围的人影如潮水般褪去，他读得很慢，你有充足时间一字一字地复述。

&lt;&lt;linkreplace &quot;继续&quot; &gt;&gt;——不过如此。

&lt;&lt;linkreplace &quot;继续&quot; &gt;&gt;你也不禁笑了起来，虽然到现在你仍未知道佩雷斯顿执着的原因，但答案此时此刻似乎并不重要，你迎接所有人的目光，这是属于你的挑战。





[[我接受|入校7]]
&lt;&lt;/linkreplace&gt;&gt;
&lt;&lt;/linkreplace&gt;&gt;
&lt;&lt;/linkreplace&gt;&gt;
&lt;&lt;/linkreplace&gt;&gt;
&lt;&lt;/linkreplace&gt;&gt;</tw-passagedata><tw-passagedata pid="126" name="入校7" tags="" position="650,2500" size="100,100">“好！”安德鲁斯伯爵的目光在你和佩雷斯顿两人间游移，“那我就拭目以待了。”嘴上如此这般，但语气是毫不掩饰的胜券在握。

事已至此已成定局，骚动按捺之下，有人指责你毫无教养面露不忿，也有人看着像自讨没趣，还有人看热闹不嫌事大，但至少这个风波已经过去了。

&lt;&lt;linkreplace &quot;继续&quot; &gt;&gt;“这种场景我也是第一次见啊......”维伦长叹一口气，看着贵族们接连离开，佩服地拍了拍你的背，“插班生小姐，开始做入学准备吧。”

很快偌大的会议室只剩下三个人，“喂喂，还有你，”眼见佩雷斯顿即将迈步走出去，维伦上前一把捞住他，“别告诉我你什么都不打算跟这位小姐说。”

佩雷斯顿瞟了他一眼，维伦立刻放手，“好的好的，我明白了，”说完便先一步走出了门。

&lt;&lt;linkreplace &quot;继续&quot; &gt;&gt;一时之间二人沉默以对，你想起之前的某个片段，愈发觉得佩雷斯顿不说话时完全就是一个俊秀文静的青年。

还是他先一步打破宁静。

“我不知道你隐藏了什么，但我一定会找出来，”这话顿时让你哑口无言，佩雷斯顿转身离去，等到走到门口时又突然停下来，“之后就全靠你自己了，回见。”

&lt;&lt;linkreplace &quot;什么时候再见？&quot; &gt;&gt;什么时候再见？

“也许很久，”他侧过身，静静地看了你一会，“还会再见的。”

等佩雷斯顿离开后一段时间，你走出门外，看见维伦坐在远方的草地上朝你招手。

“他不方便，所以我来陪你一段路，”维伦不无可惜地说，“不过可能只能送你入学了，晚点我就要回岗位去了。”

&lt;&lt;linkreplace &quot;工作很忙吗？&quot; &gt;&gt;工作很忙吗？

“是啊，最近不太平的事变多了。”维伦总是故意用轻松的语气说话，你知道他不想让你担心。

“基础的生活用品维尔弗兰可以找到，制服晚点会送到你手上，如果你有一些其他需求可以去维尔弗兰外买卖。”

维伦带你走了一段路，来到银羽宫专用的传送门，像一面巨大的镜子屹立着，两侧的大理石柱雕刻着不同的花纹，若是凝神去看，平静的门又会泛起彩色波澜。

“走吧，一眨眼就到了。”





[[我接受|入校8]]
&lt;&lt;/linkreplace&gt;&gt;
&lt;&lt;/linkreplace&gt;&gt;
&lt;&lt;/linkreplace&gt;&gt;
&lt;&lt;/linkreplace&gt;&gt;</tw-passagedata><tw-passagedata pid="127" name="入校8" tags="" position="650,2550" size="100,100">首先是触觉，浓郁的魔力从四面八方将你包围，甚至你的皮肤产生一种被润湿的清凉感，你感觉自己的五感更加敏锐了。

你睁开眼睛，站在由洁白石材砌成的巨大广场，下一刻被眼前宏伟的山脉所震撼，而你不过是山脚下的一粒尘埃，数不胜数的各色建筑错落有致随着海拔增高蜿蜒而上，位于最高点的，是一座浮动的城堡，盘旋的云雾在古老的塔尖游走，你的身后则被密林和湍急的河流环绕。

“试试抬头看？”

&lt;&lt;linkreplace &quot;抬头&quot; &gt;&gt;你抬头的下一刻就陷入了一种认知错误，那是非常奇妙的体验，一旦你注视，它也会注视你，你的认知似乎就被篡改，那究竟是天空还是一片于昼日盛放的星云，抑或是两种事物的不断交替，如此精密的造物，太阳也不过小小的切片，是被无数经纬线串联的零件之一，其间蕴含的奥秘似乎毫无规章又井然有序。

但你一旦移开视线，你所掌握的知识又会重回正轨。

&lt;&lt;linkreplace &quot;继续&quot; &gt;&gt;“这是只属于维尔弗兰的太阳，而且维尔弗兰里有一句话，谁如果读懂了维尔弗兰的天，谁就能预知未来。”

“你可以在这看一会，”你跟着维伦走到旁边一棵古老的橡树下，树影斑驳，“我帮你拿点东西。”

语毕维伦脚下升起一个小小的法阵，随后消失在原地。

&lt;&lt;linkreplace &quot;继续&quot; &gt;&gt;你观察着路过的人们，现在也有不少人穿梭其间，似乎在往返于密林与学院，他们身着各色衣袍专注于自己的事情，偶有几个人向你投来好奇的目光，你想起自己现在的装束，某种意义上也挺显眼的。

没过多久维伦再一次出现，手里拿着一个包裹，“真稀奇啊，今年除了你还有一位插班生，”他一脸不可思议，“这在维尔弗兰历史上也屈指可数吧。”

“当然......维尔弗兰的规矩可是相当古板啊......毕竟法师里的呆子也不少。”

“而且还是德拉波尔长老新收的学生，因为天赋出众被推荐过来破格录取。”他看起来很费解，“德拉波尔，是我想的那个德拉波尔吗，他居然会收徒弟？”

&lt;&lt;linkreplace &quot;继续&quot; &gt;&gt;尽管维伦没有想通，但他替你感到高兴，“总之，你也算有一个伴了？”

但很快，你望着前方高耸入云的山脉不禁发问。





[[要走过去吗？|入校9]]
&lt;&lt;/linkreplace&gt;&gt;
&lt;&lt;/linkreplace&gt;&gt;
&lt;&lt;/linkreplace&gt;&gt;
&lt;&lt;/linkreplace&gt;&gt;
</tw-passagedata><tw-passagedata pid="128" name="入校9" tags="" position="650,2600" size="100,100">“哈哈，你是第一次来，我们直接传送过去吧，”维伦似乎被逗笑了，“虽然在维尔弗兰内实施传送术的魔力只需外界的一半，但也是一笔相当大的消耗，特别是对于刚接触魔法的人。”

“不过具体的，还是等你领悟了这个术式再说吧。”

&lt;&lt;linkreplace &quot;抬头&quot; &gt;&gt;一眨眼的功夫，你似乎来到了半山腰，青灰色的石墙爬满绿藤，建筑随着地势此起彼伏，放眼望去这一块几乎没有人影，可能是大部分人还在上课的原因。

“抱歉我只能送你到这，往左边就是今年女子新生住的楼栋了，至于是哪个房间，看一下一楼的书就行了，”维伦将包裹交给你，随即露出一股别有深意的笑容，“里面有一张学生守则，总之别忘了看。”

&lt;&lt;linkreplace &quot;道别&quot; &gt;&gt;于是你向他表示谢意并道别，独自一人往里走，你回头看时维伦正注视你，直到你走进高楼。

你进到一楼，宽敞的大厅里布置好几副圆桌和椅子，家具地板大多都是木制，散发着清新的味道。

&lt;&lt;linkreplace &quot;继续&quot; &gt;&gt;维伦所说的那本书非常显眼，就摊开在左边的长柜台上，你试着往后翻动了几页，但上面写满你看不懂的文字，直到你唯独看懂一行——&lt;i&gt;$jia  219&lt;/i&gt;





[[前往房间|学院房间1][$hour += 1]]
&lt;&lt;/linkreplace&gt;&gt;
&lt;&lt;/linkreplace&gt;&gt;
&lt;&lt;/linkreplace&gt;&gt;</tw-passagedata><tw-passagedata pid="129" name="学院房间1" tags="" position="775,2125" size="100,100">你来到对应的房间，对着墨绿色的门有些犯难——这上面有锁孔，但你没有钥匙。

你迟疑地握上门把手，咔哒一声，门开了一条小缝，你猜想这应该也是一种魔法。

你进入房间，装潢古典而简朴，深色的墙纸以及原木色天花板，门在房间的最左侧，门的右侧是一个大书架，上面还没摆上东西，再往右便是卫生间。

正对面一整座墙都是木制边框的玻璃门和窗帘，光线明亮，可以去往小阳台，在阳台你能俯瞰远处的风景，即使你现在还不知道那些都代表什么，你试着推了一下玻璃门，可以从两侧和中间拉开，两侧的门各对应一套单人床，衣柜以及桌椅，其中一张桌子已经摆满了书本以及软饰，那应该就是你的室友了。

你来到属于你的位子，这个包裹装的东西比你想象中要多，除了必须的日用品，你得到了两套制服，款式是：




[[短裙装|房间2][$fu =&quot;短裙装&quot;]]
[[长裙装|房间2][$fu =&quot;长裙装&quot;]]
[[裤装|房间2][$fu =&quot;裤装&quot;]]</tw-passagedata><tw-passagedata pid="130" name="房间2" tags="" position="775,2075" size="100,100">你将衣服收拾好。

随后你展开维伦留给你的纸张，比起学生守则更像一封短信，最下面署名是一个流利的字母M。

&lt;i&gt;$jia:

时间不多，首先我替佩雷斯顿祝福你入学，虽然表面上看不出来，但他心里一定会这么想的·。

之后我们大概率还会去往其他国家，冬天过后也许就能再见了。

然后是我不得不告诉你的，就是你需要付自己的学费！正常来讲入学后会一次性交完一年的费用，不过不用担心，对于平民学生，不但可以一周一交，还有一定折扣，开始几周只需500钱，之后金额会随着你学习的深入而上涨，具体多少到时候你就知道了，会在下周一开始实行。

紧迫起来吧，校园生活可不是轻松的！
                                                                                                   ——M&lt;/i&gt;
                                                                                                   
                                                                                                   
                                                                                                   
                                                                                                   
  [[继续|房间3]]                                                                                                </tw-passagedata><tw-passagedata pid="131" name="房间3" tags="" position="775,2025" size="100,100">&lt;&lt;set $hour = 19&gt;&gt;你收起信，把它放进书桌。

你继续收拾着东西并熟悉环境，然后去了卫生间清洁，不知不觉天色暗了下来，你听见外面人声逐渐嘈杂。

没过多久，一个披着大波浪卷发的女孩推开门，她似乎有所准备，看到你时并没有太过惊讶。

“你好，我叫瑟琳娜，全名是瑟琳娜.泰西亚，”她看上去十分腼腆，”我们也是刚刚在课上得知有两位插班生，你叫$jia对吧？“

&lt;&lt;linkreplace&quot;点头&quot;&gt;&gt;你点头表示正肯定。

”可以询问你的家族吗？“瑟琳娜得到回应后把拿着的书放到桌上。

&lt;&lt;linkreplace&quot;只是平民&quot;&gt;&gt;表示自己只是平民。

”平，平民？“瑟琳娜吃了一惊，反应过来后连忙捂住嘴，”哦不不不我没有其他意思！“

”总，总之先早点休息吧，明天还要上课，你应该也很紧张。“瑟琳娜涨红着脸落荒而逃了。

&lt;&lt;linkreplace&quot;继续&quot;&gt;&gt;你看着她进了洗漱间，以后和她交流的机会还有很多。

你躺在自己床上，感觉睡意上涌。

[[继续|梦][$hour += 7]]
&lt;&lt;/linkreplace&gt;&gt;
&lt;&lt;/linkreplace&gt;&gt;
&lt;&lt;/linkreplace&gt;&gt;</tw-passagedata><tw-passagedata pid="132" name="梦" tags="" position="775,1975" size="100,100">&lt;&lt;&quot;mohu1&quot;&gt;&gt;你悠悠醒转，四周伸手不见五指，你不知道现在是什么时候，外面传来某种小兽的低音。

你很快注意到他再次坐在你的床头，银色的长发非常醒目，你情不自禁地用手指勾起他落在你枕边的头发，细腻软滑，这真的是梦吗？

虽然你有多次梦中清醒的经历，但你仍然不确定眼前是现实，还是梦境。

他微微侧身，月光照拂令他的五官线条愈发柔和，眼底清澈深邃，”最近过得怎么样？“

你注视他的脸庞，便感觉仿佛一切触手可及，所有关于他的记忆浮出水面，但你有种预感，你很快会再次忘记。
&lt;div id=&quot;choices&quot;&gt;
&lt;&lt;link&quot;还不错&quot;&gt;&gt;还不错
&lt;&lt;replace &quot;#choices&quot;&gt;&gt;
&lt;br&gt;”......那真是太好了。“他笑着说，笑容犹如春风拂面。

你注意到他回答前欲言又止的模样。

&lt;&lt;linkreplace&quot;你本来想说什么？&quot;&gt;&gt;你本来想说什么？

”那不重要。“如先前一般，他用一句话就轻轻带过。

&lt;&lt;linkreplace&quot;你的名字是什么？&quot;&gt;&gt;你的名字是什么？

他看上去很惊讶，似乎是没想到你还在注意这件事，随即绽开一个笑容，”你要不要试着去找找呢，如果是你的话——“


[[继续|房间4]]
&lt;br&gt;
&lt;&lt;/linkreplace&gt;&gt;
&lt;&lt;/linkreplace&gt;&gt;
&lt;&lt;/replace&gt;&gt;
&lt;&lt;/link&gt;&gt;
&lt;&lt;link&quot;一般&quot;&gt;&gt;一般
&lt;&lt;replace &quot;#choices&quot;&gt;&gt;
&lt;br&gt;”......不必忧虑，一切都会往好的方向发展。“

你注意到他回答前欲言又止的模样。

&lt;&lt;linkreplace&quot;你本来想说什么？&quot;&gt;&gt;你本来想说什么？

”那不重要。“如先前一般，他用一句话就轻轻带过。

&lt;&lt;linkreplace&quot;你的名字是什么？&quot;&gt;&gt;你的名字是什么？

他看上去很惊讶，似乎是没想到你还在注意这件事，随即绽开一个笑容，”你要不要试着去找找呢，如果是你的话——“


[[继续|房间4]]&lt;br&gt;
&lt;&lt;/linkreplace&gt;&gt;
&lt;&lt;/linkreplace&gt;&gt;
&lt;&lt;/replace&gt;&gt;
&lt;&lt;/link&gt;&gt;
&lt;&lt;link&quot;糟糕&quot;&gt;&gt;糟糕
&lt;&lt;replace &quot;#choices&quot;&gt;&gt;
&lt;br&gt;”......这样吗......你走在正确的路上，请相信你自己。“

你注意到他回答前欲言又止的模样。

&lt;&lt;linkreplace&quot;你本来想说什么？&quot;&gt;&gt;你本来想说什么？

”那不重要。“如先前一般，他用一句话就轻轻带过。

&lt;&lt;linkreplace&quot;你的名字是什么？&quot;&gt;&gt;你的名字是什么？

他看上去很惊讶，似乎是没想到你还在注意这件事，随即绽开一个笑容，”你要不要试着去找找呢，如果是你的话——“


[[继续|房间4]]&lt;br&gt;
&lt;&lt;/linkreplace&gt;&gt;
&lt;&lt;/linkreplace&gt;&gt;
&lt;&lt;/replace&gt;&gt;
&lt;&lt;/link&gt;&gt;
&lt;/div&gt;</tw-passagedata><tw-passagedata pid="133" name="房间4" tags="" position="725,1825" size="100,100">&lt;&lt;set $hour += 5&gt;&gt;阳光从窗帘的缝隙流出，你懵懂地看向床边，那里丝毫没有人坐过的痕迹，昨夜发生的一切似乎只是你的另一场梦。

你坐起身，发觉瑟琳娜似乎在看着这边，你转向她，瑟琳娜立刻转过头去，然后才怯生生地说：”要不......我们一起走吧。“

”我们的课室在维尔弗兰的下层，走过去需要一些时间。“

你穿上了$fu校服，与瑟琳娜一起出门·，从她的叙述你得知，出了女子宿舍后需要横穿洛夫他广场，之后便会看到奥梅拉斯大阶梯，可以通过这个阶梯前往维尔弗兰不同高度，而你们的目的地教学楼处于维尔弗兰下层。



[[继续|洛夫他广场]]</tw-passagedata><tw-passagedata pid="134" name="学院高" tags="" position="1675,1075" size="100,100">你试着往上走，但无形的屏障挡住了你的去路，可能现在还不是时候。





[[往阶梯低处走|学院中]]</tw-passagedata><tw-passagedata pid="135" name="学院低" tags="" position="1675,1275" size="100,100">这里算是相当繁忙的一条路段，连接新生们的生活区和学习区，很少人会在这里停留，但如果仔细思考，不加上来教学以及进行研究的人，所有还在学习阶段的年级加起来好像也不过千人，就又感觉这似乎没那么拥挤了。

从阶梯下来正前方的哈克之门是唯一可以不借助传送的出口，你可以从那里进城。





[[往阶梯高处走|学院中][$minute += 8]](0:08)

[[教学楼|教学楼跳转不同片段][$minute += 5]](0:05)
[[维瑟之林][$minute += 10]](0:10)

[[哈克之门][$minute += 10]](0:10)</tw-passagedata><tw-passagedata pid="136" name="学院卧室" tags="" position="2050,1200" size="100,100">这是你的卧室。






[[书桌]]
[[书柜]]
[[浴室]]
[[床铺|睡眠]]

[[离开房间|女子宿舍][$minute += 5]](0:05)
[[直达奥梅拉斯大阶梯中段|学院中][$minute += 15]](0:15)</tw-passagedata><tw-passagedata pid="137" name="洛夫他广场" tags="" position="1800,1325" size="100,100">这里是学生的聚集地，偶尔一些时候会有学生在这摆摊出售自己做的道具或者魔药，维尔弗兰也不会多加干涉，但不知道是不需要还是没必要。

再往维尔弗兰太阳升起的方向走便是几十米宽的巨大阶梯，盘桓于整座维尔弗兰连通各个层级。而反方向则是学生居住的地方，根据年级不同住在不同楼栋。当然，对于庞大的维尔弗兰来说，能睡觉的地方绝对不止这一个。




[[奥梅拉斯大阶梯|学院中][$minute += 5]](0:05)
[[男子宿舍][$minute += 5]](0:05)
[[女子宿舍][$minute += 5]](0:05)</tw-passagedata><tw-passagedata pid="138" name="男子宿舍" tags="" position="1925,1300" size="100,100">建筑外表和女子没有太大区别，但没有经过允许，你不好意思再往前走了







[[离开|洛夫他广场]]</tw-passagedata><tw-passagedata pid="139" name="女子宿舍" tags="" position="1925,1125" size="100,100">你可以和这些贵女或者天之骄子打交道——或者不，这仅仅取决与你的选择。






[[洛夫他广场][$minute += 5]](0:05)
[[你的房间|学院卧室][$minute += 5]](0:05)
</tw-passagedata><tw-passagedata pid="140" name="教学楼" tags="" position="1525,1400" size="100,100">这里一共有五楼，而你的活动主要集中在第二层，楼梯处于整栋建筑的正中间，往左走是普通教室，往右走是魔药房，那里向学生全日开放，尽头就是卫生间。穿过教学楼的空中栈道会来由石阶围成的圆形区域，面积广阔适合伸展拳脚，有时下午的课会在那里进行。


[[奥梅拉斯大阶梯|学院低][$minute += 5]](0:05)

[[普通课室][$minute += 2]](0:02)
[[魔药教室][$minute += 3]](0:03)
[[中心庭院][$minute += 10]](0:10)

[[卫生间][$minute += 2]](0:02)</tw-passagedata><tw-passagedata pid="141" name="哈克之门" tags="" position="1850,1525" size="100,100">




[[银羽宫]]</tw-passagedata><tw-passagedata pid="142" name="银羽宫" tags="" position="2050,1600" size="100,100">富丽堂皇的宫殿，但大多数职能并未对你开放




[[哈克之门]]

[[巴克诺尼城]]</tw-passagedata><tw-passagedata pid="143" name="睡眠" tags="" position="2175,1325" size="100,100">这里是你的床，一整套浅色的床上用品，当你整个人钻进被褥时，你获得极大的满足感。





[[睡8个小时|睡眠][$energy += 80,$hour += 8]]
[[睡7个小时|睡眠][$energy += 70,$hour += 7]]
[[睡6个小时|睡眠][$energy += 60,$hour += 6]]
[[休息4个小时|睡眠][$energy += 40,$hour += 4]]
[[休息2个小时|睡眠][$energy += 20,$hour += 2]]
[[离开|学院卧室]]</tw-passagedata><tw-passagedata pid="144" name="书桌" tags="" position="2150,975" size="100,100">你学习必要的书会放在这里，你摊开摆好的书，开始思考想要提高哪一门的成绩。



[[学习理论][$hour += 2,$int+=2,$energy-=20]](2:00)&lt;font color=”green”&gt;+思维&lt;/font&gt;&lt;font color=”red”&gt;-体力&lt;/font&gt;
[[学习历史][$hour+=2,$know+=2,$energy-=20]](2:00)&lt;font color=”green”&gt;+知识&lt;/font&gt;&lt;font color=”red”&gt;-体力&lt;/font&gt;

[[离开座位|学院卧室]]</tw-passagedata><tw-passagedata pid="145" name="书柜" tags="" position="2150,1075" size="100,100">你还没有在这里放很多的东西。




[[来自M的信]]




[[离开|学院卧室]]</tw-passagedata><tw-passagedata pid="146" name="浴室" tags="" position="2150,1175" size="100,100">





[[沐浴]]
[[离开|学院卧室]]</tw-passagedata><tw-passagedata pid="147" name="沐浴" tags="noreturn" position="2325,1250" size="100,100">你清洁自己的身体，感到心情舒畅。






[[返回|$return]]</tw-passagedata><tw-passagedata pid="148" name="来自M的信" tags="noreturn" position="2325,1025" size="100,100">&lt;i&gt;$jia:

时间不多，首先我替佩雷斯顿祝福你入学，虽然表面上看不出来，但他心里一定会这么想的·。

之后我们大概率还会去往其他国家，冬天过后也许就能再见了。

然后是我不得不告诉你的，就是你需要付自己的学费！正常来讲入学后会一次性交完一年的费用，不过不用担心，对于平民学生，不但可以一周一交，还有一定折扣，开始几周只需500钱，之后金额会随着你学习的深入而上涨，具体多少到时候你就知道了，会在下周一开始实行。

紧迫起来吧，校园生活可不是轻松的！
                                                                                                   ——M&lt;/i&gt;
                                                                                                   
   [[返回|$return]]</tw-passagedata><tw-passagedata pid="149" name="教学楼跳转不同片段" tags="" position="1500,1250" size="100,100">&lt;&lt;if $jiaoxuelou eq 0&gt;&gt;
&lt;&lt;goto&quot;首次入学&quot;&gt;&gt;
&lt;&lt;else&gt;&gt;
&lt;&lt;goto&quot;教学楼&quot;&gt;&gt;
&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="150" name="首次入学" tags="" position="975,1450" size="100,100">&lt;&lt;set $jiaoxuelou += 1&gt;&gt;你确实有些紧张，在瑟琳娜的带领下你们顺利抵达第一节课的教室。

讲台位于最前方中央，而学生的座位呈扇形一圈圈铺开，每个独立越往后的位子越高，你摸了摸深色的桌子，惊讶地发现它的触感冰凉近乎石头，但挪动起来并不费力，因此对于学生需要时拼桌也很方便。

&lt;&lt;linkreplace&quot;继续&quot;&gt;&gt;教室现在还很空，瑟琳娜带着你坐到了靠窗的位置，窗外挂着几盆绿萝垂下长长的枝条，叶片上没有一点瑕疵。

你发觉瑟琳娜似乎不善社交，自坐下后就开始埋头看书，同级生陆陆续续进来她也没有跟任何人打招呼，相反有几个学生注意到了你的存在，向你轻轻点头。

&lt;&lt;linkreplace&quot;回应&quot;&gt;&gt;你也点头回应。

你正打算先开口和瑟琳娜聊点什么，一个后发过肩的男生坐到了你们前面靠窗的位子。

”阿尔，“瑟琳娜眼前一亮，从面前一叠书中抽出一本薄册，“这本书还给你，谢谢你的推荐，这本确实很有意思。”

&lt;&lt;linkreplace&quot;继续&quot;&gt;&gt;你没看清那是什么书，但你看清那个男生，鼻梁挺拔，五官柔和，你惊讶于他的睫毛之长，”那下册的话，等你去到图书馆再找我拿吧。”

他的声音从容不迫，似乎有一抹淡淡的疏离感。

“这位是$jia，新来的转校生之一，”瑟琳娜热情地将你介绍给他。

”阿尔布雷希特，“他向你伸出手，露出一截腕部，肌肤近乎苍白但不显得病态，尽管骨架比你大，也因为皮肤很薄而骨感，显得纤细，你握住他微凉的手。

&lt;&lt;linkreplace&quot;很高兴认识你&quot;&gt;&gt;很高兴认识你。

”因为名字太拗口了，你可以叫我阿尔。“他勾起嘴角，冰霜一般的气质消融，你感受到某种类似于人畜无害的亲近。

“阿尔是来自其他国家的交换生，所以名字在我们看来很奇怪，”瑟琳娜补充道。

“对，我是来自艾里安德南方的......”

“纳尔斯伯里。”

“啊，是的，纳尔斯伯里。”

帮阿尔回答地名的瑟琳娜耸耸肩，“是不是很奇怪，阿尔是今年新生里数一数二的，但反应总是很慢，好几次都回答不上来简单的问题。”

“因为要记的东西实在太多了，”阿尔回答，似乎并不觉得这有什么奇怪。

&lt;&lt;linkreplace&quot;继续&quot;&gt;&gt;“阿尔在图书馆工作，放学后你可以去柜台找他，”瑟琳娜对你说完，然后转向阿尔，兴奋地说，“那我今天下午找你去拿下册？”

“好的，”阿尔眉眼弯弯，保持着那副笑容，“我代表书本欢迎你。”



&lt;&lt;set $jiaoxuelou += 1&gt;&gt;

[[继续|入学]]
&lt;&lt;/linkreplace&gt;&gt;
&lt;&lt;/linkreplace&gt;&gt;
&lt;&lt;/linkreplace&gt;&gt;
&lt;&lt;/linkreplace&gt;&gt;
&lt;&lt;/linkreplace&gt;&gt;</tw-passagedata><tw-passagedata pid="151" name="入学" tags="" position="950,1600" size="100,100">&lt;&lt;set $hour = 8&gt;&gt;八点已经开始上课了，老师还没来，教室已经坐满了学生，你环顾四周，也许是从小接受的教育，也许是学期刚开始互相还不熟悉，除了个别吵闹的，大部分人都很安静。

“还有一个转校生，他似乎还没到，”瑟琳娜小声对你说，“而且据说是德拉波尔长老的学生。”

&lt;&lt;linkreplace&quot;询问关于德拉波尔&quot;&gt;&gt;询问关于德拉波尔

“他，我知道得也不多，我们都接触不到那个层级的法师，”她思索着，“我的母亲入学前跟我讲起过掌管维尔弗兰的大人物，德拉波尔是其中之一，而且他还是来自精灵族的，本身在精灵当中也有很高的威望，但据说他脾气非常古怪，没人受得了。”

“也不知道那个转校生是什么原因，能受德拉波尔长老的青睐。”

&lt;&lt;linkreplace&quot;继续&quot;&gt;&gt;瑟琳娜话音刚落，一个留着短发的女士走进课室，远远地，你和她目光交错。

“大家应该也都知道了，那么在上课之前，认识一下新同学。”她站在讲台上发言，眼神已经在注视着你。

“$jia。”

&lt;&lt;linkreplace&quot;起身&quot;&gt;&gt;你没有什么好介绍的，所以你只是简单说了自己的名字，掌声稀稀拉拉地响起。

“非常感谢，请坐吧，”她抬手示意你坐下，看了一眼钟表，“至于另外一位，是不是还没到。”

下面的学生面面相觑，一位坐在前排的男生举手回答，“似乎是的，老师。”

&lt;&lt;linkreplace&quot;继续&quot;&gt;&gt;“......那我们先上课，”她一边说一边用手指在空气滑动，前门开始绕着轴心转动。

就在门完全闭合的瞬间，一只穿着名贵皮鞋的脚抵住了门框，一道慵懒的声音响起。

&lt;&lt;linkreplace&quot;继续&quot;&gt;&gt;“稍等一下——”

一个十六七岁的少年，微卷的头发随着他的步伐跃动，领子没有扣好，外袍看起来像刚套上，一半都耷拉在臂弯，模样是相当不羁。这不禁让你想起之前的某个人，作风看起来很像。

他轻喘着气大步走进课室，丝毫没有迟到的尴尬，反而大大方方地站在讲台。

“耽误大家时间了，”他的声音不大，但刚好能让所有人都清晰地听到，“我是狄恩特，那位......德拉波尔的学生。”

——你听不出来任何他对导师的敬意，反而有种对方在按捺笑意的感觉，随性的样子连你前方一直安静看书的阿尔都不禁抬起头，眉毛皱起。

&lt;&lt;linkreplace&quot;继续&quot;&gt;&gt;“$jia。”

然后你就从他嘴里听到了自己的那个名字，狄恩特笑得眯起了眼，“好久不见，你不会忘了我吧？”

“叙旧课后再叙，现在是上课时间。”老师只是摇摇头，“回座位上去。”

你倒吸一口凉气，两张不同却又相似的面孔逐渐交叠，现在你非常确定了，这位站在讲台上吸引所有人目光的英俊少年，和自称是你叔叔的人是同一个。

&lt;&lt;linkreplace&quot;继续&quot;&gt;&gt;你看着外袍半穿半不穿的少年拾级而上，在众人的注视下坐到你身后，还丝毫不收敛地戳了戳你的背，“你还没回答我。”

“你们......认识？”瑟琳娜犹疑地探过身子问。
&lt;div id= &quot;choices&quot;&gt;
&lt;&lt;link&quot;可能&quot;&gt;&gt;
&lt;&lt;replace &quot;#choices&quot;&gt;&gt;
&lt;br&gt;“是啊，我可是救过她一命，”狄恩特眉眼弯弯，笑得不像作假。
&lt;br&gt;
[[继续|入学2]]
&lt;&lt;/replace&gt;&gt;
&lt;&lt;/link&gt;&gt;
&lt;div id= &quot;choices&quot;&gt;
&lt;&lt;link&quot;不认识&quot;&gt;&gt;
&lt;&lt;replace &quot;#choices&quot;&gt;&gt;
&lt;br&gt;“欸——”狄恩特拉长音调，“那我就是从森林里捡了一只猫咯。”
&lt;br&gt;
[[继续|入学2]]
&lt;&lt;/replace&gt;&gt;
&lt;&lt;/link&gt;&gt;
&lt;div id= &quot;choices&quot;&gt;
&lt;&lt;link&quot;我认识他叔叔&quot;&gt;&gt;
&lt;&lt;replace &quot;#choices&quot;&gt;&gt;
&lt;br&gt;狄恩特笑了，“你不会是在生气吧？”
&lt;br&gt;
[[继续|入学2]]
&lt;&lt;/replace&gt;&gt;
&lt;&lt;/link&gt;&gt;
&lt;/div&gt;
&lt;&lt;/linkreplace&gt;&gt;
&lt;&lt;/linkreplace&gt;&gt;
&lt;&lt;/linkreplace&gt;&gt;
&lt;&lt;/linkreplace&gt;&gt;
&lt;&lt;/linkreplace&gt;&gt;
&lt;&lt;/linkreplace&gt;&gt;
&lt;&lt;/linkreplace&gt;&gt;</tw-passagedata><tw-passagedata pid="152" name="入学2" tags="" position="950,1675" size="100,100">&lt;i&gt;（以下内容涉及大量设定，比较枯燥，暂时不想阅读可直接下拉最后点过，后面我会收进卧室书桌）&lt;/i&gt;

“好了，开始上课。”严厉的声音朝向这边。

你们马上坐好在自己的位子，不得不说狄恩特的出现让你心情有些微妙。

”鉴于有新人，我重新做下自我介绍，“她端正姿态，走到中间过道，”我叫瑞拉，在未来一个学期担任你们的魔法理论基础课老师。“

她徐徐扫视半个班级，鹿皮靴走在地板上发出的啪嗒声在寂静的教室中格外清脆，你感受到一股不是出于魔力，而是来自瑞拉本身的威压。

”上节课我曾谈及，人类所掌握的术式可以大致分为三类，元素术式、精灵术式、圣血术式，三种方法所实行的功能会有重合，但就如汇入大海的河流来自于天南地北，不同术式过程的实现是完全不同的，你要付出的东西也不一样。”

“元素术式顾名思义，一般分为光元素术式和普通元素术式。”

“普通元素术式通常涉及多种形态间的保持或转变，一个完善的攻击魔法——比如爆燃术，是非常典型的魔力催生 光热转化魔法，而更高阶的往往还会涉及电和风，或者直接催动一个物体本身含有的元素，但后者这类达成的条件非常严峻，实行起来相当困难。”

“正是因为一个术式涵盖范围内的元素缺一不可，所以不能纯粹独立出任何一种元素，也正因如此，你术式的开始，过程的选择，施法时间也会相应变化，以及更高昂代价，这是一个宏观动态的过程。‘最优解’往往是针对施法者个人综合情况随机应变产生的，这也是为什么世界上的术式多如牛毛，而写进教科书授予你们的却不多。“

说到这里，瑞拉露出她今天第一个微笑，”只会死读书的人是成不了优秀的法师的。“&lt;font color=&quot;green&quot;&gt;++思维&lt;/font&gt;&lt;&lt;set $int += 3&gt;&gt;


[[继续|入学3]]



</tw-passagedata><tw-passagedata pid="153" name="加点" tags="widget" position="1275,25" size="100,100"></tw-passagedata><tw-passagedata pid="154" name="炼药变量" tags="" position="1175,1050" size="100,100">::炼药相关
&lt;&lt;set $lianyaocishu = 0&gt;&gt;

&lt;&lt;set $material1 to &quot;&quot;&gt;&gt;  &lt;!-- 第一种材料 --&gt;
&lt;&lt;set $material2 to &quot;&quot;&gt;&gt;  &lt;!-- 第二种材料 --&gt;
&lt;&lt;set $material3 to &quot;&quot;&gt;&gt;  &lt;!-- 第三种材料 --&gt;
&lt;&lt;set $potionResult to &quot;&quot;&gt;&gt;  &lt;!-- 药水结果 --&gt;
&lt;&lt;set $alchemySkill to 40&gt;&gt;  &lt;!-- 炼药技能 (例如：50) --&gt;
&lt;&lt;set $moyao to []&gt;&gt;
&lt;&lt;set $arraysAreEqual to []&gt;&gt;
&lt;&lt;set $yaoAll to 0&gt;&gt;


&lt;&lt;set $prizeyao = [$qianma, $longlin]&gt;&gt;
&lt;!-- 1.荨麻根 2.龙鳞粉 3.覆盆子叶(占卜) 4.蝶豆花 
        5.斯氏龙莲(解毒) 6.紫锥菊 7.鸢尾花--&gt;

&lt;&lt;set $weizhi = 0&gt;&gt;
&lt;&lt;set $qianma = {dis: &quot;荨麻根&quot;, money: 10,shu: 0, yaodis:&quot;荨麻根提取液&quot; ,yaoshu: 0 ,yaomoney: 50}&gt;&gt;
&lt;&lt;set $longlin = {dis:&quot;龙鳞粉&quot;, money: 10, shu: 0, yaodis:&quot;非常一般的药水&quot; ,yaoshu: 0, yaomoney: 20}&gt;&gt;
&lt;&lt;set $fupen = {dis: &quot;覆盆子叶&quot;, money: 20, shu: 0, yaodis:&quot;覆盆子叶提取液&quot; ,yaoshu: 0, yaomoney: 80}&gt;&gt;
&lt;&lt;set $diedou = {dis: &quot;蝶豆花&quot;, money: 30,shu: 0, yaodis:&quot;蝶豆花提取液&quot; ,yaoshu: 0 ,yaomoney: 150}&gt;&gt;
&lt;&lt;set $zizhui = {dis: &quot;紫锥菊&quot;, money: 100,shu: 0, yaodis:&quot;紫锥菊浸膏&quot; ,yaoshu: 0 ,yaomoney: 300}&gt;&gt;


&lt;!-- 洋蓟--&gt;</tw-passagedata><tw-passagedata pid="155" name="战斗变量" tags="" position="1975,2025" size="100,100">&lt;&lt;set $health to 100&gt;&gt;  &lt;!-- 玩家初始生命值 --&gt;
&lt;&lt;set $attack to 20&gt;&gt;   &lt;!-- 玩家初始攻击力 --&gt;
&lt;&lt;set $attackLow to 1&gt;&gt;
&lt;&lt;set $defense to 10&gt;&gt;  &lt;!-- 玩家初始防御力 --&gt;

&lt;&lt;set $enemy_health to 50&gt;&gt;  &lt;!-- 敌人初始生命值 --&gt;
&lt;&lt;set $enemy_attack to 15&gt;&gt;   &lt;!-- 敌人初始攻击力 --&gt;

&lt;&lt;set $floor = 1&gt;&gt;
&lt;&lt;set $randomNumber = 0&gt;&gt;
&lt;&lt;set $fightNumber = 0&gt;&gt;
&lt;&lt;set $enemyadd = 0&gt;&gt;
&lt;&lt;set $shenbei = 1&gt;&gt;
&lt;&lt;set $guiji = 1&gt;&gt;

&lt;&lt;set $boss to []&gt;&gt;
&lt;&lt;set $enemy to [
    [&quot;波尔斯维尔&quot;, 9999, 999],
    [&quot;芬里尔&quot;,9999 ,999 ],
    [&quot;欧洛基尔&quot;,9999 ,999 ],
]&gt;&gt;</tw-passagedata><tw-passagedata pid="156" name="none2" tags="" position="1275,850" size="100,100">:: 选择材料2
你选择了第一种材料。现在，选择第二种材料：

 &lt;!-- 记录玩家选择的材料 --&gt;

[[荨麻根-&gt;none3][$material2 to &quot;荨麻&quot;]]
[[毒草-&gt;none3]]
[[龙鳞粉-&gt;none3]]</tw-passagedata><tw-passagedata pid="157" name="none3" tags="" position="1275,875" size="100,100">:: 选择材料3
你选择了第二种材料。现在，选择第三种材料：

 &lt;!-- 记录第二种材料 --&gt;

[[荨麻根-&gt;炼药][$material3 to &quot;荨麻&quot;]]
[[毒草-&gt;炼药]]
[[龙鳞粉-&gt;炼药]]</tw-passagedata><tw-passagedata pid="158" name="炼药" tags="" position="1275,900" size="100,100">:: 炼药
你开始将三种材料混合在一起，并在炼药炉上加热。

 &lt;!-- 假设玩家选择了龙鳞粉作为第三种材料 --&gt;

&lt;&lt;set $alchemyChance to random(1, 100)&gt;&gt;  &lt;!-- 随机决定炼药成功的几率 --&gt;
&lt;&lt;set $success to false&gt;&gt;  &lt;!-- 初始状态：炼药失败 --&gt;

&lt;&lt;if $alchemyChance &gt; $alchemySkill&gt;&gt;
    由于炼药技能不足，药水未能成功炼制。
    &lt;&lt;set $potionResult to &quot;失败的药水&quot;&gt;&gt;
&lt;&lt;else&gt;&gt;
    你成功地炼制了一瓶药水，药水效果如下：
    &lt;&lt;if $material1 is &quot;荨麻&quot; and $material2 is &quot;荨麻&quot; and $material3 is &quot;荨麻&quot;&gt;&gt;
        &lt;&lt;set $potionResult to &quot;荨麻根药水&quot;&gt;&gt;  &lt;!-- 组合特定效果 --&gt;
    &lt;&lt;elseif $material1 is &quot;草药&quot; and $material2 is &quot;草药&quot; and $material3 is &quot;龙鳞粉&quot;&gt;&gt;
        &lt;&lt;set $potionResult to &quot;生命恢复药水&quot;&gt;&gt;  &lt;!-- 另一种组合的效果 --&gt;
    &lt;&lt;elseif $material1 is &quot;毒草&quot; and $material2 is &quot;毒草&quot; and $material3 is &quot;龙鳞粉&quot;&gt;&gt;
        &lt;&lt;set $potionResult to &quot;剧毒药水&quot;&gt;&gt;  &lt;!-- 特别的毒药效果 --&gt;
    &lt;&lt;else&gt;&gt;
        &lt;&lt;set $potionResult to &quot;未知药水&quot;&gt;&gt;  &lt;!-- 其他未知组合 --&gt;
    &lt;&lt;endif&gt;&gt;
&lt;&lt;endif&gt;&gt;

你得到了：&lt;&lt;print $potionResult&gt;&gt;。

[[查看药水效果-&gt;查看效果]]</tw-passagedata><tw-passagedata pid="159" name="查看效果" tags="" position="1275,925" size="100,100">:: 查看效果
&lt;&lt;if $potionResult is &quot;生命恢复药水&quot;&gt;&gt;
    这瓶药水可以恢复你的生命。你喝下去后，感到精神焕发，恢复了20点生命值。
    &lt;&lt;set $health to $health + 20&gt;&gt;
&lt;&lt;elseif $potionResult is &quot;荨麻根药水&quot;&gt;&gt;
    可以拿来交易也可以自己使用
&lt;&lt;elseif $potionResult is &quot;剧毒药水&quot;&gt;&gt;
    喝下这瓶药水后，你感到剧烈的痛苦，失去了30点生命值。
    &lt;&lt;set $health to $health - 30&gt;&gt;
&lt;&lt;elseif $potionResult is &quot;毒性恢复药水&quot;&gt;&gt;
    这瓶药水可以缓解中毒的效果，恢复了你50点的毒抗。
    &lt;&lt;set $antidote to $antidote + 50&gt;&gt;
&lt;&lt;else&gt;&gt;
    这瓶药水并没有什么效果，看起来是失败的。
&lt;&lt;endif&gt;&gt;

[[结束|开始炼药]]</tw-passagedata><tw-passagedata pid="160" name="天气变化" tags="" position="1350,25" size="100,100">::天气变化
&lt;!-- 处理季节的情况 --&gt;
&lt;&lt;if $month is 1 || $month is 2 || $month is 3&gt;&gt;
 &lt;&lt;set $Season = &quot;春季&quot;&gt;&gt;
&lt;&lt;elseif $month is 4 || $month is 5 || $month is 6&gt;&gt;
&lt;&lt;set $Season = &quot;夏季&quot;&gt;&gt;
&lt;&lt;elseif $month is 7 || $month is 8 || $month is 9&gt;&gt;
&lt;&lt;set $Season = &quot;秋季&quot;&gt;&gt;
&lt;&lt;elseif $month is 10 || $month is 11|| $month is 12&gt;&gt;
&lt;&lt;set $Season = &quot;冬季&quot;&gt;&gt;
&lt;&lt;/if&gt;&gt; 

&lt;!-- 处理天气的情况 --&gt;
&lt;&lt;if $month &lt;= 3&gt;&gt; 
    &lt;!-- 春季：1月、2月、3月 --&gt;
    &lt;&lt;set $Weather = [&quot;晴天&quot;, &quot;多云&quot;, &quot;阴天&quot;, &quot;小雨&quot;, &quot;大雨&quot;, &quot;浓雾&quot;, &quot;薄雾&quot;]&gt;&gt;
&lt;&lt;elseif $month &lt;= 6&gt;&gt; 
    &lt;!-- 夏季：4月、5月、6月 --&gt;
    &lt;&lt;set $Weather = [&quot;晴天&quot;, &quot;多云&quot;, &quot;阴天&quot;, &quot;小雨&quot;, &quot;大雨&quot;, &quot;暴雨&quot;]&gt;&gt;
&lt;&lt;elseif $month &lt;= 9&gt;&gt; 
    &lt;!-- 秋季：7月、8月、9月 --&gt;
    &lt;&lt;set $Weather = [&quot;晴天&quot;, &quot;多云&quot;, &quot;阴天&quot;, &quot;小雨&quot;, &quot;大雨&quot;, &quot;浓雾&quot;, &quot;薄雾&quot;]&gt;&gt;
&lt;&lt;elseif $month &lt;= 12&gt;&gt; 
    &lt;!-- 冬季：10月、11月、12月 --&gt;
    &lt;&lt;set $Weather = [&quot;晴天&quot;, &quot;多云&quot;, &quot;阴天&quot;, &quot;小雪&quot;, &quot;大雪&quot;, &quot;暴雪&quot;]&gt;&gt;
&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="161" name="炼药2" tags="" position="1375,625" size="100,100">:: 选择材料
你可以选择三种材料来炼制药水。请选择第一种材料：

&lt;&lt;nobr&gt;&gt;
&lt;&lt;if $qianma.shu &gt;0 &gt;&gt;[[荨麻根-&gt;选择材料2][$moyao.push(1),$material1 to &quot;荨麻根&quot;,$qianma.shu -= 1]]&lt;&lt;/if&gt;&gt;&lt;br&gt;
&lt;&lt;if $longlin.shu &gt; 0&gt;&gt;[[龙鳞粉-&gt;选择材料2][$moyao.push(2),$material1 to &quot;龙鳞粉&quot;,$longlin.shu -= 1]]&lt;&lt;/if&gt;&gt;&lt;br&gt;
&lt;&lt;if $fupen.shu &gt; 0&gt;&gt;[[覆盆子叶-&gt;选择材料2][$moyao.push(3),$material1 to &quot;覆盆子叶&quot;,$fupen.shu -= 1]]&lt;&lt;/if&gt;&gt;&lt;br&gt;
&lt;&lt;if $diedou.shu &gt; 0&gt;&gt;[[蝶豆花-&gt;选择材料2][$moyao.push(4),$material1 to &quot;蝶豆花&quot;,$diedou.shu -= 1]]&lt;&lt;/if&gt;&gt;&lt;br&gt;
&lt;&lt;if $zizhui.shu &gt; 0&gt;&gt;[[紫锥菊-&gt;选择材料2][$moyao.push(6),$material1 to &quot;紫锥菊&quot;,$zizhui.shu -=1]]&lt;&lt;/if&gt;&gt;&lt;br&gt;
&lt;&lt;/nobr&gt;&gt;
</tw-passagedata><tw-passagedata pid="162" name="选择材料2" tags="" position="1375,675" size="100,100">:: 选择材料2
你选择了第一种材料$material1。现在，选择第二种材料：

 &lt;!-- 记录玩家选择的材料 --&gt;

&lt;&lt;nobr&gt;&gt;
&lt;&lt;if $qianma.shu &gt;0 &gt;&gt;[[荨麻根-&gt;选择材料3][$moyao.push(1),$material2 to &quot;荨麻根&quot;,$qianma.shu -= 1]]&lt;&lt;/if&gt;&gt;&lt;br&gt;
&lt;&lt;if $longlin.shu &gt; 0&gt;&gt;[[龙鳞粉-&gt;选择材料3][$moyao.push(2),$material2 to &quot;龙鳞粉&quot;,$longlin.shu -= 1]]&lt;&lt;/if&gt;&gt;&lt;br&gt;
&lt;&lt;if $fupen.shu &gt; 0&gt;&gt;[[覆盆子叶-&gt;选择材料3][$moyao.push(3),$material2 to &quot;覆盆子叶&quot;,$fupen.shu -= 1]]&lt;&lt;/if&gt;&gt;&lt;br&gt;
&lt;&lt;if $diedou.shu &gt; 0&gt;&gt;[[蝶豆花-&gt;选择材料3][$moyao.push(4),$material2 to &quot;蝶豆花&quot;,$diedou.shu -= 1]]&lt;&lt;/if&gt;&gt;&lt;br&gt;
&lt;&lt;if $zizhui.shu &gt; 0&gt;&gt;[[紫锥菊-&gt;选择材料3][$moyao.push(6),$material2 to &quot;紫锥菊&quot;,$zizhui.shu -=1]]&lt;&lt;/if&gt;&gt;&lt;br&gt;
&lt;&lt;/nobr&gt;&gt;
</tw-passagedata><tw-passagedata pid="163" name="选择材料3" tags="" position="1375,750" size="100,100">:: 选择材料3
第一种材料是$material1，你选择了第二种材料$material2。现在，选择第三种材料：

 &lt;!-- 记录第二种材料 --&gt;

&lt;&lt;nobr&gt;&gt;
&lt;&lt;if $qianma.shu &gt;0 &gt;&gt;[[荨麻根|炼药条件判断跳转][$moyao.push(1),$material3 to &quot;荨麻根&quot;,$qianma.shu -= 1]]&lt;&lt;/if&gt;&gt;&lt;br&gt;
&lt;&lt;if $longlin.shu &gt; 0&gt;&gt;[[龙鳞粉|炼药条件判断跳转][$moyao.push(2),$material3 to &quot;龙鳞粉&quot;,$longlin.shu -= 1]]&lt;&lt;/if&gt;&gt;&lt;br&gt;
&lt;&lt;if $fupen.shu &gt; 0&gt;&gt;[[覆盆子叶|炼药条件判断跳转][$moyao.push(3),$material3 to &quot;覆盆子叶&quot;,$fupen.shu -= 1]]&lt;&lt;/if&gt;&gt;&lt;br&gt;
&lt;&lt;if $diedou.shu &gt; 0&gt;&gt;[[蝶豆花|炼药条件判断跳转][$moyao.push(4),$material3 to &quot;蝶豆花&quot;,$diedou.shu -= 1]]&lt;&lt;/if&gt;&gt;&lt;br&gt;
&lt;&lt;if $zizhui.shu &gt; 0&gt;&gt;[[紫锥菊|炼药条件判断跳转][$moyao.push(6),$material3 to &quot;紫锥菊&quot;,$zizhui.shu -=1]]&lt;&lt;/if&gt;&gt;&lt;br&gt;
&lt;&lt;/nobr&gt;&gt;</tw-passagedata><tw-passagedata pid="164" name="炼药3" tags="" position="1575,875" size="100,100">&lt;&lt;print $moyao&gt;&gt;你使用的材料及顺序是，$material1、$material2、$material3




&lt;&lt;set $alchemyChance to random(1, 100)&gt;&gt;  &lt;!-- 随机决定炼药成功的几率 --&gt;
&lt;&lt;set $success to false&gt;&gt;  &lt;!-- 初始状态：炼药失败 --&gt;

&lt;&lt;if $alchemyChance &gt; $alchemySkill&gt;&gt;
    由于炼药技能不足，药水未能成功炼制。
    &lt;&lt;set $potionResult to &quot;失败的药水&quot;&gt;&gt;
    
&lt;&lt;else&gt;&gt;
&lt;&lt;set $arraysAreEqual to function(a, b) { if (a.length !== b.length) return false;
    for (var i = 0; i &lt; a.length; i++) { if (a[i] !== b[i]) return false; } return true;}&gt;&gt;

&lt;&lt;if $arraysAreEqual($moyao, $pf1)&gt;&gt;
你获得了$qianma.yaodis！
&lt;&lt;elseif $arraysAreEqual($moyao, $pf2)&gt;&gt;
你获得了龙鳞荨麻混合提取液！
&lt;&lt;else&gt;&gt;
你获得了普通药水，它没有什么用处。&lt;&lt;set $my0.shu += 1&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;/if&gt;&gt;


[[返回|开始炼药]]</tw-passagedata><tw-passagedata pid="165" name="炼药条件判断跳转" tags="" position="1500,800" size="100,100">&lt;&lt;set $lianyaocishu += 1&gt;&gt;
&lt;&lt;set $alchemySkill += 1&gt;&gt;
&lt;&lt;if $moyao.indexOf(6) !== -1&gt;&gt;
    &lt;&lt;goto&quot;含紫锥菊&quot;&gt;&gt;
&lt;&lt;else&gt;&gt;
    &lt;&lt;goto&quot;炼药3&quot;&gt;&gt;
&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="166" name="含紫锥菊" tags="" position="1575,725" size="100,100">&lt;&lt;print $moyao&gt;&gt;你使用的材料及顺序是，$material1、$material2、$material3


&lt;&lt;set $alchemyChance to random(1, 100)&gt;&gt;  &lt;!-- 随机决定炼药成功的几率 --&gt;
&lt;&lt;set $success to false&gt;&gt;  &lt;!-- 初始状态：炼药失败 --&gt;
&lt;&lt;set $alchemySkill = $alchemySkill += $lianyaocishu&gt;&gt;
&lt;&lt;if $alchemyChance &gt;= $alchemySkill&gt;&gt;
    由于炼药技能不足，药水未能成功炼制。
    &lt;&lt;set $potionResult to &quot;失败的药水&quot;&gt;&gt;
    
&lt;&lt;else&gt;&gt;
&lt;&lt;set $arraysAreEqual to function(a, b) { if (a.length !== b.length) return false;
    for (var i = 0; i &lt; a.length; i++) { if (a[i] !== b[i]) return false; } return true;}&gt;&gt;

&lt;&lt;if $arraysAreEqual($moyao, $pf3)&gt;&gt;
你获得了紫锥花浸膏！&lt;&lt;set $zizhui.yaoshu += 1&gt;&gt;
&lt;&lt;elseif $arraysAreEqual($moyao, $pf4)&gt;&gt;
你获得了初级生命回复药水！&lt;&lt;set $my4.shu += 1&gt;&gt;
&lt;&lt;elseif $arraysAreEqual($moyao, $pf5)&gt;&gt;
你获得了中级生命回复药水！&lt;&lt;set $my5.shu += 1&gt;&gt;
&lt;&lt;else&gt;&gt;
你获得了含紫锥菊的普通药水，但它没有什么用处。&lt;&lt;set $my0zizhui.shu += 1&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;/if&gt;&gt;

[[返回|开始炼药]]</tw-passagedata><tw-passagedata pid="167" name="药方列表" tags="" position="1275,1050" size="100,100">::药方列表

&lt;!-- 1.荨麻根 2.龙鳞粉 3.覆盆子叶(占卜) 4.蝶豆花 
        5.斯氏龙莲(解毒) 6.紫锥菊 7.--&gt;

&lt;&lt;set $pf1 to [1, 1, 1]&gt;&gt;
&lt;&lt;set $pf2 to [1, 2, 1]&gt;&gt;
&lt;&lt;set $my2 = {dis: &quot;龙鳞荨麻混合提取液&quot; ,shu: 0 ,money: 50}&gt;&gt;

&lt;!-- 含紫锥菊配方--&gt;
&lt;&lt;set $pf3 to [6, 6, 6]&gt;&gt;
&lt;&lt;set $pf4 to [6, 1, 1]&gt;&gt;
&lt;&lt;set $my4 ={dis: &quot;初级生命回复药水&quot; ,shu: 0 ,money:150 ,add:50 }&gt;&gt;
&lt;&lt;set $pf5 to [6, 1, 6]&gt;&gt;
&lt;&lt;set $my5 ={dis: &quot;中级生命回复药水&quot; ,shu: 0 ,money:250 ,add:100}&gt;&gt;

&lt;!-- 普通药水--&gt;
&lt;&lt;set $my0 = {dis:&quot;普通药水&quot; ,shu: 0 ,money:20 ,add: 10}&gt;&gt;
&lt;&lt;set $my0zizhui = {dis:&quot;普通药水&quot; ,shu: 0 ,money:110 ,add: 10}&gt;&gt;</tw-passagedata><tw-passagedata pid="168" name="增加原料" tags="" position="1275,700" size="100,100">全部+1
&lt;&lt;set $qianma.shu += 1&gt;&gt;
&lt;&lt;set $longlin.shu += 1&gt;&gt;
&lt;&lt;set $fupen.shu += 1&gt;&gt;
&lt;&lt;set $fupen.shu += 1&gt;&gt;
&lt;&lt;set $diedou.shu += 1&gt;&gt;
&lt;&lt;set $zizhui.shu += 1&gt;&gt;




[[返回|开始炼药]]</tw-passagedata><tw-passagedata pid="169" name="巴克诺尼城" tags="" position="2200,1700" size="100,100">繁华的首都街道，行人如织，商贸繁盛，售卖的东西繁多——价格也很触目惊心。而城市的另一头则是目前皇室所在的居住地，离这里还有相当远的一段距离



[[银羽宫]]

[[利夫药店]]
[[传送驿站|皇城站]]</tw-passagedata><tw-passagedata pid="170" name="皇城站" tags="" position="2350,1625" size="100,100">提供传送服务，费用高昂，




北方站点


南方站点
[[维利城]]


[[]]</tw-passagedata><tw-passagedata pid="171" name="维利城" tags="" position="2300,2025" size="100,100"></tw-passagedata><tw-passagedata pid="172" name="22" tags="" position="1700,2300" size="100,100">阿尔克那二十二试炼

你的初始血量固定一百，攻击力数值上继承力量

权杖——进行攻击
圣杯——防御和恢复
刃剑——精灵驻地，可能获得随机加成或物品，一次战斗内仅能使用一次
财富——使用诡计，一次战斗内仅能使用一次，能提高诡计技巧


[[进入战斗-&gt;战斗条件跳转][$hour+=4]](4:00)
[[离开|维瑟深]]</tw-passagedata><tw-passagedata pid="173" name="战斗" tags="" position="1875,2125" size="100,100">:: 战斗
&lt;&lt;nobr&gt;&gt;
&lt;&lt;set $shenbei = 1&gt;&gt;
&lt;&lt;set $guiji = 1&gt;&gt;
&lt;&lt;set $attack = $body&gt;&gt;
&lt;&lt;/nobr&gt;&gt;
&lt;&lt;if $fightNumber &lt;= 3&gt;&gt;
  &lt;&lt;set $randomNumber to random(10)&gt;&gt;
         &lt;&lt;if $randomNumber &gt;  4&gt;&gt;
  你和敌人正面交战！
  敌人生命值：&lt;&lt;print $enemy_health&gt;&gt;，攻击力：&lt;&lt;print $enemy_attack&gt;&gt;。
  你的生命值：&lt;&lt;print    $health&gt;&gt;，你的攻击力：&lt;&lt;print $attack&gt;&gt;。

  [[权杖-&gt;攻击]]  
  [[圣杯-&gt;防御]]
  &lt;&lt;if $shenbei == 1&gt;&gt;[[刃剑-&gt;随机加成]]&lt;&lt;/if&gt;&gt;
  &lt;&lt;if $guiji == 1&gt;&gt; [[财富-&gt;使用诡计]]&lt;&lt;/if&gt;&gt;
  &lt;&lt;else&gt;&gt;
  你进入一个奇怪的房间，虽然气氛很不妙，但这里没有敌人。


  [[进入-&gt;奖励层]]
 
             &lt;&lt;/if&gt;&gt;
&lt;&lt;else&gt;&gt;
&lt;&lt;goto&quot;boss战条件判定&quot;&gt;&gt;
&lt;&lt;/if&gt;&gt;
</tw-passagedata><tw-passagedata pid="174" name="攻击" tags="" position="1925,2450" size="100,100">:: 攻击
&lt;&lt;set $enemy_health to $enemy_health -= random($attackLow, $attack)&gt;&gt; &lt;!-- 玩家攻击敌人 --&gt;
&lt;&lt;set $health to $health -= random(1, $enemy_attack)&gt;&gt; &lt;!-- 敌人反击 --&gt;
&lt;&lt;if $enemy_health &lt;= 0&gt;&gt;&lt;&lt;set $enemy_health = 0&gt;&gt;&lt;&lt;/if&gt;&gt;
 你和敌人正面交战！
 敌人生命值：&lt;&lt;print $enemy_health&gt;&gt;，攻击力：&lt;&lt;print $enemy_attack&gt;&gt;。
 你的生命值：&lt;&lt;print    $health&gt;&gt;，你的攻击力：&lt;&lt;print $attack&gt;&gt;。
&lt;&lt;if $enemy_health &lt;= 0&gt;&gt;
    你击败了敌人！你继续前进。
    &lt;&lt;set $enemy_health to random(30, 60)&gt;&gt; &lt;!-- 新敌人 --&gt;
    &lt;&lt;set $enemy_attack to $enemy_attack += random(10, 15)&gt;&gt;
    &lt;&lt;set $attack to $attack += random(10, 20)&gt;&gt;  &lt;!-- 提升攻击力 --&gt;
    &lt;&lt;set $defense to $defense += random(10, 20)&gt;&gt; &lt;!-- 提升防御力 --&gt;
    &lt;&lt;set $shenbei = 1&gt;&gt;&lt;&lt;set $guiji = 1&gt;&gt;
    [[继续前进-&gt;战斗][$fightNumber += 1]]
&lt;&lt;elseif $health &lt;= 0&gt;&gt;
    你被击败了。游戏结束。
    &lt;&lt;goto&quot;结局判定&quot;&gt;&gt;
&lt;&lt;else&gt;&gt;
    继续战斗。
    [[权杖-&gt;攻击]]  
    [[圣杯-&gt;防御]]
   &lt;&lt;if $shenbei == 1&gt;&gt; [[刃剑-&gt;随机加成]]&lt;&lt;/if&gt;&gt;
   &lt;&lt;if $guiji == 1&gt;&gt; [[财富-&gt;使用诡计]]&lt;&lt;/if&gt;&gt;
&lt;&lt;endif&gt;&gt;</tw-passagedata><tw-passagedata pid="175" name="防御" tags="" position="1925,2500" size="100,100">&lt;&lt;set $randomNumber to random(10,20)&gt;&gt;
&lt;&lt;set $health to $health + $randomNumber&gt;&gt;
你回复了&lt;&lt;print $randomNumber&gt;&gt;点生命！
&lt;&lt;set _$enemy_attack to $enemy_attack - $defense&gt;&gt;
&lt;&lt;if _$enemy_attack &lt;= 0&gt;&gt;&lt;&lt;set _$enemy_attack = 0&gt;&gt;
敌人生命值：&lt;&lt;print $enemy_health&gt;&gt;。
你的生命值：&lt;&lt;print $health&gt;&gt;。
你防御住了敌人，没有受到任何伤害

    [[权杖-&gt;攻击]]  
    [[圣杯-&gt;防御]]
   &lt;&lt;if $shenbeii == 1&gt;&gt; [[刃剑-&gt;随机加成]]&lt;&lt;/if&gt;&gt;
   &lt;&lt;if $guiji == 1&gt;&gt; [[财富-&gt;使用诡计]]&lt;&lt;/if&gt;&gt;
&lt;&lt;else&gt;&gt;
   &lt;&lt;set $health to $health -= random(1, _$enemy_attack)&gt;&gt; &lt;!-- 敌人反击 --&gt;
敌人生命值：&lt;&lt;print $enemy_health&gt;&gt;。
你的生命值：&lt;&lt;print    $health&gt;&gt;。
   &lt;&lt;if $health &gt; 0&gt;&gt;
你抗住了一部分伤害
    [[权杖-&gt;攻击]]  
    [[圣杯-&gt;防御]]
    &lt;&lt;if $shenbei == 1&gt;&gt;[[刃剑-&gt;随机加成]]&lt;&lt;/if&gt;&gt;
    &lt;&lt;if $guiji == 1&gt;&gt; [[财富-&gt;使用诡计]]&lt;&lt;/if&gt;&gt;
    &lt;&lt;else&gt;&gt;
    你被击败了。游戏结束。
    &lt;&lt;goto&quot;结局判定&quot;&gt;&gt;
    &lt;&lt;/if&gt;&gt;
&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="176" name="战斗条件跳转" tags="" position="1725,2425" size="100,100">&lt;&lt;set $fightNumber = 0&gt;&gt;
&lt;&lt;if $floor &lt;= 3&gt;&gt;
&lt;&lt;goto&quot;战斗&quot;&gt;&gt;
&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="177" name="终点" tags="" position="1850,2300" size="100,100">
你到达这次旅行的终点

&lt;&lt;set $fightNumber = 0&gt;&gt;
[[继续战斗-&gt;战斗]]
[[离开-&gt;22]]</tw-passagedata><tw-passagedata pid="178" name="奖励层" tags="" position="2050,2125" size="100,100">&lt;&lt;set $randomNumber to random(100)&gt;&gt;
&lt;&lt;if $randomNumber &lt;= 40&gt;&gt;
你找到了一瓶恢复药水，恢复20点生命值。
&lt;&lt;set $health to $health + 20&gt;&gt;
&lt;&lt;elseif $randomNumber &lt;= 60&gt;&gt;
你找到了一把新武器
现在你的最低和最高攻击力提高5
&lt;&lt;set $attackLow += 5&gt;&gt;&lt;&lt;set $attack += 5&gt;&gt;
&lt;&lt;else&gt;&gt;
这里一无所有
&lt;&lt;/if&gt;&gt;
[[返回战斗-&gt;战斗]]
</tw-passagedata><tw-passagedata pid="179" name="boss战条件判定" tags="" position="2025,2250" size="100,100">&lt;&lt;set $randomNumber to random(100)&gt;&gt;
&lt;&lt;if $randomNumber &gt; 50&gt;&gt;
&lt;&lt;goto&quot;波尔斯韦尔&quot;&gt;&gt;
&lt;&lt;else&gt;&gt;
&lt;&lt;goto&quot;终点&quot;&gt;&gt;
&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="180" name="使用诡计" tags="" position="1925,2625" size="100,100">&lt;&lt;set $guiji = 0&gt;&gt;&lt;&lt;set $lie += 1&gt;&gt;
你感觉到自己脱离现实，来到一个无序混乱的空间，你可能来到一段不知道属于谁的记忆，可能得到一些奇异的增益，也有可能直接受到伤害且无法反击......

——意思是，这里什么都可能发生。

这将取决于你的诡计水平，你的诡计等级越高，抽取到记忆的概率越大。



[[摸索]]



</tw-passagedata><tw-passagedata pid="181" name="随机加成" tags="" position="1925,2550" size="100,100">&lt;&lt;set $shenbei = 0&gt;&gt;
这里是元素精灵构造的独特空间，你能感受到这里面流动着的浓郁魔力。

既然你已经来到了这里，说明你是受欢迎的客人，精灵在这里面囤积了各种各样的东西，它们会很乐意能帮到你。

欢迎你来到精灵们的卧室！



[[继续|开抽]]
</tw-passagedata><tw-passagedata pid="182" name="字体" tags="widget" position="1500,25" size="100,100">/* 字体轻模糊 */
&lt;&lt;widget &quot;mohu1&quot; container&gt;&gt;&lt;p class=&quot;mohu1&quot;&gt;_contents&lt;/p&gt;&lt;&lt;/widget&gt;&gt;
/* 字体重模糊 */
&lt;&lt;widget &quot;mohu2&quot; container&gt;&gt;&lt;p class=&quot;mohu2&quot;&gt;_contents&lt;/p&gt;&lt;&lt;/widget&gt;&gt;
/* 字体震动 */
&lt;&lt;widget &quot;zhendong&quot; container&gt;&gt;&lt;p class=&quot;zhendong&quot;&gt;_contents&lt;/p&gt;&lt;&lt;/widget&gt;&gt;
/* 字体向左旋转90度，用来制作裂开效果 */
&lt;&lt;widget &quot;xuanzhuan&quot; container&gt;&gt;&lt;p class=&quot;xuanzhuan&quot;&gt;_contents&lt;/p&gt;&lt;&lt;/widget&gt;&gt;
/* 字体向右旋转90度，用来制作裂开效果 */
&lt;&lt;widget &quot;xuanzhuan1&quot; container&gt;&gt;&lt;p class=&quot;xuanzhuan1&quot;&gt;_contents&lt;/p&gt;&lt;&lt;/widget&gt;&gt;</tw-passagedata><tw-passagedata pid="183" name="波尔斯韦尔" tags="" position="2175,2225" size="100,100">&lt;&lt;nobr&gt;&gt;
&lt;&lt;set $boss to $enemy[0]&gt;&gt;
&lt;&lt;set $enemy_health to $boss[1]&gt;&gt;
&lt;&lt;set $enemy_attack to $boss[2]&gt;&gt;
&lt;&lt;/nobr&gt;&gt;
 你遇到了&lt;&lt;print $boss[0]&gt;&gt;，生命值：&lt;&lt;print $boss[1]&gt;&gt;。你的生命值：&lt;&lt;print    $health&gt;&gt;。&lt;&lt;print $boss[0]&gt;&gt;
 
 你被威慑了！你无法逃跑！
 
 [[权杖-&gt;龙战]]  
 </tw-passagedata><tw-passagedata pid="184" name="芬里尔" tags="" position="2175,2300" size="100,100">，</tw-passagedata><tw-passagedata pid="185" name="龙战" tags="" position="2400,2200" size="100,100">&lt;&lt;set $enemy_health to $enemy_health -= random($attackLow, $attack)&gt;&gt; &lt;!-- 玩家攻击敌人 --&gt;
&lt;&lt;set $health to $health -= random(1, $enemy_attack)&gt;&gt; &lt;!-- 敌人反击 --&gt;
&lt;&lt;if $enemy_health &lt;= 0&gt;&gt;&lt;&lt;set $enemy_health = 0&gt;&gt;&lt;&lt;/if&gt;&gt;
 你和敌人正面交战！敌人生命值：&lt;&lt;print $enemy_health&gt;&gt;。你的生命值：&lt;&lt;print    $health&gt;&gt;。
&lt;&lt;if $enemy_health &lt;= 0&gt;&gt;
    你击败了敌人！你继续前进。
    &lt;&lt;set $enemy_health to random(30, 60)&gt;&gt; &lt;!-- 新敌人 --&gt;
    &lt;&lt;set $attack to $attack += 5&gt;&gt;  &lt;!-- 提升攻击力 --&gt;
    &lt;&lt;set $defense to $defense += 2&gt;&gt; &lt;!-- 提升防御力 --&gt;
    [[继续前进-&gt;战斗][$fightNumber += 1]]
&lt;&lt;elseif $health &lt;= 0&gt;&gt;
    毫无疑问地，你被击溃了
    [[醒来-&gt;boss战后]]
&lt;&lt;else&gt;&gt;
    继续战斗。
    [[权杖-&gt;龙战]]  
    [[圣杯-&gt;防御]]
    &lt;&lt;if $shenbei = 1&gt;&gt;[[刃剑-&gt;随机加成]]&lt;/if&gt;
    [[财富-&gt;使用诡计]]
&lt;&lt;endif&gt;&gt;</tw-passagedata><tw-passagedata pid="186" name="boss战后" tags="" position="2325,2450" size="100,100">“哦？你看到那位&lt;&lt;print $boss[0]&gt;&gt;了是吗。”

陌生的声音在空间回荡。

“那真是有意思，没想到居然还有人能窥视到它的记忆。波尔斯维尔于万年前就陨落了，曾经被称为“龙之王”，其他的就无从考据，据说它吹口气就能把一座山吹飞。至于是谁干的，有人猜测是精灵......也是，只有同样历史悠久的种族才有可能在当时站在同一高度的山峰上——当然，现在不一样了。”

“但记住龙是无法被杀死的，龙没有真正的名字，因此它强大的灵魂无法夺取和消散，终有一日它会再次苏醒，这到底是好还是坏呢......”

“哦，你问我是谁？”

“那不重要，我只是一个碰巧被你吸引来的人，啊，已经这个时候了，我也该离开了，期待你再次来到这里的那天。”






[[继续-&gt;终点]]</tw-passagedata><tw-passagedata pid="187" name="结局判定" tags="" position="2125,2500" size="100,100">&lt;&lt;if $enemy = $boss[0]&gt;&gt;
&lt;&lt;goto&quot;boss战后&quot;&gt;&gt;
&lt;&lt;else&gt;&gt;
&lt;&lt;goto&quot;终点&quot;&gt;&gt;
&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="188" name="摸索" tags="" position="2000,2725" size="100,100">暂未填充






[[继续战斗|战斗中间]]</tw-passagedata><tw-passagedata pid="189" name="开抽" tags="" position="1975,2575" size="100,100">元素精灵包围着你，如果你能听懂它们的语言，也许能听到它们在唱歌？
&lt;&lt;set $randomNumber to random(100)&gt;&gt;
&lt;&lt;if $randomNumber &lt; 70&gt;&gt;
      &lt;&lt;set $prize to random(100)&gt;&gt;
      &lt;&lt;if $prize &lt; 20&gt;&gt;
      你获得了&lt;font color=&quot;green&quot;&gt;一株荨麻根药草&lt;/font&gt;！&lt;&lt;set $qianma.shu += 1&gt;&gt;
      &lt;&lt;elseif $prize &lt; 40&gt;&gt;
      你获得了&lt;font color=&quot;green&quot;&gt;两株荨麻根药草&lt;/font&gt;！&lt;&lt;set $qianma.shu += 2&gt;&gt;
      &lt;&lt;elseif $prize &lt; 80 &gt;&gt;
      你获得了&lt;font color=&quot;green&quot;&gt;一份龙鳞粉和两株荨麻根药草&lt;/font&gt;！&lt;&lt;set $lnglin.shu += 1&gt;&gt;&lt;&lt;set $qianma.shu += 1&gt;&gt;
      &lt;&lt;elseif $prize &lt; 90&gt;&gt;
      你找到&lt;font color=&quot;green&quot;&gt;一株散发着芳香的紫锥菊，这抹香气让你精神振奋了一些&lt;/font&gt;。
      这种药草拿来炼药似乎有很好的效果。&lt;&lt;set $zizhui.shu += 1&gt;&gt;&lt;&lt;set $health += 20&gt;&gt;
      &lt;&lt;elseif $prize &lt; 95&gt;&gt;
      你找到&lt;font color=&quot;green&quot;&gt;两株散发着芳香紫锥菊，这抹香气让你精神振奋了一些&lt;/font&gt;。
      这种药草拿来炼药似乎有很好的效果。&lt;&lt;set $zizhui.shu += 2&gt;&gt;&lt;&lt;set $health += 20&gt;&gt;
      &lt;&lt;else&gt;&gt;
      你什么也没找到——运气差到不行是否也是一种好运气呢？
      &lt;&lt;/if&gt;&gt;
&lt;&lt;elseif $randomNumber &lt; 80 &gt;&gt;
你找到了一把非常趁手的武器，现在你的最低和最高攻击力提高15。
&lt;&lt;set $attackLow += 15&gt;&gt;&lt;&lt;set $attack += 15&gt;&gt;
&lt;&lt;else&gt;&gt;
但可惜的是，你没找到什么有用的。

精灵们停在你身边，一股暖意流过你的身体，你的法力增加了！&lt;&lt;set $magic += 5&gt;&gt;
&lt;&lt;/if&gt;&gt;

元素精灵的光开始黯淡，空间快要消失了，你是时候返回战斗了。

[[离开|战斗中间]]</tw-passagedata><tw-passagedata pid="190" name="战斗中间" tags="" position="2125,2625" size="100,100"> 你和敌人正面交战！
 敌人生命值：&lt;&lt;print $enemy_health&gt;&gt;，攻击力：&lt;&lt;print $enemy_attack&gt;&gt;。
 你的生命值：&lt;&lt;print    $health&gt;&gt;，你的攻击力：&lt;&lt;print $attack&gt;&gt;。
 
 
   [[权杖-&gt;攻击]]  
  [[圣杯-&gt;防御]]
  &lt;&lt;if $shenbei == 1&gt;&gt;[[刃剑-&gt;随机加成]]&lt;&lt;/if&gt;&gt;
 &lt;&lt;if $guiji == 1&gt;&gt; [[财富-&gt;使用诡计]]&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="191" name="魔药教室" tags="" position="1325,1225" size="100,100">&lt;&lt;if $weekDay &lt;= 5&gt;&gt;
   &lt;&lt;if $hour &lt;= 16&gt;&gt;
      &lt;&lt;if $moyaoke == 1&gt;&gt;“缇瑟，魔药课的老师，”眼下带着乌青的人就这样结束了介绍，他看上去很年轻，二十出头的样子。

“魔药和魔法不同，魔法讲究因地制宜，但魔药大多有着固定的组合以及顺序，无论是哪一种出现误差，最后导致的结果都可能天差地别。”

“龙鳞粉，是比较常见使用的调和剂，并不是古龙的龙鳞粉，而是一些龙形生物的角质磨成的，比如蜥蜴、蛇之类，拥有稀薄的，龙类生物特有的，将不同魔力混沌化的特性，不过只放调和剂的结果会很糟糕......”

“......少说多做，现在每人来拿三份荨麻根和龙鳞粉，直接开始吧。”
      &lt;&lt;set $qianma.shu += 3&gt;&gt;&lt;&lt;set $longlin.shu += 3&gt;&gt;
      &lt;&lt;elseif $moyaoke == 4&gt;&gt;
      缇瑟拿着一本厚书走了进来。
      
    “一些药性极强的草药，放进去会立刻覆盖其他草药的效果，紫锥菊就是其中一种，开放时有一个拳头那么大，具有很强的活血效果，也是圣殿广为种植的花目，因此你可以看到许多不同颜色，不同季节开放的紫锥菊......”

“今天介绍一个比较罕见的草药，塞维尔芸莲，由它制作的魔药常用于皇室的祭奠，据说对辅佐预知魔法有一定效力，不过是否真的有效那只有那几位屈指可数的君主才知道了，”

你翻着书，里面的图画得栩栩如生，现在你可以认识许多基础草药了！

[[继续上课|下午下课][$lianyaocishu += 1,$hour += 3,$energy -= 20]](3:00)&lt;font color=”green”&gt;+制药技巧&lt;/font&gt;&lt;font color=”red”&gt;- 体力&lt;/font&gt;
      &lt;&lt;else&gt;&gt;
缇瑟翻着书，开始讲解一些药物的特性，你环顾四周，发现大多数人对这种课似乎没什么兴趣。

[[继续上课|下午下课][$lianyaocishu += 1,$hour += 3,$energy -= 20]](3:00)&lt;font color=”green”&gt;+制药技巧&lt;/font&gt;&lt;font color=”red”&gt;- 体力&lt;/font&gt;
      &lt;&lt;/if&gt;&gt;
   &lt;&lt;else&gt;&gt;
   现在是课余时间，你可以自由使用这里的炼药锅。
   
   
   [[离开|教学楼][$minute += 3]](0:03)
   &lt;&lt;/if&gt;&gt;
&lt;&lt;else&gt;&gt;
  现在是课余时间，你可以自由使用这里的炼药锅。
  
  
  [[离开|教学楼][$minute += 3]](0:03)
  &lt;&lt;/if&gt;&gt;
[[开始炼药]]
</tw-passagedata><tw-passagedata pid="192" name="入学3" tags="" position="950,1775" size="100,100">&lt;&lt;set $hour = 10&gt;&gt;你在半知半解中度过了你的第一节课，瑟琳娜告诉你一般上午只设置两种课，根据星期会有不同的课程，今天下一节是历史课。

”教历史的这位也是十足的怪人，“瑟琳娜揣摩着用词，”也不能说他不亲切，只是你永远无法猜测他下一步要做什么。“

随着铃声响起，很快你就认识了瑟琳娜口中的历史老师。

”上午好，我亲爱的同学们，“一个穿得灰扑扑的花胡子老头，脸上容光焕发，他绅士地朝众人行了个礼，”哦，我知道今天有新同学，德古拉，德古拉教授，老头——随你怎么喊我，但我更希望你能称呼我为教授，这样会显得我更有威严。“

德古拉悠哉游哉地走上台前，步伐看上去比他的外貌年轻多了，”上次我讲到哪里来着？“

”精灵，老师。“

”哦，对，对，“他摸着胡子，咧开一个笑容，”精灵是个神奇的群体，它真的太多，太多了，存在时间最久的精灵可以当我的曾曾曾曾.......祖父吧。“

“当然对于你们这群初出茅庐的菜鸟法师们，“德古拉用手指点了点自己的头，”第一步先在这里分离元素精灵和高精灵的概念。高精灵——就是那种第一眼很容易被认为的人族的，先一步带领人类认识了元素为本质的魔法，他们称元素精灵为同胞，不过，高精灵这种称呼，这只是单纯在精灵出现的时间轴上靠最后，没有地位高低之分——尽管确实看上去比古老的其他精灵物种更高级更聪明一些，像人和猴子，不，还要远远不同，像人和田螺——这就是研究精灵不同种族之间的乐趣，如果你将他们拿来与自身比较，总会得到千奇百怪的结果。“

他发出奇怪的笑声。

”万年前高精灵向所有其他种族传播知识，建立起元素的概念，编制整个魔法的框架，从这个角度想，不觉得高精灵就像元素精灵发育出来的发声器官吗，”一些学生脸上露出愕然，这显然背离了他们自小被教授的。

“哦不，忘了我刚刚说的吧，”德古拉笑得前仰后合，“总之，我的意思是，不要把元素精灵和高精灵或者其他精灵归为同类，他们已经完全是不同的物种，牢牢记住这点，你在未来许多课题就不会犯错。”

你边听边看着他像上了发条一样走来走去，然后随着德古拉坐到座椅上的动作，你觉得他衣袍抖落了小山那么高的尘埃。

“哦，现在都几点了。”

“我们提前进入自习时间，拿出你们最喜欢的——任何相关的书，只要你能学到知识，“德古拉每说一个字，语气就拉得越长，”所以可怜我一个老头，不要在我面前耍小心眼，”说完后他就打着哈欠，闭上眼仰头就开始在座椅上——呼呼大睡。

——你没想到这样一个老人拥有如此优秀的睡眠质量，在坐满学生的教室中如入无人之境。

“......说得我都想睡了，好无聊啊。”你听见狄恩特在你身后也打了个哈欠，然后是衣料摩擦声。

你缓缓转过头，只见狄恩特已经舒服地趴在桌上小寐。

但你现在无暇顾及他，你没有带任何的课外书，你的寝室里也没有——当然如果你也想睡觉那就没什么所谓了。

瑟琳娜也没有多余的书，但她用表情示意你可以去问问阿尔布雷希特有没有多的书。

[[向阿尔借书][$minute += 40,$know += 2]]&lt;font color=&quot;green&quot;&gt;++学识&lt;/font&gt;
[[在课上睡觉][$minute += 40,$energy += 20]]&lt;font color=&quot;green&quot;&gt;+体力&lt;/font&gt;


</tw-passagedata><tw-passagedata pid="193" name="未命名片段" tags="" position="1100,1700" size="100,100">被抓到算违纪处理，要留堂处罚的，当然大家还是乐此不疲</tw-passagedata><tw-passagedata pid="194" name="在课上睡觉" tags="" position="1250,2075" size="100,100">头脑中一旦升起这个念头，你便感觉睡意上涌，索性趴在了桌上。

&lt;&lt;if $AER.love &gt; 5&gt;&gt;你感受到前面人的桌椅似乎动了动，然后困扰你的阳光便消失了。

阿尔拉上了窗帘。&lt;&lt;/if&gt;&gt;

[[睡到中午|中午]]</tw-passagedata><tw-passagedata pid="195" name="向阿尔借书" tags="" position="1075,2000" size="100,100">&lt;&lt;if $jieshu == 0&gt;&gt;你看向坐在前方神情专注的阿尔，深色的宽松校服外衣更衬他肌肤白皙，像一座没有温度的美丽雕塑，无论哪个严苛的角度望过去都毫无瑕疵。唯有肩膀随着呼吸微微起伏，给他增添一抹鲜活的气息。

他和你之间不过半臂距离，你却不禁觉得他离你极远。

你轻拍他的肩膀。

&lt;&lt;linkreplace&quot;询问他是否有多的书&quot;&gt;&gt;询问他是否有多的书

阿尔顿时睁大眼睛，眉头轻皱转瞬即逝，他无言地拿出几册书。

“我现在只带了这些，“阿尔压低声音，“有你感兴趣的吗。”

在安静的环境中你才发觉他的声音似乎有种奇怪的魔力，低沉而富有磁性·，字节的发音从他的唇舌间流出仿佛在吟诵一段陈旧的寓言。

直到来自对方的冰冷气息萦绕，你才回过神从阿尔手中接过书，开始从书名和简介提中取关键词。

”你可以先挑一本带走，课余时间去图书馆还就行。“长长的睫毛遮住他的瞳孔，你看不出他的神情。&lt;&lt;set $jieshu += 1&gt;&gt;


&lt;&lt;include&quot;书目&quot;&gt;&gt;
&lt;&lt;/linkreplace&gt;&gt;
&lt;&lt;elseif $jieshu &lt;= 10&gt;&gt;
你又拍了拍阿尔的肩膀，这次他没有过度的反应。

”这些，“他似乎想说什么，但还是止住了话头，拿出一叠书放在你面前，你尽快选好了一本。


&lt;&lt;include&quot;书目&quot;&gt;&gt;
&lt;&lt;else&gt;&gt;
阿尔已经习惯了，什么也没说，甚至在你问之前就把书端了出来。


&lt;&lt;include&quot;书目&quot;&gt;&gt;

&lt;&lt;/if&gt;&gt;


</tw-passagedata><tw-passagedata pid="196" name="阿尔的书单" tags="" position="1100,2125" size="100,100">&lt;&lt;if $book == 0&gt;&gt;
这是一本很厚的书，你随便翻开了前几页。

&lt;center&gt;&lt;strong&gt;和元素精灵相处的十一种方法  节选&lt;/strong&gt;&lt;/center&gt;

&lt;i&gt;如果一个人想学习精灵魔法，不如说是学习如何跟精灵打好交道，一般来讲，它们会更喜欢和与元素亲和性高、天生魔力高的人，一旦元素精灵认同你，它的跟随就是终身的，直到你死亡，或者魔力消失无法再感应到精灵。对于如何得知精灵喜欢你，访问多位法师后得到的回答出奇地一致——自然而然地就知道了，只需用你的灵魂感受——虽然很抽象，但事实上确实精灵奇怪的，近似无偿奉献的行径由人类看来别有一种浪漫。

但精灵比人类长寿得多，应该说，人们从未观测到一个元素精灵的死亡，它只是不在这里，不在某处，仅此而已，本书这里就不多赘述，精灵种族学会有更深入的介绍。

回归正题，如果先天条件达不到该做些什么呢？最简单的一个方法，优先去花草木繁盛的地方逛一逛！

元素精灵拥有从植物提炼元素或者魔力的能力，因此越是富饶的土地越容易成为精灵的聚集地。这也是王公贵族酷爱建设花园，养殖奇花异草的原因，尽管后面逐渐形成一种攀比，但想到精灵在其中很开心，笔者心灵也倍感舒畅。

......&lt;/i&gt;

[[继续|历史课下半]]
&lt;&lt;elseif $book == 1&gt;&gt;
这是夹在一本书中的报纸，出于好奇你选择了这个。

&lt;i&gt;世人只知当今维克多.德因赫兹陛下先后两位妻子，膝下三位王子，一位公主。

前皇后汉娜.德因赫兹是历史悠久的奥尔德里奇家族的长女，知性温婉，自幼与还是皇太子的陛下定下婚约，本以为会和谐美满相伴一生，诞下大皇子后便猝然长逝

德尔芬.多姆利特是位于东方的多姆利特领主的妹妹，多姆利特可谓名声赫赫，守护边境受多代先皇封赏，领土面积广阔，是艾德里安数一数二的贵族，在成为皇后的三年内先后诞下一女一儿，

至于三皇子，并非陛下的亲生孩子，而是陛下的妹妹——死于暗杀，留下当时尚且年幼的私生子，其父不详，陛下疼爱妹妹，为了让她的灵魂得以安息，她的闺名不允许被提起，并将此事封禁，但调查结果并不理想，这个案件自此是一个谜团，总之言尽于此。

同年陛下的弟弟，里亚特公爵因病去世，自此先皇的三个孩子仅剩维克多陛下，据说三皇子容貌与陛下的妹妹如出一辙，陛下每每见到三皇子便会想起曾经年少时光，便收其到宫中作为亲生儿子养育。

......&lt;/i&gt;

[[继续|历史课下半]]
&lt;&lt;elseif $book == 2&gt;&gt;
这本书封面比较陈旧，你随意翻开几页。

&lt;center&gt;&lt;strong&gt;魔法的实践到生产  节选&lt;/strong&gt;&lt;/center&gt;

&lt;i&gt;......在最黑暗，最危难的时期，哪怕几乎所有的土地都用来耕作，衣食也难以为继，更遑论上交粮食之后，远远无法弥补普通百姓的吃喝，饿殍遍野，但农民还需承担数不胜数的赋税，瘟疫和各种意外，哪怕孤独一注将所有都投入到对教廷的信仰，这真的正确吗......

......放下武器就是农民，拿起武器就是民兵，也有许多人试图反抗，从无尽的租聘雇佣契约的剥削中解脱出来，但和领主们的精兵良马来说，实在太可笑了......这种情况历代来并不少见，农民永远无法拥有自己的地，意味着他们永远无法自由......

......将魔法极其产物用于农业耕作也是几个世纪前才有的事，国与国之间的征战逐渐平息，艾里安德异军突起将其他国家都按在一张桌子上谈话，能做到这一切，皇室背后的维尔弗兰以及一众有能之士的助力非同小可。法师塔地位陡升，甚至左右法律规章，一度给人发展千万年的魔法是近百年中一蹴而就的错觉，他们从达官贵族的帷幕后走到台前，让未知不再恐惧，几公顷的土地只需一位农业特长的资深法师适当管理，土地利用率是往日完全无法想象的，可以说这根本上改变了农民的生产结构，说实话我敬佩这种行为，但我依旧在思考，如果自此以后再也无人思考脚下的地从何而来，又要到哪去？如果法师的定义被扭曲？对农民来说解放还重要吗？这到底是好，还是不好？

......&lt;/i&gt;

[[继续|历史课下半]]
&lt;&lt;elseif $book == 3&gt;&gt;
这是一本薄册子，印着漂亮的彩图。

&lt;center&gt;&lt;strong&gt;多伦多亚旅行手册&lt;/strong&gt;&lt;/center&gt;

&lt;i&gt;......多伦多亚无论是从地理位置还是人文纪实上来说，都是名副其实的旅游胜地！

多伦多亚靠西偏北，与大海相接，终年清凉，夏季避暑，冬季赏雪，除此之外不得不提到的就是圣血教最初，也是最宏伟的教堂，多伦多亚大教堂，在历史的沉淀下愈发庄严肃穆的瑞德米拉德女神像，如果实在秋末冬初的时候来，还能赶上一年一度的丰收节......

......&lt;/i&gt;

[[继续|历史课下半]]
&lt;&lt;elseif $book == 4&gt;&gt;
这是一本厚度居中，拥有蓝色封皮的书，标题似乎有着某种怨念。

&lt;center&gt;&lt;strong&gt;传送术—从入门到入土  节选&lt;/strong&gt;&lt;/center&gt;

&lt;i&gt;......传送术是一种相当特殊的光魔法，更具体应该说是光元素魔法和光精灵魔法的结合体。术式的激发只需要施法者少量的魔力，而真正困难的是过程，利用光元素精灵能进行相位移动的特性进行远距离传送，对于能够释放传送术的初学者来说，基本不可能精确的将魔法有效地释放在独立的光元素精灵上，而是要将自己作为海，去包容石头，即几乎抽空所有魔力调动光元素精灵，魔力与元素的碰撞足够多而尽可能激发更多的光精灵去参与传送，确保术式完成度，这时候激发的术式有效体积往往是远超需要的，从而形成相当大面积的传送法阵。

到达入门学习传送术所需的庞大术法魔力，是一个阶段，而能完美控制自己每一滴的魔力是另一个阶段，每个阶段都有人可能这辈子望其项背，这是所有法师公认的，代表学习生涯的两大门槛。

这里提另一个说法，速度的感知是相对的，人们肉眼感知的一瞬，对于光元素精灵来说可能是段漫长的旅途。

不久前我还听学生说，问光元素精灵会不会在传送路上迷路，有一说一这个问题真的很有意思，我认真思考了，但就算迷路它们也总会回来，毕竟它们就是这么不可思议的小东西......

......&lt;/i&gt;

[[继续|历史课下半]]
&lt;&lt;elseif $book == 5&gt;&gt;
比起说是一本书，更像是谁的笔记本，上面满是不知所谓的涂涂画画。

&lt;center&gt;&lt;strong&gt;魔族纪事  节选&lt;/center&gt;&lt;/strong&gt;

魔族是一个相当庞大的群体，人们把无法形容的，来自于魔界的异种生物统称为魔族。从有记载以来，拥有明确身形的种类就数不胜数，大部分以兽形姿态显露于世，尽管近几个世纪魔族偃旗息鼓，在境内造成的伤亡损失还在可控范围内，但来自于它们的威胁仍不容小觑。

自万年前瑞德米拉德女神降福以来，也曾发生过几次大陆几乎毁灭的灾难，而那种强大魔兽被冠上特殊的名字——归零者，它们出现时必然生灵涂炭，家国熹微，只是血肉尽散是不够的，不然它们一定，一定还会从地狱之中爬出来，还要摧毁灵魂，永世不得翻身......

神殿一直是解决魔族的主力，这也是为什么这片大陆都有信仰圣血教的虔诚教徒。但不依靠血肉活动的魔族也越来越多了，活死人、骷髅兵......亵渎死者们的家伙......它们完全是带来死亡的幽灵，尽管我对女神的信仰坚不可摧，但我也冷静地意识到这些是女神的权能无法解决的问题......

难道.....如果那一天真的来临，我们难道需要完全依靠灵魂派那群疯子吗......

......&lt;/i&gt;

[[继续|历史课下半]]
&lt;&lt;else&gt;&gt;
这是一本精装书，书脊是鲜红色的，十分显眼。

&lt;center&gt;&lt;strong&gt;龙图腾  节选&lt;/strong&gt;&lt;/center&gt;

&lt;i&gt;现代的龙并不是指那些沉睡千年的龙，那些古龙在女神在大陆活跃的时期便接连进入沉眠，有大量遗迹可以阐明古龙的伟力，却完全没有可以指向其消失的原因，自此，古龙就完全脱离了后世对龙的重新诠释。

于是前人逐渐将尖翼鸟、鲤鱼王、蜥蜴人、多头蛇等，类似的魔法生物或者魔兽也归为龙。

直到不久前古龙苏醒......虽然我们现在还没勘探出它苏醒的原因，以及溯源它的过去，但......但我没想到我的有生之年能见证这种事，即使无法亲眼去看，这还是令我热血沸腾，历史会在我们这一代改写......总之如果最近还看到龙这个字眼，还请务必结合上下文分析。

......&lt;/i&gt;

[[继续|历史课下半]]
&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="197" name="学校变量" tags="" position="1225,1825" size="100,100">&lt;&lt;set $book to []&gt;&gt;
&lt;&lt;set $weise to &quot;falus&quot;&gt;&gt;
&lt;&lt;set $jiaoxuelou = 0&gt;&gt;

&lt;&lt;set $SLN ={dis:&quot;瑟琳娜&quot; ,fri:0}&gt;&gt;
&lt;&lt;set $DET ={dis:&quot;狄恩特&quot; ,love:0 ,nick:&quot;&quot;}&gt;&gt;
&lt;&lt;set $AER ={dis:&quot;阿尔布雷斯特&quot; ,love:0}&gt;&gt;
&lt;&lt;set $SAM ={dis:&quot;塞缪尔&quot; ,love:0}&gt;&gt;

&lt;&lt;set $aerlishi = 0&gt;&gt;//阿尔的第一节历史课
&lt;&lt;set $zaotui = 0&gt;&gt;
&lt;&lt;set $zt to &quot;faulse&quot;&gt;&gt;//判定当天是否逃课
&lt;&lt;set $cd to &quot;faulse&quot;&gt;&gt;//判断是否迟到
&lt;&lt;set $moyaoke = 0&gt;&gt;//第一次魔药课
&lt;&lt;set $jieshu = 0&gt;&gt;//借书
&lt;&lt;set $tiyvke = 0&gt;&gt;
&lt;&lt;set $ruxue1 to &quot;faulse&quot;&gt;&gt;

&lt;&lt;set $reputation = 0&gt;&gt;

&lt;&lt;set $pd to &quot;&quot;&gt;&gt;</tw-passagedata><tw-passagedata pid="198" name="中午" tags="" position="1425,2125" size="100,100">&lt;&lt;set $hour = 12&gt;&gt;&lt;&lt;set $minute = 0&gt;&gt;现在是午饭时间，你来到食堂，深红色的长桌上已经坐满了人，有时你能看到熟悉的身影，你可以选择要坐哪里。


&lt;&lt;nobr&gt;&gt;
&lt;&lt;set $randomNumber to random(100)&gt;&gt;&lt;&lt;if $randomNumber &lt;20&gt;&gt;[[坐到狄更斯周围][$DET.love += 1]]&lt;br&gt;&lt;&lt;/if&gt;&gt;
&lt;&lt;set $randomNumber to random(100)&gt;&gt;&lt;&lt;if $randomNumber &lt;50&gt;&gt;[[坐到阿尔布雷希特周围][$AER.love += 1]]&lt;br&gt;&lt;&lt;/if&gt;&gt;
&lt;&lt;set $randomNumber to random(100)&gt;&gt;&lt;&lt;if $randomNumber &lt;60&gt;&gt;[[坐到瑟琳娜周围][$SLN.fri += 1]]&lt;br&gt;&lt;&lt;/if&gt;&gt;
[[自己独自一人]]
&lt;&lt;/nobr&gt;&gt;</tw-passagedata><tw-passagedata pid="199" name="历史课下半" tags="" position="1000,2275" size="100,100">&lt;&lt;if $aerlishi == 0&gt;&gt;&lt;&lt;set $aerlishi += 1&gt;&gt;有什么挤到你的胳膊下，是瑟琳娜的纸条，”抱歉我忘了说，阿尔似乎不喜欢被触碰。“

你朝前方睹了一眼，来日方长，你应该有很多时间来改善同学关系。

&lt;&lt;linkreplace&quot;继续&quot;&gt;&gt;你看着书，教室里十分安静。

所以当不远处产生一阵骚动很快被觉察，你看几个人交头接耳，像是商量好什么似的，然后猫着腰打开后门溜了出去，德古拉还在呼呼大睡，一部分学生注意到了但没有过多管束。

......这种不能叫逃课，这算早退。

这启发你发现自己也有地域优势，你坐在二楼窗边，这窗不高，不用费力就可以跨上去，而窗外下方是柔软的草坪。

你看向窗外，&lt;font color=&quot;yellow&quot;&gt;如果你的敏捷达到一定程度，你就可以确保自己跳下去不受伤害的同时减少引起别人注意的几率。&lt;/font&gt;



[[早退|早退][$ruxue1 to &quot;ture&quot;,$fly += 2,$lie += 1,$energy -= 10,$reputation -= 3,$zt to &quot;ture&quot;]]
[[继续读书][$know += 1]]&lt;font color=&quot;green&quot;&gt;+学识&lt;/font&gt;
&lt;&lt;/linkreplace&gt;&gt;
&lt;&lt;else&gt;&gt;
又到了下半节课，你看向德古拉，他已经又悠闲地躺在椅子上，无论他有没有睡着，但肯定没有注意到你的动作。

你看向窗外，&lt;font color=&quot;yellow&quot;&gt;如果你的敏捷达到一定程度，你就可以确保自己跳下去不受伤害的同时减少引起别人注意的几率。&lt;/font&gt;



[[早退|早退][$fly += 1,$lie += 1,$energy -= 10,$reputation -= 3,$zt to &quot;ture&quot;]]
[[继续读书][$know += 1]]&lt;font color=&quot;green&quot;&gt;+学识&lt;/font&gt;
&lt;&lt;/if&gt;&gt;
</tw-passagedata><tw-passagedata pid="200" name="早退地图0" tags="" position="1025,2625" size="100,100">你猫着腰躲过人群，你找到一个舒服的角落，微风拂面暖阳和煦，似乎连精灵也在给你唱催眠曲，说实话你没有很多时间，你需要在下午上课前赶回去。

你昏昏欲睡，你决定趁这个机会睡一觉。

&lt;&lt;set $magic += 3&gt;&gt;&lt;&lt;set $energy += 20&gt;&gt;
++魔力，+体力


[[前往教学楼|下午]]</tw-passagedata><tw-passagedata pid="201" name="继续读书" tags="" position="1250,2175" size="100,100">你集中精神继续看书，你有所补益。






[[中午]]</tw-passagedata><tw-passagedata pid="202" name="早退" tags="" position="1125,2400" size="100,100">&lt;&lt;if $fly &lt;= 10&gt;&gt;   
      你收拾好书包，蹑手蹑脚离开座位，瑟琳娜注意到了你的离席，然后在她震惊的目光中，你爬上窗户一跃而下！
      
      你没有调整好姿势落地，你受到了一点伤害。&lt;font color=&quot;red&quot;&gt;-体力&lt;/font&gt;
      
      一些路过的学生被从天而降的你吓到了，他们面面相觑，然后很快就远离了你。&lt;font color=&quot;red&quot;&gt;--声望&lt;/font&gt;
   
      &lt;&lt;if $ruxue1 is &quot;ture&quot;&gt;&gt;&lt;&lt;set $ruxue1 to &quot;faulse&quot;&gt;&gt;你做到了！你上学第一天就早退了！你也许创下了维尔弗兰建立史上首次的壮举，这让你感觉很兴奋。&lt;font color=&quot;green&quot;&gt;++敏捷，+诡计&lt;/font&gt;&lt;&lt;else&gt;&gt;但无论如何你做到了！这让你感觉很兴奋。&lt;font color=&quot;green&quot;&gt;+敏捷，+诡计&lt;/font&gt;&lt;&lt;/if&gt;&gt;&lt;&lt;if $lie == 5&gt;&gt;&lt;font color=&quot;yellow&quot;&gt;你觉得自己突破了某种界限，或许你可以试着去其他地方逛逛，说不定会有新发现。&lt;/font&gt;&lt;&lt;/if&gt;&gt;
      
      你不知道狄恩特或者阿尔发现了会作何感想，你整理好衣服沿着墙壁走出教学楼，你可以想想接下来要做些什么。
      
      &lt;&lt;set $zaotui += 1&gt;&gt;
      [[继续|早退跳转]]
      
&lt;&lt;else&gt;&gt;
      你收拾好书包，轻手轻脚离开位子，你的同伴们已经习以为常，你的同学甚至有些敬佩。&lt;font color=&quot;green&quot;&gt;+声望&lt;/font&gt;&lt;&lt;$reputation += 4&gt;&gt;
      
      你爬上窗户一跃而下，在任何一处身体部位接触到地面之前你就调整好了姿态。
      
      一个完美的落地！也没有发出任何声响。&lt;font color=&quot;green&quot;&gt;+敏捷，+诡计&lt;/font&gt;
      
      你觉得自己真是干得漂亮！
      
      你都不需要整理衣服，它们依旧整洁，你沿着墙壁走出教学楼，是时候想想接下来要做些什么。
      &lt;&lt;set $zaotui += 1&gt;&gt;
      [[继续|早退跳转]]
   
&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="203" name="早退跳转" tags="" position="1150,2525" size="100,100">&lt;&lt;if $zaotui == 5&gt;&gt;
&lt;&lt;goto&quot;塞缪尔a1&quot;&gt;&gt;
&lt;&lt;elseif $zaotui &gt; 5&gt;&gt;
&lt;&lt;goto&quot;早退地图&quot;&gt;&gt;
&lt;&lt;else&gt;&gt;
&lt;&lt;goto&quot;早退地图0&quot;&gt;&gt;
&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="204" name="书目" tags="" position="950,2075" size="100,100">&lt;&lt;nobr&gt;&gt;
&lt;&lt;set $x = [0, 1, 2, 3, 4, 5, 6]&gt;&gt;
&lt;&lt;set $book = $x.pluckMany(3)&gt;&gt;
&lt;&lt;if $book.includes(0)&gt;&gt;[[与元素精灵相处的十一种方法|阿尔的书单][$book to 0]]&lt;br&gt;&lt;&lt;/if&gt;&gt;
&lt;&lt;if $book.includes(1)&gt;&gt;[[一截简报|阿尔的书单][$book to 1]]&lt;br&gt;&lt;&lt;/if&gt;&gt;
&lt;&lt;if $book.includes(2)&gt;&gt;[[魔法的实践到生产|阿尔的书单][$book to 2]]&lt;br&gt;&lt;&lt;/if&gt;&gt;
&lt;&lt;if $book.includes(3)&gt;&gt;[[多伦多亚旅行手册|阿尔的书单][$book to 3]]&lt;br&gt;&lt;&lt;/if&gt;&gt;
&lt;&lt;if $book.includes(4)&gt;&gt;[[传送术—从入门到入土|阿尔的书单][$book to 4]]&lt;br&gt;&lt;&lt;/if&gt;&gt;
&lt;&lt;if $book.includes(5)&gt;&gt;[[魔界纪事|阿尔的书单][$book to 5]]&lt;br&gt;&lt;&lt;/if&gt;&gt;
&lt;&lt;if $book.includes(6)&gt;&gt;[[龙图腾|阿尔的书单][$book to 6]]&lt;br&gt;&lt;&lt;/if&gt;&gt;
&lt;&lt;/nobr&gt;&gt;</tw-passagedata><tw-passagedata pid="205" name="卫生间" tags="" position="1225,1475" size="100,100">左边是男卫生间，右边是女卫生间，就是普普通通的卫生间，难道你在想这里会有什么奇遇吗？


[[离开|教学楼]]</tw-passagedata><tw-passagedata pid="206" name="普通课室" tags="" position="1375,1550" size="100,100">&lt;&lt;if $weekDay &gt;= 6&gt;&gt;  
 现在不是上课时间，但有一些人坐在教室里不知道在做什么，你并没有什么事需要在这里完成。
 
 [[离开|教学楼]]
 &lt;&lt;else&gt;&gt;
  &lt;&lt;if $hour &lt;6&gt;&gt;
 现在还是深夜，教学楼里空无一人，还是赶紧离开吧。
 
 [[离开|教学楼]]
 &lt;&lt;elseif $hour &lt; 8&gt;&gt;
 已经有些人坐在教室了，你的课程会在八点开始，时间没到时你可以先自习。
 
 [[进入教室][$int += 1,$energy -= 20]]+思维
 [[离开|教学楼]]
 &lt;&lt;elseif $hour &lt;= 12&gt;&gt;
   &lt;&lt;if $zt == &quot;ture&quot;&gt;&gt;
   你已经早退了，不能再众目睽睽之下回到课室，还是算了。
   
    [[离开|教学楼]]
   &lt;&lt;else&gt;&gt;&lt;&lt;set $cd to &quot;ture&quot;&gt;&gt;
   显然你已经迟到了，虽然这样会降低你对声望，但总比无故旷课多一个记过处分要好吧。
   
    [[进入教室]]
    [[离开|教学楼][$energy -= 20]]
    &lt;&lt;/if&gt;&gt;
&lt;&lt;elseif $hour &lt;= 18&gt;&gt;
现在有别的学生在上课，还是不要打搅别人比较好。

 [[离开|教学楼]]
 
&lt;&lt;else&gt;&gt;
现在是空闲时间，夕阳透过窗户落在地板上，走廊很安静，学生们基本投入到其他活动之中了。

 [[离开|教学楼]]
 &lt;&lt;/if&gt;&gt;
 &lt;&lt;/if&gt;&gt;
 </tw-passagedata><tw-passagedata pid="207" name="维瑟之森里" tags="" position="1675,1775" size="100,100">你成功了






[[往深处走|维瑟深][$minute += 10]](0:10)
[[离开|维瑟之林][$minute += 5]](0:05)</tw-passagedata><tw-passagedata pid="208" name="利夫药店" tags="" position="2375,1850" size="100,100">






[[出售魔药|魔药商店]]

[[离开|巴克诺尼城]]</tw-passagedata><tw-passagedata pid="209" name="维瑟深" tags="" position="1700,1975" size="100,100">你来到了更深处，一道柔和的白色光源吸引了你的注意力，看起来很像是许多元素精灵聚集在一起形成的。






[[试炼|22]]
[[往外走|维瑟之森里][$minute += 10]](0:10)</tw-passagedata><tw-passagedata pid="210" name="阿尔a1" tags="" position="1525,2700" size="100,100">“听好了，今天是实践课，我们将前往......记住一定要听从指......希望各位不要平白无故地受伤......”

辛西娅的声音从前面传来，狄恩特从背后搭上你的肩膀，露出古怪的表情，“你怕高吗，嗯......也许几百米的那种。”
&lt;div id= &quot;choices&quot;&gt;
&lt;&lt;link&quot;怕&quot;&gt;&gt;
&lt;&lt;replace &quot;#choices&quot;&gt;&gt;
怕
&lt;br&gt;“怕的话，那最好的方法就是别去看吧，”狄恩特似乎若有所思。
&lt;br&gt;“总之我翘课了，问起来的话就说那个老头找我。”他潇洒地摆摆手，没等你反应过来，狄恩特就消失在了树荫之下。

[[继续|阿尔a2]]
&lt;&lt;/replace&gt;&gt;
&lt;&lt;/link&gt;&gt;
&lt;&lt;link&quot;不怕&quot;&gt;&gt;不怕
&lt;&lt;replace &quot;#choices&quot;&gt;&gt;
不怕
&lt;br&gt;“哦？那不错啊。”狄恩特露出熟悉的玩味微笑。
&lt;br&gt;“总之我翘课了，问起来的话就说那个老头找我。”他潇洒地摆摆手，没等你反应过来，狄恩特就消失在了树荫之下。

[[继续|阿尔a2]]
&lt;&lt;/replace&gt;&gt;
&lt;&lt;/link&gt;&gt;
&lt;/div&gt;

</tw-passagedata><tw-passagedata pid="211" name="阿尔a2" tags="" position="1525,2750" size="100,100">“现在开始两两分组，”你的注意力转回课堂，以辛西娅为中心刮起风，将地上的叶子卷起，你看见那些叶片在飞旋的同时裂成了两半，“每人拿一半叶子，找到另一个可以和你手中叶子拼回去的人，那人就是你以后的搭档。”

你拿起一片的同时与众人手中的叶子一起比较，裂痕并非沿着叶脉蔓延，切入的角度以及转折每片叶子各有不同，你似乎理解了辛西娅的意思。

&lt;&lt;linkreplace&quot;感知&quot;&gt;&gt;你注入了一点魔力

你感知到了非常明显的术式残留，像某种黏浊的液体，简直就像是施术者故意留下的，于是你找到了瑟琳娜说了你的想法，果不其然，她的叶子上也有残留，但和你的有细微差别——如果是被同一道风刃切开，残留应该是一样的。

这样就方便多了，你不需要用眼睛去看，只需触碰且付出一点魔力就能精准排除。

很快你找到了你的搭档。

&lt;&lt;linkreplace&quot;继续&quot;&gt;&gt;“......是你啊，有劳了，”那人向你微微点头，语气平淡，看起来不是很惊讶，或者说无所谓——是阿尔布雷希特。

你与他的交流不算多，对他来说你们之间大概也不算朋友，阿尔跟谁都一视同仁地话少，只有聊及感兴趣的话题时才多说一点。

“我们要去的地方，是希波战争时建造的暗道，里面留下了相当多的完整的术式，数量上可以被称作教科书级的，但同时里，面滋生的魔物也是成正比的，我们今天的目的只是接触比较弱小的给各位练练手。”

&lt;&lt;linkreplace&quot;继续&quot;&gt;&gt;“你们的出生让你们拥有这份才能，而才能意味着未来总要肩负起责任，还是尽快适应为好。”

“没人知道这里面有多少亡魂，死者越多的地方越容易滋生魔物，”辛西娅眼底的狠戾一闪而过，神情严肃。

“这段路会非常危险，一定不要偏离我的路线。”

“都准备好，我们要传送过去了。”所有人都找到了搭档后，辛西娅朝一个身着白衣的人点头，那人有着柔顺的中长发，只见他轻轻抬手，你们脚下升起熟悉的法阵。

[[继续|阿尔a3]]
&lt;&lt;/linkreplace&gt;&gt;
&lt;&lt;/linkreplace&gt;&gt;
&lt;&lt;/linkreplace&gt;&gt;</tw-passagedata><tw-passagedata pid="212" name="中心庭院" tags="" position="1325,1375" size="100,100">&lt;&lt;if $weekDay &lt;= 5&gt;&gt;
   &lt;&lt;if $hour &lt;= 15&gt;&gt;
      &lt;&lt;if $tiyvke == 1&gt;&gt;
      ”这节课的老师叫辛西娅，“瑟琳娜远远朝你招手，她走到你身边，”不过她的教学作风......嗯，也许过一段时间你就熟悉了？“
      
      就在你们交流期间，你看到一位身材健壮的女性朝你们靠近，“都换好衣服了吗！如果你们哪一天遇上对手，你们的柔弱就是敌人最大的突破口！”

”跑起来，直到累趴下，“你看她随手抓起一个，似乎给那人喝下什么，”感恩吧，你的敌人只会在你倒下的时候补上几刀。“
       &lt;&lt;/if&gt;&gt;
          你看着风风火火的老师，自觉开始跟上部队跑了起来。
   
   [[运动|下午下课][$hour += 3,$body += 3,$energy -= 30]](3:00)&lt;font color=”green”&gt;++力量&lt;/font&gt;&lt;font color=”red”&gt;--体力&lt;/font&gt;
   &lt;&lt;else&gt;&gt;
   这里零星有几位学生，你可以在这里运动或者练习。


  [[离开|教学楼][$minute += 10]](0:10)
  [[运动|中心庭院][$hour += 3,$body += 3,$energy -= 30]](3:00)&lt;font color=”green”&gt;++力量&lt;/font&gt;&lt;font color=”red”&gt;--体力&lt;/font&gt;
  [[练习术法|下午下课][$hour += 3,$magic += 3,$energy -= 30]](3:00)&lt;font color=”green”&gt;++术法&lt;/font&gt;&lt;font color=”red”&gt;--体力&lt;/font&gt;
   &lt;&lt;/if&gt;&gt;

&lt;&lt;else&gt;&gt;
这里零星有几位学生，你可以在这里运动或者练习。


  [[离开|教学楼][$minute += 10]](0:10)
  [[运动|中心庭院][$hour += 3,$body += 3,$energy -= 30]](3:00)&lt;font color=”green”&gt;++力量&lt;/font&gt;&lt;font color=”red”&gt;--体力&lt;/font&gt;
  [[练习术法|下午下课][$hour += 3,$magic += 3,$energy -= 30]](3:00)&lt;font color=”green”&gt;++术法&lt;/font&gt;&lt;font color=”red”&gt;--体力&lt;/font&gt;
&lt;&lt;/if&gt;&gt;
</tw-passagedata><tw-passagedata pid="213" name="阿尔a3" tags="" position="1525,2800" size="100,100">你们降落于断壁残垣之中，这些建筑残骸已和森林融为一体完全看不出原本是什么。

“就是这里。”辛西娅停在一个坍塌的洞口边上，唯一的通路只能容纳两个人并肩通过。

与外面的艳阳高照截然相反，洞窟入口阴暗潮湿，石砖上布满暗紫色的印记，不知是苔藓留下的痕迹还是千年前的血迹，洞口往里不到一米就黑洞洞的一片，气氛毛骨悚然。

&lt;&lt;linkreplace&quot;继续&quot;&gt;&gt;你等了一会才跟着人群后进入，走了狭窄的小路前进十米左右豁然开朗，你们面前出现了偌大的空间，但里面空空如也，只有几排支撑空间的石柱，形状各异的矿石镶嵌在石壁上照亮整块区域。

“这是夜光石？老天，这里居然有整整一面？”你听见人群有谁发出感叹。

你的目光不经意间扫过一直默默跟在你身旁的阿尔，发现他少有地对其他事物挂上一副专注的表情。

&lt;&lt;linkreplace&quot;这里怎么了吗？&quot;&gt;&gt;这里怎么了吗？

“我在猜这里的用途，”阿尔用手指点着下巴，“夜光石被称为指引灵魂的路标，在上个世代被流行用作随葬品，如果是照明大有更廉价的选择。”

“至于整整一墙，是想谁安息呢......”阿尔自问自答，陷入了与世隔绝的状态。

&lt;&lt;linkreplace&quot;继续&quot;&gt;&gt;辛西娅的声音在石宫中回荡，“穿过这个房间往前走是一段天然溶洞，里面四通八达，点亮鱼油灯的区域是安全的，它能驱散一部分魔物，所以遇到没有光的地方，就离开，你们也许会遇到木精或者别的东西，但它们对于现在的你们来说并不难解决。”

“我不管你是用拳头，还是用你的法力，你们今天要做的事情只有一个，那就是尽你所你地消灭你遭遇到的所有魔物！”

在辛西娅如同发号施令般地开始后，你们被簇拥着进入了宛若迷宫的庞大地道。

&lt;&lt;linkreplace&quot;继续&quot;&gt;&gt;石墙上挂着的鱼油灯焰火跳动，你和阿尔已经在这里转了有一会了，这里像个巨大的刷怪笼，总有些奇奇怪怪的东西，会动的藤蔓，伪装成石头的蟹类，尽管有些时候你也会被吓一跳，但它们不难解决，确实是一个非常适合新手扫街的地方。

但阿尔的情况就......优雅许多，他似乎并不喜欢攻击，只是精确避开每一个出现的魔物，然后隔得远远的发出统一评价。

“真的......丑陋......”他冷着一张脸，“那边，老鼠。”

他话音刚落，你看见一道小腿般大的影子从阿尔刚刚经过的小巷飞中速朝你窜过来！

[[尖叫]]
[[踩]]

&lt;&lt;/linkreplace&gt;&gt;
&lt;&lt;/linkreplace&gt;&gt;
&lt;&lt;/linkreplace&gt;&gt;
&lt;&lt;/linkreplace&gt;&gt;</tw-passagedata><tw-passagedata pid="214" name="尖叫" tags="" position="1450,2850" size="100,100">你发出了尖叫，在窄小的廊道上回荡。等你冷静下来后，那玩意已经消失不见。

“......很好，我现在觉得你才是这里面最危险的了。”阿尔隔得远远的发出评价。

小插曲过后，你们继续沿着有亮灯的地方走，这种鱼油烧起来有股类似植物的特殊焦味。

你们来到一个岔路，左右两边都有亮灯，阿尔跟在你身后。


[[往左走|阿尔a4]]
[[往右走|阿尔a4]]</tw-passagedata><tw-passagedata pid="215" name="踩" tags="" position="1575,2850" size="100,100">你眼疾手快，在它经过你脚边时，毫不犹豫地用鞋跟朝它用力往下一蹬，轻微的啪唧声过后，你得以观察被你踩在脚下的生物——是鼹鼠兽，你在书本看到过，生活在阴暗的地方，食草或以弱小的魔兽为食。

你的鞋算是脏了，而它的身体在抽搐，半死不活的样子。
&lt;div id= &quot;choices&quot;&gt;
&lt;&lt;link&quot;离开&quot;&gt;&gt;
&lt;&lt;replace &quot;#choices&quot;&gt;&gt;&lt;br&gt;“......”

两个人之间的沉默突如其来，总之还是先继续往前走吧。
&lt;br&gt;小插曲过后，你们继续沿着有亮灯的地方走，这种鱼油烧起来有股类似植物的特殊焦味。

你们来到一个岔路，左右两边都有亮灯，阿尔跟在你身后。


[[往左走|阿尔a4]]
[[往右走|阿尔a4]]
&lt;&lt;/replace&gt;&gt;
&lt;&lt;/link&gt;&gt;
&lt;&lt;link&quot;碾压&quot;&gt;&gt;
&lt;&lt;replace &quot;#choices&quot;&gt;&gt;&lt;br&gt;你又用脚使劲碾压了一阵，鼹鼠兽彻底不动弹了。

“说真的，如果你可以离我远点我会非常感激......”阿尔又后退了一步，隔得远远的发出评价。
&lt;br&gt;小插曲过后，你们继续沿着有亮灯的地方走，这种鱼油烧起来有股类似植物的特殊焦味。

你们来到一个岔路，左右两边都有亮灯，阿尔跟在你身后。


[[往左走|阿尔a4]]
[[往右走|阿尔a4]]
&lt;&lt;/replace&gt;&gt;
&lt;&lt;/link&gt;&gt;
&lt;/div&gt;

</tw-passagedata><tw-passagedata pid="216" name="阿尔a4" tags="" position="1525,2925" size="100,100">你们继续深入着，不知是否你的错觉，&lt;font color=&quot;#FF1493&quot;&gt;前方鱼油灯的光亮似乎扭曲了&lt;/font&gt;。

曾经你在森林迷路时也有类似的感觉，这不是一个好兆头，你立刻停下脚步。现在往回走......还有用吗？

你看向阿尔正欲说话，随即发生的事顿时让你愣了一下，这个天然迷宫——起雾了。

&lt;&lt;linkreplace&quot;路不对&quot;&gt;&gt;路不对

“我知道，”阿尔的声音也沉下来。

&lt;&lt;linkreplace&quot;我们得回去&quot;&gt;&gt;我们得回去

你抓住他的胳膊想往回走，“来不及了！”阿尔反手抓住了你，掀起外袍罩住了你们二人。

一股汹涌澎湃的雾突如其来从深处向外淹没，如一条巨蟒在巷道中横冲直撞，一切发生得太快，你们被卷入雾中。

再次睁开眼，世界一片灰黑，没有一丝灯光指引，你只能看见身旁的阿尔。

这里的雾和村子里的不太一样，你能清晰地感受到这雾仿佛活物，试图通过每一片裸露的肌肤渗入你的身体，你感到阴冷，你不确定如果再待下去你是会失温而死还是疯掉。

&lt;&lt;linkreplace&quot;继续&quot;&gt;&gt;“不要愣着，”阿尔靠近你，你第一次从他的语气中听出严肃，“用魔力把雾气抵消掉。”

“......有一类魔物，它们不依靠肉体，是灵魂的聚集体，因此可以将自身消融溶解进雾中，就可以像雾一样迁移，速度快，覆盖面积广，难以解决。”阿尔一边回忆，一边摸索着墙壁上的凹陷。

“我们已经脱离辛西娅划出的主干道了，这里应该是旁殿的遗迹。”

你也伸出手触碰四周，指尖传来柔软潮湿的触感，像是泥土，如果有照明状况或许可以好转。

&lt;&lt;linkreplace&quot;询问他是否会光魔法&quot;&gt;&gt;询问他是否会光魔法

“我们现在就相当于处在别人的术式领域之中，随便使用魔法，小心引来奇怪的东西，”阿尔有了点头绪，神情不复先前的凝重，开始往前走，嘴里念念有词，“应该发生了什么事，无视那个人的术式的同时波及到了我们，不然以你的魔法水平不可能做到。”

话题突然转移到你身上，这么一说，那条满是疑云的项链——你好像确实有一点嫌疑。不过阿尔只是阐述了这个结论，对是否证实它没有兴趣。

你久违地隔着衣服触碰那个石头，什么也没发生。
&lt;div id= &quot;choices&quot;&gt;
&lt;&lt;link&quot;你还挺博学多闻的&quot;&gt;&gt;
&lt;&lt;replace &quot;#choices&quot;&gt;&gt;&lt;br&gt;你还挺博学多闻的

阿尔扭过头去，你看不到他的表情，“不需要你说。”

[[继续|阿尔a5]]
&lt;br&gt;
&lt;&lt;/replace&gt;&gt;
&lt;&lt;/link&gt;&gt;
&lt;&lt;link&quot;你藏书目录还挺丰富的&quot;&gt;&gt;
&lt;&lt;replace &quot;#choices&quot;&gt;&gt;&lt;br&gt;你藏书目录还挺丰富的

“书有什么区别吗，会给文字分门别类才奇怪吧。”

[[继续|阿尔a5]]
&lt;br&gt;
&lt;&lt;/replace&gt;&gt;
&lt;&lt;/link&gt;&gt;
&lt;/div&gt;

&lt;&lt;/linkreplace&gt;&gt;
&lt;&lt;/linkreplace&gt;&gt;
&lt;&lt;/linkreplace&gt;&gt;
&lt;&lt;/linkreplace&gt;&gt;</tw-passagedata><tw-passagedata pid="217" name="阿尔a5" tags="" position="1525,2975" size="100,100">“你是不是还有藤蔓，”阿尔突然停下脚步，转头问你。

&lt;&lt;linkreplace&quot;什么？&quot;&gt;&gt;什么？

“......你一开始就扯断的那个。”

你往衣兜里摸索，还真找出了一截半个小臂长的粗枝，你想起来这是你进洞穴第一个发现的魔物，一时不知道怎么解决就随手塞兜里了，你记得当时阿尔就离你有些远，没想到他比你记得清楚。

等你拿出那段藤蔓时，阿尔不知手上在把玩什么。

“一种魔兽的牙齿，粗糙，硬度非常高，适合打火，”阿尔把兽牙丢给你，然后双手解开外袍，拉开里衬，从侧腰附近抽出一把匕首，衣物好巧不巧被这个动作带动卷起，露出一截肌肉紧实的腹部，“会不会生火？”

虽然在雾里面看什么都有些模糊，你也不知道为什么他要在那里藏一把武器，总之你还是适时移开目光。
&lt;div id= &quot;choices&quot;&gt;
&lt;&lt;link&quot;会&quot;&gt;&gt;
&lt;&lt;replace &quot;#choices&quot;&gt;&gt;&lt;br&gt;会

于是阿尔便将匕首也给了你，你按照记忆中的方法，开始用匕首敲击兽牙。

叮，叮几下，一簇火光在阴影中绽放。

“一般人都只当罗摩草是普通魔物，不知道它的油极其耐烧，”伸手不见五指的洞窟被火把照亮出一方天地，“没想到你竟然知道。”

......居然是这么回事吗？

[[默认|阿尔a6][$pd to &quot;ture&quot;]]
[[表示不知道|阿尔a6][$pd to &quot;faulse&quot;]]
&lt;br&gt;
&lt;&lt;/replace&gt;&gt;
&lt;&lt;/link&gt;&gt;
&lt;&lt;link&quot;不会&quot;&gt;&gt;
&lt;&lt;replace &quot;#choices&quot;&gt;&gt;&lt;br&gt;不会

“那就我来吧......”你看着他指节分明的手握住匕首，用力时更显指长的优越，你不禁觉得这个姿势对他来说，有些性感。

叮，叮几下，一簇火光在敲击下绽放。

“一般人都只当罗摩草是普通魔物，不知道它的油极其耐烧，”伸手不见五指的洞窟被火把照亮出一方天地，“没想到你竟然知道。”

......居然是这么回事吗？

[[默认|阿尔a6][$pd to &quot;ture&quot;]]
[[表示不知道|阿尔a6][$pd to &quot;faulse&quot;]]
&lt;br&gt;
&lt;&lt;/replace&gt;&gt;
&lt;&lt;/link&gt;&gt;
&lt;/div&gt;
&lt;&lt;/linkreplace&gt;&gt;</tw-passagedata><tw-passagedata pid="218" name="阿尔a6" tags="" position="1525,3025" size="100,100">&lt;&lt;if $pd == &quot;faulse&quot;&gt;&gt;
你感到阿尔默不作声地叹了口气，“那就当运气好吧......”
&lt;&lt;/if&gt;&gt;
有了一些照明之后，推进顺畅了一些，但除了千篇一律的深灰石墙别无他物，而且你察觉到本来多如牛毛的岔道这一路上几乎全部消失了。

就在你思索之时，你们就碰上了路的分歧，而雾中隐约有什么庞然大物正向你们坍塌。

阿尔眼疾手快把你拽离，一道肉墙砸到地上发出闷哼——你认出了瑟琳娜，以及其他学生一共四个人。

&lt;&lt;linkreplace&quot;继续&quot;&gt;&gt;“你们.....终于找到你们了！”瑟琳娜第一个开口，她撩开乱糟糟的头发抓住你伸出的手。

“痛.....好痛，”一个戴着眼镜的男同学摸着脑袋爬了起来，“塞莱斯特小姐...不...塞莱斯特同学你没事吧！？”

阿尔面无表情，“真的是吵死了.....”他看着乱糟糟的现场，像个木头一样杵在原地发表感言。

“长话短说，老师说看来这里面的某种术法被触发了，引发空间错位了，”被称作塞莱斯特的女孩无视同伴的帮扶，独自一人优雅地站了起来，她瞟了一眼阿尔，掸了掸裙子，“只有两个人没有回去，老师让我们来找你们。”

但现在看起来是连她们也被卷入了。

&lt;&lt;linkreplace&quot;继续&quot;&gt;&gt;“这诡异的雾到底是什么。”瑟琳娜忧心忡忡地攥住衣角。

“如果想省事，一拳轰开是最快的，”阿尔抱臂走在一旁，离所有人都隔了些距离，“对那个老师来说应该简简单单。”

“不行，这里可是珍贵的文物，”最后一个短发的学生立刻否定阿尔的说法。

“啧，”阿尔抬腿就往另外的路走，压根不管还在整理现状的四人，“那就继续走吧，”不知道为什么，人数一变多，他就目光所及地变得烦躁。

“还不跟上，你想跟这群烦人的家伙呆在一起吗？”看见你并没有跟上，阿尔语气隐隐不耐。

“你这是在说什么？”和塞莱斯特一组的男生露出非常吃惊的表情，“我们可是来找你们的！”

阿尔无视了他的话，甚至脚步迈得更快了。

[[留下|阿尔a7][$pd to &quot;ture&quot;]]
[[跟上|阿尔a7][$pd to &quot;faulse&quot;]]
&lt;&lt;/linkreplace&gt;&gt;
&lt;&lt;/linkreplace&gt;&gt;</tw-passagedata><tw-passagedata pid="219" name="阿尔a7" tags="" position="1525,3075" size="100,100">&lt;&lt;if $pd == &quot;ture&quot;&gt;&gt;“不然我们直接往回走好了，凭什么要我们来救，”短发学生满脸写着愤怒，“什么态度......”

“消消气，消消气......”

瑟琳娜手足无措的样子有些可怜，她对这副情境无可奈何，只好转头跟你说话，“你先去阿尔同学那里吧，我们很快上来。”&lt;&lt;/if&gt;&gt;

你快步追了上去，却发现阿尔停在原地。

在搭话之前，你注意到角落里缓慢蠕动的存在，它的鳞片在火光的印染下折射出诡异的光，是一条小臂那么粗的蛇。

你还没做出任何反应，突然一股力道拽紧了你，熟悉的气息传来，只见阿尔布雷希特那张完美的脸蛋表情崩落，面色铁青，呼吸有些急促。

&lt;&lt;linkreplace&quot;不然你还是叫出来吧&quot;&gt;&gt;不然你还是叫出来吧

阿尔瞪了你一眼，“我、不、怕。”

但你觉得他指尖的颤动出卖了他的话。

“这不是窟龙蛇的幼体吗，”塞莱斯特和瑟琳娜一行人也在这个空挡赶了过来。

“这么丑陋的垃圾，居然也配叫做龙？”你感觉阿尔说这句话的时候，颇有些咬牙切齿。

“这只是一个称谓，阿尔布雷希特同学，被称作龙的物种多了去了，”塞莱斯特似乎不满阿尔的过度反应，出声打断他，“你真的有认真上课吗？”

阿尔嘴角微微上扬，眼中赤裸裸得是对所有人的不屑，不知为何你能感受到他此刻从骨子里透出的傲慢，一种与生俱来的优越感令他在任何场合都应该是高高在上的那个。

“你又是谁，居然反驳我。”仿佛只是在阐述书本上写下的教条，从他的语气中听不出情绪，但正是因为不带任何情绪而显得可怕。

&lt;&lt;linkreplace&quot;继续&quot;&gt;&gt;“阿尔同学！”瑟琳娜瞪大眼睛，不可置信地说到，“你怎么......”

“果真是一个怪胎，”短发的少年朝阿尔靠近一步，面带讽刺，“别以为所有人都被你之前那副表情骗到了。”

“你！”而养尊处优的少女显然没受过这种待遇，塞莱斯特眼圈都红了，“你凭什么这样跟我说话！”

剩下那个人迷茫地与你目光相交，你意识到现在放任事态进行下去弊大于利，事已至此先打圆场吧。

&lt;&lt;linkreplace&quot;表示当务之急是先出去&quot;&gt;&gt;表示当务之急先出去

你用力拽了两三下才把搞乱气氛的罪魁祸首带离原地，尽管当前最好还是不要和人群走散，但为了抵抗雾的蚕食，你此刻的魔力已经所剩无几。于是你只好跟瑟琳娜表示在安抚好其他人之前，你们会到前面远一点的地方探索，后面再回合。

终于拉开一段距离后，其他人的身影在雾中模糊，你看向你那腰杆挺得板直的搭档。

&lt;&lt;linkreplace&quot;怎么对别人那么凶&quot;&gt;&gt;怎么对别人那么凶

“我需要原因吗？”此刻阿尔语气里满是冷漠，你能听出他确实不认为自己有做过头的地方。

你想起当初瑟琳娜介绍他给你认识的时候，又联想刚刚众人一副被欺骗的表情。

&lt;&lt;linkreplace&quot;但你一开始还挺好说话的&quot;&gt;&gt;但你一开始还挺好说话的

“不是说这样就可以给人好感吗？”

你没想到阿尔是出于这种想法，不禁偏头看向他，此时此刻他半阖着眼，睫毛长而卷翘，姿态又变回一副完美无瑕的雕塑模样，你猜不透他的想法。


[[社交是需要维持的|阿尔a8][$pd to &quot;ture&quot;]]
[[你其实不喜欢社交吧|阿尔a8][$pd to &quot;faulse&quot;]]
&lt;&lt;/linkreplace&gt;&gt;
&lt;&lt;/linkreplace&gt;&gt;
&lt;&lt;/linkreplace&gt;&gt;
&lt;&lt;/linkreplace&gt;&gt;
&lt;&lt;/linkreplace&gt;&gt;</tw-passagedata><tw-passagedata pid="220" name="阿尔a8" tags="" position="1525,3150" size="100,100">&lt;&lt;if $pd == &quot;ture&quot;&gt;&gt;“......真是麻烦。”你听见阿尔小声嘀咕。
&lt;&lt;else&gt;&gt;“为什么要喜欢？”他又是一句疑问，你深感阿尔在这方面完全是一个空白。

他直直地盯着前方，突然喃喃自语，“如果时间再久一点......我就可以学会了。”

“......真是麻烦。”最后你听见阿尔小声嘀咕。
&lt;&lt;/if&gt;&gt;
你们以正常的速度前进，罗摩草烧制的火焰早已不如先前明亮，你开始有些透不过气，时间一分一秒地过去，你隐隐感觉到雾的流动逐渐凝滞，阿尔也是同样的感受。

&lt;&lt;linkreplace&quot;不能再往前了&quot;&gt;&gt;不能再往前了，你有这种直觉

“确实，但这里还不是源头，”阿尔静静地说，看来他似乎心情平复了很多，“快了。”

你转头看向来路，其他人的身影还完全看不见。

“不.....我们运气很好，”阿尔停了下来，示意你看向脚下，雾中蜷缩着紫黑色的光芒，如同雷光闪烁时隐时现，目光所及之处皆是如此，其中蕴含的诡异力量让人只是看着就足以灵魂破碎，这里已经不是一条巷道了，你们正身处这一路下来前所未有的的巨大空间。

他又沉默了一会才说，“书里可没说没路的地方就是出口。”

&lt;&lt;linkreplace&quot;继续&quot;&gt;&gt;就在你往四周远眺时，突然你的大脑一阵刺痛，这些雾开始影响你，&lt;font color=&quot;#FF1493&quot;&gt;你的认知似乎发生了变化&lt;/font&gt;。

除了阿尔，你是这群人里呆在雾中最久的了，已经消耗大量魔力抵御雾气侵袭，你需要速战速决。

正当你不得不开始考虑阿尔先前提议轰开这里的可行性之时，你的眼前一阵花白。

&lt;&lt;linkreplace&quot;继续&quot;&gt;&gt;&lt;font color=&quot;yellow&quot;&gt; “露珠。”&lt;/font&gt;

——熟悉的声音于灵魂深处呼唤你，心脏砰砰作响，来不及考虑阿尔惊讶的目光，你不假思索地摸向胸口，那沉寂许久的水滴型宝石此刻仿佛千钧重，在你手中再一次散发光辉，照亮你的面颊。

“光精灵？”你听见你的身后传来声音，你的身体忠实地执行着你的本能，但你的灵魂只想要睡去，“这里怎么会有光元素......这么多？”

你的五感被蒙上一层玻璃，你所感知的一切正在离你远去。

&lt;&lt;linkreplace&quot;继续&quot;&gt;&gt;&lt;font color=&quot;yellow&quot;&gt; “露珠，约定之日”&lt;/font&gt;

它们柔和地散开，你感受到一种牵引的力量指引着你向前，你强撑着抬起头，顷刻间地面之上的雾被荡平，你简直不敢相信眼前的情景，雾海的尽头巨大的屏障拔地而起不见终点，让人不禁觉得若是日月存在于此，它们也会被这强大的力量撕裂，而离你们只有一步之遥的是深不见底的沟壑，浓雾翻涌犹如窥伺的毒蛇。

但你的情况更糟，本就见底的身体根本无法支撑数量庞大的精灵，你已经完全透支脚下一软。


[[继续|阿尔a9]]
&lt;&lt;/linkreplace&gt;&gt;
&lt;&lt;/linkreplace&gt;&gt;
&lt;&lt;/linkreplace&gt;&gt;
&lt;&lt;/linkreplace&gt;&gt;</tw-passagedata><tw-passagedata pid="221" name="阿尔a9" tags="" position="1525,3225" size="100,100">——阿尔及时抓住了你的手，在你的意识激将溺毙于水下之时，一股极其霸道的魔力突然涌向你，在你的身体之中横冲直撞，你差点叫出来，那实在是太烫了，烫得你浑身战栗，你顿时清醒过来。

而这魔力的来源，阿尔布雷希特正并肩站在你身旁，相握的手掩盖在宽大的外袍之下，嗓音低沉钻入你的耳朵，“集中注意力。”

源源不断的魔力如同活水洗刷你的身体，原本混沌的意识被强制性唤醒，你一度觉得自己人生中从未有过如此清醒的时刻，你不知道阿尔布雷希特是怎么做到的，你惊讶地看向他。

&lt;&lt;linkreplace&quot;表示感谢&quot;&gt;&gt;表示感谢

阿尔的脸红了一下，随即转过头目视前方，长叹一口气，“不要去问，不要去想，一切交给我，你只需感受魔力。”

你感官的敏锐度被无限放大，无时无刻想将你拆解入腹的雾气此刻在你的目光中颤抖，如同丧家之犬般被迫承受你的注视——于是你看到了，由血肉搭建的断壁颓垣，黑色的兽有了凡人模样，灵魂苍白叫嚣着，亡者隐藏于雾中，混沌与安宁并无区别。

&lt;p class=&quot;mohu1&quot;&gt;你突然意识到一直以来你所面对的雾是什么，那是数不胜数的灵魂——它们欢迎你，它们诋毁你。&lt;/p&gt;



[[你应该对此保持宽容|阿尔a10][$pd to &quot;ture&quot;]]&lt;font color=&quot;green&quot;&gt;+???&lt;/font&gt;
[[你应该对此进行审判|阿尔a10][$pd to &quot;faulse&quot;]]&lt;font color=&quot;green&quot;&gt;+???&lt;/font&gt;
&lt;&lt;/linkreplace&gt;&gt;</tw-passagedata><tw-passagedata pid="222" name="阿尔a10" tags="" position="1525,3300" size="100,100">&lt;&lt;if $pd == &quot;ture&quot;&gt;&gt;——但你远在它们之上，强烈的情感充斥着你，你对这些卑劣的灵魂觊觎于你感到可怜，尽管它们渴求着你的堕落，但你依然选择宽容，你已然和整个空间融为一体。

&lt;&lt;linkreplace&quot;信徒&quot;&gt;&gt;&lt;font color=&quot;yellow&quot;&gt;——它们是你的信徒&lt;/font&gt;

你不知被何种事物驱使着抬起手，遥遥指向万丈沟壑之外，你的眼中只剩下一个奇异的光点，牙根发酸骨头酥麻，你甚至听见自己肋骨随着呼吸扩张的震动。

&lt;p class=&quot;mohu1&quot;&gt;——你需要做什么才能结束一切？

——击中它，仅此而已。&lt;/p&gt;

&lt;&lt;linkreplace&quot;直击&quot;&gt;&gt;&lt;font color=&quot;yellow&quot;&gt;直击&lt;/font&gt;

你无声地轻起唇齿，一道光破空而去，在稀薄的雾中撕裂出一个大洞，刹那间屏障如同沸腾的河海，预示其崩溃前兆的是风，强烈的风扑面而来拽得你发根生疼，你拽着阿尔弯下腰降低重心，但不过须臾，风又以完全相反的方向席卷。

你仿佛看见雾中的亡魂嘶吼着，挣扎着，像一颗小小的石子，轻而易举掉入面前的深渊。

两个人的心跳于迷雾中振聋发聩，你看向身边的人。

&lt;&lt;linkreplace&quot;询问还能支撑多久&quot;&gt;&gt;询问还能支撑多久

“到你解决这件事为止，绰绰有余。”尽管阿尔此刻的外表并不好看，白皙的脸上沾满灰尘，侧发绞起一绺绺在风中飞扬，他依然保持平静，握着你的手巍然不动，你能看见他的瞳仁形状正在迅速变化，眼底暗流涌动，你能感受到他的魔力，那只是窥视就会被灼烧的炽热源头，阿尔布雷斯特，犹如一位流浪的君主于此刻蔑视他被摧毁的巢。

你深吸一口气，眼前的深渊就是出口，或者说是以灵魂为驱动力的术式源头，你能感受到它对你的渴望，即便你不主动去，也迟早会被愈演愈烈的风卷入。

&lt;font color=&quot;#FF1493&quot;&gt;但就这种脆弱的阵法也妄图容纳你的灵魂，下场只有毁灭&lt;/font&gt;。你听见有谁在你耳边低语，恍惚中，一种预感油然而生，如果有什么是为称量灵魂之重而存在，那么你一定会万劫不复。

&lt;&lt;linkreplace&quot;询问是否怕高&quot;&gt;&gt;询问是否怕高

“我怕高？”阿尔嗤笑了一声，“开什么玩笑。”

&lt;&lt;linkreplace&quot;那就和我跳下去&quot;&gt;&gt;那就和我跳下去

“.......你们要干什么，为什么起风了！”好几个人杂乱的声音从逆着风的方向传来，但你无暇顾忌，你拉起阿尔布雷希特的手，一步一步走向悬崖。

“怎么看起来像殉情。”阿尔还在笑，但你听出些许惬意。




[[如果失败那就是了|阿尔a11][$pd to &quot;ture&quot;]]
[[你从哪本书学到的词|阿尔a11][$pd to &quot;faulse&quot;]]
&lt;&lt;/linkreplace&gt;&gt;
&lt;&lt;/linkreplace&gt;&gt;
&lt;&lt;/linkreplace&gt;&gt;
&lt;&lt;/linkreplace&gt;&gt;
&lt;&lt;/linkreplace&gt;&gt;
&lt;&lt;else&gt;&gt;——但你远在它们之上，强烈的情感充斥着你，你对这些卑劣的灵魂觊觎于你感到可笑，你已然和整个空间融为一体。

&lt;&lt;linkreplace&quot;囚徒&quot;&gt;&gt;&lt;font color=&quot;yellow&quot;&gt;——它们是你的囚徒&lt;/font&gt;

你不知被何种事物驱使着抬起手，遥遥指向万丈沟壑之外，你的眼中只剩下一个奇异的光点，牙根发酸骨头酥麻，你甚至听见自己肋骨随着呼吸扩张的震动。

&lt;p class=&quot;mohu1&quot;&gt;——你需要做什么才能结束一切？

——击中它，仅此而已。&lt;/p&gt;

&lt;&lt;linkreplace&quot;直击&quot;&gt;&gt;&lt;font color=&quot;yellow&quot;&gt;直击&lt;/font&gt;

你无声地轻起唇齿，一道光破空而去，在稀薄的雾中撕裂出一个大洞，刹那间屏障如同沸腾的河海，预示其崩溃前兆的是风，强烈的风扑面而来拽得你发根生疼，你拽着阿尔弯下腰降低重心，但不过须臾，风又以完全相反的方向席卷。

你仿佛看见雾中的亡魂嘶吼着，挣扎着，像一颗小小的石子，轻而易举掉入面前的深渊。

两个人的心跳于迷雾中振聋发聩，你看向身边的人。

&lt;&lt;linkreplace&quot;询问还能支撑多久&quot;&gt;&gt;询问还能支撑多久

“到你解决这件事为止，绰绰有余。”尽管阿尔此刻的外表并不好看，白皙的脸上沾满灰尘，侧发绞起一绺绺在风中飞扬，他依然保持平静，握着你的手巍然不动，你能看见他的瞳仁形状正在迅速变化，眼底暗流涌动，你能感受到他的魔力，那只是窥视就会被灼烧的炽热源头，阿尔布雷斯特，犹如一位流浪的君主于此刻睥睨万物。

你深吸一口气，眼前的深渊就是出口，或者说，以灵魂为驱动力的术式源头，你能感受到它对你的渴望，即便你不主动去，也迟早会被愈演愈烈的风卷入。

但就这种脆弱的阵法也妄图容纳你的灵魂，下场只有毁灭。恍惚中，一种预感油然而生，如果有什么是为称量灵魂之重而存在，那么你一定会万劫不复。

&lt;&lt;linkreplace&quot;询问是否怕高&quot;&gt;&gt;询问是否怕高

“我怕高？”阿尔嗤笑了一声，“开什么玩笑。”

&lt;&lt;linkreplace&quot;那就和我跳下去&quot;&gt;&gt;那就和我跳下去

“.......你们要干什么，为什么起风了！”好几个人杂乱的声音从逆着风的方向传来，但你无暇顾忌，你拉起阿尔布雷希特的手，一步一步走向悬崖。

“怎么看起来像殉情。”阿尔还在笑，但你听出些许惬意。




[[如果失败那就是了|阿尔a11][$pd to &quot;ture&quot;]]
[[你从哪本书学到的词|阿尔a11][$pd to &quot;faulse&quot;]]
&lt;&lt;/linkreplace&gt;&gt;
&lt;&lt;/linkreplace&gt;&gt;
&lt;&lt;/linkreplace&gt;&gt;
&lt;&lt;/linkreplace&gt;&gt;
&lt;&lt;/linkreplace&gt;&gt;
&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="223" name="阿尔a11" tags="" position="1525,3350" size="100,100">&lt;&lt;if $pd == &quot;ture&quot;&gt;&gt;“那会失败吗？”阿尔反问你。
&lt;div id= &quot;choices&quot;&gt;
&lt;&lt;link&quot;如果会呢&quot;&gt;&gt;
&lt;&lt;replace &quot;#choices&quot;&gt;&gt;&lt;br&gt;“那确实是殉情了。”
&lt;br&gt;
&lt;&lt;/replace&gt;&gt;
&lt;&lt;/link&gt;&gt;
&lt;&lt;link&quot;不会&quot;&gt;&gt;
&lt;&lt;replace &quot;#choices&quot;&gt;&gt;&lt;br&gt;“看来是不能小瞧你的意思？”
&lt;br&gt;
&lt;&lt;/replace&gt;&gt;
&lt;&lt;/link&gt;&gt;
&lt;/div&gt;

&lt;&lt;else&gt;&gt;“哪本呢......我忘了，要记的东西太多了，”

“多到我不知道该留下哪些了。”
&lt;&lt;/if&gt;&gt;

你的心脏几乎跃出胸膛，衣袍猎猎作响，你放松身体，任由风将你们二人拽入深渊。

[[继续|阿尔a12]]</tw-passagedata><tw-passagedata pid="224" name="坐到狄更斯周围" tags="" position="1275,2300" size="100,100">你坐到狄更斯的周围。
&lt;&lt;if $DET.love &gt; 10&gt;&gt;
     &lt;&lt;set $randomNumber to random(100)&gt;&gt;
     &lt;&lt;if $randomNumber &lt; 10 &amp;&amp; $DET.nick == &quot;&quot;&gt;&gt;
          
“想不想换一个称呼？”狄恩特正坐在你对面。

“你也看出来了吧，维尔弗兰招收的学生几乎没有年龄限制。”

确实，你在这里看到了几乎各种年龄段的学生，年轻的看起来不过十四五岁，年长的可以二三十了，但维尔弗兰似乎有种神奇的魔力将这些人拧成一股麻绳。

“所以学生间的称呼往往变成势力间的比较，”他显然对这个比对盘子里的食物更感兴趣，一整块鱼肉在他无意识地戳动下变成一滩碎沫。

你感觉有些莫名其妙，不明白这个话题的目的。

狄恩特放下手中的餐具，双手交叠托着脸笑了起来，循循善诱，“你希望我叫你学姐，还是学妹？”

.......

[[学姐|昵称狄恩特][$DET.nick to &quot;学姐&quot;]]
[[学妹|昵称狄恩特][$DET.nick to &quot;学妹&quot;]]
[[保持原样|昵称狄恩特]]
        &lt;&lt;/if&gt;&gt;
        &lt;&lt;set $randomNumber to random(100)&gt;&gt;
        &lt;&lt;if $randomNumber &lt; 40&gt;&gt;
        狄恩特眼底有浅浅的乌青，正在不停地打哈欠。
        
        ”呀，中午好，如你所见，我正在努力克服睡意。“他向你挥了挥叉子权当打招呼。
        
        ”看起来想做了噩梦的样子？怎么，你觉得我做梦很神奇？“
        
        ”然而，“狄恩特有些出神，”正因为是我，才不停地做梦。“
        &lt;&lt;else&gt;&gt;
        你看见狄恩特一如既往地在盘子里挑挑拣拣。
        
        ”形貌不端？“他瞪大眼睛，用手指挑开散在一边的领带。
        
        ”你怎么可以这样说我，“狄恩特一副伤心的样子，”如果你每次醒来都发现自己在不同的地方，也不会有心思整理衣服吧！“
        &lt;&lt;elseif $randomNumber &lt; 70&gt;&gt;
        ”我很高兴看见你朝我走来。“
        
        ”因为现在的你坐在我旁边，“”让我今天没有虚度。“
        &lt;&lt;/if&gt;&gt;
        午餐时间结束了，该准备前往下午的课了。
        
        [[继续|下午]]
&lt;&lt;else&gt;&gt;
“嗨，”他向你打招呼。

“和你一起上学是相当新奇的体验，”狄恩特对进食兴致缺缺，正拿着叉子对盘子里的西兰花进行分类，你怀疑他是不是挑食。

“不过原谅我大部分时间都不在吧，”他笑嘻嘻的，“为了维持这副躯体，我得付出相当大的努力啊。”

午餐时间结束了，该准备前往下午的课了。

[[继续|下午]]
&lt;&lt;/if&gt;&gt;
</tw-passagedata><tw-passagedata pid="225" name="坐到阿尔布雷希特周围" tags="" position="1275,2400" size="100,100">你坐到阿尔旁边的空位。
&lt;&lt;set $randomNumber to random(100)&gt;&gt;
&lt;&lt;if $randomNumber &lt; 20&gt;&gt;
”不知道你有没有看到一种奇怪的蜜蜂，“阿尔少有地跟你说话，”不是普通的那种蜜蜂，或者说是被改造后的生物，还是本身是种魔导具......“

阿尔陷入了自我思考，旁若无人地开始自言自语，”也许我可以故意......“

&lt;&lt;else&gt;&gt;
“...你好，”阿尔对做到他身边的你轻轻点头，然后继续投入书本。

阿尔经常翻几页才吃一点，或者直接拿着食物翻页，你没有打扰他，然后眼睁睁地看着阿尔叉子上的小面包掉到书上。

在那瞬间你看到他完美的脸蛋露出一丝裂痕，然后对着书本如临大敌地念了一长串咒语。

......就当没注意到吧。

午餐时间结束了，该准备前往下午的课了。

&lt;&lt;/if&gt;&gt;

[[继续|下午]]</tw-passagedata><tw-passagedata pid="226" name="自己独自一人" tags="" position="1575,2500" size="100,100">你选择独自一人吃午饭。

你听着周围人叽叽喳喳，以及锅碗瓢盆碰撞的声音，恍然产生有一种融入这个群体的感觉。



[[下午]]</tw-passagedata><tw-passagedata pid="227" name="坐到瑟琳娜周围" tags="" position="1275,2500" size="100,100">你坐到瑟琳娜的周围。
&lt;&lt;set $randomNumber to random(100)&gt;&gt;
&lt;&lt;if $randomNumber &lt; 20&gt;&gt;
”你知道当初入学的成绩排名吗，“瑟琳娜环顾四周，压低声音说到，”虽然说是不公开的，但我恰好知道。“

”第一名是阿尔布雷希特哦，是不是看不出来，“她吃吃地笑起来，”不过可能因为第一被外国人拿了，后面几名特别不服气呢。“

&lt;&lt;elseif $randomNumber &lt; 70&gt;&gt;
瑟琳娜进食时可以称得上优雅，还向你介绍了几种食材如何搭配才好吃。

看来在这方面她颇有自己的见解。

&lt;&lt;else&gt;&gt;
”你知道维尔弗兰的学生的处分是怎么样的吗，“瑟琳娜像是想起什么有趣的东西，笑了起来，”就是让学生去搞卫生——整整一天，不准用魔法，要是被发现使用魔法的话就再延长一天。“

”也许乍一听没什么关系，但如果说占用的时间是周末呢，“瑟琳娜放下手中的餐食，”我可不想宝贵的回家时间被占。“

&lt;&lt;/if&gt;&gt;

[[下午]]</tw-passagedata><tw-passagedata pid="228" name="下午" tags="" position="1550,2100" size="100,100">&lt;&lt;set $hour = 14&gt;&gt;&lt;&lt;set $minute = 0&gt;&gt;今天是星期$weekDay

下午的课是&lt;&lt;if $weekDay == 1||$weekDay == 3 || $weekDay == 5&gt;&gt;实战课&lt;&lt;else&gt;&gt;魔药课&lt;&lt;/if&gt;&gt;


&lt;&lt;if $weekDay == 1||$weekDay == 3 || $weekDay == 5&gt;&gt;[[前往中心庭院|中心庭院上课跳转][$tiyvke += 1]]&lt;&lt;else&gt;&gt;[[前往炼药房|魔药教室][$moyaoke += 1]]&lt;&lt;/if&gt;&gt;

</tw-passagedata><tw-passagedata pid="229" name="昵称狄恩特" tags="" position="1425,2400" size="100,100">&lt;&lt;if $DET.nick == &quot;学姐&quot;&gt;&gt;
”&lt;&lt;print $DET .nick&gt;&gt;？“

狄恩特原本正兴致盎然地关注你的表情，他却突然沉默了，一点绯红爬上他的耳廓，狄恩特偏开头，卷曲的刘海遮住眼睛。

”......原来是这种感觉吗？“

午餐时间结束了，该准备前往下午的课了。

[[继续|下午]]
&lt;&lt;elseif $DET.nick == &quot;学妹&quot;&gt;&gt;
”&lt;&lt;print $DET .nick&gt;&gt;？“

狄恩特原本正兴致盎然地关注你的表情，他却突然沉默了，一点绯红爬上他的耳廓，狄恩特偏开头，卷曲的刘海遮住眼睛。

”......原来是这种感觉吗？“

午餐时间结束了，该准备前往下午的课了。

[[继续|下午]]
&lt;&lt;else&gt;&gt;
”这样吗，$jia，“狄恩特笑着说，”那也不错，看来你对这个名字很满意？“

午餐时间结束了，该准备前往下午的课了。

[[继续|下午]]
&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="230" name="塞缪尔a1" tags="" position="1725,2650" size="100,100">&lt;&lt;set $currentWeather = &quot;晴天&quot;&gt;&gt;你正打算往西边走，迎面突然走来一群师生，如果这时候在路中间回身未免显得反常，于是你硬着头皮与她们擦肩而过。

毕竟现在还是低年级上课时间，你独自在这游荡非常显眼，虽然你不怎么担心会不会被认出来，但如果因此被处分总是会多一份麻烦事。

接连遇到几次这样的情况，最后你来到了一个完全陌生的庭院，你走在这里的回廊上，一时半会还不熟悉方向。

&lt;&lt;linkreplace&quot;继续走&quot;&gt;&gt;不停地走

你穿过好几个回廊，这里实在太大了，每个花坛每根柱子似乎都微妙地相同又不同，你没有明确的参照物。

你意识到自己迷路了。

目光所及的范围里没有一个人，尽管你还分得清南北，但你找不到确切出去的路，如果绕着边缘走一大圈回去可能连下午的课也要错过了，你试着进入这些建筑，但无一例外每扇门都被一股力量锁住，你无法撼动。

&lt;&lt;linkreplace&quot;继续&quot;&gt;&gt;如果有一个足够高的地方，也许可以帮助你找到正确的路，你环视四周，在树木掩映的西边看到一个非常突出的尖顶塔楼，距离不是很远，你祈祷至少那里不要锁门。

你穿过一座桥，这里似乎没有太多魔法的管束，你上了台阶走进那片铺满落叶的树林，已是晚秋仍有鸟类的身影在枝叶间时隐时现。风声渐起，时不时就要伸手压住被吹得皱起的外衣，你沿着卵石小路走到一处水塘，尖塔就在旁边。

[[继续|塞缪尔a2]]
&lt;&lt;/linkreplace&gt;&gt;
&lt;&lt;/linkreplace&gt;&gt;</tw-passagedata><tw-passagedata pid="231" name="塞缪尔a2" tags="" position="1725,2775" size="100,100">你来到塔前，灰色的石砖被磨砺得粗糙却依然坚固，高处若隐若现的轮廓间伸出无数条细长的藤蔓，与其他已经枯黄的落叶相比，这些枝条茂盛生长像瀑布一样披散在塔身，嫩绿色的叶片小而圆在风中轻轻摇曳。

然后你毫不意外地发现——门紧紧关着。

&lt;&lt;linkreplace&quot;继续&quot;&gt;&gt;虽然是意料之中，但难免还是有些失落，你可能要做好最坏的打算了。

“你好？”就在此时，悦耳的声音忽地穿过风，从高处落进你的耳中。

你抬头望去，塔顶露台处，一位青年探出半个身体看向你，你看见他璨金色发丝随风拂动，逆着湛蓝天光像一颗毛茸茸的太阳。

&lt;&lt;linkreplace&quot;你好&quot;&gt;&gt;你好

你眯起眼试图看清他的面容，时间却仿佛凝固，有什么无形的力量将你们的目光紧紧吸引，对方的安静让你霎时感到恍惚，一丝毫无缘由的怅然从你心中升起。

隔着遥远的距离，你似乎在深秋一片叶子落下的间隙中与对方感同身受，微微缩小的瞳孔，错乱的心跳，你忘了出声让他帮你开门，直到骤起的强风吹散一切，你不得不低头掩住口鼻。

&lt;&lt;linkreplace&quot;继续&quot;&gt;&gt;“你等一下！”高处的青年反应过来，转身消失在你的视野。

很快隔着门你能听见急促的脚步声如攀升的音阶越来越近，他推开门，碧色的瞳孔在阳光下熠熠生辉，清浅的眉眼间蕴着不属于这个季节的暖意。

呼吸间，他直直地看向你没有转移视线，端着一张清纯无害的脸，突然向你问道。

“你叫什么名字？”

[[？|塞缪尔a3]]
&lt;&lt;/linkreplace&gt;&gt;
&lt;&lt;/linkreplace&gt;&gt;
&lt;&lt;/linkreplace&gt;&gt;</tw-passagedata><tw-passagedata pid="232" name="塞缪尔a3" tags="" position="1725,2825" size="100,100">他似乎是终于意识到自己那过于直白的注视，碧色的瞳孔闪烁了一下，他侧过头。

“抱歉，只是非常好奇，”他重新向你展露了一个无可挑剔的笑容，耳后却染上一层薄红，“我应该先做自我介绍。”

“塞缪尔，我的名字是塞缪尔，可以知道你的名字吗？”

[[告诉|塞缪尔a4][$SAM.name to &quot;ture&quot;]]
[[拒绝|塞缪尔a4][$SAM.name to &quot;faulse&quot;]]

</tw-passagedata><tw-passagedata pid="233" name="塞缪尔剧情变量" tags="" position="1850,2900" size="100,100">&lt;&lt;set $SAM.name to &quot;&quot;&gt;&gt;</tw-passagedata><tw-passagedata pid="234" name="塞缪尔a4" tags="" position="1725,2875" size="100,100">&lt;&lt;if $SAM.name == &quot;ture&quot;&gt;&gt;“$jia，”塞缪尔眼神微动，“太好了，我会记住的，你是不是想上去，这种偏远角落里，也就只有这座塔楼值得一来。”
&lt;&lt;else&gt;&gt;“那等哪一天你会愿意告诉我吗，”他并没有显露出失落，“我希望可以有这个机会。”

“对了，你是不是想上去？这种偏远角落里，也就只有这座塔楼值得一来。”
&lt;&lt;/if&gt;&gt;
&lt;&lt;linkreplace&quot;继续&quot;&gt;&gt;你跟在塞缪尔的身后，十分方便你默默地打量，他个子很高，穿着的深色高腰裤更显身型优越，衣料没有什么点缀，但领口和肩部的剪裁非常贴身，你不禁在心里猜测他的身份。

塔楼有些高，你们爬了有一会儿，与塔身的给人留下的古朴印象不同，塔顶整洁许多，内部是不染尘埃的白色砖墙，塞缪尔一副轻车熟路的样子将你引到边上。

&lt;&lt;linkreplace&quot;询问他是否是这里的学生&quot;&gt;&gt;你是这里的学生吗？

“是。”他几乎是马上接着你的话头回答，然后他瞪大眼睛。

“等...”塞缪尔收回目光往外望去，手指因为紧张而收紧，“等等，不.....我不是。”

“我是来侍弄花草的，我想你肯定看到了，就是那些垂在塔外的枝条，”他向你展示这一大圈的植物，它们根部发达牢牢抓在土壤之中，枝条熙熙攘攘，与外界隔绝出一片小天地，如此茂盛的植株想来应该有些年头了，“雪茧莲，它们开在冬天，花瓣是纯白色的，花蕊是靛蓝。”

不得不说，塞缪尔的长相应当是非常受人欢迎以及信服的。

你趴在边缘往外看，这里确实更高，但还不足以让你看清所有通路。

&lt;&lt;linkreplace&quot;询问是否知道如何出去&quot;&gt;&gt;你知道怎么走出去

“原来是迷路了吗，”塞缪尔露出了然的微笑，“确实，我每次来维尔弗兰也觉得这里实在太大了。”

他思索了一会，“这里还不够高吧，要不要去更高的地方。”

&lt;&lt;linkreplace&quot;什么意思？&quot;&gt;&gt;什么意思？

话音未落，塞缪尔一只脚便踩上围栏的空隙，那里仅有半只手掌宽，他几乎整个身子都在空中，随后他又稳稳地迈开另一条腿，重心前移，就这样像一只轻盈的飞鸟停在了半空。

这明显是一种术法，但你没有在他身上感受到任何魔力流动。

&lt;&lt;linkreplace&quot;询问如何做到&quot;&gt;&gt;怎么做到的？

“如果你想学的话，我很乐意教你，”青年露出灿烂的笑容斜倚在空中，浅金色的阳光洒在他脸上更显明眸皓齿，“不过现在先找路吧。”

“所以要试一试吗？”塞缪尔俯身朝你伸出右手，嗓音放得低沉，如同诱哄一般令人无法拒绝，但若是注视他的双眸，又让人觉得那种想法只会污秽这眼底的真挚。

&lt;font color=&quot;#FF1493&quot;&gt;你似乎被蛊惑了，你无法拒绝。&lt;/font&gt;

[[伸手|塞缪尔a5]]
&lt;&lt;/linkreplace&gt;&gt;
&lt;&lt;/linkreplace&gt;&gt;
&lt;&lt;/linkreplace&gt;&gt;
&lt;&lt;/linkreplace&gt;&gt;
&lt;&lt;/linkreplace&gt;&gt;
</tw-passagedata><tw-passagedata pid="235" name="塞缪尔a5" tags="" position="1725,2925" size="100,100">塞缪尔握紧了你的手，这是干燥而温暖的掌心，指腹上的薄茧粗糙，平添一丝亲近，你的身体似乎发生变化，你感受到自己的身体越来越轻，仿佛剥离了肉体只剩下灵魂。

他徐徐收紧手臂，你便和他肩并肩，此时已经看不清地面的影像，但脚底传来的坚实触感让你感到安心。

&lt;&lt;linkreplace&quot;询问后面怎么做&quot;&gt;&gt;询问后面怎么做

“就像走楼梯一样，”塞缪尔率先往上走了一步给你示范，你紧跟其后。

&lt;&lt;linkreplace&quot;询问这样能走多高&quot;&gt;&gt;询问这样能走多高

“你想要多高就能走到多高，”你们在空中漫步，塞缪尔舒展左臂，几只振翅翱翔的蓝鸟恰好从他指尖掠过。

&lt;&lt;linkreplace&quot;询问真假&quot;&gt;&gt;真的假的

“当然，只要是你说的，”他向你展开手，一根纤细的蓝色羽毛躺在手心，“水笛鸟的羽毛，从不同方向看会呈现不同颜色，试一下？”

你掂起羽毛，如他所说稍微偏转角度，原本纯净的天蓝变为紫金交织的颜色，非常漂亮，“只有秋冬交际的时候它们才会经过这里，”你们快要走到塔尖，塞缪尔突然停了下来慢你一步，于是你走到比他更高的地方。

“它们和你很有缘。”

借助高度差，你得以俯视塞缪尔被秋日照亮的脸庞，他的所有颜色都被无尘无垢的白浸透。

&lt;&lt;linkreplace&quot;你对谁都这样说话吗&quot;&gt;&gt;你对谁都这样说话吗

“说什...”塞缪尔惊讶地歪头看你，然后就卡壳了，仿佛对自己说过的话后知后觉，“并不是那样，因为认识你很高兴，所以情不自禁......唯有这一点请务必相信我。”

你感受到他对你天然带有好感，你看向眼前神情认真的青年，不知道自己现在是不否也如他那般脸颊发烫，又不禁觉得塞缪尔有什么不看别人眼睛就说不出话的毛病。

“现在呢，够高了吗？”塞缪尔捏了捏你的手，转移你的注意力。

[[继续|塞谬尔a6]]
&lt;&lt;/linkreplace&gt;&gt;
&lt;&lt;/linkreplace&gt;&gt;
&lt;&lt;/linkreplace&gt;&gt;
&lt;&lt;/linkreplace&gt;&gt;</tw-passagedata><tw-passagedata pid="236" name="塞谬尔a6" tags="" position="1725,2975" size="100,100">你往奥梅拉斯大阶梯的方向望去，这次你看清了这错综复杂的道路，原来从一开始你就误入了另外一个建筑群，而这个区域也只有那一条路可以回去。

“如果可以，我很乐意直接带你过去，可惜维尔弗兰有一套相当复杂的管制条例，要是被发现就不好了......”他思索一会，扶住了你的肩膀，“但如果保持安静，我们悄悄地......”

你眼前一花，眨眼间你们就翩跹降落在地面上了，你环顾四周，已经是你熟悉的教学楼了，塞缪尔眨眨眼，”我想你应该是从这里来的......“

话音未落，你突然听到清脆的金属碰撞声，频率细而密让你联想起会扇动翅膀翅膀的生物，于是某种像是昆虫的东西突然出现在了周围，“哦，好吧，被发现了，”塞缪尔改口道，他似乎对这个流程并不陌生，”既然如此我就先和它们走一步了，“那奇怪的生物停在塞缪尔的肩头。

“你对雪茧花感兴趣吗？”塞缪尔慢慢松开你的手，他有些紧张，“就是，如果晴天的这个时间段，还是那个地方，”你的指节从他手心滑走，“抱歉，我得先走了。”

他连同那个生物一起消失在原地。

你重新观察你的方位，开始往外走。



[[下午]]</tw-passagedata><tw-passagedata pid="237" name="早退地图" tags="" position="1250,2675" size="100,100">你现在



[[前往塔楼]]
[[休息|早退地图0]]</tw-passagedata><tw-passagedata pid="238" name="前往塔楼" tags="" position="1100,2800" size="100,100">施工中


[[前往教学楼|下午]]</tw-passagedata><tw-passagedata pid="239" name="进入教室" tags="" position="1375,1700" size="100,100">&lt;&lt;if $hour &lt; 10&gt;&gt;
&lt;&lt;goto&quot;理论课&quot;&gt;&gt;
&lt;&lt;else&gt;&gt;
&lt;&lt;goto”历史课“&gt;&gt;
&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="240" name="理论课" tags="" position="1425,1875" size="100,100">&lt;&lt;set $hour = 8&gt;&gt;&lt;&lt;set $minute = 0&gt;&gt;&lt;&lt;if $cd == &quot;ture&quot;&gt;&gt;&lt;&lt;set $cd to &quot;faulse&quot;&gt;&gt;所有人看着你进来，教室鸦雀无声，”坐到位子上，“瑞拉头都没抬地说道，你低下头赶紧坐到你的位置，”我们继续上课。“
&lt;&lt;/if&gt;&gt;
瑞拉进入课室，开始上课了。

今天没有发生什么意外。&lt;font color=”green”&gt;++思维&lt;/font&gt;&lt;&lt;set $int += 3&gt;&gt;

[[下一节课|历史课][$hour += 2,$energy -= 20]]</tw-passagedata><tw-passagedata pid="241" name="历史课" tags="" position="1425,1975" size="100,100">&lt;&lt;if $cd == &quot;ture&quot;&gt;&gt;&lt;&lt;set $cd to &quot;faulse&quot;&gt;&gt;”哦，原来我们还有朋友没到啊，“德古拉大笑，”那你岂不是连上一节也没来？哦别担心，我不会为此为难你，坐回去吧，我的学生。“
&lt;&lt;/if&gt;&gt;
德古拉大摇大摆地走进课室，以他熟悉的腔调开始讲课。他完全不依靠书本，想到什么讲什么，说实话你不知道这样真的能学到什么吗？

很快半节课过后，“书书书，拿出书小崽子们，”他像一辆牛车碾过教室发出轰隆隆的巨响。


[[向阿尔借书][$minute += 40,$know += 2,$jieshu += 1]]&lt;font color=&quot;green&quot;&gt;++学识&lt;/font&gt;
[[在课上睡觉][$minute += 40,$energy += 20]]&lt;font color=&quot;green&quot;&gt;+体力&lt;/font&gt;
</tw-passagedata><tw-passagedata pid="242" name="下午下课" tags="" position="1425,1100" size="100,100">现在是放学时间了。


[[继续|学院低]]</tw-passagedata><tw-passagedata pid="243" name="学习理论" tags="" position="2275,725" size="100,100">你选择学习一段时间理论课的知识。

[[继续学习|学习理论][$hour += 2,$int+=2,$energy-=20]](2:00)&lt;font color=”green”&gt;+思维&lt;/font&gt;&lt;font color=”red”&gt;-体力&lt;/font&gt;
[[返回|书桌]]</tw-passagedata><tw-passagedata pid="244" name="学习历史" tags="" position="2275,850" size="100,100">你选择学习一段时间历史课的知识。

[[继续学习|学习历史][$hour+=2,$know+=2,$energy-=20]](2:00)&lt;font color=”green”&gt;+知识&lt;/font&gt;&lt;font color=”red”&gt;-体力&lt;/font&gt;
[[返回|书桌]]</tw-passagedata><tw-passagedata pid="245" name="中心庭院上课跳转" tags="" position="1525,1825" size="100,100">&lt;&lt;if $tiyvke == 5&gt;&gt;
&lt;&lt;goto&quot;阿尔a1&quot;&gt;&gt;
&lt;&lt;else&gt;&gt;
&lt;&lt;goto&quot;中心庭院&quot;&gt;&gt;
&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="246" name="未命名片段 4" tags="" position="1350,3100" size="100,100"></tw-passagedata><tw-passagedata pid="247" name="阿尔a12" tags="" position="1525,3425" size="100,100">&lt;&lt;set $hour = 18&gt;&gt;等你再次睁眼，你正躺在人群中央，四周都是好奇的视线，不过坐在你旁边的阿尔帮你挡住了一部分。

“你感觉还好吗？”人群分开出一条路，你看见辛西娅走了出来。

你静下心感受自己的身体，没有什么不快的地方。

&lt;&lt;linkreplace&quot;表示自己感觉还好&quot;&gt;&gt;表示自己感觉还好

“欸，有够麻烦的，怎么第一节实践课就出这种事，该说你们幸运还是不幸运。”辛西娅摸着额头，像一下老了十几岁，“先回去吧。”

”看来确实是你消耗比较大，真是做了个好梦，“阿尔幽幽地说，“太难解释了，所以我跟其他人说在你醒之前我什么都不会讲。”

（若已触发早退特殊剧情那就无新剧情，继续拉磨中）

[[回校|学院卧室]]</tw-passagedata></tw-storydata>
	<script id="script-sugarcube" type="text/javascript">
	/*! SugarCube JS */
	if(document.documentElement.getAttribute("data-init")==="loading"){(function(window,document,jQuery,undefined){"use strict";function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){return protoProps&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),Object.defineProperty(Constructor,"prototype",{writable:!1}),Constructor}function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_unsupportedIterableToArray(arr,i)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null!=_i){var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}function _toConsumableArray(arr){return _arrayWithoutHoles(arr)||_iterableToArray(arr)||_unsupportedIterableToArray(arr)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(o,minLen){if(o){if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);return"Object"===n&&o.constructor&&(n=o.constructor.name),"Map"===n||"Set"===n?Array.from(o):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(o,minLen):void 0}}function _iterableToArray(iter){if("undefined"!=typeof Symbol&&null!=iter[Symbol.iterator]||null!=iter["@@iterator"])return Array.from(iter)}function _arrayWithoutHoles(arr){if(Array.isArray(arr))return _arrayLikeToArray(arr)}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function _typeof(obj){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj},_typeof(obj)}var errorPrologRegExp=/^(?:(?:uncaught\s+(?:exception:\s+)?)?\w*(?:error|exception|_err):\s+)+/i,Alert=function(){function mesg(where,error,isFatal,isUncaught){var mesg="Error",nice="A".concat(isFatal?" fatal":"n"," error has occurred.");nice+=isFatal?" Aborting.":" You may be able to continue, but some parts may not work properly.";var isObject=null!==error&&"object"===_typeof(error),what=(isObject&&"message"in error?String(error.message).replace(errorPrologRegExp,""):String(error)).trim()||"unknown error";null!=where&&(mesg+=" [".concat(where,"]")),mesg+=": ".concat(what,"."),isObject&&"stack"in error&&(mesg+="\n\nStack Trace:\n".concat(error.stack)),mesg&&(nice+="\n\n".concat(mesg)),isUncaught||console[isFatal?"error":"warn"](mesg),window.alert(nice)}var origOnError;return origOnError=window.onerror,window.onerror=function(what,source,lineNum,colNum,error){"complete"===document.readyState?mesg(null,null!=error?error:what,!1,!0):(mesg(null,null!=error?error:what,!0,!0),window.onerror=origOnError,"function"==typeof window.onerror&&window.onerror.apply(this,arguments))},Object.freeze(Object.defineProperties({},{error:{value:function(where,error){mesg(where,error)}},fatal:{value:function(where,error){mesg(where,error,!0)}}}))}(),Patterns=(wsMap=new Map([[" ","\\u0020"],["\f","\\f"],["\n","\\n"],["\r","\\r"],["\t","\\t"],["\v","\\v"],[" ","\\u00a0"],[" ","\\u1680"],["᠎","\\u180e"],[" ","\\u2000"],[" ","\\u2001"],[" ","\\u2002"],[" ","\\u2003"],[" ","\\u2004"],[" ","\\u2005"],[" ","\\u2006"],[" ","\\u2007"],[" ","\\u2008"],[" ","\\u2009"],[" ","\\u200a"],["\u2028","\\u2028"],["\u2029","\\u2029"],[" ","\\u202f"],[" ","\\u205f"],["　","\\u3000"],["\ufeff","\\ufeff"]]),wsRe=/^\s$/,missing="",wsMap.forEach((function(pat,char){wsRe.test(char)||(missing+=pat)})),space=missing?"[\\s".concat(missing,"]"):"\\s",spaceNoTerminator="[\\u0020\\f\\t\\v\\u00a0\\u1680\\u180e\\u2000-\\u200a\\u202f\\u205f\\u3000\\ufeff]",notSpace="\\s"===space?"\\S":space.replace(/^\[/,"[^"),anyChar="(?:.|".concat("[\\n\\r\\u2028\\u2029]",")"),anyLetter="[0-9A-Z_a-z\\-\\u00c0-\\u00d6\\u00d8-\\u00f6\\u00f8-\\u00ff\\u0150\\u0170\\u0151\\u0171]",anyLetterStrict=anyLetter.replace("\\-",""),identifier="".concat("[$A-Z_a-z]").concat("[$0-9A-Z_a-z]","*"),variable="[$_]"+identifier,htmlTagName="[A-Za-z](?:".concat(cENChar="(?:[\\x2D.0-9A-Z_a-z\\xB7\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u037D\\u037F-\\u1FFF\\u200C\\u200D\\u203F\\u2040\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD]|[\\uD800-\\uDB7F][\\uDC00-\\uDFFF])","*-").concat(cENChar,"*|[0-9A-Za-z]*)"),twStyle="(".concat(anyLetter,"+)\\(([^\\)\\|\\n]+)\\):"),cssStyle="".concat(spaceNoTerminator,"*(").concat(anyLetter,"+)").concat(spaceNoTerminator,"*:([^;\\|\\n]+);"),idOrClass="".concat(spaceNoTerminator,"*((?:").concat("[#.]").concat(anyLetter,"+").concat(spaceNoTerminator,"*)+);"),inlineCss="".concat(twStyle,"|").concat(cssStyle,"|").concat(idOrClass),Object.freeze({space:space,spaceNoTerminator:spaceNoTerminator,lineTerminator:"[\\n\\r\\u2028\\u2029]",notSpace:notSpace,anyChar:anyChar,anyLetter:anyLetter,anyLetterStrict:anyLetterStrict,identifierFirstChar:"[$A-Z_a-z]",identifierNextChar:"[$0-9A-Z_a-z]",identifier:identifier,variableSigil:"[$_]",variable:variable,macroName:"[A-Za-z][\\w-]*|[=-]",templateName:"[A-Za-z][\\w-]*",htmlTagName:htmlTagName,cssIdOrClassSigil:"[#.]",cssImage:"\\[[<>]?[Ii][Mm][Gg]\\[(?:\\s|\\S)*?\\]\\]+",inlineCss:inlineCss,url:"(?:file|https?|mailto|ftp|javascript|irc|news|data):[^\\s'\"]+"})),wsMap,wsRe,missing,cENChar,twStyle,cssStyle,idOrClass,space,spaceNoTerminator,notSpace,anyChar,anyLetter,anyLetterStrict,identifier,variable,htmlTagName,inlineCss;!function(){var startWSRe,endWSRe,_trimString=(startWSRe=new RegExp("^".concat(Patterns.space).concat(Patterns.space,"*")),endWSRe=new RegExp("".concat(Patterns.space).concat(Patterns.space,"*$")),function(str,where){var val=String(str);if(!val)return val;switch(where){case"start":return startWSRe.test(val)?val.replace(startWSRe,""):val;case"end":return endWSRe.test(val)?val.replace(endWSRe,""):val;default:throw new Error('_trimString called with incorrect where parameter value: "'.concat(where,'"'))}});function _createPadString(length,padding){var targetLength=Number.parseInt(length,10)||0;if(targetLength<1)return"";var padString=void 0===padding?"":String(padding);for(""===padString&&(padString=" ");padString.length<targetLength;){var curPadLength=padString.length,remainingLength=targetLength-curPadLength;padString+=curPadLength>remainingLength?padString.slice(0,remainingLength):padString}return padString.length>targetLength&&(padString=padString.slice(0,targetLength)),padString}Array.prototype.flat||Object.defineProperty(Array.prototype,"flat",{configurable:!0,writable:!0,value:function flat(){if(null==this)throw new TypeError("Array.prototype.flat called on null or undefined");var depth=0===arguments.length?1:Number(arguments[0])||0;return depth<1?Array.prototype.slice.call(this):Array.prototype.reduce.call(this,(function(acc,cur){return cur instanceof Array?acc.push.apply(acc,_toConsumableArray(flat.call(cur,depth-1))):acc.push(cur),acc}),[])}}),Array.prototype.flatMap||Object.defineProperty(Array.prototype,"flatMap",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("Array.prototype.flatMap called on null or undefined");return Array.prototype.map.apply(this,arguments).flat()}}),Array.prototype.includes||Object.defineProperty(Array.prototype,"includes",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("Array.prototype.includes called on null or undefined");if(0===arguments.length)return!1;var length=this.length>>>0;if(0===length)return!1;var needle=arguments[0],i=Number(arguments[1])||0;for(i<0&&(i=Math.max(0,length+i));i<length;++i){var value=this[i];if(value===needle||value!=value&&needle!=needle)return!0}return!1}}),Object.entries||Object.defineProperty(Object,"entries",{configurable:!0,writable:!0,value:function(obj){if("object"!==_typeof(obj)||null===obj)throw new TypeError("Object.entries object parameter must be an object");return Object.keys(obj).map((function(key){return[key,obj[key]]}))}}),Object.fromEntries||Object.defineProperty(Object,"fromEntries",{configurable:!0,writable:!0,value:function(iter){return Array.from(iter).reduce((function(acc,pair){if(Object(pair)!==pair)throw new TypeError("Object.fromEntries iterable parameter must yield objects");return pair[0]in acc?Object.defineProperty(acc,pair[0],{configurable:!0,enumerable:!0,writable:!0,value:pair[1]}):acc[pair[0]]=pair[1],acc}),{})}}),Object.getOwnPropertyDescriptors||Object.defineProperty(Object,"getOwnPropertyDescriptors",{configurable:!0,writable:!0,value:function(obj){if(null==obj)throw new TypeError("Object.getOwnPropertyDescriptors object parameter is null or undefined");var O=Object(obj);return Reflect.ownKeys(O).reduce((function(acc,key){var desc=Object.getOwnPropertyDescriptor(O,key);return void 0!==desc&&(key in acc?Object.defineProperty(acc,key,{configurable:!0,enumerable:!0,writable:!0,value:desc}):acc[key]=desc),acc}),{})}}),Object.values||Object.defineProperty(Object,"values",{configurable:!0,writable:!0,value:function(obj){if("object"!==_typeof(obj)||null===obj)throw new TypeError("Object.values object parameter must be an object");return Object.keys(obj).map((function(key){return obj[key]}))}}),String.prototype.padStart||Object.defineProperty(String.prototype,"padStart",{configurable:!0,writable:!0,value:function(length,padding){if(null==this)throw new TypeError("String.prototype.padStart called on null or undefined");var baseString=String(this),baseLength=baseString.length,targetLength=Number.parseInt(length,10);return targetLength<=baseLength?baseString:_createPadString(targetLength-baseLength,padding)+baseString}}),String.prototype.padEnd||Object.defineProperty(String.prototype,"padEnd",{configurable:!0,writable:!0,value:function(length,padding){if(null==this)throw new TypeError("String.prototype.padEnd called on null or undefined");var baseString=String(this),baseLength=baseString.length,targetLength=Number.parseInt(length,10);return targetLength<=baseLength?baseString:baseString+_createPadString(targetLength-baseLength,padding)}}),String.prototype.trimStart||Object.defineProperty(String.prototype,"trimStart",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("String.prototype.trimStart called on null or undefined");return _trimString(this,"start")}}),String.prototype.trimLeft||Object.defineProperty(String.prototype,"trimLeft",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("String.prototype.trimLeft called on null or undefined");return _trimString(this,"start")}}),String.prototype.trimEnd||Object.defineProperty(String.prototype,"trimEnd",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("String.prototype.trimEnd called on null or undefined");return _trimString(this,"end")}}),String.prototype.trimRight||Object.defineProperty(String.prototype,"trimRight",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("String.prototype.trimRight called on null or undefined");return _trimString(this,"end")}})}(),function(){var _nativeMathRandom=Math.random,_regExpMetaCharsRe,_hasRegExpMetaCharsRe,_formatRegExp,_hasFormatRegExp;function _random(){var min,max;switch(arguments.length){case 0:throw new Error("_random called with insufficient parameters");case 1:min=0,max=arguments[0];break;default:min=arguments[0],max=arguments[1]}if(min>max){var _ref=[max,min];min=_ref[0],max=_ref[1]}return Math.floor(_nativeMathRandom()*(max-min+1))+min}function _randomIndex(length,boundsArgs){var min,max;switch(boundsArgs.length){case 1:min=0,max=length-1;break;case 2:min=0,max=Math.trunc(boundsArgs[1]);break;default:min=Math.trunc(boundsArgs[1]),max=Math.trunc(boundsArgs[2])}return Number.isNaN(min)?min=0:!Number.isFinite(min)||min>=length?min=length-1:min<0&&(min=length+min)<0&&(min=0),Number.isNaN(max)?max=0:(!Number.isFinite(max)||max>=length||max<0&&(max=length+max)<0)&&(max=length-1),_random(min,max)}function _getCodePointStartAndEnd(str,pos){var code=str.charCodeAt(pos);if(Number.isNaN(code))return{char:"",start:-1,end:-1};if(code<55296||code>57343)return{char:str.charAt(pos),start:pos,end:pos};if(code>=55296&&code<=56319){var nextPos=pos+1;if(nextPos>=str.length)throw new Error("high surrogate without trailing low surrogate");var nextCode=str.charCodeAt(nextPos);if(nextCode<56320||nextCode>57343)throw new Error("high surrogate without trailing low surrogate");return{char:str.charAt(pos)+str.charAt(nextPos),start:pos,end:nextPos}}if(0===pos)throw new Error("low surrogate without leading high surrogate");var prevPos=pos-1,prevCode=str.charCodeAt(prevPos);if(prevCode<55296||prevCode>56319)throw new Error("low surrogate without leading high surrogate");return{char:str.charAt(prevPos)+str.charAt(pos),start:prevPos,end:pos}}Object.defineProperty(Array,"random",{configurable:!0,writable:!0,value:function(array){if("object"!==_typeof(array)||null===array||!Object.prototype.hasOwnProperty.call(array,"length"))throw new TypeError("Array.random array parameter must be an array or array-lke object");var length=array.length>>>0;if(0!==length){var index=0===arguments.length?_random(0,length-1):_randomIndex(length,Array.prototype.slice.call(arguments,1));return array[index]}}}),Object.defineProperty(Array.prototype,"concatUnique",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("Array.prototype.concatUnique called on null or undefined");var result=Array.from(this);if(0===arguments.length)return result;var items=Array.prototype.reduce.call(arguments,(function(prev,cur){return prev.concat(cur)}),[]),addSize=items.length;if(0===addSize)return result;for(var indexOf=Array.prototype.indexOf,push=Array.prototype.push,i=0;i<addSize;++i){var value=items[i];-1===indexOf.call(result,value)&&push.call(result,value)}return result}}),Object.defineProperty(Array.prototype,"count",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("Array.prototype.count called on null or undefined");for(var indexOf=Array.prototype.indexOf,needle=arguments[0],pos=Number(arguments[1])||0,count=0;-1!==(pos=indexOf.call(this,needle,pos));)++count,++pos;return count}}),Object.defineProperty(Array.prototype,"countWith",{configurable:!0,writable:!0,value:function(predicate,thisArg){if(null==this)throw new TypeError("Array.prototype.countWith called on null or undefined");if("function"!=typeof predicate)throw new Error("Array.prototype.countWith predicate parameter must be a function");var length=this.length>>>0;if(0===length)return 0;for(var count=0,i=0;i<length;++i)predicate.call(thisArg,this[i],i,this)&&++count;return count}}),Object.defineProperty(Array.prototype,"delete",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("Array.prototype.delete called on null or undefined");if(0===arguments.length)return[];var length=this.length>>>0;if(0===length)return[];for(var needles=Array.prototype.concat.apply([],arguments),needlesLength=needles.length,indices=[],i=0;i<length;++i)for(var value=this[i],j=0;j<needlesLength;++j){var needle=needles[j];if(value===needle||value!=value&&needle!=needle){indices.push(i);break}}for(var result=[],_i=0,iend=indices.length;_i<iend;++_i)result[_i]=this[indices[_i]];for(var splice=Array.prototype.splice,_i2=indices.length-1;_i2>=0;--_i2)splice.call(this,indices[_i2],1);return result}}),Object.defineProperty(Array.prototype,"deleteAt",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("Array.prototype.deleteAt called on null or undefined");if(0===arguments.length)return[];var length=this.length>>>0;if(0===length)return[];for(var splice=Array.prototype.splice,cpyIndices=_toConsumableArray(new Set(Array.prototype.concat.apply([],arguments).map((function(x){return x<0?Math.max(0,length+x):x}))).values()),delIndices=_toConsumableArray(cpyIndices).sort((function(a,b){return b-a})),result=[],i=0,iend=cpyIndices.length;i<iend;++i)result[i]=this[cpyIndices[i]];for(var _i3=0,_iend=delIndices.length;_i3<_iend;++_i3)splice.call(this,delIndices[_i3],1);return result}}),Object.defineProperty(Array.prototype,"deleteWith",{configurable:!0,writable:!0,value:function(predicate,thisArg){if(null==this)throw new TypeError("Array.prototype.deleteWith called on null or undefined");if("function"!=typeof predicate)throw new Error("Array.prototype.deleteWith predicate parameter must be a function");var length=this.length>>>0;if(0===length)return[];for(var splice=Array.prototype.splice,indices=[],result=[],i=0;i<length;++i)predicate.call(thisArg,this[i],i,this)&&(result.push(this[i]),indices.push(i));for(var _i4=indices.length-1;_i4>=0;--_i4)splice.call(this,indices[_i4],1);return result}}),Object.defineProperty(Array.prototype,"first",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("Array.prototype.first called on null or undefined");if(0!==this.length>>>0)return this[0]}}),Object.defineProperty(Array.prototype,"includesAll",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("Array.prototype.includesAll called on null or undefined");if(1===arguments.length)return Array.isArray(arguments[0])?Array.prototype.includesAll.apply(this,arguments[0]):Array.prototype.includes.apply(this,arguments);for(var i=0,iend=arguments.length;i<iend;++i)if(!Array.prototype.some.call(this,(function(val){return val===this.val||val!=val&&this.val!=this.val}),{val:arguments[i]}))return!1;return!0}}),Object.defineProperty(Array.prototype,"includesAny",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("Array.prototype.includesAny called on null or undefined");if(1===arguments.length)return Array.isArray(arguments[0])?Array.prototype.includesAny.apply(this,arguments[0]):Array.prototype.includes.apply(this,arguments);for(var i=0,iend=arguments.length;i<iend;++i)if(Array.prototype.some.call(this,(function(val){return val===this.val||val!=val&&this.val!=this.val}),{val:arguments[i]}))return!0;return!1}}),Object.defineProperty(Array.prototype,"last",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("Array.prototype.last called on null or undefined");var length=this.length>>>0;if(0!==length)return this[length-1]}}),Object.defineProperty(Array.prototype,"pluck",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("Array.prototype.pluck called on null or undefined");var length=this.length>>>0;if(0!==length){var index=0===arguments.length?_random(0,length-1):_randomIndex(length,Array.prototype.slice.call(arguments));return Array.prototype.splice.call(this,index,1)[0]}}}),Object.defineProperty(Array.prototype,"pluckMany",{configurable:!0,writable:!0,value:function(wantSize){if(null==this)throw new TypeError("Array.prototype.pluckMany called on null or undefined");var length=this.length>>>0;if(0===length)return[];var want=Math.trunc(wantSize);if(!Number.isInteger(want))throw new Error("Array.prototype.pluckMany want parameter must be an integer");if(want<1)return[];want>length&&(want=length);var splice=Array.prototype.splice,result=[],max=length-1;do{result.push(splice.call(this,_random(0,max--),1)[0])}while(result.length<want);return result}}),Object.defineProperty(Array.prototype,"pushUnique",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("Array.prototype.pushUnique called on null or undefined");var addSize=arguments.length;if(0===addSize)return this.length>>>0;for(var indexOf=Array.prototype.indexOf,push=Array.prototype.push,i=0;i<addSize;++i){var value=arguments[i];-1===indexOf.call(this,value)&&push.call(this,value)}return this.length>>>0}}),Object.defineProperty(Array.prototype,"random",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("Array.prototype.random called on null or undefined");var length=this.length>>>0;if(0!==length){var index=0===arguments.length?_random(0,length-1):_randomIndex(length,Array.prototype.slice.call(arguments));return this[index]}}}),Object.defineProperty(Array.prototype,"randomMany",{configurable:!0,writable:!0,value:function(wantSize){if(null==this)throw new TypeError("Array.prototype.randomMany called on null or undefined");var length=this.length>>>0;if(0===length)return[];var want=Math.trunc(wantSize);if(!Number.isInteger(want))throw new Error("Array.prototype.randomMany want parameter must be an integer");if(want<1)return[];want>length&&(want=length);var picked=new Map,result=[],max=length-1;do{var i=void 0;do{i=_random(0,max)}while(picked.has(i));picked.set(i,!0),result.push(this[i])}while(result.length<want);return result}}),Object.defineProperty(Array.prototype,"shuffle",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("Array.prototype.shuffle called on null or undefined");var length=this.length>>>0;if(0===length)return this;for(var i=length-1;i>0;--i){var j=Math.floor(_nativeMathRandom()*(i+1));if(i!==j){var swap=this[i];this[i]=this[j],this[j]=swap}}return this}}),Object.defineProperty(Array.prototype,"unshiftUnique",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("Array.prototype.unshiftUnique called on null or undefined");var addSize=arguments.length;if(0===addSize)return this.length>>>0;for(var indexOf=Array.prototype.indexOf,unshift=Array.prototype.unshift,i=0;i<addSize;++i){var value=arguments[i];-1===indexOf.call(this,value)&&unshift.call(this,value)}return this.length>>>0}}),Object.defineProperty(Function.prototype,"partial",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("Function.prototype.partial called on null or undefined");var slice=Array.prototype.slice,fn=this,bound=slice.call(arguments,0);return function(){for(var applied=[],argc=0,i=0;i<bound.length;++i)applied.push(bound[i]===undefined?arguments[argc++]:bound[i]);return fn.apply(this,applied.concat(slice.call(arguments,argc)))}}}),Object.defineProperty(Math,"clamp",{configurable:!0,writable:!0,value:function(num,min,max){var value=Number(num);return Number.isNaN(value)?NaN:value.clamp(min,max)}}),Object.defineProperty(Math,"easeInOut",{configurable:!0,writable:!0,value:function(num){return 1-(Math.cos(Number(num)*Math.PI)+1)/2}}),Object.defineProperty(Number.prototype,"clamp",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("Number.prototype.clamp called on null or undefined");if(2!==arguments.length)throw new Error("Number.prototype.clamp called with an incorrect number of parameters");var min=Number(arguments[0]),max=Number(arguments[1]);if(min>max){var _ref2=[max,min];min=_ref2[0],max=_ref2[1]}return Math.min(Math.max(this,min),max)}}),RegExp.escape||(_regExpMetaCharsRe=/[\\^$*+?.()|[\]{}]/g,_hasRegExpMetaCharsRe=new RegExp(_regExpMetaCharsRe.source),Object.defineProperty(RegExp,"escape",{configurable:!0,writable:!0,value:function(str){var val=String(str);return val&&_hasRegExpMetaCharsRe.test(val)?val.replace(_regExpMetaCharsRe,"\\$&"):val}})),_formatRegExp=/{(\d+)(?:,([+-]?\d+))?}/g,_hasFormatRegExp=new RegExp(_formatRegExp.source),Object.defineProperty(String,"format",{configurable:!0,writable:!0,value:function(format){function padString(str,align,pad){if(!align)return str;var plen=Math.abs(align)-str.length;if(plen<1)return str;var padding=String(pad).repeat(plen);return align<0?str+padding:padding+str}if(arguments.length<2)return 0===arguments.length?"":format;var args=2===arguments.length&&Array.isArray(arguments[1])?_toConsumableArray(arguments[1]):Array.prototype.slice.call(arguments,1);return 0===args.length?format:_hasFormatRegExp.test(format)?(_formatRegExp.lastIndex=0,format.replace(_formatRegExp,(function(match,index,align){var retval=args[index];if(null==retval)return"";for(;"function"==typeof retval;)retval=retval();switch(_typeof(retval)){case"string":break;case"object":retval=JSON.stringify(retval);break;default:retval=String(retval)}return padString(retval,align?Number.parseInt(align,10):0," ")}))):format}}),Object.defineProperty(String.prototype,"contains",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("String.prototype.contains called on null or undefined");return-1!==String.prototype.indexOf.apply(this,arguments)}}),Object.defineProperty(String.prototype,"count",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("String.prototype.count called on null or undefined");var needle=String(arguments[0]||"");if(""===needle)return 0;for(var indexOf=String.prototype.indexOf,step=needle.length,pos=Number(arguments[1])||0,count=0;-1!==(pos=indexOf.call(this,needle,pos));)++count,pos+=step;return count}}),Object.defineProperty(String.prototype,"first",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("String.prototype.first called on null or undefined");return _getCodePointStartAndEnd(String(this),0).char}}),Object.defineProperty(String.prototype,"last",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("String.prototype.last called on null or undefined");var str=String(this);return _getCodePointStartAndEnd(str,str.length-1).char}}),Object.defineProperty(String.prototype,"splice",{configurable:!0,writable:!0,value:function(startAt,delCount,replacement){if(null==this)throw new TypeError("String.prototype.splice called on null or undefined");var length=this.length>>>0;if(0===length)return"";var start=Number(startAt);Number.isSafeInteger(start)?start<0&&(start+=length)<0&&(start=0):start=0,start>length&&(start=length);var count=Number(delCount);(!Number.isSafeInteger(count)||count<0)&&(count=0);var res=this.slice(0,start);return void 0!==replacement&&(res+=replacement),start+count<length&&(res+=this.slice(start+count)),res}}),Object.defineProperty(String.prototype,"splitOrEmpty",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("String.prototype.splitOrEmpty called on null or undefined");return""===String(this)?[]:String.prototype.split.apply(this,arguments)}}),Object.defineProperty(String.prototype,"toLocaleUpperFirst",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("String.prototype.toLocaleUpperFirst called on null or undefined");var str=String(this),_getCodePointStartAnd3=_getCodePointStartAndEnd(str,0),char=_getCodePointStartAnd3.char,end=_getCodePointStartAnd3.end;return-1===end?"":char.toLocaleUpperCase()+str.slice(end+1)}}),Object.defineProperty(String.prototype,"toUpperFirst",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("String.prototype.toUpperFirst called on null or undefined");var str=String(this),_getCodePointStartAnd4=_getCodePointStartAndEnd(str,0),char=_getCodePointStartAnd4.char,end=_getCodePointStartAnd4.end;return-1===end?"":char.toUpperCase()+str.slice(end+1)}}),Object.defineProperty(Date.prototype,"toJSON",{configurable:!0,writable:!0,value:function(){return["(revive:date)",this.toISOString()]}}),Object.defineProperty(Function.prototype,"toJSON",{configurable:!0,writable:!0,value:function(){return["(revive:eval)","(".concat(this.toString(),")")]}}),Object.defineProperty(Map.prototype,"toJSON",{configurable:!0,writable:!0,value:function(){return["(revive:map)",_toConsumableArray(this)]}}),Object.defineProperty(RegExp.prototype,"toJSON",{configurable:!0,writable:!0,value:function(){return["(revive:eval)",this.toString()]}}),Object.defineProperty(Set.prototype,"toJSON",{configurable:!0,writable:!0,value:function(){return["(revive:set)",_toConsumableArray(this)]}}),Object.defineProperty(JSON,"reviveWrapper",{configurable:!0,writable:!0,value:function(code,data){if("string"!=typeof code)throw new TypeError("JSON.reviveWrapper code parameter must be a string");return["(revive:eval)",[code,data]]}}),Object.defineProperty(JSON,"_real_stringify",{value:JSON.stringify}),Object.defineProperty(JSON,"stringify",{configurable:!0,writable:!0,value:function(_value,replacer,space){return JSON._real_stringify(_value,(function(key,val){var value=val;if("function"==typeof replacer)try{value=replacer(key,value)}catch(ex){}return void 0===value&&(value=["(revive:eval)","undefined"]),value}),space)}}),Object.defineProperty(JSON,"_real_parse",{value:JSON.parse}),Object.defineProperty(JSON,"parse",{configurable:!0,writable:!0,value:function value(text,reviver){return JSON._real_parse(text,(function(key,val){var value=val;if(Array.isArray(value)&&2===value.length)switch(value[0]){case"(revive:set)":value=new Set(value[1]);break;case"(revive:map)":value=new Map(value[1]);break;case"(revive:date)":value=new Date(value[1]);break;case"(revive:eval)":try{if(Array.isArray(value[1])){var $ReviveData$=value[1][1];value=eval(value[1][0])}else value=eval(value[1])}catch(ex){}}else if("string"==typeof value&&"@@revive@@"===value.slice(0,10))try{value=eval(value.slice(10))}catch(ex){}if("function"==typeof reviver)try{value=reviver(key,value)}catch(ex){}return value}))}}),Object.defineProperty(Array.prototype,"contains",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("Array.prototype.contains called on null or undefined");return Array.prototype.includes.apply(this,arguments)}}),Object.defineProperty(Array.prototype,"containsAll",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("Array.prototype.containsAll called on null or undefined");return Array.prototype.includesAll.apply(this,arguments)}}),Object.defineProperty(Array.prototype,"containsAny",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("Array.prototype.containsAny called on null or undefined");return Array.prototype.includesAny.apply(this,arguments)}}),Object.defineProperty(Array.prototype,"flatten",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("Array.prototype.flatten called on null or undefined");return Array.prototype.flat.call(this,1/0)}}),Object.defineProperty(String.prototype,"readBracketedList",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("String.prototype.readBracketedList called on null or undefined");for(var match,re=new RegExp("(?:\\[\\[((?:\\s|\\S)*?)\\]\\])|([^\"'\\s]\\S*)","gm"),names=[];null!==(match=re.exec(this));)match[1]?names.push(match[1]):match[2]&&names.push(match[2]);return names}})}();var Browser=(userAgent=navigator.userAgent.toLowerCase(),winPhone=userAgent.includes("windows phone"),isMobile=Object.freeze({Android:!winPhone&&userAgent.includes("android"),BlackBerry:/blackberry|bb10/.test(userAgent),iOS:!winPhone&&/ip(?:hone|ad|od)/.test(userAgent),Opera:!winPhone&&("object"===_typeof(window.operamini)||userAgent.includes("opera mini")),Windows:winPhone||/iemobile|wpdesktop/.test(userAgent),any:function(){return isMobile.Android||isMobile.BlackBerry||isMobile.iOS||isMobile.Opera||isMobile.Windows}}),isGecko=!isMobile.Windows&&!/khtml|trident|edge/.test(userAgent)&&userAgent.includes("gecko"),isIE=!userAgent.includes("opera")&&/msie|trident/.test(userAgent),ieVersion=isIE?(ver=/(?:msie\s+|rv:)(\d+\.\d)/.exec(userAgent))?Number(ver[1]):0:null,isOpera=userAgent.includes("opera")||userAgent.includes(" opr/"),operaVersion=isOpera?function(){var ver=new RegExp("".concat(/khtml|chrome/.test(userAgent)?"opr":"version","\\/(\\d+\\.\\d+)")).exec(userAgent);return ver?Number(ver[1]):0}():null,isVivaldi=userAgent.includes("vivaldi"),Object.freeze({userAgent:userAgent,isMobile:isMobile,isGecko:isGecko,isIE:isIE,ieVersion:ieVersion,isOpera:isOpera,operaVersion:operaVersion,isVivaldi:isVivaldi})),ver,userAgent,winPhone,isMobile,isGecko,isIE,ieVersion,isOpera,operaVersion,isVivaldi,Has=(hasAudioElement=function(){try{return"function"==typeof document.createElement("audio").canPlayType}catch(ex){}return!1}(),hasFile=function(){try{return"Blob"in window&&"File"in window&&"FileList"in window&&"FileReader"in window&&(!Browser.isOpera||Browser.operaVersion>=15)}catch(ex){}return!1}(),hasGeolocation=function(){try{return"geolocation"in navigator&&"function"==typeof navigator.geolocation.getCurrentPosition&&"function"==typeof navigator.geolocation.watchPosition}catch(ex){}return!1}(),hasMutationObserver=function(){try{return"MutationObserver"in window&&"function"==typeof window.MutationObserver}catch(ex){}return!1}(),hasPerformance=function(){try{return"performance"in window&&"function"==typeof window.performance.now}catch(ex){}return!1}(),hasTouch=function(){try{return"ontouchstart"in window||!!window.DocumentTouch&&document instanceof window.DocumentTouch||!!navigator.maxTouchPoints||!!navigator.msMaxTouchPoints}catch(ex){}return!1}(),hasTransitionEndEvent=function(){try{for(var teMap=new Map([["transition","transitionend"],["MSTransition","msTransitionEnd"],["WebkitTransition","webkitTransitionEnd"],["MozTransition","transitionend"]]),teKeys=_toConsumableArray(teMap.keys()),el=document.createElement("div"),i=0;i<teKeys.length;++i)if(el.style[teKeys[i]]!==undefined)return teMap.get(teKeys[i])}catch(ex){}return!1}(),Object.freeze({audio:hasAudioElement,fileAPI:hasFile,geolocation:hasGeolocation,mutationObserver:hasMutationObserver,performance:hasPerformance,touch:hasTouch,transitionEndEvent:hasTransitionEndEvent})),hasAudioElement,hasFile,hasGeolocation,hasMutationObserver,hasPerformance,hasTouch,hasTransitionEndEvent,Visibility=(vendor=function(){try{return Object.freeze([{hiddenProperty:"hidden",stateProperty:"visibilityState",changeEvent:"visibilitychange"},{hiddenProperty:"webkitHidden",stateProperty:"webkitVisibilityState",changeEvent:"webkitvisibilitychange"},{hiddenProperty:"mozHidden",stateProperty:"mozVisibilityState",changeEvent:"mozvisibilitychange"},{hiddenProperty:"msHidden",stateProperty:"msVisibilityState",changeEvent:"msvisibilitychange"}].find((function(vnd){return vnd.hiddenProperty in document})))}catch(ex){}return undefined}(),Object.freeze(Object.defineProperties({},{vendor:{get:function(){return vendor}},state:{get:function(){return vendor&&document[vendor.stateProperty]||"visible"}},isEnabled:{value:function(){return Boolean(vendor)}},isHidden:{value:function(){return Boolean(vendor&&document[vendor.hiddenProperty])}},hiddenProperty:{value:vendor&&vendor.hiddenProperty},stateProperty:{value:vendor&&vendor.stateProperty},changeEvent:{value:vendor&&vendor.changeEvent}}))),vendor,Fullscreen=function(){var _hasPromise,vendor=function(){try{return Object.freeze([{isEnabled:"fullscreenEnabled",element:"fullscreenElement",requestFn:"requestFullscreen",exitFn:"exitFullscreen",changeEvent:"fullscreenchange",errorEvent:"fullscreenerror"},{isEnabled:"webkitFullscreenEnabled",element:"webkitFullscreenElement",requestFn:"webkitRequestFullscreen",exitFn:"webkitExitFullscreen",changeEvent:"webkitfullscreenchange",errorEvent:"webkitfullscreenerror"},{isEnabled:"mozFullScreenEnabled",element:"mozFullScreenElement",requestFn:"mozRequestFullScreen",exitFn:"mozCancelFullScreen",changeEvent:"mozfullscreenchange",errorEvent:"mozfullscreenerror"},{isEnabled:"msFullscreenEnabled",element:"msFullscreenElement",requestFn:"msRequestFullscreen",exitFn:"msExitFullscreen",changeEvent:"MSFullscreenChange",errorEvent:"MSFullscreenError"}].find((function(vnd){return vnd.isEnabled in document})))}catch(ex){}return undefined}(),_returnsPromise=(_hasPromise=null,function(){if(null!==_hasPromise)return _hasPromise;if(_hasPromise=!1,vendor)try{var value=document.exitFullscreen();value.catch((function(){})),_hasPromise=value instanceof Promise}catch(ex){}return _hasPromise});function _selectElement(requestedEl){var selectedEl=requestedEl||document.documentElement;return selectedEl===document.documentElement&&("msRequestFullscreen"===vendor.requestFn||Browser.isOpera&&Browser.operaVersion<15)&&(selectedEl=document.body),selectedEl}function isFullscreen(){return Boolean(vendor&&document[vendor.element])}function requestFullscreen(options,requestedEl){var _this=this;if(!vendor)return Promise.reject(new Error("fullscreen not supported"));var element=_selectElement(requestedEl);if("function"!=typeof element[vendor.requestFn])return Promise.reject(new Error("fullscreen not supported"));if(isFullscreen())return Promise.resolve();if(_returnsPromise())return element[vendor.requestFn](options);var namespace=".Fullscreen_requestFullscreen";return new Promise((function(resolve,reject){jQuery(element).off(namespace).one("".concat(vendor.errorEvent).concat(namespace," ").concat(vendor.changeEvent).concat(namespace),(function(ev){jQuery(_this).off(namespace),ev.type===vendor.errorEvent?reject(new Error("unknown fullscreen request error")):resolve()})),element[vendor.requestFn](options)}))}function exitFullscreen(){var _this2=this;if(!vendor||"function"!=typeof document[vendor.exitFn])return Promise.reject(new TypeError("fullscreen not supported"));if(!isFullscreen())return Promise.reject(new TypeError("fullscreen mode not active"));if(_returnsPromise())return document[vendor.exitFn]();var namespace=".Fullscreen_exitFullscreen";return new Promise((function(resolve,reject){jQuery(document).off(namespace).one("".concat(vendor.errorEvent).concat(namespace," ").concat(vendor.changeEvent).concat(namespace),(function(ev){jQuery(_this2).off(namespace),ev.type===vendor.errorEvent?reject(new Error("unknown fullscreen exit error")):resolve()})),document[vendor.exitFn]()}))}return Object.freeze(Object.defineProperties({},{vendor:{get:function(){return vendor}},element:{get:function(){return vendor?document[vendor.element]:null}},isEnabled:{value:function(){return Boolean(vendor&&document[vendor.isEnabled])}},isFullscreen:{value:isFullscreen},request:{value:requestFullscreen},exit:{value:exitFullscreen},toggle:{value:function(options,requestedEl){return isFullscreen()?exitFullscreen():requestFullscreen(options,requestedEl)}},onChange:{value:function(handlerFn,requestedEl){if(vendor){var element=_selectElement(requestedEl);$(element).on(vendor.changeEvent,handlerFn)}}},offChange:{value:function(handlerFn,requestedEl){if(vendor){var element=_selectElement(requestedEl);handlerFn?$(element).off(vendor.changeEvent,handlerFn):$(element).off(vendor.changeEvent)}}},onError:{value:function(handlerFn,requestedEl){if(vendor){var element=_selectElement(requestedEl);$(element).on(vendor.errorEvent,handlerFn)}}},offError:{value:function(handlerFn,requestedEl){if(vendor){var element=_selectElement(requestedEl);handlerFn?$(element).off(vendor.errorEvent,handlerFn):$(element).off(vendor.errorEvent)}}}}))}(),_ref3=Object.freeze(Object.defineProperties({},{clone:{value:function clone(orig){return"object"!==_typeof(orig)||null===orig?orig:orig instanceof String?String(orig):orig instanceof Number?Number(orig):orig instanceof Boolean?Boolean(orig):"function"==typeof orig.clone?orig.clone(!0):orig.nodeType&&"function"==typeof orig.cloneNode?orig.cloneNode(!0):(orig instanceof Array?copy=new Array(orig.length):orig instanceof Date?copy=new Date(orig.getTime()):orig instanceof Map?(copy=new Map,orig.forEach((function(val,key){return copy.set(key,clone(val))}))):orig instanceof RegExp?copy=new RegExp(orig):orig instanceof Set?(copy=new Set,orig.forEach((function(val){return copy.add(clone(val))}))):copy=Object.create(Object.getPrototypeOf(orig)),Object.keys(orig).forEach((function(name){return copy[name]=clone(orig[name])})),copy);var copy}},convertBreaks:{value:function(source){for(var node,output=document.createDocumentFragment(),para=document.createElement("p");null!==(node=source.firstChild);){if(node.nodeType===Node.ELEMENT_NODE)switch(node.nodeName.toUpperCase()){case"BR":if(null!==node.nextSibling&&node.nextSibling.nodeType===Node.ELEMENT_NODE&&"BR"===node.nextSibling.nodeName.toUpperCase()){source.removeChild(node.nextSibling),source.removeChild(node),output.appendChild(para),para=document.createElement("p");continue}if(!para.hasChildNodes()){source.removeChild(node);continue}break;case"ADDRESS":case"ARTICLE":case"ASIDE":case"BLOCKQUOTE":case"CENTER":case"DIV":case"DL":case"FIGURE":case"FOOTER":case"FORM":case"H1":case"H2":case"H3":case"H4":case"H5":case"H6":case"HEADER":case"HR":case"MAIN":case"NAV":case"OL":case"P":case"PRE":case"SECTION":case"TABLE":case"UL":para.hasChildNodes()&&(output.appendChild(para),para=document.createElement("p")),output.appendChild(node);continue}para.appendChild(node)}para.hasChildNodes()&&output.appendChild(para),source.appendChild(output)}},safeActiveElement:{value:function(){try{return document.activeElement||null}catch(ex){return null}}},setDisplayTitle:{value:function(title){if("string"!=typeof title)throw new TypeError("story display title must be a string (received: ".concat(Util.getType(title),")"));var render=document.createDocumentFragment();new Wikifier(render,title);var text=function(source){for(var node,copy=source.cloneNode(!0),frag=document.createDocumentFragment();null!==(node=copy.firstChild);){if(node.nodeType===Node.ELEMENT_NODE)switch(node.nodeName.toUpperCase()){case"BR":case"DIV":case"P":frag.appendChild(document.createTextNode(" "))}frag.appendChild(node)}return frag.textContent}(render).trim();document.title=Config.passages.displayTitles&&""!==State.passage&&State.passage!==Config.passages.start?"".concat(State.passage," | ").concat(text):text;var storyTitle=document.getElementById("story-title");null!==storyTitle&&jQuery(storyTitle).empty().append(render)}},setPageElement:{value:function(idOrElement,titles,defaultText){var el="object"===_typeof(idOrElement)?idOrElement:document.getElementById(idOrElement);if(null==el)return null;var ids=Array.isArray(titles)?titles:[titles];jQuery(el).empty();for(var i=0,iend=ids.length;i<iend;++i)if(Story.has(ids[i]))return new Wikifier(el,Story.get(ids[i]).processText().trim()),el;if(null!=defaultText){var text=String(defaultText).trim();""!==text&&new Wikifier(el,text)}return el}},throwError:{value:function(place,message,source){var $wrapper=jQuery(document.createElement("div")),$toggle=jQuery(document.createElement("button")),$source=jQuery(document.createElement("pre")),mesg="".concat(L10n.get("errorTitle"),": ").concat(message||"unknown error");return $toggle.addClass("error-toggle").ariaClick({label:L10n.get("errorToggle")},(function(){$toggle.hasClass("enabled")?($toggle.removeClass("enabled"),$source.attr({"aria-hidden":!0,hidden:"hidden"})):($toggle.addClass("enabled"),$source.removeAttr("aria-hidden hidden"))})).appendTo($wrapper),jQuery(document.createElement("span")).addClass("error").text(mesg).appendTo($wrapper),jQuery(document.createElement("code")).text(source).appendTo($source),$source.addClass("error-source").attr({"aria-hidden":!0,hidden:"hidden"}).appendTo($wrapper),$wrapper.addClass("error-view").appendTo(place),console.warn("".concat(mesg,"\n\t").concat(source.replace(/\n/g,"\n\t"))),!1}},stringFrom:{value:function stringFrom(value){switch(_typeof(value)){case"function":return"[function]";case"number":if(Number.isNaN(value))return"[number NaN]";break;case"object":if(null===value)return"[null]";if(value instanceof Array)return value.map((function(val){return stringFrom(val)})).join(", ");if(value instanceof Set)return Array.from(value).map((function(val){return stringFrom(val)})).join(", ");if(value instanceof Map){var result=Array.from(value).map((function(_ref4){var _ref5=_slicedToArray(_ref4,2),key=_ref5[0],val=_ref5[1];return"".concat(stringFrom(key)," → ").concat(stringFrom(val))}));return"{ ".concat(result.join(", ")," }")}if(value instanceof Date)return value.toLocaleString();if(value instanceof Element){if(value===document.documentElement||value===document.head||value===document.body)throw new Error("illegal operation; attempting to convert the <html>, <head>, or <body> tags to string is not allowed");return value.outerHTML}return value instanceof Node?value.textContent:"function"==typeof value.toString?value.toString():Object.prototype.toString.call(value);case"symbol":var desc=void 0!==value.description?' "'.concat(value.description,'"'):"";return"[symbol".concat(desc,"]");case"undefined":return"[undefined]"}return String(value)}}})),clone=_ref3.clone,convertBreaks=_ref3.convertBreaks,safeActiveElement=_ref3.safeActiveElement,setDisplayTitle=_ref3.setDisplayTitle,setPageElement=_ref3.setPageElement,throwError=_ref3.throwError,stringFrom=_ref3.stringFrom;!function(){function onKeypressFn(ev){13!==ev.which&&32!==ev.which||(ev.preventDefault(),jQuery(safeActiveElement()||this).trigger("click"))}function onClickFnWrapper(fn){return function(){var $this=jQuery(this);$this.ariaIsDisabled()||($this.is("[aria-pressed]")&&$this.attr("aria-pressed","true"===$this.attr("aria-pressed")?"false":"true"),fn.apply(this,arguments))}}function oneClickFnWrapper(fn){return onClickFnWrapper((function(){jQuery(this).off(".aria-clickable").removeAttr("role tabindex aria-controls aria-pressed").filter("button").prop("disabled",!0),fn.apply(this,arguments)}))}jQuery.fn.extend({ariaClick:function(options,handler){if(0===this.length||0===arguments.length)return this;var opts=options,fn=handler;return null==fn&&(fn=opts,opts=undefined),"string"!=typeof(opts=jQuery.extend({namespace:undefined,one:!1,selector:undefined,data:undefined,role:undefined,controls:undefined,pressed:undefined,label:undefined},opts)).namespace?opts.namespace="":"."!==opts.namespace[0]&&(opts.namespace=".".concat(opts.namespace)),"boolean"==typeof opts.pressed&&(opts.pressed=opts.pressed?"true":"false"),this.filter("button").prop("type","button"),null!=opts.role?this.attr("role",opts.role):this.not("[role]").filter("a,[data-passage]").attr("role","link").end().not("a").not("[data-passage]").attr("role","button").end().end().end(),this.attr("tabindex",0),null!=opts.controls&&this.attr("aria-controls",opts.controls),null!=opts.pressed&&this.attr("aria-pressed",opts.pressed),null!=opts.label&&this.attr({"aria-label":opts.label,title:opts.label}),this.not("button").on("keypress.aria-clickable".concat(opts.namespace),opts.selector,onKeypressFn),this.on("click.aria-clickable".concat(opts.namespace),opts.selector,opts.data,opts.one?oneClickFnWrapper(fn):onClickFnWrapper(fn)),this},ariaDisabled:function(disable){if(0===this.length||0===arguments.length)return this;var $nonDisableable=this.not("button,fieldset,input,menuitem,optgroup,option,select,textarea"),$disableable=this.filter("button,fieldset,input,menuitem,optgroup,option,select,textarea");return disable?($nonDisableable.each((function(){this.setAttribute("disabled",""),this.setAttribute("aria-disabled","true")})),$disableable.each((function(){this.disabled=!0,this.setAttribute("aria-disabled","true")}))):($nonDisableable.each((function(){this.removeAttribute("disabled"),this.removeAttribute("aria-disabled")})),$disableable.each((function(){this.disabled=!1,this.removeAttribute("aria-disabled")}))),this},ariaIsDisabled:function(){return this.is("[disabled]")}})}(),jQuery.extend({wikiWithOptions:function(options){for(var _len=arguments.length,sources=new Array(_len>1?_len-1:0),_key=1;_key<_len;_key++)sources[_key-1]=arguments[_key];if(0!==sources.length){var frag=document.createDocumentFragment();sources.forEach((function(content){return new Wikifier(frag,content,options)}));var errors=_toConsumableArray(frag.querySelectorAll(".error")).map((function(errEl){return errEl.textContent.replace(errorPrologRegExp,"")}));if(errors.length>0)throw new Error(errors.join("; "))}},wiki:function(){for(var _len2=arguments.length,sources=new Array(_len2),_key2=0;_key2<_len2;_key2++)sources[_key2]=arguments[_key2];this.wikiWithOptions.apply(this,[undefined].concat(sources))}}),jQuery.fn.extend({wikiWithOptions:function(options){for(var _len3=arguments.length,sources=new Array(_len3>1?_len3-1:0),_key3=1;_key3<_len3;_key3++)sources[_key3-1]=arguments[_key3];if(0===this.length||0===sources.length)return this;var frag=document.createDocumentFragment();return sources.forEach((function(content){return new Wikifier(frag,content,options)})),this.append(frag),this},wiki:function(){for(var _len4=arguments.length,sources=new Array(_len4),_key4=0;_key4<_len4;_key4++)sources[_key4]=arguments[_key4];return this.wikiWithOptions.apply(this,[undefined].concat(sources))}});var Util=function(){var toString,utilGetType="[object Object]"===(toString=Object.prototype.toString).call(new Map)?function(O){if(null===O)return"null";if(O instanceof Map)return"Map";if(O instanceof Set)return"Set";var baseType=_typeof(O);return"object"===baseType?toString.call(O).slice(8,-1):baseType}:function(O){if(null===O)return"null";var baseType=_typeof(O);return"object"===baseType?toString.call(O).slice(8,-1):baseType};function utilToEnum(obj){var pEnum=Object.create(null);if(obj instanceof Array)obj.forEach((function(val,i){return pEnum[String(val)]=i}));else if(obj instanceof Set)Array.from(obj).forEach((function(val,i){return pEnum[String(val)]=i}));else if(obj instanceof Map)obj.forEach((function(val,key){return pEnum[String(key)]=val}));else{if("object"!==_typeof(obj)||null===obj||Object.getPrototypeOf(obj)!==Object.prototype)throw new TypeError("Util.toEnum obj parameter must be an Array, Map, Set, or generic object");Object.assign(pEnum,obj)}return Object.freeze(pEnum)}function utilToStringTag(obj){return Object.prototype.toString.call(obj).slice(8,-1)}var _illegalSlugCharsRe=/[\x00-\x20!-/:-@[-^`{-\x9f]+/g,_isInvalidSlugRe=/^-*$/;var _illegalFilenameCharsRE=/[\x00-\x1f"#$%&'*+,/:;<=>?\\^`|\x7f-\x9f]+/g;var _markupCharsRe=/[!"#$&'*\-/<=>?@[\\\]^_`{|}~]/g,_hasMarkupCharsRe=new RegExp(_markupCharsRe.source),_markupCharsMap=utilToEnum({"!":"&#33;",'"':"&quot;","#":"&#35;",$:"&#36;","&":"&amp;","'":"&#39;","*":"&#42;","-":"&#45;","/":"&#47;","<":"&lt;","=":"&#61;",">":"&gt;","?":"&#63;","@":"&#64;","[":"&#91;","\\":"&#92;","]":"&#93;","^":"&#94;",_:"&#95;","`":"&#96;","{":"&#123;","|":"&#124;","}":"&#125;","~":"&#126;"});var _htmlCharsRe=/[&<>"'`]/g,_hasHtmlCharsRe=new RegExp(_htmlCharsRe.source),_htmlCharsMap=utilToEnum({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","`":"&#96;"});function utilEscape(str){if(null==str)return"";var val=String(str);return val&&_hasHtmlCharsRe.test(val)?val.replace(_htmlCharsRe,(function(ch){return _htmlCharsMap[ch]})):val}var _escapedHtmlRe=/&(?:amp|#38|#x26|lt|#60|#x3c|gt|#62|#x3e|quot|#34|#x22|apos|#39|#x27|#96|#x60);/gi,_hasEscapedHtmlRe=new RegExp(_escapedHtmlRe.source,"i"),_escapedHtmlMap=utilToEnum({"&amp;":"&","&#38;":"&","&#x26;":"&","&lt;":"<","&#60;":"<","&#x3c;":"<","&gt;":">","&#62;":">","&#x3e;":">","&quot;":'"',"&#34;":'"',"&#x22;":'"',"&apos;":"'","&#39;":"'","&#x27;":"'","&#96;":"`","&#x60;":"`"});function utilUnescape(str){if(null==str)return"";var val=String(str);return val&&_hasEscapedHtmlRe.test(val)?val.replace(_escapedHtmlRe,(function(entity){return _escapedHtmlMap[entity.toLowerCase()]})):val}var _nowSource=Has.performance?performance:Date;var _cssTimeRe=/^([+-]?(?:\d*\.)?\d+)([Mm]?[Ss])$/;var utilScrubEventKey=function(){var separatorKey,decimalKey;if("undefined"!=typeof Intl&&"function"==typeof Intl.NumberFormat){var match=(new Intl.NumberFormat).format(111111.5).match(/(\D*)\d+(\D*)/);match&&(separatorKey=match[1],decimalKey=match[2])}return separatorKey||decimalKey||(separatorKey=",",decimalKey="."),function(key){switch(key){case"Scroll":return"ScrollLock";case"Spacebar":return" ";case"Left":return"ArrowLeft";case"Right":return"ArrowRight";case"Up":return"ArrowUp";case"Down":return"ArrowDown";case"Del":return"Delete";case"Crsel":return"CrSel";case"Exsel":return"ExSel";case"Esc":return"Escape";case"Apps":return"ContextMenu";case"Nonconvert":return"NonConvert";case"MediaNextTrack":return"MediaTrackNext";case"MediaPreviousTrack":return"MediaTrackPrevious";case"VolumeUp":return"AudioVolumeUp";case"VolumeDown":return"AudioVolumeDown";case"VolumeMute":return"AudioVolumeMute";case"Zoom":return"ZoomToggle";case"SelectMedia":case"MediaSelect":return"LaunchMediaPlayer";case"Add":return"+";case"Divide":return"/";case"Multiply":return"*";case"Subtract":return"-";case"Decimal":return decimalKey;case"Separator":return separatorKey}return key}}(),utilHasMediaQuery="function"!=typeof window.matchMedia?function(){return!1}:function(mediaQuery){return window.matchMedia(mediaQuery).matches};return Object.freeze(Object.defineProperties({},{getType:{value:utilGetType},isBoolean:{value:function(obj){return"boolean"==typeof obj||"string"==typeof obj&&("true"===obj||"false"===obj)}},isIterable:{value:function(obj){return null!=obj&&"function"==typeof obj[Symbol.iterator]}},isNumeric:{value:function(obj){var num;switch(_typeof(obj)){case"number":num=obj;break;case"string":num=Number(obj);break;default:return!1}return!Number.isNaN(num)&&Number.isFinite(num)}},sameValueZero:{value:function(a,b){return a===b||a!=a&&b!=b}},toEnum:{value:utilToEnum},toStringTag:{value:utilToStringTag},slugify:{value:function(str){var base=String(str).trim(),_legacy=base.replace(/[^\w\s\u2013\u2014-]+/g,"").replace(/[_\s\u2013\u2014-]+/g,"-").toLocaleLowerCase();return _isInvalidSlugRe.test(_legacy)?base.replace(_illegalSlugCharsRe,"").replace(/[_\s\u2013\u2014-]+/g,"-"):_legacy}},sanitizeFilename:{value:function(str){return String(str).trim().replace(_illegalFilenameCharsRE,"")}},escapeMarkup:{value:function(str){if(null==str)return"";var val=String(str);return val&&_hasMarkupCharsRe.test(val)?val.replace(_markupCharsRe,(function(ch){return _markupCharsMap[ch]})):val}},escape:{value:utilEscape},unescape:{value:utilUnescape},charAndPosAt:{value:function(text,position){var str=String(text),pos=Math.trunc(position),code=str.charCodeAt(pos);if(Number.isNaN(code))return{char:"",start:-1,end:-1};var retval={char:str.charAt(pos),start:pos,end:pos};if(code<55296||code>57343)return retval;if(code>=55296&&code<=56319){var nextPos=pos+1;if(nextPos>=str.length)return retval;var nextCode=str.charCodeAt(nextPos);return nextCode<56320||nextCode>57343||(retval.char=retval.char+str.charAt(nextPos),retval.end=nextPos),retval}if(0===pos)return retval;var prevPos=pos-1,prevCode=str.charCodeAt(prevPos);return prevCode<55296||prevCode>56319||(retval.char=str.charAt(prevPos)+retval.char,retval.start=prevPos),retval}},now:{value:function(){return _nowSource.now()}},fromCssTime:{value:function(cssTime){var match=_cssTimeRe.exec(String(cssTime));if(null===match)throw new SyntaxError('invalid time value syntax: "'.concat(cssTime,'"'));var msec=Number(match[1]);if(1===match[2].length&&(msec*=1e3),Number.isNaN(msec)||!Number.isFinite(msec))throw new RangeError('invalid time value: "'.concat(cssTime,'"'));return msec}},toCssTime:{value:function(msec){if("number"!=typeof msec||Number.isNaN(msec)||!Number.isFinite(msec)){var what;switch(_typeof(msec)){case"string":what='"'.concat(msec,'"');break;case"number":what=String(msec);break;default:what=utilToStringTag(msec)}throw new Error("invalid milliseconds: ".concat(what))}return"".concat(msec,"ms")}},fromCssProperty:{value:function(cssName){if(!cssName.includes("-"))switch(cssName){case"bgcolor":return"backgroundColor";case"float":return"cssFloat";default:return cssName}return("-ms-"===cssName.slice(0,4)?cssName.slice(1):cssName).split("-").map((function(part,i){return 0===i?part:part.toUpperFirst()})).join("")}},parseUrl:{value:function(url){var el=document.createElement("a"),queryObj=Object.create(null);el.href=url,el.search&&el.search.replace(/^\?/,"").splitOrEmpty(/(?:&(?:amp;)?|;)/).forEach((function(query){var _query$split2=_slicedToArray(query.split("="),2),key=_query$split2[0],value=_query$split2[1];queryObj[key]=value}));var pathname=el.host&&"/"!==el.pathname[0]?"/".concat(el.pathname):el.pathname;return{href:el.href,protocol:el.protocol,host:el.host,hostname:el.hostname,port:el.port,path:"".concat(pathname).concat(el.search),pathname:pathname,query:el.search,search:el.search,queries:queryObj,searches:queryObj,hash:el.hash}}},newExceptionFrom:{value:function(original,exceptionType,override){if("object"!==_typeof(original)||null===original)throw new Error("Util.newExceptionFrom original parameter must be an object");if("function"!=typeof exceptionType)throw new Error("Util.newExceptionFrom exceptionType parameter must be an error type constructor");var ex=new exceptionType(original.message);void 0!==original.name&&(ex.name=original.name),void 0!==original.code&&(ex.code=original.code),void 0!==original.columnNumber&&(ex.columnNumber=original.columnNumber),void 0!==original.description&&(ex.description=original.description),void 0!==original.fileName&&(ex.fileName=original.fileName),void 0!==original.lineNumber&&(ex.lineNumber=original.lineNumber),void 0!==original.number&&(ex.number=original.number),void 0!==original.stack&&(ex.stack=original.stack);var overrideType=_typeof(override);if("undefined"!==overrideType)if("object"===overrideType&&null!==override)Object.assign(ex,override);else{if("string"!==overrideType)throw new Error("Util.newExceptionFrom override parameter must be an object or string");ex.message=override}return ex}},scrubEventKey:{value:utilScrubEventKey},hasMediaQuery:{value:utilHasMediaQuery},random:{value:Math.random},entityEncode:{value:utilEscape},entityDecode:{value:utilUnescape},evalExpression:{value:function(){return Scripting.evalJavaScript.apply(Scripting,arguments)}},evalStatements:{value:function(){return Scripting.evalJavaScript.apply(Scripting,arguments)}}}))}(),SimpleStore=(_adapters=[],_initialized=null,Object.freeze(Object.defineProperties({},{adapters:{value:_adapters},create:{value:function(storageId,persistent){if(_initialized)return _initialized.create(storageId,persistent);for(var i=0;i<_adapters.length;++i)if(_adapters[i].init(storageId,persistent))return(_initialized=_adapters[i]).create(storageId,persistent);throw new Error("no valid storage adapters found")}}}))),_adapters,_initialized,_ok,_WebStorageAdapter;SimpleStore.adapters.push((_ok=!1,_WebStorageAdapter=function(){function _WebStorageAdapter(storageId,persistent){_classCallCheck(this,_WebStorageAdapter);var prefix="".concat(storageId,"."),engine=null,name=null;persistent?(engine=window.localStorage,name="localStorage"):(engine=window.sessionStorage,name="sessionStorage"),Object.defineProperties(this,{_engine:{value:engine},_prefix:{value:prefix},_prefixRe:{value:new RegExp("^".concat(RegExp.escape(prefix)))},name:{value:name},id:{value:storageId},persistent:{value:!!persistent}})}return _createClass(_WebStorageAdapter,[{key:"length",get:function(){return this.keys().length}},{key:"size",value:function(){return this.keys().length}},{key:"keys",value:function(){for(var keys=[],i=0;i<this._engine.length;++i){var key=this._engine.key(i);this._prefixRe.test(key)&&keys.push(key.replace(this._prefixRe,""))}return keys}},{key:"has",value:function(key){return!("string"!=typeof key||!key)&&this._engine.hasOwnProperty(this._prefix+key)}},{key:"get",value:function(key){if("string"!=typeof key||!key)return null;var value=this._engine.getItem(this._prefix+key);return null==value?null:_WebStorageAdapter._deserialize(value)}},{key:"set",value:function(key,value){if("string"!=typeof key||!key)return!1;try{this._engine.setItem(this._prefix+key,_WebStorageAdapter._serialize(value))}catch(ex){if(/quota.?(?:exceeded|reached)/i.test(ex.name+ex.message))throw Util.newExceptionFrom(ex,Error,"".concat(this.name," quota exceeded"));throw ex}return!0}},{key:"delete",value:function(key){return!("string"!=typeof key||!key||(this._engine.removeItem(this._prefix+key),0))}},{key:"clear",value:function(){for(var keys=this.keys(),i=0,iend=keys.length;i<iend;++i)this.delete(keys[i]);return!0}}],[{key:"_serialize",value:function(obj){return LZString.compressToUTF16(JSON.stringify(obj))}},{key:"_deserialize",value:function(str){return JSON.parse(LZString.decompressFromUTF16(str))}}]),_WebStorageAdapter}(),Object.freeze(Object.defineProperties({},{init:{value:function(){function hasWebStorage(storeId){try{var store=window[storeId],tid="_sc_".concat(String(Date.now()));store.setItem(tid,tid);var result=store.getItem(tid)===tid;return store.removeItem(tid),result}catch(ex){}return!1}return _ok=hasWebStorage("localStorage")&&hasWebStorage("sessionStorage")}},create:{value:function(storageId,persistent){if(!_ok)throw new Error("adapter not initialized");return new _WebStorageAdapter(storageId,persistent)}}})))),SimpleStore.adapters.push(function(){var _MAX_EXPIRY="Tue, 19 Jan 2038 03:14:07 GMT",_MIN_EXPIRY="Thu, 01 Jan 1970 00:00:00 GMT",_ok=!1,_CookieAdapter=function(){function _CookieAdapter(storageId,persistent){_classCallCheck(this,_CookieAdapter);var prefix="".concat(storageId).concat(persistent?"!":"*",".");Object.defineProperties(this,{_prefix:{value:prefix},_prefixRe:{value:new RegExp("^".concat(RegExp.escape(prefix)))},name:{value:"cookie"},id:{value:storageId},persistent:{value:!!persistent}})}return _createClass(_CookieAdapter,[{key:"length",get:function(){return this.keys().length}},{key:"size",value:function(){return this.keys().length}},{key:"keys",value:function(){if(""===document.cookie)return[];for(var cookies=document.cookie.split(/;\s*/),keys=[],i=0;i<cookies.length;++i){var kvPair=cookies[i].split("="),key=decodeURIComponent(kvPair[0]);if(this._prefixRe.test(key))""!==decodeURIComponent(kvPair[1])&&keys.push(key.replace(this._prefixRe,""))}return keys}},{key:"has",value:function(key){return!("string"!=typeof key||!key)&&null!==_CookieAdapter._getCookie(this._prefix+key)}},{key:"get",value:function(key){if("string"!=typeof key||!key)return null;var value=_CookieAdapter._getCookie(this._prefix+key);return null===value?null:_CookieAdapter._deserialize(value)}},{key:"set",value:function(key,value){if("string"!=typeof key||!key)return!1;try{if(_CookieAdapter._setCookie(this._prefix+key,_CookieAdapter._serialize(value),this.persistent?"Tue, 19 Jan 2038 03:14:07 GMT":undefined),!this.has(key))throw new Error("unknown validation error during set")}catch(ex){throw Util.newExceptionFrom(ex,Error,"cookie error: ".concat(ex.message))}return!0}},{key:"delete",value:function(key){if("string"!=typeof key||!key||!this.has(key))return!1;try{if(_CookieAdapter._setCookie(this._prefix+key,undefined,_MIN_EXPIRY),this.has(key))throw new Error("unknown validation error during delete")}catch(ex){throw Util.newExceptionFrom(ex,Error,"cookie error: ".concat(ex.message))}return!0}},{key:"clear",value:function(){for(var keys=this.keys(),i=0,iend=keys.length;i<iend;++i)this.delete(keys[i]);return!0}}],[{key:"_getCookie",value:function(prefixedKey){if(!prefixedKey||""===document.cookie)return null;for(var cookies=document.cookie.split(/;\s*/),i=0;i<cookies.length;++i){var kvPair=cookies[i].split("=");if(prefixedKey===decodeURIComponent(kvPair[0]))return decodeURIComponent(kvPair[1])||null}return null}},{key:"_setCookie",value:function(prefixedKey,value,expiry){if(prefixedKey){var payload="".concat(encodeURIComponent(prefixedKey),"=");null!=value&&(payload+=encodeURIComponent(value)),null!=expiry&&(payload+="; expires=".concat(expiry)),payload+="; path=/",document.cookie=payload}}},{key:"_serialize",value:function(obj){return LZString.compressToBase64(JSON.stringify(obj))}},{key:"_deserialize",value:function(str){return JSON.parse(LZString.decompressFromBase64(str))}}]),_CookieAdapter}();return Object.freeze(Object.defineProperties({},{init:{value:function(storageId){try{var tid="_sc_".concat(String(Date.now()));_CookieAdapter._setCookie(tid,_CookieAdapter._serialize(tid),undefined),_ok=_CookieAdapter._deserialize(_CookieAdapter._getCookie(tid))===tid,_CookieAdapter._setCookie(tid,undefined,_MIN_EXPIRY)}catch(ex){_ok=!1}return _ok&&function(storageId){if(""===document.cookie)return;for(var oldPrefix="".concat(storageId,"."),oldPrefixRe=new RegExp("^".concat(RegExp.escape(oldPrefix))),persistPrefix="".concat(storageId,"!."),sessionPrefix="".concat(storageId,"*."),sessionTestRe=/\.(?:state|rcWarn)$/,cookies=document.cookie.split(/;\s*/),i=0;i<cookies.length;++i){var kvPair=cookies[i].split("="),key=decodeURIComponent(kvPair[0]);if(oldPrefixRe.test(key)){var value=decodeURIComponent(kvPair[1]);""!==value&&function(){var persist=!sessionTestRe.test(key);_CookieAdapter._setCookie(key,undefined,_MIN_EXPIRY),_CookieAdapter._setCookie(key.replace(oldPrefixRe,(function(){return persist?persistPrefix:sessionPrefix})),value,persist?_MAX_EXPIRY:undefined)}()}}}(storageId),_ok}},create:{value:function(storageId,persistent){if(!_ok)throw new Error("adapter not initialized");return new _CookieAdapter(storageId,persistent)}}}))}());var DebugView=function(){function DebugView(parent,type,name,title){_classCallCheck(this,DebugView),Object.defineProperties(this,{parent:{value:parent},view:{value:document.createElement("span")},break:{value:document.createElement("wbr")}}),jQuery(this.view).attr({title:title,"aria-label":title,"data-type":null!=type?type:"","data-name":null!=name?name:""}).addClass("debug"),jQuery(this.break).addClass("debug hidden"),this.parent.appendChild(this.view),this.parent.appendChild(this.break)}return _createClass(DebugView,[{key:"output",get:function(){return this.view}},{key:"type",get:function(){return this.view.getAttribute("data-type")},set:function(type){this.view.setAttribute("data-type",null!=type?type:"")}},{key:"name",get:function(){return this.view.getAttribute("data-name")},set:function(name){this.view.setAttribute("data-name",null!=name?name:"")}},{key:"title",get:function(){return this.view.title},set:function(title){this.view.title=title}},{key:"append",value:function(el){return jQuery(this.view).append(el),this}},{key:"modes",value:function(options){if(null==options){var current={};return this.view.className.splitOrEmpty(/\s+/).forEach((function(name){"debug"!==name&&(current[name]=!0)})),current}if("object"===_typeof(options))return Object.keys(options).forEach((function(name){this[options[name]?"addClass":"removeClass"](name)}),jQuery(this.view)),this;throw new Error("DebugView.prototype.modes options parameter must be an object or null/undefined")}},{key:"remove",value:function(){var $view=jQuery(this.view);this.view.hasChildNodes()&&$view.contents().appendTo(this.parent),$view.remove(),jQuery(this.break).remove()}}],[{key:"isEnabled",value:function(){return"enabled"===jQuery(document.documentElement).attr("data-debug-view")}},{key:"enable",value:function(){jQuery(document.documentElement).attr("data-debug-view","enabled"),jQuery.event.trigger(":debugviewupdate")}},{key:"disable",value:function(){jQuery(document.documentElement).removeAttr("data-debug-view"),jQuery.event.trigger(":debugviewupdate")}},{key:"toggle",value:function(){"enabled"===jQuery(document.documentElement).attr("data-debug-view")?DebugView.disable():DebugView.enable()}}]),DebugView}(),NodeTyper=function(){var NodeTyper=function(){function NodeTyper(config){if(_classCallCheck(this,NodeTyper),"object"!==_typeof(config)||null===config)throw new Error("config parameter must be an object (received: ".concat(Util.getType(config),")"));if(!(config.hasOwnProperty("targetNode")&&config.targetNode instanceof Node))throw new Error('config parameter object "targetNode" property must be a node');Object.defineProperties(this,{node:{value:config.targetNode},childNodes:{value:[]},nodeValue:{writable:!0,value:""},appendTo:{writable:!0,value:config.parentNode||null},classNames:{writable:!0,value:config.classNames||null},finished:{writable:!0,value:!1}});var childNode,node=this.node;for(node.nodeValue&&(this.nodeValue=node.nodeValue,node.nodeValue="");null!==(childNode=node.firstChild);)this.childNodes.push(new NodeTyper({targetNode:childNode,parentNode:node,classNames:this.classNames})),node.removeChild(childNode)}return _createClass(NodeTyper,[{key:"finish",value:function(){for(;this.type(!0););return!1}},{key:"type",value:function(flush){if(this.finished)return!1;if(this.appendTo){if(this.appendTo.appendChild(this.node),this.appendTo=null,this.node.nodeType!==Node.ELEMENT_NODE&&this.node.nodeType!==Node.TEXT_NODE||"none"===jQuery(this.node.parentNode).css("display"))return this.finish();this.node.parentNode&&this.classNames&&jQuery(this.node.parentNode).addClass(this.classNames)}if(this.nodeValue){if(flush)this.node.nodeValue+=this.nodeValue,this.nodeValue="";else{var _Util$charAndPosAt=Util.charAndPosAt(this.nodeValue,0),char=_Util$charAndPosAt.char,start=_Util$charAndPosAt.start,end=_Util$charAndPosAt.end;this.node.nodeValue+=char,this.nodeValue=this.nodeValue.slice(1+end-start)}return!0}this.classNames&&(jQuery(this.node.parentNode).removeClass(this.classNames),this.classNames=null);for(var childNodes=this.childNodes;childNodes.length>0;){if(childNodes[0].type())return!0;childNodes.shift()}return this.finished=!0,!1}}]),NodeTyper}();return NodeTyper}(),PRNGWrapper=function(){function PRNGWrapper(seed,useEntropy){_classCallCheck(this,PRNGWrapper),Object.defineProperties(this,new Math.seedrandom(seed,useEntropy,(function(prng,seed){return{_prng:{value:prng},seed:{writable:!0,value:seed},pull:{writable:!0,value:0},random:{value:function(){return++this.pull,this._prng()}}}})))}return _createClass(PRNGWrapper,null,[{key:"marshal",value:function(prng){if(!prng||!prng.hasOwnProperty("seed")||!prng.hasOwnProperty("pull"))throw new Error("PRNG is missing required data");return{seed:prng.seed,pull:prng.pull}}},{key:"unmarshal",value:function(prngObj){if(!prngObj||!prngObj.hasOwnProperty("seed")||!prngObj.hasOwnProperty("pull"))throw new Error("PRNG object is missing required data");for(var prng=new PRNGWrapper(prngObj.seed,!1),i=prngObj.pull;i>0;--i)prng.random();return prng}}]),PRNGWrapper}(),StyleWrapper=(_imageMarkupRe=new RegExp(Patterns.cssImage,"g"),_hasImageMarkupRe=new RegExp(Patterns.cssImage),function(){function StyleWrapper(style){if(_classCallCheck(this,StyleWrapper),null==style)throw new TypeError("StyleWrapper style parameter must be an HTMLStyleElement object");Object.defineProperties(this,{style:{value:style}})}return _createClass(StyleWrapper,[{key:"isEmpty",value:function(){return 0===this.style.cssRules.length}},{key:"set",value:function(rawCss){this.clear(),this.add(rawCss)}},{key:"add",value:function(rawCss){var css=rawCss;_hasImageMarkupRe.test(css)&&(_imageMarkupRe.lastIndex=0,css=css.replace(_imageMarkupRe,(function(wikiImage){var markup=Wikifier.helpers.parseSquareBracketedMarkup({source:wikiImage,matchStart:0});if(markup.hasOwnProperty("error")||markup.pos<wikiImage.length)return wikiImage;var source=markup.source;if("data:"!==source.slice(0,5)&&Story.has(source)){var passage=Story.get(source);passage.tags.includes("Twine.image")&&(source=passage.text.trim())}return'url("'.concat(source.replace(/"/g,"%22"),'")')}))),this.style.styleSheet?this.style.styleSheet.cssText+=css:this.style.appendChild(document.createTextNode(css))}},{key:"clear",value:function(){this.style.styleSheet?this.style.styleSheet.cssText="":jQuery(this.style).empty()}}]),StyleWrapper}()),_imageMarkupRe,_hasImageMarkupRe,Diff=(Op=Util.toEnum({Delete:0,SpliceArray:1,Copy:2,CopyDate:3}),Object.freeze(Object.defineProperties({},{Op:{value:Op},diff:{value:function diff(orig,dest){for(var aOpRef,objToString=Object.prototype.toString,origIsArray=orig instanceof Array,keys=[].concat(Object.keys(orig),Object.keys(dest)).sort().filter((function(val,i,arr){return 0===i||arr[i-1]!==val})),diffed={},keyIsAOpRef=function(key){return key===aOpRef},i=0,klen=keys.length;i<klen;++i){var key=keys[i],origP=orig[key],destP=dest[key];if(orig.hasOwnProperty(key))if(dest.hasOwnProperty(key)){if(origP===destP)continue;if(_typeof(origP)===_typeof(destP))if("function"==typeof origP)origP.toString()!==destP.toString()&&(diffed[key]=[Op.Copy,destP]);else if("object"!==_typeof(origP)||null===origP)diffed[key]=[Op.Copy,destP];else{var origPType=objToString.call(origP);if(origPType===objToString.call(destP))if(origP instanceof Date)Number(origP)!==Number(destP)&&(diffed[key]=[Op.Copy,clone(destP)]);else if(origP instanceof Map)diffed[key]=[Op.Copy,clone(destP)];else if(origP instanceof RegExp)origP.toString()!==destP.toString()&&(diffed[key]=[Op.Copy,clone(destP)]);else if(origP instanceof Set)diffed[key]=[Op.Copy,clone(destP)];else if("[object Object]"!==origPType)diffed[key]=[Op.Copy,clone(destP)];else{var recurse=diff(origP,destP);null!==recurse&&(diffed[key]=recurse)}else diffed[key]=[Op.Copy,clone(destP)]}else diffed[key]=[Op.Copy,"object"!==_typeof(destP)||null===destP?destP:clone(destP)]}else if(origIsArray&&Util.isNumeric(key)){var nKey=Number(key);if(!aOpRef){aOpRef="";do{aOpRef+="~"}while(keys.some(keyIsAOpRef));diffed[aOpRef]=[Op.SpliceArray,nKey,nKey]}nKey<diffed[aOpRef][1]&&(diffed[aOpRef][1]=nKey),nKey>diffed[aOpRef][2]&&(diffed[aOpRef][2]=nKey)}else diffed[key]=Op.Delete;else diffed[key]=[Op.Copy,"object"!==_typeof(destP)||null===destP?destP:clone(destP)]}return Object.keys(diffed).length>0?diffed:null}},patch:{value:function patch(orig,diffed){for(var keys=Object.keys(diffed||{}),patched=clone(orig),i=0,klen=keys.length;i<klen;++i){var key=keys[i],diffedP=diffed[key];if(diffedP===Op.Delete)delete patched[key];else if(diffedP instanceof Array)switch(diffedP[0]){case Op.SpliceArray:patched.splice(diffedP[1],diffedP[2]-diffedP[1]+1);break;case Op.Copy:patched[key]=clone(diffedP[1]);break;case Op.CopyDate:patched[key]=new Date(diffedP[1])}else patched[key]=patch(patched[key],diffedP)}return patched}}}))),Op,L10n=(_patternRe=/\{\w+\}/g,_hasPatternRe=new RegExp(_patternRe.source),Object.freeze(Object.defineProperties({},{init:{value:function(){strings&&Object.keys(strings).length>0&&Object.keys(l10nStrings).forEach((function(id){try{var value;switch(id){case"identity":value=strings.identity;break;case"aborting":value=strings.aborting;break;case"cancel":value=strings.cancel;break;case"close":value=strings.close;break;case"ok":value=strings.ok;break;case"errorTitle":value=strings.errors.title;break;case"errorNonexistentPassage":value=strings.errors.nonexistentPassage;break;case"errorSaveMissingData":value=strings.errors.saveMissingData;break;case"errorSaveIdMismatch":value=strings.errors.saveIdMismatch;break;case"warningDegraded":value=strings.warnings.degraded;break;case"debugViewTitle":value=strings.debugView.title;break;case"debugViewToggle":value=strings.debugView.toggle;break;case"uiBarToggle":value=strings.uiBar.toggle;break;case"uiBarBackward":value=strings.uiBar.backward;break;case"uiBarForward":value=strings.uiBar.forward;break;case"uiBarJumpto":value=strings.uiBar.jumpto;break;case"jumptoTitle":value=strings.jumpto.title;break;case"jumptoTurn":value=strings.jumpto.turn;break;case"jumptoUnavailable":value=strings.jumpto.unavailable;break;case"savesTitle":value=strings.saves.title;break;case"savesDisallowed":value=strings.saves.disallowed;break;case"savesIncapable":value=strings.saves.incapable;break;case"savesLabelAuto":value=strings.saves.labelAuto;break;case"savesLabelDelete":value=strings.saves.labelDelete;break;case"savesLabelExport":value=strings.saves.labelExport;break;case"savesLabelImport":value=strings.saves.labelImport;break;case"savesLabelLoad":value=strings.saves.labelLoad;break;case"savesLabelClear":value=strings.saves.labelClear;break;case"savesLabelSave":value=strings.saves.labelSave;break;case"savesLabelSlot":value=strings.saves.labelSlot;break;case"savesUnavailable":value=strings.saves.unavailable;break;case"savesUnknownDate":value=strings.saves.unknownDate;break;case"settingsTitle":value=strings.settings.title;break;case"settingsOff":value=strings.settings.off;break;case"settingsOn":value=strings.settings.on;break;case"settingsReset":value=strings.settings.reset;break;case"restartTitle":value=strings.restart.title;break;case"restartPrompt":value=strings.restart.prompt;break;case"shareTitle":value=strings.share.title;break;case"alertTitle":break;case"autoloadTitle":value=strings.autoload.title;break;case"autoloadCancel":value=strings.autoload.cancel;break;case"autoloadOk":value=strings.autoload.ok;break;case"autoloadPrompt":value=strings.autoload.prompt;break;case"macroBackText":value=strings.macros.back.text;break;case"macroReturnText":value=strings.macros.return.text}value&&(l10nStrings[id]=value.replace(/%\w+%/g,(function(pat){return"{".concat(pat.slice(1,-1),"}")})))}catch(ex){}}))}},get:{value:function(ids,overrides){if(!ids)return"";var selectedId,id=((Array.isArray(ids)?ids:[ids]).some((function(id){return!!l10nStrings.hasOwnProperty(id)&&(selectedId=id,!0)})),selectedId);if(!id)return"";for(var processed=l10nStrings[id],iteration=0;_hasPatternRe.test(processed);){if(++iteration>50)throw new Error("L10n.get exceeded maximum replacement iterations, probable infinite loop");_patternRe.lastIndex=0,processed=processed.replace(_patternRe,(function(pat){var subId=pat.slice(1,-1);return overrides&&overrides.hasOwnProperty(subId)?overrides[subId]:l10nStrings.hasOwnProperty(subId)?l10nStrings[subId]:void 0}))}return processed}}}))),_patternRe,_hasPatternRe,strings={errors:{},warnings:{},debugView:{},uiBar:{},jumpto:{},saves:{},settings:{},restart:{},share:{},autoload:{},macros:{back:{},return:{}}},l10nStrings={identity:"game",aborting:"Aborting",cancel:"Cancel",close:"Close",ok:"OK",errorTitle:"Error",errorToggle:"Toggle the error view",errorNonexistentPassage:'the passage "{passage}" does not exist',errorSaveDiskLoadFailed:"failed to load save file from disk",errorSaveMissingData:"save is missing required data. Either the loaded file is not a save or the save has become corrupted",errorSaveIdMismatch:"save is from the wrong {identity}",_warningIntroLacking:"Your browser either lacks or has disabled",_warningOutroDegraded:", so this {identity} is running in a degraded mode. You may be able to continue, however, some parts may not work properly.",warningNoWebStorage:"{_warningIntroLacking} the Web Storage API{_warningOutroDegraded}",warningDegraded:"{_warningIntroLacking} some of the capabilities required by this {identity}{_warningOutroDegraded}",debugBarToggle:"Toggle the debug bar",debugBarNoWatches:"— no watches set —",debugBarAddWatch:"Add watch",debugBarDeleteWatch:"Delete watch",debugBarWatchAll:"Watch all",debugBarWatchNone:"Delete all",debugBarLabelAdd:"Add",debugBarLabelWatch:"Watch",debugBarLabelTurn:"Turn",debugBarLabelViews:"Views",debugBarViewsToggle:"Toggle the debug views",debugBarWatchToggle:"Toggle the watch panel",uiBarToggle:"Toggle the UI bar",uiBarBackward:"Go backward within the {identity} history",uiBarForward:"Go forward within the {identity} history",uiBarJumpto:"Jump to a specific point within the {identity} history",jumptoTitle:"Jump To",jumptoTurn:"Turn",jumptoUnavailable:"No jump points currently available…",savesTitle:"Saves",savesDisallowed:"Saving has been disallowed on this passage.",savesIncapable:"{_warningIntroLacking} the capabilities required to support saves, so saves have been disabled for this session.",savesLabelAuto:"Autosave",savesLabelDelete:"Delete",savesLabelExport:"Save to Disk…",savesLabelImport:"Load from Disk…",savesLabelLoad:"Load",savesLabelClear:"Delete All",savesLabelSave:"Save",savesLabelSlot:"Slot",savesUnavailable:"No save slots found…",savesUnknownDate:"unknown",settingsTitle:"Settings",settingsOff:"Off",settingsOn:"On",settingsReset:"Reset to Defaults",restartTitle:"Restart",restartPrompt:"Are you sure that you want to restart? Unsaved progress will be lost.",shareTitle:"Share",alertTitle:"Alert",autoloadTitle:"Autoload",autoloadCancel:"Go to start",autoloadOk:"Load autosave",autoloadPrompt:"An autosave exists. Load it now or go to the start?",macroBackText:"Back",macroReturnText:"Return"},Config=(_debug=!1,_addVisitedLinkClass=!1,_cleanupWikifierOutput=!1,_loadDelay=0,_audioPauseOnFadeToZero=!0,_audioPreloadMetadata=!0,_historyControls=!0,_historyMaxStates=40,_macrosIfAssignmentError=!0,_macrosMaxLoopIterations=1e3,_macrosTypeSkipKey=" ",_macrosTypeVisitedPassages=!0,_passagesDisplayTitles=!1,_passagesNobr=!1,_savesId="untitled-story",_savesSlots=8,_savesTryDiskOnMobile=!0,_uiStowBarInitially=800,_uiUpdateStoryElements=!0,_errHistoryModeDeprecated="Config.history.mode has been deprecated and is no longer used by SugarCube, please remove it from your code",Object.freeze({get debug(){return _debug},set debug(value){_debug=Boolean(value)},get addVisitedLinkClass(){return _addVisitedLinkClass},set addVisitedLinkClass(value){_addVisitedLinkClass=Boolean(value)},get cleanupWikifierOutput(){return _cleanupWikifierOutput},set cleanupWikifierOutput(value){_cleanupWikifierOutput=Boolean(value)},get loadDelay(){return _loadDelay},set loadDelay(value){if(!Number.isSafeInteger(value)||value<0)throw new RangeError("Config.loadDelay must be a non-negative integer");_loadDelay=value},audio:Object.freeze({get pauseOnFadeToZero(){return _audioPauseOnFadeToZero},set pauseOnFadeToZero(value){_audioPauseOnFadeToZero=Boolean(value)},get preloadMetadata(){return _audioPreloadMetadata},set preloadMetadata(value){_audioPreloadMetadata=Boolean(value)}}),history:Object.freeze({get controls(){return _historyControls},set controls(value){var controls=Boolean(value);if(1===_historyMaxStates&&controls)throw new Error("Config.history.controls must be false when Config.history.maxStates is 1");_historyControls=controls},get maxStates(){return _historyMaxStates},set maxStates(value){if(!Number.isSafeInteger(value)||value<1)throw new RangeError("Config.history.maxStates must be a positive integer");_historyMaxStates=value,_historyControls&&1===value&&(_historyControls=!1)},get mode(){throw new Error(_errHistoryModeDeprecated)},set mode(_){throw new Error(_errHistoryModeDeprecated)},get tracking(){throw new Error("Config.history.tracking has been deprecated, use Config.history.maxStates instead")},set tracking(_){throw new Error("Config.history.tracking has been deprecated, use Config.history.maxStates instead")}}),macros:Object.freeze({get ifAssignmentError(){return _macrosIfAssignmentError},set ifAssignmentError(value){_macrosIfAssignmentError=Boolean(value)},get maxLoopIterations(){return _macrosMaxLoopIterations},set maxLoopIterations(value){if(!Number.isSafeInteger(value)||value<1)throw new RangeError("Config.macros.maxLoopIterations must be a positive integer");_macrosMaxLoopIterations=value},get typeSkipKey(){return _macrosTypeSkipKey},set typeSkipKey(value){_macrosTypeSkipKey=String(value)},get typeVisitedPassages(){return _macrosTypeVisitedPassages},set typeVisitedPassages(value){_macrosTypeVisitedPassages=Boolean(value)}}),navigation:Object.freeze({get override(){return _navigationOverride},set override(value){if(!(null==value||value instanceof Function))throw new TypeError("Config.navigation.override must be a function or null/undefined (received: ".concat(Util.getType(value),")"));_navigationOverride=value}}),passages:Object.freeze({get descriptions(){return _passagesDescriptions},set descriptions(value){if(null!=value){var valueType=Util.getType(value);if("boolean"!==valueType&&"Object"!==valueType&&"function"!==valueType)throw new TypeError("Config.passages.descriptions must be a boolean, object, function, or null/undefined (received: ".concat(valueType,")"))}_passagesDescriptions=value},get displayTitles(){return _passagesDisplayTitles},set displayTitles(value){_passagesDisplayTitles=Boolean(value)},get nobr(){return _passagesNobr},set nobr(value){_passagesNobr=Boolean(value)},get onProcess(){return _passagesOnProcess},set onProcess(value){if(null!=value){var valueType=Util.getType(value);if("function"!==valueType)throw new TypeError("Config.passages.onProcess must be a function or null/undefined (received: ".concat(valueType,")"))}_passagesOnProcess=value},get start(){return _passagesStart},set start(value){if(null!=value){var valueType=Util.getType(value);if("string"!==valueType)throw new TypeError("Config.passages.start must be a string or null/undefined (received: ".concat(valueType,")"))}_passagesStart=value},get transitionOut(){return _passagesTransitionOut},set transitionOut(value){if(null!=value){var valueType=Util.getType(value);if("string"!==valueType&&("number"!==valueType||!Number.isSafeInteger(value)||value<0))throw new TypeError("Config.passages.transitionOut must be a string, non-negative integer, or null/undefined (received: ".concat(valueType,")"))}_passagesTransitionOut=value}}),saves:Object.freeze({get autoload(){return _savesAutoload},set autoload(value){if(null!=value){var valueType=Util.getType(value);if("boolean"!==valueType&&"string"!==valueType&&"function"!==valueType)throw new TypeError("Config.saves.autoload must be a boolean, string, function, or null/undefined (received: ".concat(valueType,")"))}_savesAutoload=value},get autosave(){return _savesAutosave},set autosave(value){if(null!=value){var valueType=Util.getType(value);if("string"===valueType)return void(_savesAutosave=[value]);if("boolean"!==valueType&&("Array"!==valueType||!value.every((function(item){return"string"==typeof item})))&&"function"!==valueType)throw new TypeError("Config.saves.autosave must be a boolean, Array<string>, function, or null/undefined (received: ".concat(valueType).concat("Array"===valueType?"<any>":"",")"))}_savesAutosave=value},get id(){return _savesId},set id(value){if("string"!=typeof value||""===value)throw new TypeError("Config.saves.id must be a non-empty string (received: ".concat(Util.getType(value),")"));_savesId=value},get isAllowed(){return _savesIsAllowed},set isAllowed(value){if(!(null==value||value instanceof Function))throw new TypeError("Config.saves.isAllowed must be a function or null/undefined (received: ".concat(Util.getType(value),")"));_savesIsAllowed=value},get slots(){return _savesSlots},set slots(value){if(!Number.isSafeInteger(value)||value<0)throw new TypeError("Config.saves.slots must be a non-negative integer (received: ".concat(Util.getType(value),")"));_savesSlots=value},get tryDiskOnMobile(){return _savesTryDiskOnMobile},set tryDiskOnMobile(value){_savesTryDiskOnMobile=Boolean(value)},get version(){return _savesVersion},set version(value){_savesVersion=value},get onLoad(){throw new Error("Config.saves.onLoad has been deprecated, use the Save.onLoad API instead")},set onLoad(value){console.warn("Config.saves.onLoad has been deprecated, use the Save.onLoad API instead"),Save.onLoad.add(value)},get onSave(){throw new Error("Config.saves.onSave has been deprecated, use the Save.onSave API instead")},set onSave(value){console.warn("Config.saves.onSave has been deprecated, use the Save.onSave API instead"),Save.onSave.add(value)}}),ui:Object.freeze({get stowBarInitially(){return _uiStowBarInitially},set stowBarInitially(value){var valueType=Util.getType(value);if("boolean"!==valueType&&("number"!==valueType||!Number.isSafeInteger(value)||value<0))throw new TypeError("Config.ui.stowBarInitially must be a boolean or non-negative integer (received: ".concat(valueType,")"));_uiStowBarInitially=value},get updateStoryElements(){return _uiUpdateStoryElements},set updateStoryElements(value){_uiUpdateStoryElements=Boolean(value)}})})),_navigationOverride,_passagesDescriptions,_passagesStart,_passagesOnProcess,_passagesTransitionOut,_savesAutoload,_savesAutosave,_savesIsAllowed,_savesVersion,_debug,_addVisitedLinkClass,_cleanupWikifierOutput,_loadDelay,_audioPauseOnFadeToZero,_audioPreloadMetadata,_historyControls,_historyMaxStates,_macrosIfAssignmentError,_macrosMaxLoopIterations,_macrosTypeSkipKey,_macrosTypeVisitedPassages,_passagesDisplayTitles,_passagesNobr,_savesId,_savesSlots,_savesTryDiskOnMobile,_uiStowBarInitially,_uiUpdateStoryElements,_errHistoryModeDeprecated,SimpleAudio=function(){var _hasPromise,_gestureEventNames=Object.freeze(["click","contextmenu","dblclick","keyup","mouseup","pointerup","touchend"]),_specialIds=Object.freeze([":not",":all",":looped",":muted",":paused",":playing"]),_formatSpecRe=/^([\w-]+)\s*\|\s*(\S.*)$/,_badIdRe=/[:\s]/,_tracks=new Map,_groups=new Map,_lists=new Map,_subscribers=new Map,_masterRate=1,_masterVolume=1,_masterMute=!1,_masterMuteOnHidden=!1,_playReturnsPromise=(_hasPromise=null,function(){if(null!==_hasPromise)return _hasPromise;if(_hasPromise=!1,Has.audio)try{var audio=document.createElement("audio");audio.muted=!0;var value=audio.play();value.catch((function(){})),_hasPromise=value instanceof Promise}catch(ex){}return _hasPromise}),AudioTrack=function(){function AudioTrack(obj){if(_classCallCheck(this,AudioTrack),obj instanceof Array)this._create(obj);else{if(!(obj instanceof AudioTrack))throw new Error("sources parameter must be either an array, of URIs or source objects, or an AudioTrack instance");this._copy(obj)}}return _createClass(AudioTrack,[{key:"_create",value:function(sourceList){var dataUriRe=/^data:\s*audio\/(?:x-)?([^;,]+)\s*[;,]/i,extRe=/\.([^./\\]+)$/,formats=AudioTrack.formats,usedSources=[],audio=document.createElement("audio");audio.preload="none",sourceList.forEach((function(src){var srcUri=null;switch(_typeof(src)){case"string":var match;if("data:"===src.slice(0,5)){if(null===(match=dataUriRe.exec(src)))throw new Error("source data URI missing media type")}else if(null===(match=extRe.exec(Util.parseUrl(src).pathname)))throw new Error("source URL missing file extension");formats[match[1]]&&(srcUri=src);break;case"object":if(null===src)throw new Error("source object cannot be null");if(!src.hasOwnProperty("src"))throw new Error('source object missing required "src" property');if(!src.hasOwnProperty("format"))throw new Error('source object missing required "format" property');formats[src.format]&&(srcUri=src.src);break;default:throw new Error("invalid source value (type: ".concat(_typeof(src),")"))}if(null!==srcUri){var source=document.createElement("source");source.src=srcUri,audio.appendChild(source),usedSources.push(srcUri)}})),audio.hasChildNodes()&&Config.audio.preloadMetadata&&(audio.preload="metadata"),this._finalize(audio,usedSources,clone(sourceList))}},{key:"_copy",value:function(obj){this._finalize(obj.audio.cloneNode(!0),clone(obj.sources),clone(obj.originals))}},{key:"_finalize",value:function(audio,sources,originals){var _this3=this;Object.defineProperties(this,{audio:{configurable:!0,value:audio},sources:{value:Object.freeze(sources)},originals:{value:Object.freeze(originals)},_error:{writable:!0,value:!1},_faderId:{writable:!0,value:null},_mute:{writable:!0,value:!1},_rate:{writable:!0,value:1},_volume:{writable:!0,value:1}}),jQuery(this.audio).on("loadstart.AudioTrack",(function(){return _this3._error=!1})).on("error.AudioTrack",(function(){return _this3._error=!0})).find("source:last-of-type").on("error.AudioTrack",(function(){return _this3._trigger("error")})),function(id,callback){if("function"!=typeof callback)throw new Error("callback parameter must be a function");_subscribers.set(id,callback)}(this,(function(mesg){if(_this3.audio)switch(mesg){case"loadwithscreen":if(_this3.hasSource()){var lockId=LoadScreen.lock();_this3.one("canplaythrough.AudioTrack_loadwithscreen error.AudioTrack_loadwithscreen",(function(){jQuery(this).off(".AudioTrack_loadwithscreen"),LoadScreen.unlock(lockId)})).load()}break;case"load":_this3.load();break;case"mute":_this3._updateAudioMute();break;case"rate":_this3._updateAudioRate();break;case"stop":_this3.stop();break;case"volume":_this3._updateAudioVolume();break;case"unload":_this3.unload()}else unsubscribe(_this3)})),this._updateAudioMute(),this._updateAudioRate(),this._updateAudioVolume()}},{key:"_trigger",value:function(eventName){jQuery(this.audio).triggerHandler(eventName)}},{key:"_destroy",value:function(){unsubscribe(this),this.audio&&(jQuery(this.audio).off(),this.unload(),this._error=!0,delete this.audio)}},{key:"clone",value:function(){return new AudioTrack(this)}},{key:"load",value:function(){var _this4=this;if(this.fadeStop(),this.audio.pause(),!this.audio.hasChildNodes()){if(0===this.sources.length)return;this.sources.forEach((function(srcUri){var source=document.createElement("source");source.src=srcUri,_this4.audio.appendChild(source)}))}"auto"!==this.audio.preload&&(this.audio.preload="auto"),this.isLoading()||this.audio.load()}},{key:"unload",value:function(){this.fadeStop(),this.stop();var audio=this.audio;for(audio.preload="none";audio.hasChildNodes();)audio.removeChild(audio.firstChild);audio.load()}},{key:"play",value:function(){var _this5=this;if(!this.hasSource())return Promise.reject(new Error("none of the candidate sources were acceptable"));if(this.isUnloaded())return Promise.reject(new Error("no sources are loaded"));if(this.isFailed())return Promise.reject(new Error("failed to load any of the sources"));"auto"!==this.audio.preload&&(this.audio.preload="auto");var namespace=".AudioTrack_play";return _playReturnsPromise()?this.audio.play():new Promise((function(resolve,reject){_this5.isPlaying()?resolve():(jQuery(_this5.audio).off(namespace).one("error".concat(namespace," playing").concat(namespace," timeupdate").concat(namespace),(function(ev){jQuery(_this5).off(namespace),"error"===ev.type?reject(new Error("unknown audio play error")):resolve()})),_this5.audio.play())}))}},{key:"playWhenAllowed",value:function(){var _this6=this;this.play().catch((function(){var gestures=_gestureEventNames.map((function(name){return"".concat(name,".AudioTrack_playWhenAllowed")})).join(" ");jQuery(document).one(gestures,(function(){jQuery(document).off(".AudioTrack_playWhenAllowed"),_this6.audio.play()}))}))}},{key:"pause",value:function(){this.audio.pause()}},{key:"stop",value:function(){this.audio.pause(),this.time(0),this._trigger(":stopped")}},{key:"fade",value:function(duration,toVol,fromVol){var _this7=this;if("number"!=typeof duration)throw new TypeError("duration parameter must be a number");if("number"!=typeof toVol)throw new TypeError("toVolume parameter must be a number");if(null!=fromVol&&"number"!=typeof fromVol)throw new TypeError("fromVolume parameter must be a number");if(!this.hasSource())return Promise.reject(new Error("none of the candidate sources were acceptable"));if(this.isUnloaded())return Promise.reject(new Error("no sources are loaded"));if(this.isFailed())return Promise.reject(new Error("failed to load any of the sources"));this.fadeStop();var from=Math.clamp(null==fromVol?this.volume():fromVol,0,1),to=Math.clamp(toVol,0,1);return from!==to?(this.volume(from),jQuery(this.audio).off("timeupdate.AudioTrack_fade").one("timeupdate.AudioTrack_fade",(function(){var min,max;from<to?(min=from,max=to):(min=to,max=from);var time=Math.max(duration,1),delta=(to-from)/(time/.025);_this7._trigger(":fading"),_this7._faderId=setInterval((function(){_this7.isPlaying()?(_this7.volume(Math.clamp(_this7.volume()+delta,min,max)),Config.audio.pauseOnFadeToZero&&0===_this7.volume()&&_this7.pause(),_this7.volume()===to&&(_this7.fadeStop(),_this7._trigger(":faded"))):_this7.fadeStop()}),25)})),this.play()):void 0}},{key:"fadeIn",value:function(duration,fromVol){return this.fade(duration,1,fromVol)}},{key:"fadeOut",value:function(duration,fromVol){return this.fade(duration,0,fromVol)}},{key:"fadeStop",value:function(){null!==this._faderId&&(clearInterval(this._faderId),this._faderId=null)}},{key:"loop",value:function(_loop){return null==_loop?this.audio.loop:(this.audio.loop=!!_loop,this)}},{key:"mute",value:function(_mute){return null==_mute?this._mute:(this._mute=!!_mute,this._updateAudioMute(),this)}},{key:"_updateAudioMute",value:function(){this.audio.muted=this._mute||_masterMute}},{key:"rate",value:function(_rate){if(null==_rate)return this._rate;if("number"!=typeof _rate)throw new TypeError("rate parameter must be a number");return this._rate=Math.clamp(_rate,.2,5),this._updateAudioRate(),this}},{key:"_updateAudioRate",value:function(){this.audio.playbackRate=Math.clamp(this._rate*_masterRate,.2,5)}},{key:"time",value:function(_time){var _this8=this;if(null==_time)return this.audio.currentTime;if("number"!=typeof _time)throw new TypeError("time parameter must be a number");return this.hasMetadata()?this.audio.currentTime=_time:jQuery(this.audio).off("loadedmetadata.AudioTrack_time").one("loadedmetadata.AudioTrack_time",(function(){return _this8.audio.currentTime=_time})),this}},{key:"volume",value:function(_volume){if(null==_volume)return this._volume;if("number"!=typeof _volume)throw new TypeError("volume parameter must be a number");return this._volume=Math.clamp(_volume,0,1),this._updateAudioVolume(),this}},{key:"_updateAudioVolume",value:function(){this.audio.volume=Math.clamp(this._volume*_masterVolume,0,1)}},{key:"duration",value:function(){return this.audio.duration}},{key:"remaining",value:function(){return this.audio.duration-this.audio.currentTime}},{key:"isFailed",value:function(){return this._error}},{key:"isLoading",value:function(){return this.audio.networkState===HTMLMediaElement.NETWORK_LOADING}},{key:"isUnloaded",value:function(){return!this.audio.hasChildNodes()}},{key:"isUnavailable",value:function(){return!this.hasSource()||this.isUnloaded()||this.isFailed()}},{key:"isPlaying",value:function(){return!this.audio.paused&&this.hasSomeData()}},{key:"isPaused",value:function(){return this.audio.paused&&(this.audio.duration===1/0||this.audio.currentTime>0)&&!this.audio.ended}},{key:"isStopped",value:function(){return this.audio.paused&&0===this.audio.currentTime}},{key:"isEnded",value:function(){return this.audio.ended}},{key:"isFading",value:function(){return null!==this._faderId}},{key:"isSeeking",value:function(){return this.audio.seeking}},{key:"hasSource",value:function(){return this.sources.length>0}},{key:"hasNoData",value:function(){return this.audio.readyState===HTMLMediaElement.HAVE_NOTHING}},{key:"hasMetadata",value:function(){return this.audio.readyState>=HTMLMediaElement.HAVE_METADATA}},{key:"hasSomeData",value:function(){return this.audio.readyState>=HTMLMediaElement.HAVE_CURRENT_DATA}},{key:"hasData",value:function(){return this.audio.readyState===HTMLMediaElement.HAVE_ENOUGH_DATA}},{key:"on",value:function(){for(var _len5=arguments.length,args=new Array(_len5),_key5=0;_key5<_len5;_key5++)args[_key5]=arguments[_key5];return jQuery.fn.on.apply(jQuery(this.audio),args),this}},{key:"one",value:function(){for(var _len6=arguments.length,args=new Array(_len6),_key6=0;_key6<_len6;_key6++)args[_key6]=arguments[_key6];return jQuery.fn.one.apply(jQuery(this.audio),args),this}},{key:"off",value:function(){for(var _len7=arguments.length,args=new Array(_len7),_key7=0;_key7<_len7;_key7++)args[_key7]=arguments[_key7];return jQuery.fn.off.apply(jQuery(this.audio),args),this}}]),AudioTrack}();Object.defineProperties(AudioTrack,{formats:{value:function(){var audio=document.createElement("audio"),types=new Map;function canPlay(mimeType){return types.has(mimeType)||types.set(mimeType,""!==audio.canPlayType(mimeType).replace(/^no$/i,"")),types.get(mimeType)}return Object.assign(Object.create(null),{aac:canPlay("audio/aac"),caf:canPlay("audio/x-caf")||canPlay("audio/caf"),flac:canPlay("audio/x-flac")||canPlay("audio/flac"),mp3:canPlay('audio/mpeg; codecs="mp3"')||canPlay("audio/mpeg")||canPlay("audio/mp3")||canPlay("audio/mpa"),mpeg:canPlay("audio/mpeg"),m4a:canPlay("audio/x-m4a")||canPlay("audio/m4a")||canPlay("audio/aac"),mp4:canPlay("audio/x-mp4")||canPlay("audio/mp4")||canPlay("audio/aac"),ogg:canPlay("audio/ogg"),oga:canPlay("audio/ogg"),opus:canPlay('audio/ogg; codecs="opus"')||canPlay("audio/opus"),wav:canPlay('audio/wave; codecs="1"')||canPlay('audio/wav; codecs="1"')||canPlay("audio/wave")||canPlay("audio/wav"),wave:canPlay('audio/wave; codecs="1"')||canPlay('audio/wav; codecs="1"')||canPlay("audio/wave")||canPlay("audio/wav"),weba:canPlay("audio/webm"),webm:canPlay("audio/webm")})}()}});var AudioList=function(){function AudioList(obj){if(_classCallCheck(this,AudioList),obj instanceof Array)this._create(obj);else{if(!(obj instanceof AudioList))throw new Error("tracks parameter must be either an array, of track objects, or an AudioTrack instance");this._copy(obj)}}return _createClass(AudioList,[{key:"_create",value:function(trackList){var _this9=this;this._finalize(trackList.map((function(trackObj){if("object"!==_typeof(trackObj))throw new Error("tracks parameter array members must be objects");var own,rate,track,volume;if(trackObj instanceof AudioTrack)own=!0,rate=trackObj.rate(),track=trackObj.clone(),volume=trackObj.volume();else{if(!trackObj.hasOwnProperty("track"))throw new Error('track object missing required "track" property');if(!(trackObj.track instanceof AudioTrack))throw new Error('track object\'s "track" property must be an AudioTrack object');own=trackObj.hasOwnProperty("own")&&trackObj.own,rate=trackObj.hasOwnProperty("rate")?trackObj.rate:trackObj.track.rate(),track=trackObj.track,volume=trackObj.hasOwnProperty("volume")?trackObj.volume:trackObj.track.volume()}return track.stop(),track.loop(!1),track.mute(!1),track.rate(rate),track.volume(volume),track.on("ended.AudioList",(function(){return _this9._onEnd()})),{own:own,track:track,volume:volume,rate:rate}})))}},{key:"_copy",value:function(obj){this._finalize(clone(obj.tracks))}},{key:"_finalize",value:function(tracks){Object.defineProperties(this,{tracks:{configurable:!0,value:Object.freeze(tracks)},queue:{configurable:!0,value:[]},current:{writable:!0,value:null},_rate:{writable:!0,value:1},_volume:{writable:!0,value:1},_mute:{writable:!0,value:!1},_loop:{writable:!0,value:!1},_shuffle:{writable:!0,value:!1}})}},{key:"_destroy",value:function(){this.stop(),this.tracks.filter((function(trackObj){return trackObj.own})).forEach((function(trackObj){return trackObj.track._destroy()})),delete this.tracks,delete this.queue}},{key:"load",value:function(){this.tracks.forEach((function(trackObj){return trackObj.track.load()}))}},{key:"unload",value:function(){this.stop(),this.tracks.forEach((function(trackObj){return trackObj.track.unload()}))}},{key:"play",value:function(){return null!==this.current&&!this.current.track.isUnavailable()&&!this.current.track.isEnded()||(0===this.queue.length&&this._fillQueue(),this._next())?this.current.track.play():Promise.reject(new Error("no tracks were available"))}},{key:"playWhenAllowed",value:function(){var _this10=this;this.play().catch((function(){var gestures=_gestureEventNames.map((function(name){return"".concat(name,".AudioList_playWhenAllowed")})).join(" ");jQuery(document).one(gestures,(function(){jQuery(document).off(".AudioList_playWhenAllowed"),_this10.play()}))}))}},{key:"pause",value:function(){null!==this.current&&this.current.track.pause()}},{key:"stop",value:function(){null!==this.current&&(this.current.track.stop(),this.current=null),this._drainQueue()}},{key:"skip",value:function(){this._next()?this.current.track.play():this._loop&&this.play()}},{key:"fade",value:function(duration,toVol,fromVol){if("number"!=typeof duration)throw new TypeError("duration parameter must be a number");if("number"!=typeof toVol)throw new TypeError("toVolume parameter must be a number");if(null!=fromVol&&"number"!=typeof fromVol)throw new TypeError("fromVolume parameter must be a number");if(0===this.queue.length&&this._fillQueue(),null!==this.current&&!this.current.track.isUnavailable()&&!this.current.track.isEnded()||this._next()){var adjFromVol,adjToVol=Math.clamp(toVol,0,1)*this.current.volume;return null!=fromVol&&(adjFromVol=Math.clamp(fromVol,0,1)*this.current.volume),this._volume=toVol,this.current.track.fade(duration,adjToVol,adjFromVol)}}},{key:"fadeIn",value:function(duration,fromVol){return this.fade(duration,1,fromVol)}},{key:"fadeOut",value:function(duration,fromVol){return this.fade(duration,0,fromVol)}},{key:"fadeStop",value:function(){null!==this.current&&this.current.track.fadeStop()}},{key:"loop",value:function(_loop2){return null==_loop2?this._loop:(this._loop=!!_loop2,this)}},{key:"mute",value:function(_mute2){return null==_mute2?this._mute:(this._mute=!!_mute2,null!==this.current&&this.current.track.mute(this._mute),this)}},{key:"rate",value:function(_rate2){if(null==_rate2)return this._rate;if("number"!=typeof _rate2)throw new TypeError("rate parameter must be a number");return this._rate=Math.clamp(_rate2,.2,5),null!==this.current&&this.current.track.rate(this._rate*this.current.rate),this}},{key:"shuffle",value:function(_shuffle){var _this11=this;if(null==_shuffle)return this._shuffle;if(this._shuffle=!!_shuffle,this.queue.length>0&&(this._fillQueue(),!this._shuffle&&null!==this.current&&this.queue.length>1)){var _this$queue,firstIdx=this.queue.findIndex((function(trackObj){return trackObj===_this11.current}));if(-1!==firstIdx)(_this$queue=this.queue).push.apply(_this$queue,_toConsumableArray(this.queue.splice(0,firstIdx+1)))}return this}},{key:"volume",value:function(_volume2){if(null==_volume2)return this._volume;if("number"!=typeof _volume2)throw new TypeError("volume parameter must be a number");return this._volume=Math.clamp(_volume2,0,1),null!==this.current&&this.current.track.volume(this._volume*this.current.volume),this}},{key:"duration",value:function(){if(arguments.length>0)throw new Error("duration takes no parameters");return this.tracks.map((function(trackObj){return trackObj.track.duration()})).reduce((function(prev,cur){return prev+cur}),0)}},{key:"remaining",value:function(){if(arguments.length>0)throw new Error("remaining takes no parameters");var remainingTime=this.queue.map((function(trackObj){return trackObj.track.duration()})).reduce((function(prev,cur){return prev+cur}),0);return null!==this.current&&(remainingTime+=this.current.track.remaining()),remainingTime}},{key:"time",value:function(){if(arguments.length>0)throw new Error("time takes no parameters");return this.duration()-this.remaining()}},{key:"isPlaying",value:function(){return null!==this.current&&this.current.track.isPlaying()}},{key:"isPaused",value:function(){return null===this.current||this.current.track.isPaused()}},{key:"isStopped",value:function(){return 0===this.queue.length&&null===this.current}},{key:"isEnded",value:function(){return 0===this.queue.length&&(null===this.current||this.current.track.isEnded())}},{key:"isFading",value:function(){return null!==this.current&&this.current.track.isFading()}},{key:"_next",value:function(){var nextTrack;for(null!==this.current&&(this.current.track.stop(),this.current=null);nextTrack=this.queue.shift();)if(!nextTrack.track.isUnavailable()){this.current=nextTrack;break}return null!==this.current&&(this.current.track.mute(this._mute),this.current.track.rate(this._rate*this.current.rate),this.current.track.volume(this._volume*this.current.volume),this.current.track.loop(!1),!0)}},{key:"_onEnd",value:function(){if(0===this.queue.length){if(!this._loop)return;this._fillQueue()}this._next()&&this.current.track.play()}},{key:"_drainQueue",value:function(){this.queue.splice(0)}},{key:"_fillQueue",value:function(){var _this$queue2;this._drainQueue(),(_this$queue2=this.queue).push.apply(_this$queue2,_toConsumableArray(this.tracks.filter((function(trackObj){return!trackObj.track.isUnavailable()})))),0!==this.queue.length&&this._shuffle&&(this.queue.shuffle(),this.queue.length>1&&this.queue[0]===this.current&&this.queue.push(this.queue.shift()))}}]),AudioList}(),AudioRunner=function(){function AudioRunner(list){if(_classCallCheck(this,AudioRunner),!(list instanceof Set||list instanceof AudioRunner))throw new TypeError("list parameter must be a Set or a AudioRunner instance");Object.defineProperties(this,{trackIds:{value:new Set(list instanceof AudioRunner?list.trackIds:list)}})}return _createClass(AudioRunner,[{key:"load",value:function(){AudioRunner._run(this.trackIds,AudioTrack.prototype.load)}},{key:"unload",value:function(){AudioRunner._run(this.trackIds,AudioTrack.prototype.unload)}},{key:"play",value:function(){AudioRunner._run(this.trackIds,AudioTrack.prototype.play)}},{key:"playWhenAllowed",value:function(){AudioRunner._run(this.trackIds,AudioTrack.prototype.playWhenAllowed)}},{key:"pause",value:function(){AudioRunner._run(this.trackIds,AudioTrack.prototype.pause)}},{key:"stop",value:function(){AudioRunner._run(this.trackIds,AudioTrack.prototype.stop)}},{key:"fade",value:function(duration,toVol,fromVol){if(null==duration||null==toVol)throw new Error("fade requires parameters");AudioRunner._run(this.trackIds,AudioTrack.prototype.fade,duration,toVol,fromVol)}},{key:"fadeIn",value:function(duration,fromVol){if(null==duration)throw new Error("fadeIn requires a parameter");AudioRunner._run(this.trackIds,AudioTrack.prototype.fadeIn,duration,fromVol)}},{key:"fadeOut",value:function(duration,fromVol){if(null==duration)throw new Error("fadeOut requires a parameter");AudioRunner._run(this.trackIds,AudioTrack.prototype.fadeOut,duration,fromVol)}},{key:"fadeStop",value:function(){AudioRunner._run(this.trackIds,AudioTrack.prototype.fadeStop)}},{key:"loop",value:function(_loop3){if(null==_loop3)throw new Error("loop requires a parameter");return AudioRunner._run(this.trackIds,AudioTrack.prototype.loop,_loop3),this}},{key:"mute",value:function(_mute3){if(null==_mute3)throw new Error("mute requires a parameter");return AudioRunner._run(this.trackIds,AudioTrack.prototype.mute,_mute3),this}},{key:"rate",value:function(_rate3){if(null==_rate3)throw new Error("rate requires a parameter");return AudioRunner._run(this.trackIds,AudioTrack.prototype.rate,_rate3),this}},{key:"time",value:function(_time2){if(null==_time2)throw new Error("time requires a parameter");return AudioRunner._run(this.trackIds,AudioTrack.prototype.time,_time2),this}},{key:"volume",value:function(_volume3){if(null==_volume3)throw new Error("volume requires a parameter");return AudioRunner._run(this.trackIds,AudioTrack.prototype.volume,_volume3),this}},{key:"on",value:function(){for(var _len8=arguments.length,args=new Array(_len8),_key8=0;_key8<_len8;_key8++)args[_key8]=arguments[_key8];return AudioRunner._run.apply(AudioRunner,[this.trackIds,AudioTrack.prototype.on].concat(args)),this}},{key:"one",value:function(){for(var _len9=arguments.length,args=new Array(_len9),_key9=0;_key9<_len9;_key9++)args[_key9]=arguments[_key9];return AudioRunner._run.apply(AudioRunner,[this.trackIds,AudioTrack.prototype.one].concat(args)),this}},{key:"off",value:function(){for(var _len10=arguments.length,args=new Array(_len10),_key10=0;_key10<_len10;_key10++)args[_key10]=arguments[_key10];return AudioRunner._run.apply(AudioRunner,[this.trackIds,AudioTrack.prototype.off].concat(args)),this}}],[{key:"_run",value:function(ids,fn){for(var _len11=arguments.length,args=new Array(_len11>2?_len11-2:0),_key11=2;_key11<_len11;_key11++)args[_key11-2]=arguments[_key11];ids.forEach((function(id){var track=_tracks.get(id);track&&fn.apply(track,args)}))}}]),AudioRunner}();var _runnerParseSelector=function(){var notWsRe=/\S/g,parenRe=/[()]/g;function processNegation(str,startPos){var match;if(notWsRe.lastIndex=startPos,null===(match=notWsRe.exec(str))||"("!==match[0])throw new Error('invalid ":not()" syntax: missing parentheticals');parenRe.lastIndex=notWsRe.lastIndex;for(var start=notWsRe.lastIndex,result={str:"",nextMatch:-1},depth=1;null!==(match=parenRe.exec(str));)if("("===match[0]?++depth:--depth,depth<1){result.nextMatch=parenRe.lastIndex,result.str=str.slice(start,result.nextMatch-1);break}return result}return function parseSelector(idArg){for(var match,ids=[],idRe=/:?[^\s:()]+/g;null!==(match=idRe.exec(idArg));){var id=match[0];if(":not"===id){if(0===ids.length)throw new Error('invalid negation: no group ID preceded ":not()"');var parent=ids[ids.length-1];if(":"!==parent.id[0])throw new Error('invalid negation of track "'.concat(parent.id,'": only groups may be negated with ":not()"'));var negation=processNegation(idArg,idRe.lastIndex);if(-1===negation.nextMatch)throw new Error('unknown error parsing ":not()"');idRe.lastIndex=negation.nextMatch,parent.not=parseSelector(negation.str)}else ids.push({id:id})}return ids}}();function masterMute(mute){if(null==mute)return _masterMute;publish("mute",_masterMute=!!mute)}function unsubscribe(id){_subscribers.delete(id)}function publish(mesg,data){_subscribers.forEach((function(fn){return fn(mesg,data)}))}function _newTrack(sources){return new AudioTrack(sources.map((function(source){if("data:"!==source.slice(0,5)&&Story.has(source)){var passage=Story.get(source);if(passage.tags.includes("Twine.audio"))return passage.text.trim()}var match=_formatSpecRe.exec(source);return null===match?source:{format:match[1],src:match[2]}})))}return Object.freeze(Object.defineProperties({},{tracks:{value:Object.freeze(Object.defineProperties({},{add:{value:function(){if(arguments.length<2){var errors=[];throw arguments.length<1&&errors.push("track ID"),arguments.length<2&&errors.push("sources"),new Error("no ".concat(errors.join(" or ")," specified"))}var id=String(arguments[0]).trim(),what='track ID "'.concat(id,'"');if(_badIdRe.test(id))throw new Error("invalid ".concat(what,": track IDs must not contain colons or whitespace"));var track,sources=Array.isArray(arguments[1])?Array.from(arguments[1]):Array.from(arguments).slice(1);try{track=_newTrack(sources)}catch(ex){throw new Error("".concat(what,": error during track initialization: ").concat(ex.message))}if(Config.debug&&!track.hasSource())throw new Error("".concat(what,": no supported audio sources found"));_tracks.has(id)&&_tracks.get(id)._destroy(),_tracks.set(id,track)}},delete:{value:function(id){return _tracks.has(id)&&_tracks.get(id)._destroy(),_tracks.delete(id)}},clear:{value:function(){_tracks.forEach((function(track){return track._destroy()})),_tracks.clear()}},has:{value:function(id){return _tracks.has(id)}},get:{value:function(id){return _tracks.get(id)||null}}}))},groups:{value:Object.freeze(Object.defineProperties({},{add:{value:function(){if(arguments.length<2){var errors=[];throw arguments.length<1&&errors.push("group ID"),arguments.length<2&&errors.push("track IDs"),new Error("no ".concat(errors.join(" or ")," specified"))}var id=String(arguments[0]).trim(),what='group ID "'.concat(id,'"');if(":"!==id[0]||_badIdRe.test(id.slice(1)))throw new Error("invalid ".concat(what,": group IDs must start with a colon and must not contain colons or whitespace"));if(_specialIds.includes(id))throw new Error("cannot clobber special ".concat(what));var group,trackIds=Array.isArray(arguments[1])?Array.from(arguments[1]):Array.from(arguments).slice(1);try{group=new Set(trackIds.map((function(trackId){if(!_tracks.has(trackId))throw new Error('track "'.concat(trackId,'" does not exist'));return trackId})))}catch(ex){throw new Error("".concat(what,": error during group initialization: ").concat(ex.message))}_groups.set(id,Object.freeze(Array.from(group)))}},delete:{value:function(id){return _groups.delete(id)}},clear:{value:function(){_groups.clear()}},has:{value:function(id){return _groups.has(id)}},get:{value:function(id){return _groups.get(id)||null}}}))},lists:{value:Object.freeze(Object.defineProperties({},{add:{value:function(){if(arguments.length<2){var errors=[];throw arguments.length<1&&errors.push("list ID"),arguments.length<2&&errors.push("track IDs"),new Error("no ".concat(errors.join(" or ")," specified"))}var id=String(arguments[0]).trim(),what='list ID "'.concat(id,'"');if(_badIdRe.test(id))return this.error("invalid ".concat(what,": list IDs must not contain colons or whitespace"));var list,descriptors=Array.isArray(arguments[1])?Array.from(arguments[1]):Array.from(arguments).slice(1);try{list=new AudioList(descriptors.map((function(desc){if(null===desc)throw new Error("track descriptor must be a string or object (type: null)");switch(_typeof(desc)){case"string":desc={id:desc};break;case"object":if(!desc.hasOwnProperty("id")&&!desc.hasOwnProperty("sources"))throw new Error('track descriptor must contain one of either an "id" or a "sources" property');if(desc.hasOwnProperty("id")&&desc.hasOwnProperty("sources"))throw new Error('track descriptor must contain either an "id" or a "sources" property, not both');break;default:throw new Error("track descriptor must be a string or object (type: ".concat(_typeof(desc),")"))}var own,track,volume;if(desc.hasOwnProperty("id")){if("string"!=typeof desc.id)throw new Error('"id" property must be a string');if(!_tracks.has(desc.id))throw new Error('track "'.concat(desc.id,'" does not exist'));track=_tracks.get(desc.id)}else if(desc.hasOwnProperty("sources")){if(!Array.isArray(desc.sources)||0===desc.sources.length)throw new Error('"sources" property must be a non-empty array');if(desc.hasOwnProperty("own"))throw new Error('"own" property is not allowed with the "sources" property');try{track=_newTrack(desc.sources),own=!0}catch(ex){throw new Error("error during track initialization: ".concat(ex.message))}if(Config.debug&&!track.hasSource())throw new Error("no supported audio sources found")}if(desc.hasOwnProperty("own")){if("boolean"!=typeof desc.own)throw new Error('"own" property must be a boolean');(own=desc.own)&&(track=track.clone())}if(desc.hasOwnProperty("volume")){if("number"!=typeof desc.volume||Number.isNaN(desc.volume)||!Number.isFinite(desc.volume)||desc.volume<0)throw new Error('"volume" property must be a non-negative finite number');volume=desc.volume}return{own:null!=own&&own,track:track,volume:null!=volume?volume:track.volume()}})))}catch(ex){throw new Error("".concat(what,": error during playlist initialization: ").concat(ex.message))}_lists.has(id)&&_lists.get(id)._destroy(),_lists.set(id,list)}},delete:{value:function(id){return _lists.has(id)&&_lists.get(id)._destroy(),_lists.delete(id)}},clear:{value:function(){_lists.forEach((function(list){return list._destroy()})),_lists.clear()}},has:{value:function(id){return _lists.has(id)}},get:{value:function(id){return _lists.get(id)||null}}}))},select:{value:function(){if(0===arguments.length)throw new Error("no track selector specified");var selector=String(arguments[0]).trim(),trackIds=new Set;try{var renderIds=function renderIds(idObj){var ids,id=idObj.id;switch(id){case":all":ids=allIds;break;case":looped":ids=allIds.filter((function(id){return _tracks.get(id).loop()}));break;case":muted":ids=allIds.filter((function(id){return _tracks.get(id).mute()}));break;case":paused":ids=allIds.filter((function(id){return _tracks.get(id).isPaused()}));break;case":playing":ids=allIds.filter((function(id){return _tracks.get(id).isPlaying()}));break;default:ids=":"===id[0]?_groups.get(id):[id]}if(idObj.hasOwnProperty("not")){var negated=idObj.not.map((function(idObj){return renderIds(idObj)})).flat(1/0);ids=ids.filter((function(id){return!negated.includes(id)}))}return ids},allIds=Array.from(_tracks.keys());_runnerParseSelector(selector).forEach((function(idObj){return renderIds(idObj).forEach((function(id){if(!_tracks.has(id))throw new Error('track "'.concat(id,'" does not exist'));trackIds.add(id)}))}))}catch(ex){throw new Error("error during runner initialization: ".concat(ex.message))}return new AudioRunner(trackIds)}},load:{value:function(){publish("load")}},loadWithScreen:{value:function(){publish("loadwithscreen")}},mute:{value:masterMute},muteOnHidden:{value:function(mute){if(!Visibility.isEnabled())return!1;if(null==mute)return _masterMuteOnHidden;var namespace=".SimpleAudio_masterMuteOnHidden";if(_masterMuteOnHidden=!!mute){var visibilityChange="".concat(Visibility.changeEvent).concat(namespace);jQuery(document).off(namespace).on(visibilityChange,(function(){return masterMute(Visibility.isHidden())})),Visibility.isHidden()&&masterMute(!0)}else jQuery(document).off(namespace)}},rate:{value:function(rate){if(null==rate)return _masterRate;if("number"!=typeof rate||Number.isNaN(rate)||!Number.isFinite(rate))throw new Error("rate must be a finite number");publish("rate",_masterRate=Math.clamp(rate,.2,5))}},stop:{value:function(){publish("stop")}},unload:{value:function(){publish("unload")}},volume:{value:function(volume){if(null==volume)return _masterVolume;if("number"!=typeof volume||Number.isNaN(volume)||!Number.isFinite(volume))throw new Error("volume must be a finite number");publish("volume",_masterVolume=Math.clamp(volume,0,1))}}}))}(),State=function(){var _history=[],_active=momentCreate(),_activeIndex=-1,_expired=[],_prng=null,_tempVariables={};function stateMarshal(noDelta){var stateObj={index:_activeIndex};return noDelta?stateObj.history=clone(_history):stateObj.delta=historyDeltaEncode(_history),_expired.length>0&&(stateObj.expired=_toConsumableArray(_expired)),null!==_prng&&(stateObj.seed=_prng.seed),stateObj}function stateUnmarshal(stateObj,noDelta){if(null==stateObj)throw new Error("state object is null or undefined");if(!stateObj.hasOwnProperty(noDelta?"history":"delta")||0===stateObj[noDelta?"history":"delta"].length)throw new Error("state object has no history or history is empty");if(!stateObj.hasOwnProperty("index"))throw new Error("state object has no index");if(null!==_prng&&!stateObj.hasOwnProperty("seed"))throw new Error("state object has no seed, but PRNG is enabled");if(null===_prng&&stateObj.hasOwnProperty("seed"))throw new Error("state object has seed, but PRNG is disabled");_history=noDelta?clone(stateObj.history):historyDeltaDecode(stateObj.delta),_activeIndex=stateObj.index,_expired=stateObj.hasOwnProperty("expired")?_toConsumableArray(stateObj.expired):[],stateObj.hasOwnProperty("seed")&&(_prng.seed=stateObj.seed),momentActivate(_activeIndex)}function momentCreate(title,variables){return{title:null==title?"":String(title),variables:null==variables?{}:clone(variables)}}function momentActivate(moment){if(null==moment)throw new Error("moment activation attempted with null or undefined");switch(_typeof(moment)){case"object":_active=clone(moment);break;case"number":if(historyIsEmpty())throw new Error("moment activation attempted with index on empty history");if(moment<0||moment>=historySize())throw new RangeError("moment activation attempted with out-of-bounds index; need [0, ".concat(historySize()-1,"], got ").concat(moment));_active=clone(_history[moment]);break;default:throw new TypeError('moment activation attempted with a "'.concat(_typeof(moment),'"; must be an object or valid history stack index'))}return null!==_prng&&(_prng=PRNGWrapper.unmarshal({seed:_prng.seed,pull:_active.pull})),session.set("state",stateMarshal()),jQuery.event.trigger(":historyupdate"),_active}function historyLength(){return _activeIndex+1}function historySize(){return _history.length}function historyIsEmpty(){return 0===_history.length}function historyTop(){return _history.length>0?_history[_history.length-1]:null}function historyGoTo(index){return!(null==index||index<0||index>=historySize()||index===_activeIndex)&&(momentActivate(_activeIndex=index),!0)}function historyDeltaEncode(historyArr){if(!Array.isArray(historyArr))return null;if(0===historyArr.length)return[];for(var delta=[historyArr[0]],i=1,iend=historyArr.length;i<iend;++i)delta.push(Diff.diff(historyArr[i-1],historyArr[i]));return delta}function historyDeltaDecode(delta){if(!Array.isArray(delta))return null;if(0===delta.length)return[];for(var historyArr=[clone(delta[0])],i=1,iend=delta.length;i<iend;++i)historyArr.push(Diff.patch(historyArr[i-1],delta[i]));return historyArr}function prngInit(seed,useEntropy){var scriptSection;if(!historyIsEmpty())throw scriptSection="the Story JavaScript",new Error("State.prng.init must be called during initialization, within either ".concat(scriptSection," or the StoryInit special passage"));_prng=new PRNGWrapper(seed,useEntropy),_active.pull=_prng.pull}function metadataDelete(key){if("string"!=typeof key)throw new TypeError("State.metadata.delete key parameter must be a string (received: ".concat(_typeof(key),")"));var store=storage.get("metadata");store&&store.hasOwnProperty(key)&&(1===Object.keys(store).length?storage.delete("metadata"):(delete store[key],storage.set("metadata",store)))}return Object.freeze(Object.defineProperties({},{reset:{value:function(){session.delete("state"),_history=[],_active=momentCreate(),_activeIndex=-1,_expired=[],_prng=null===_prng?null:new PRNGWrapper(_prng.seed,!1)}},restore:{value:function(){if(session.has("state")){var stateObj=session.get("state");return null!=stateObj&&(stateUnmarshal(stateObj),!0)}return!1}},marshalForSave:{value:function(){return stateMarshal(!0)}},unmarshalForSave:{value:function(stateObj){return stateUnmarshal(stateObj,!0)}},expired:{get:function(){return _expired}},turns:{get:function(){return _expired.length+historyLength()}},passages:{get:function(){return _expired.concat(_history.slice(0,historyLength()).map((function(moment){return moment.title})))}},hasPlayed:{value:function(title){return null!=title&&""!==title&&(!!_expired.includes(title)||!!_history.slice(0,historyLength()).some((function(moment){return moment.title===title})))}},active:{get:function(){return _active}},activeIndex:{get:function(){return _activeIndex}},passage:{get:function(){return _active.title}},variables:{get:function(){return _active.variables}},history:{get:function(){return _history}},length:{get:historyLength},size:{get:historySize},isEmpty:{value:historyIsEmpty},current:{get:function(){return _history.length>0?_history[_activeIndex]:null}},top:{get:historyTop},bottom:{get:function(){return _history.length>0?_history[0]:null}},index:{value:function(index){return historyIsEmpty()||index<0||index>_activeIndex?null:_history[index]}},peek:{value:function(offset){if(historyIsEmpty())return null;var lengthOffset=1+(offset?Math.abs(offset):0);return lengthOffset>historyLength()?null:_history[historyLength()-lengthOffset]}},has:{value:function(title){if(historyIsEmpty()||null==title||""===title)return!1;for(var i=_activeIndex;i>=0;--i)if(_history[i].title===title)return!0;return!1}},create:{value:function(title){for(0,historyLength()<historySize()&&_history.splice(historyLength(),historySize()-historyLength()),_history.push(momentCreate(title,_active.variables)),_prng&&(historyTop().pull=_prng.pull);historySize()>Config.history.maxStates;)_expired.push(_history.shift().title);return momentActivate(_activeIndex=historySize()-1),historyLength()}},goTo:{value:historyGoTo},go:{value:function(offset){return null!=offset&&0!==offset&&historyGoTo(_activeIndex+offset)}},deltaEncode:{value:historyDeltaEncode},deltaDecode:{value:historyDeltaDecode},prng:{value:Object.freeze(Object.defineProperties({},{init:{value:prngInit},isEnabled:{value:function(){return null!==_prng}},pull:{get:function(){return _prng?_prng.pull:NaN}},seed:{get:function(){return _prng?_prng.seed:null}}}))},random:{value:function(){return _prng?_prng.random():Math.random()}},clearTemporary:{value:function(){TempVariables=_tempVariables={}}},temporary:{get:function(){return _tempVariables}},getVar:{value:function(varExpression){try{return Scripting.evalTwineScript(varExpression)}catch(ex){}}},setVar:{value:function(varExpression,value){try{return Scripting.evalTwineScript("".concat(varExpression," = evalTwineScript$Data$"),null,value),!0}catch(ex){}return!1}},metadata:{value:Object.freeze(Object.defineProperties({},{clear:{value:function(){storage.delete("metadata")}},delete:{value:metadataDelete},entries:{value:function(){var store=storage.get("metadata");return store&&Object.entries(store)}},get:{value:function(key){if("string"!=typeof key)throw new TypeError("State.metadata.get key parameter must be a string (received: ".concat(_typeof(key),")"));var store=storage.get("metadata");return store&&store.hasOwnProperty(key)?store[key]:undefined}},has:{value:function(key){if("string"!=typeof key)throw new TypeError("State.metadata.has key parameter must be a string (received: ".concat(_typeof(key),")"));var store=storage.get("metadata");return store&&store.hasOwnProperty(key)}},keys:{value:function(){var store=storage.get("metadata");return store&&Object.keys(store)}},set:{value:function(key,value){if("string"!=typeof key)throw new TypeError("State.metadata.set key parameter must be a string (received: ".concat(_typeof(key),")"));if(void 0===value)metadataDelete(key);else{var store=storage.get("metadata")||{};store[key]=value,storage.set("metadata",store)}}},size:{get:function(){var store=storage.get("metadata");return store?Object.keys(store).length:0}}}))},initPRNG:{value:prngInit},restart:{value:function(){return Engine.restart()}},backward:{value:function(){return Engine.backward()}},forward:{value:function(){return Engine.forward()}},display:{value:function(){return Engine.display.apply(Engine,arguments)}},show:{value:function(){return Engine.show.apply(Engine,arguments)}},play:{value:function(){return Engine.play.apply(Engine,arguments)}}}))}(),Scripting=function(){function addAccessibleClickHandler(targets,selector,handler,one,namespace){if(arguments.length<2)throw new Error("addAccessibleClickHandler insufficient number of parameters");var fn,opts;if("function"==typeof selector?(fn=selector,opts={namespace:one,one:!!handler}):(fn=handler,opts={namespace:namespace,one:!!one,selector:selector}),"function"!=typeof fn)throw new TypeError("addAccessibleClickHandler handler parameter must be a function");return jQuery(targets).ariaClick(opts,fn)}function insertElement(place,type,id,classNames,text,title){var $el=jQuery(document.createElement(type));return id&&$el.attr("id",id),classNames&&$el.addClass(classNames),title&&$el.attr("title",title),text&&$el.text(text),place&&$el.appendTo(place),$el[0]}function insertText(place,text){jQuery(place).append(document.createTextNode(text))}function removeChildren(node){jQuery(node).empty()}function removeElement(node){jQuery(node).remove()}function fade(el,options){var current,intervalId,direction="in"===options.fade?1:-1,proxy=el.cloneNode(!0);function setOpacity(el,opacity){el.style.zoom=1,el.style.filter="alpha(opacity=".concat(Math.floor(100*opacity),")"),el.style.opacity=opacity}el.parentNode.replaceChild(proxy,el),"in"===options.fade?(current=0,proxy.style.visibility="visible"):current=1,setOpacity(proxy,current),intervalId=window.setInterval((function(){current+=.05*direction,setOpacity(proxy,Math.easeInOut(current)),(1===direction&&current>=1||-1===direction&&current<=0)&&(el.style.visibility="in"===options.fade?"visible":"hidden",proxy.parentNode.replaceChild(el,proxy),proxy=null,window.clearInterval(intervalId),options.onComplete&&options.onComplete())}),25)}function scrollWindowTo(el,incrementBy){var increment=null!=incrementBy?Number(incrementBy):.1;Number.isNaN(increment)||!Number.isFinite(increment)||increment<0?increment=.1:increment>1&&(increment=1);var intervalId,start=window.scrollY?window.scrollY:document.body.scrollTop,end=function(el){var posTop=function(el){var curtop=0;for(;el.offsetParent;)curtop+=el.offsetTop,el=el.offsetParent;return curtop}(el),posBottom=posTop+el.offsetHeight,winTop=window.scrollY?window.scrollY:document.body.scrollTop,winHeight=window.innerHeight?window.innerHeight:document.body.clientHeight,winBottom=winTop+winHeight;return posTop>=winTop&&posBottom>winBottom&&el.offsetHeight<winHeight?posTop-(winHeight-el.offsetHeight)+20:posTop}(el),distance=Math.abs(start-end),direction=start>end?-1:1,progress=0;intervalId=window.setInterval((function(){progress+=increment,window.scroll(0,start+direction*(distance*Math.easeInOut(progress))),progress>=1&&window.clearInterval(intervalId)}),25)}function toStringOrDefault(value){return stringFrom(value)}function either(){if(0!==arguments.length)return Array.prototype.concat.apply([],arguments).random()}function forget(key){if("string"!=typeof key)throw new TypeError("forget key parameter must be a string (received: ".concat(Util.getType(key),")"));State.metadata.delete(key)}function hasVisited(){if(0===arguments.length)throw new Error("hasVisited called with insufficient parameters");if(State.isEmpty())return!1;for(var needles=Array.prototype.concat.apply([],arguments),played=State.passages,i=0,iend=needles.length;i<iend;++i)if(!played.includes(needles[i]))return!1;return!0}function lastVisited(){if(0===arguments.length)throw new Error("lastVisited called with insufficient parameters");if(State.isEmpty())return-1;for(var needles=Array.prototype.concat.apply([],arguments),played=State.passages,uBound=played.length-1,turns=State.turns,i=0,iend=needles.length;i<iend&&turns>-1;++i){var lastIndex=played.lastIndexOf(needles[i]);turns=Math.min(turns,-1===lastIndex?-1:uBound-lastIndex)}return turns}function memorize(key,value){if("string"!=typeof key)throw new TypeError("memorize key parameter must be a string (received: ".concat(Util.getType(key),")"));State.metadata.set(key,value)}function passage(){return State.passage}function previous(){var passages=State.passages;if(arguments.length>0){var offset=Number(arguments[0]);if(!Number.isSafeInteger(offset)||offset<1)throw new RangeError("previous offset parameter must be a positive integer greater than zero");return passages.length>offset?passages[passages.length-1-offset]:""}for(var i=passages.length-2;i>=0;--i)if(passages[i]!==State.passage)return passages[i];return""}function random(){var min,max;switch(arguments.length){case 0:throw new Error("random called with insufficient parameters");case 1:min=0,max=Math.trunc(arguments[0]);break;default:min=Math.trunc(arguments[0]),max=Math.trunc(arguments[1])}if(!Number.isInteger(min))throw new Error("random min parameter must be an integer");if(!Number.isInteger(max))throw new Error("random max parameter must be an integer");if(min>max){var _ref6=[max,min];min=_ref6[0],max=_ref6[1]}return Math.floor(State.random()*(max-min+1))+min}function randomFloat(){var min,max;switch(arguments.length){case 0:throw new Error("randomFloat called with insufficient parameters");case 1:min=0,max=Number(arguments[0]);break;default:min=Number(arguments[0]),max=Number(arguments[1])}if(Number.isNaN(min)||!Number.isFinite(min))throw new Error("randomFloat min parameter must be a number");if(Number.isNaN(max)||!Number.isFinite(max))throw new Error("randomFloat max parameter must be a number");if(min>max){var _ref7=[max,min];min=_ref7[0],max=_ref7[1]}return State.random()*(max-min)+min}function recall(key,defaultValue){if("string"!=typeof key)throw new TypeError("recall key parameter must be a string (received: ".concat(Util.getType(key),")"));return State.metadata.has(key)?State.metadata.get(key):defaultValue}function tags(){if(0===arguments.length)return Story.get(State.passage).tags.slice(0);for(var passages=Array.prototype.concat.apply([],arguments),tags=[],i=0,iend=passages.length;i<iend;++i)tags=tags.concat(Story.get(passages[i]).tags);return tags}function temporary(){return State.temporary}function time(){return null===Engine.lastPlay?0:Util.now()-Engine.lastPlay}function turns(){return State.turns}function variables(){return State.variables}function visited(){if(State.isEmpty())return 0;for(var needles=Array.prototype.concat.apply([],0===arguments.length?[State.passage]:arguments),played=State.passages,count=State.turns,i=0,iend=needles.length;i<iend&&count>0;++i)count=Math.min(count,played.count(needles[i]));return count}function visitedTags(){if(0===arguments.length)throw new Error("visitedTags called with insufficient parameters");if(State.isEmpty())return 0;for(var needles=Array.prototype.concat.apply([],arguments),nLength=needles.length,played=State.passages,seen=new Map,count=0,i=0,iend=played.length;i<iend;++i){var title=played[i];if(seen.has(title))seen.get(title)&&++count;else{var _tags2=Story.get(title).tags;if(_tags2.length>0){for(var found=0,j=0;j<nLength;++j)_tags2.includes(needles[j])&&++found;found===nLength?(++count,seen.set(title,!0)):seen.set(title,!1)}}}return count}var _ref8=function(){function slugifyUrl(url){return Util.parseUrl(url).path.replace(/^[^\w]+|[^\w]+$/g,"").replace(/[^\w]+/g,"-").toLocaleLowerCase()}function addScript(url){return new Promise((function(resolve,reject){jQuery(document.createElement("script")).one("load abort error",(function(ev){jQuery(ev.target).off(),"load"===ev.type?resolve(ev.target):reject(new Error('importScripts failed to load the script "'.concat(url,'".')))})).appendTo(document.head).attr({id:"script-imported-".concat(slugifyUrl(url)),type:"text/javascript",src:url})}))}function addStyle(url){return new Promise((function(resolve,reject){jQuery(document.createElement("link")).one("load abort error",(function(ev){jQuery(ev.target).off(),"load"===ev.type?resolve(ev.target):reject(new Error('importStyles failed to load the stylesheet "'.concat(url,'".')))})).appendTo(document.head).attr({id:"style-imported-".concat(slugifyUrl(url)),rel:"stylesheet",href:url})}))}function sequence(callbacks){return callbacks.reduce((function(seq,fn){return seq.then(fn)}),Promise.resolve())}return{importScripts:function(){for(var _len12=arguments.length,urls=new Array(_len12),_key12=0;_key12<_len12;_key12++)urls[_key12]=arguments[_key12];return Promise.all(urls.map((function(oneOrSeries){return Array.isArray(oneOrSeries)?sequence(oneOrSeries.map((function(url){return function(){return addScript(url)}}))):addScript(oneOrSeries)})))},importStyles:function(){for(var _len13=arguments.length,urls=new Array(_len13),_key13=0;_key13<_len13;_key13++)urls[_key13]=arguments[_key13];return Promise.all(urls.map((function(oneOrSeries){return Array.isArray(oneOrSeries)?sequence(oneOrSeries.map((function(url){return function(){return addStyle(url)}}))):addStyle(oneOrSeries)})))}}}(),importScripts=_ref8.importScripts,importStyles=_ref8.importStyles,parse=function(){var tokenTable=Util.toEnum({$:"State.variables.",_:"State.temporary.",to:"=",eq:"==",neq:"!=",is:"===",isnot:"!==",gt:">",gte:">=",lt:"<",lte:"<=",and:"&&",or:"||",not:"!",def:'"undefined" !== typeof',ndef:'"undefined" === typeof'}),parseRe=new RegExp(["(?:\"\"|''|``)",'(?:"(?:\\\\.|[^"\\\\])+")',"(?:'(?:\\\\.|[^'\\\\])+')","(`(?:\\\\.|[^`\\\\])+`)","(?:[=+\\-*\\/%<>&\\|\\^~!?:,;\\(\\)\\[\\]{}]+)","([^\"'=+\\-*\\/%<>&\\|\\^~!?:,;\\(\\)\\[\\]{}\\s]+)"].join("|"),"g"),notSpaceRe=/\S/,varTest=new RegExp("^".concat(Patterns.variable)),withColonTestRe=/^\s*:/,withNotTestRe=/^\s+not\b/;function parse(rawCodeString){if(0!==parseRe.lastIndex)throw new RangeError("Scripting.parse last index is non-zero at start");for(var match,code=rawCodeString;null!==(match=parseRe.exec(code));)if(match[1]){var rawTemplate=match[1],parsedTemplate=parseTemplate(rawTemplate);parsedTemplate!==rawTemplate&&(code=code.splice(match.index,rawTemplate.length,parsedTemplate),parseRe.lastIndex+=parsedTemplate.length-rawTemplate.length)}else if(match[2]){var token=match[2];if("$"===token||"_"===token)continue;if(varTest.test(token))token=token[0];else if("is"===token){var start=parseRe.lastIndex,ahead=code.slice(start);withNotTestRe.test(ahead)&&(code=code.splice(start,ahead.search(notSpaceRe)),token="isnot")}else{var _ahead=code.slice(parseRe.lastIndex);if(withColonTestRe.test(_ahead))continue}tokenTable[token]&&(code=code.splice(match.index,token.length,tokenTable[token]),parseRe.lastIndex+=tokenTable[token].length-token.length)}return code}var templateGroupStartRe=/\$\{/g,templateGroupParseRe=new RegExp(["(?:\"\"|'')",'(?:"(?:\\\\.|[^"\\\\])+")',"(?:'(?:\\\\.|[^'\\\\])+')","(\\{)","(\\})"].join("|"),"g");function parseTemplate(rawTemplateLiteral){if(0!==templateGroupStartRe.lastIndex)throw new RangeError("Scripting.parse last index is non-zero at start of template literal");for(var startMatch,template=rawTemplateLiteral;null!==(startMatch=templateGroupStartRe.exec(template));){var startIdx=startMatch.index+2,endIdx=startIdx,depth=1,endMatch=void 0;for(templateGroupParseRe.lastIndex=startIdx;null!==(endMatch=templateGroupParseRe.exec(template));)if(endMatch[1]?++depth:endMatch[2]&&--depth,0===depth){endIdx=endMatch.index;break}if(endIdx>startIdx){var parseIndex=parseRe.lastIndex,rawGroup=template.slice(startIdx,endIdx);parseRe.lastIndex=0;var parsedGroup=parse(rawGroup);parseRe.lastIndex=parseIndex,template=template.splice(startIdx,rawGroup.length,parsedGroup),templateGroupStartRe.lastIndex+=parsedGroup.length-rawGroup.length}}return template}return parse}();function evalJavaScript(code,output,data){return function(code,output,evalJavaScript$Data$){return eval(code)}.call(output?{output:output}:null,String(code),output,data)}function evalTwineScript(code,output,data){return function(code,output,evalTwineScript$Data$){return eval(code)}.call(output?{output:output}:null,parse(String(code)),output,data)}return Object.freeze(Object.defineProperties({},{parse:{value:parse},evalJavaScript:{value:evalJavaScript},evalTwineScript:{value:evalTwineScript}}))}(),_ref9=function(){var Lexer=function(){function Lexer(source,initialState){if(_classCallCheck(this,Lexer),arguments.length<2)throw new Error("Lexer constructor called with too few parameters (source:string , initialState:function)");Object.defineProperties(this,{source:{value:source},initial:{value:initialState},state:{writable:!0,value:initialState},start:{writable:!0,value:0},pos:{writable:!0,value:0},depth:{writable:!0,value:0},items:{writable:!0,value:[]},data:{writable:!0,value:{}}})}return _createClass(Lexer,[{key:"reset",value:function(){this.state=this.initial,this.start=0,this.pos=0,this.depth=0,this.items=[],this.data={}}},{key:"run",value:function(){for(;null!==this.state;)this.state=this.state(this);return this.items}},{key:"nextItem",value:function(){for(;0===this.items.length&&null!==this.state;)this.state=this.state(this);return this.items.shift()}},{key:"next",value:function(){return this.pos>=this.source.length?-1:this.source[this.pos++]}},{key:"peek",value:function(){return this.pos>=this.source.length?-1:this.source[this.pos]}},{key:"backup",value:function(num){this.pos-=num||1}},{key:"forward",value:function(num){this.pos+=num||1}},{key:"ignore",value:function(){this.start=this.pos}},{key:"accept",value:function(valid){var ch=this.next();return-1!==ch&&(!!valid.includes(ch)||(this.backup(),!1))}},{key:"acceptRe",value:function(validRe){var ch=this.next();return-1!==ch&&(!!validRe.test(ch)||(this.backup(),!1))}},{key:"acceptRun",value:function(valid){for(;;){var ch=this.next();if(-1===ch)return;if(!valid.includes(ch))break}this.backup()}},{key:"acceptRunRe",value:function(validRe){for(;;){var ch=this.next();if(-1===ch)return;if(!validRe.test(ch))break}this.backup()}},{key:"emit",value:function(type){this.items.push({type:type,text:this.source.slice(this.start,this.pos),start:this.start,pos:this.pos}),this.start=this.pos}},{key:"error",value:function(type,message){if(arguments.length<2)throw new Error("Lexer.prototype.error called with too few parameters (type:number , message:string)");return this.items.push({type:type,message:message,text:this.source.slice(this.start,this.pos),start:this.start,pos:this.pos}),null}}],[{key:"enumFromNames",value:function(names){var obj=names.reduce((function(obj,name,i){return obj[name]=i,obj}),{});return Object.freeze(Object.assign(Object.create(null),obj))}}]),Lexer}();return{EOF:-1,Lexer:Lexer}}(),EOF=_ref9.EOF,Lexer=_ref9.Lexer,Wikifier=function(){var _optionsStack,lookaheadRe,idOrClassRe,_callDepth=0,Wikifier=function(){function Wikifier(destination,source,options){_classCallCheck(this,Wikifier),Wikifier.Parser.Profile.isEmpty()&&Wikifier.Parser.Profile.compile(),Object.defineProperties(this,{source:{value:String(source)},options:{writable:!0,value:Object.assign({profile:"all"},options)},nextMatch:{writable:!0,value:0},output:{writable:!0,value:null},_rawArgs:{writable:!0,value:""}}),null==destination?this.output=document.createDocumentFragment():destination.jquery?this.output=destination[0]:this.output=destination;try{++_callDepth,this.subWikify(this.output),1===_callDepth&&Config.cleanupWikifierOutput&&convertBreaks(this.output)}finally{--_callDepth}}return _createClass(Wikifier,[{key:"subWikify",value:function(output,terminator,options){var newOptions,oldOptions,oldOutput=this.output;this.output=output,Wikifier.Option.length>0&&(newOptions=Object.assign(newOptions||{},Wikifier.Option.options)),null!==options&&"object"===_typeof(options)&&(newOptions=Object.assign(newOptions||{},options)),newOptions&&(oldOptions=this.options,this.options=Object.assign({},this.options,newOptions));var terminatorMatch,parserMatch,parsersProfile=Wikifier.Parser.Profile.get(this.options.profile),terminatorRegExp=terminator?new RegExp("(?:".concat(terminator,")"),this.options.ignoreTerminatorCase?"gim":"gm"):null;do{if(parsersProfile.parserRegExp.lastIndex=this.nextMatch,terminatorRegExp&&(terminatorRegExp.lastIndex=this.nextMatch),parserMatch=parsersProfile.parserRegExp.exec(this.source),(terminatorMatch=terminatorRegExp?terminatorRegExp.exec(this.source):null)&&(!parserMatch||terminatorMatch.index<=parserMatch.index))return terminatorMatch.index>this.nextMatch&&this.outputText(this.output,this.nextMatch,terminatorMatch.index),this.matchStart=terminatorMatch.index,this.matchLength=terminatorMatch[0].length,this.matchText=terminatorMatch[0],this.nextMatch=terminatorRegExp.lastIndex,this.output=oldOutput,void(oldOptions&&(this.options=oldOptions));if(parserMatch){parserMatch.index>this.nextMatch&&this.outputText(this.output,this.nextMatch,parserMatch.index),this.matchStart=parserMatch.index,this.matchLength=parserMatch[0].length,this.matchText=parserMatch[0],this.nextMatch=parsersProfile.parserRegExp.lastIndex;for(var matchingParser=void 0,i=1,iend=parserMatch.length;i<iend;++i)if(parserMatch[i]){matchingParser=i-1;break}if(parsersProfile.parsers[matchingParser].handler(this),null!=TempState.break)break}}while(terminatorMatch||parserMatch);null==TempState.break?this.nextMatch<this.source.length&&(this.outputText(this.output,this.nextMatch,this.source.length),this.nextMatch=this.source.length):this.output.lastChild&&this.output.lastChild.nodeType===Node.ELEMENT_NODE&&"BR"===this.output.lastChild.nodeName.toUpperCase()&&jQuery(this.output.lastChild).remove(),this.output=oldOutput,oldOptions&&(this.options=oldOptions)}},{key:"outputText",value:function(destination,startPos,endPos){jQuery(destination).append(document.createTextNode(this.source.substring(startPos,endPos)))}},{key:"rawArgs",value:function(){return this._rawArgs}},{key:"fullArgs",value:function(){return Scripting.parse(this._rawArgs)}}],[{key:"wikifyEval",value:function(text){var output=document.createDocumentFragment();new Wikifier(output,text);var errors=output.querySelector(".error");if(null!==errors)throw new Error(errors.textContent.replace(errorPrologRegExp,""));return output}},{key:"createInternalLink",value:function(destination,passage,text,callback){var $link=jQuery(document.createElement("a"));return null!=passage&&($link.attr("data-passage",passage),Story.has(passage)?($link.addClass("link-internal"),Config.addVisitedLinkClass&&State.hasPlayed(passage)&&$link.addClass("link-visited")):$link.addClass("link-broken"),$link.ariaClick({one:!0},(function(){"function"==typeof callback&&callback(),Engine.play(passage)}))),text&&$link.append(document.createTextNode(text)),destination&&$link.appendTo(destination),$link[0]}},{key:"createExternalLink",value:function(destination,url,text){var $link=jQuery(document.createElement("a")).attr("target","_blank").addClass("link-external").text(text).appendTo(destination);return null!=url&&$link.attr({href:url,tabindex:0}),$link[0]}},{key:"isExternalLink",value:function(link){return!Story.has(link)&&(new RegExp("^".concat(Patterns.url),"gim").test(link)||/[/.?#]/.test(link))}}]),Wikifier}();return Object.defineProperty(Wikifier,"Option",{value:(_optionsStack=[],Object.freeze(Object.defineProperties({},{length:{get:function(){return _optionsStack.length}},options:{get:function(){return Object.assign.apply(Object,[{}].concat(_toConsumableArray(_optionsStack)))}},clear:{value:function(){_optionsStack=[]}},get:{value:function(idx){return _optionsStack[idx]}},pop:{value:function(){return _optionsStack.pop()}},push:{value:function(options){if("object"!==_typeof(options)||null===options)throw new TypeError("Wikifier.Option.push options parameter must be an object (received: ".concat(Util.getType(options),")"));return _optionsStack.push(options)}}})))}),Object.defineProperty(Wikifier,"Parser",{value:function(){var _profiles,_parsers=[];function parsersHas(name){return!!_parsers.find((function(parser){return parser.name===name}))}return Object.freeze(Object.defineProperties({},{parsers:{get:function(){return _parsers}},add:{value:function(parser){if("object"!==_typeof(parser))throw new Error("Wikifier.Parser.add parser parameter must be an object");if(!parser.hasOwnProperty("name"))throw new Error('parser object missing required "name" property');if("string"!=typeof parser.name)throw new Error('parser object "name" property must be a string');if(!parser.hasOwnProperty("match"))throw new Error('parser object missing required "match" property');if("string"!=typeof parser.match)throw new Error('parser object "match" property must be a string');if(!parser.hasOwnProperty("handler"))throw new Error('parser object missing required "handler" property');if("function"!=typeof parser.handler)throw new Error('parser object "handler" property must be a function');if(parser.hasOwnProperty("profiles")&&!Array.isArray(parser.profiles))throw new Error('parser object "profiles" property must be an array');if(parsersHas(parser.name))throw new Error('cannot clobber existing parser "'.concat(parser.name,'"'));_parsers.push(parser)}},delete:{value:function(name){var parser=_parsers.find((function(parser){return parser.name===name}));parser&&_parsers.delete(parser)}},isEmpty:{value:function(){return 0===_parsers.length}},has:{value:parsersHas},get:{value:function(name){return _parsers.find((function(parser){return parser.name===name}))||null}},Profile:{value:Object.freeze(Object.defineProperties({},{profiles:{get:function(){return _profiles}},compile:{value:function(){var all=_parsers,core=all.filter((function(parser){return!Array.isArray(parser.profiles)||parser.profiles.includes("core")}));return _profiles=Object.freeze({all:{parsers:all,parserRegExp:new RegExp(all.map((function(parser){return"(".concat(parser.match,")")})).join("|"),"gm")},core:{parsers:core,parserRegExp:new RegExp(core.map((function(parser){return"(".concat(parser.match,")")})).join("|"),"gm")}})}},isEmpty:{value:function(){return"object"!==_typeof(_profiles)||0===Object.keys(_profiles).length}},has:{value:function(profile){return"object"===_typeof(_profiles)&&_profiles.hasOwnProperty(profile)}},get:{value:function(profile){if("object"!==_typeof(_profiles)||!_profiles.hasOwnProperty(profile))throw new Error('nonexistent parser profile "'.concat(profile,'"'));return _profiles[profile]}}}))}}))}()}),Object.defineProperties(Wikifier,{helpers:{value:{}},getValue:{value:State.getVar},setValue:{value:State.setVar},parse:{value:Scripting.parse},evalExpression:{value:Scripting.evalTwineScript},evalStatements:{value:Scripting.evalTwineScript},textPrimitives:{value:Patterns}}),Object.defineProperties(Wikifier.helpers,{inlineCss:{value:(lookaheadRe=new RegExp(Patterns.inlineCss,"gm"),idOrClassRe=new RegExp("(".concat(Patterns.cssIdOrClassSigil,")(").concat(Patterns.anyLetter,"+)"),"g"),function(w){var matched,css={classes:[],id:"",styles:{}};do{lookaheadRe.lastIndex=w.nextMatch;var match=lookaheadRe.exec(w.source);if(matched=match&&match.index===w.nextMatch){if(match[1])css.styles[Util.fromCssProperty(match[1])]=match[2].trim();else if(match[3])css.styles[Util.fromCssProperty(match[3])]=match[4].trim();else if(match[5]){var subMatch=void 0;for(idOrClassRe.lastIndex=0;null!==(subMatch=idOrClassRe.exec(match[5]));)"."===subMatch[1]?css.classes.push(subMatch[2]):css.id=subMatch[2]}w.nextMatch=lookaheadRe.lastIndex}}while(matched);return css})},evalText:{value:function(text){var result;try{switch(_typeof(result=Scripting.evalTwineScript(text))){case"string":""===result.trim()&&(result=text);break;case"number":result=String(result);break;default:result=text}}catch(ex){result=text}return result}},evalPassageId:{value:function(passage){return null==passage||Story.has(passage)?passage:Wikifier.helpers.evalText(passage)}},hasBlockContext:{value:function(nodes){for(var hasGCS="function"==typeof window.getComputedStyle,i=nodes.length-1;i>=0;--i){var node=nodes[i];switch(node.nodeType){case Node.ELEMENT_NODE:var tagName=node.nodeName.toUpperCase();if("BR"===tagName)return!0;var styles=hasGCS?window.getComputedStyle(node,null):node.currentStyle;if(styles&&styles.display){if("none"===styles.display)continue;return"block"===styles.display}switch(tagName){case"ADDRESS":case"ARTICLE":case"ASIDE":case"BLOCKQUOTE":case"CENTER":case"DIV":case"DL":case"FIGURE":case"FOOTER":case"FORM":case"H1":case"H2":case"H3":case"H4":case"H5":case"H6":case"HEADER":case"HR":case"MAIN":case"NAV":case"OL":case"P":case"PRE":case"SECTION":case"TABLE":case"UL":return!0}return!1;case Node.COMMENT_NODE:continue;default:return!1}}return!0}},createShadowSetterCallback:{value:function(){var macroParser=null;function getMacroContextShadowView(){for(var macro=macroParser||function(){if(!macroParser&&!(macroParser=Wikifier.Parser.get("macro")))throw new Error('cannot find "macro" parser');return macroParser}(),view=new Set,context=macro.context;null!==context;context=context.parent)context._shadows&&context._shadows.forEach((function(name){return view.add(name)}));return _toConsumableArray(view)}return function(code){var shadowStore={};return getMacroContextShadowView().forEach((function(varName){var varKey=varName.slice(1),store="$"===varName[0]?State.variables:State.temporary;shadowStore[varName]=store[varKey]})),function(){var shadowNames=Object.keys(shadowStore),valueCache=shadowNames.length>0?{}:null;try{return shadowNames.forEach((function(varName){var varKey=varName.slice(1),store="$"===varName[0]?State.variables:State.temporary;store.hasOwnProperty(varKey)&&(valueCache[varKey]=store[varKey]),store[varKey]=shadowStore[varName]})),Scripting.evalJavaScript(code)}finally{shadowNames.forEach((function(varName){var varKey=varName.slice(1),store="$"===varName[0]?State.variables:State.temporary;shadowStore[varName]=store[varKey],valueCache.hasOwnProperty(varKey)?store[varKey]=valueCache[varKey]:delete store[varKey]}))}}}}()},parseSquareBracketedMarkup:{value:function(){var Item=Lexer.enumFromNames(["Error","DelimLTR","DelimRTL","InnerMeta","ImageMeta","LinkMeta","Link","RightMeta","Setter","Source","Text"]),Delim=Lexer.enumFromNames(["None","LTR","RTL"]);function slurpQuote(lexer,endQuote){loop:for(;;)switch(lexer.next()){case"\\":var ch=lexer.next();if(ch!==EOF&&"\n"!==ch)break;case EOF:case"\n":return EOF;case endQuote:break loop}return lexer.pos}function lexLeftMeta(lexer){if(!lexer.accept("["))return lexer.error(Item.Error,"malformed square-bracketed markup");if(lexer.accept("["))lexer.data.isLink=!0,lexer.emit(Item.LinkMeta);else{if(lexer.accept("<>"),!(lexer.accept("Ii")&&lexer.accept("Mm")&&lexer.accept("Gg")&&lexer.accept("[")))return lexer.error(Item.Error,"malformed square-bracketed markup");lexer.data.isLink=!1,lexer.emit(Item.ImageMeta)}return lexer.depth=2,lexCoreComponents}function lexCoreComponents(lexer){for(var what=lexer.data.isLink?"link":"image",delim=Delim.None;;)switch(lexer.next()){case EOF:case"\n":return lexer.error(Item.Error,"unterminated ".concat(what," markup"));case'"':if(slurpQuote(lexer,'"')===EOF)return lexer.error(Item.Error,"unterminated double quoted string in ".concat(what," markup"));break;case"|":delim===Delim.None&&(delim=Delim.LTR,lexer.backup(),lexer.emit(Item.Text),lexer.forward(),lexer.emit(Item.DelimLTR));break;case"-":delim===Delim.None&&">"===lexer.peek()&&(delim=Delim.LTR,lexer.backup(),lexer.emit(Item.Text),lexer.forward(2),lexer.emit(Item.DelimLTR));break;case"<":delim===Delim.None&&"-"===lexer.peek()&&(delim=Delim.RTL,lexer.backup(),lexer.emit(lexer.data.isLink?Item.Link:Item.Source),lexer.forward(2),lexer.emit(Item.DelimRTL));break;case"[":++lexer.depth;break;case"]":if(--lexer.depth,1===lexer.depth)switch(lexer.peek()){case"[":return++lexer.depth,lexer.backup(),delim===Delim.RTL?lexer.emit(Item.Text):lexer.emit(lexer.data.isLink?Item.Link:Item.Source),lexer.forward(2),lexer.emit(Item.InnerMeta),lexer.data.isLink?lexSetter:lexImageLink;case"]":return--lexer.depth,lexer.backup(),delim===Delim.RTL?lexer.emit(Item.Text):lexer.emit(lexer.data.isLink?Item.Link:Item.Source),lexer.forward(2),lexer.emit(Item.RightMeta),null;default:return lexer.error(Item.Error,"malformed ".concat(what," markup"))}}}function lexImageLink(lexer){for(var what=lexer.data.isLink?"link":"image";;)switch(lexer.next()){case EOF:case"\n":return lexer.error(Item.Error,"unterminated ".concat(what," markup"));case'"':if(slurpQuote(lexer,'"')===EOF)return lexer.error(Item.Error,"unterminated double quoted string in ".concat(what," markup link component"));break;case"[":++lexer.depth;break;case"]":if(--lexer.depth,1===lexer.depth)switch(lexer.peek()){case"[":return++lexer.depth,lexer.backup(),lexer.emit(Item.Link),lexer.forward(2),lexer.emit(Item.InnerMeta),lexSetter;case"]":return--lexer.depth,lexer.backup(),lexer.emit(Item.Link),lexer.forward(2),lexer.emit(Item.RightMeta),null;default:return lexer.error(Item.Error,"malformed ".concat(what," markup"))}}}function lexSetter(lexer){for(var what=lexer.data.isLink?"link":"image";;)switch(lexer.next()){case EOF:case"\n":return lexer.error(Item.Error,"unterminated ".concat(what," markup"));case'"':if(slurpQuote(lexer,'"')===EOF)return lexer.error(Item.Error,"unterminated double quoted string in ".concat(what," markup setter component"));break;case"'":if(slurpQuote(lexer,"'")===EOF)return lexer.error(Item.Error,"unterminated single quoted string in ".concat(what," markup setter component"));break;case"[":++lexer.depth;break;case"]":if(--lexer.depth,1===lexer.depth)return"]"!==lexer.peek()?lexer.error(Item.Error,"malformed ".concat(what," markup")):(--lexer.depth,lexer.backup(),lexer.emit(Item.Setter),lexer.forward(2),lexer.emit(Item.RightMeta),null)}}return function(w){var lexer=new Lexer(w.source,lexLeftMeta);lexer.start=lexer.pos=w.matchStart;var markup={},items=lexer.run(),last=items.last();return last&&last.type===Item.Error?markup.error=last.message:items.forEach((function(item){var text=item.text.trim();switch(item.type){case Item.ImageMeta:markup.isImage=!0,"<"===text[1]?markup.align="left":">"===text[1]&&(markup.align="right");break;case Item.LinkMeta:markup.isLink=!0;break;case Item.Link:"~"===text[0]?(markup.forceInternal=!0,markup.link=text.slice(1)):markup.link=text;break;case Item.Setter:markup.setter=text;break;case Item.Source:markup.source=text;break;case Item.Text:markup.text=text}})),markup.pos=lexer.pos,markup}}()}}),Wikifier}();!function(){function _verbatimTagHandler(w){this.lookahead.lastIndex=w.matchStart;var match=this.lookahead.exec(w.source);match&&match.index===w.matchStart&&(w.nextMatch=this.lookahead.lastIndex,jQuery(document.createDocumentFragment()).append(match[1]).appendTo(w.output))}Wikifier.Parser.add({name:"quoteByBlock",profiles:["block"],match:"^<<<\\n",terminator:"^<<<\\n",handler:function(w){Wikifier.helpers.hasBlockContext(w.output.childNodes)?w.subWikify(jQuery(document.createElement("blockquote")).appendTo(w.output).get(0),this.terminator):jQuery(w.output).append(document.createTextNode(w.matchText))}}),Wikifier.Parser.add({name:"quoteByLine",profiles:["block"],match:"^>+",lookahead:/^>+/gm,terminator:"\\n",handler:function(w){if(Wikifier.helpers.hasBlockContext(w.output.childNodes)){var matched,i,destStack=[w.output],curLevel=0,newLevel=w.matchLength;do{if(newLevel>curLevel)for(i=curLevel;i<newLevel;++i)destStack.push(jQuery(document.createElement("blockquote")).appendTo(destStack[destStack.length-1]).get(0));else if(newLevel<curLevel)for(i=curLevel;i>newLevel;--i)destStack.pop();curLevel=newLevel,w.subWikify(destStack[destStack.length-1],this.terminator),jQuery(document.createElement("br")).appendTo(destStack[destStack.length-1]),this.lookahead.lastIndex=w.nextMatch;var match=this.lookahead.exec(w.source);(matched=match&&match.index===w.nextMatch)&&(newLevel=match[0].length,w.nextMatch+=match[0].length)}while(matched)}else jQuery(w.output).append(document.createTextNode(w.matchText))}}),Wikifier.Parser.add({name:"macro",profiles:["core"],match:"<<",lookahead:new RegExp("<<(/?".concat(Patterns.macroName,")(?:\\s*)((?:(?:/\\*[^*]*\\*+(?:[^/*][^*]*\\*+)*/)|(?://.*\\n)|(?:`(?:\\\\.|[^`\\\\])*`)|(?:\"(?:\\\\.|[^\"\\\\])*\")|(?:'(?:\\\\.|[^'\\\\])*')|(?:\\[(?:[<>]?[Ii][Mm][Gg])?\\[[^\\r\\n]*?\\]\\]+)|[^>]|(?:>(?!>)))*)>>"),"gm"),working:{source:"",name:"",arguments:"",index:0},context:null,handler:function(w){var matchStart=this.lookahead.lastIndex=w.matchStart;if(this.parseTag(w)){var macro,nextMatch=w.nextMatch,name=this.working.name,rawArgs=this.working.arguments;try{if(!(macro=Macro.get(name))){if(Macro.tags.has(name)){var tags=Macro.tags.get(name);return throwError(w.output,"child tag <<".concat(name,">> was found outside of a call to its parent macro").concat(1===tags.length?"":"s"," <<").concat(tags.join(">>, <<"),">>"),w.source.slice(matchStart,w.nextMatch))}return throwError(w.output,"macro <<".concat(name,">> does not exist"),w.source.slice(matchStart,w.nextMatch))}var payload=null;if(void 0!==macro.tags&&!(payload=this.parseBody(w,macro)))return w.nextMatch=nextMatch,throwError(w.output,"cannot find a closing tag for macro <<".concat(name,">>"),"".concat(w.source.slice(matchStart,w.nextMatch),"…"));if("function"!=typeof macro.handler)return throwError(w.output,"macro <<".concat(name,">> handler function ").concat(void 0===macro.handler?"does not exist":"is not a function"),w.source.slice(matchStart,w.nextMatch));var args=payload?payload[0].args:this.createArgs(rawArgs,this.skipArgs(macro,macro.name));if(void 0!==macro._MACRO_API){this.context=new MacroContext({macro:macro,name:name,args:args,payload:payload,source:w.source.slice(matchStart,w.nextMatch),parent:this.context,parser:w});try{macro.handler.call(this.context)}finally{this.context=this.context.parent}}else{var prevRawArgs=w._rawArgs;w._rawArgs=rawArgs;try{macro.handler(w.output,name,args,w,payload)}finally{w._rawArgs=prevRawArgs}}}catch(ex){return throwError(w.output,"cannot execute ".concat(macro&&macro.isWidget?"widget":"macro"," <<").concat(name,">>: ").concat(ex.message),w.source.slice(matchStart,w.nextMatch))}finally{this.working.source="",this.working.name="",this.working.arguments="",this.working.index=0}}else w.outputText(w.output,w.matchStart,w.nextMatch)},parseTag:function(w){var match=this.lookahead.exec(w.source);return!(!match||match.index!==w.matchStart||!match[1])&&(w.nextMatch=this.lookahead.lastIndex,this.working.source=w.source.slice(match.index,this.lookahead.lastIndex),this.working.name=match[1],this.working.arguments=match[2],this.working.index=match.index,!0)},parseBody:function(w,macro){for(var openTag=this.working.name,closeTag="/".concat(openTag),closeAlt="end".concat(openTag),bodyTags=!!Array.isArray(macro.tags)&&macro.tags,payload=[],end=-1,opened=1,curSource=this.working.source,curTag=this.working.name,curArgument=this.working.arguments,contentStart=w.nextMatch;-1!==(w.matchStart=w.source.indexOf(this.match,w.nextMatch));)if(this.parseTag(w)){var tagSource=this.working.source,tagName=this.working.name,tagArgs=this.working.arguments,tagBegin=this.working.index,tagEnd=w.nextMatch,hasArgs=""!==tagArgs.trim();switch(tagName){case openTag:++opened;break;case closeAlt:case closeTag:if(hasArgs)throw w.nextMatch=tagBegin+2+tagName.length,new Error('malformed closing tag: "'.concat(tagSource,'"'));--opened;break;default:if(hasArgs&&(tagName.startsWith("/")||tagName.startsWith("end"))){this.lookahead.lastIndex=w.nextMatch=tagBegin+2+tagName.length;continue}if(1===opened&&bodyTags)for(var i=0,iend=bodyTags.length;i<iend;++i)tagName===bodyTags[i]&&(payload.push({source:curSource,name:curTag,arguments:curArgument,args:this.createArgs(curArgument,this.skipArgs(macro,curTag)),contents:w.source.slice(contentStart,tagBegin)}),curSource=tagSource,curTag=tagName,curArgument=tagArgs,contentStart=tagEnd)}if(0===opened){payload.push({source:curSource,name:curTag,arguments:curArgument,args:this.createArgs(curArgument,this.skipArgs(macro,curTag)),contents:w.source.slice(contentStart,tagBegin)}),end=tagEnd;break}}else this.lookahead.lastIndex=w.nextMatch=w.matchStart+this.match.length;return-1!==end?(w.nextMatch=end,payload):null},createArgs:function(rawArgsString,skipArgs){var args=skipArgs?[]:this.parseArgs(rawArgsString);return Object.defineProperties(args,{raw:{value:rawArgsString},full:{value:Scripting.parse(rawArgsString)}}),args},skipArgs:function(macro,tagName){if(void 0!==macro.skipArgs){var sa=macro.skipArgs;return"boolean"==typeof sa&&sa||Array.isArray(sa)&&sa.includes(tagName)}return void 0!==macro.skipArg0&&(macro.skipArg0&&macro.name===tagName)},parseArgs:function(){var Item=Lexer.enumFromNames(["Error","Bareword","Expression","String","SquareBracket"]),spaceRe=new RegExp(Patterns.space),notSpaceRe=new RegExp(Patterns.notSpace),varTest=new RegExp("^".concat(Patterns.variable));function slurpQuote(lexer,endQuote){loop:for(;;)switch(lexer.next()){case"\\":var ch=lexer.next();if(ch!==EOF&&"\n"!==ch)break;case EOF:case"\n":return EOF;case endQuote:break loop}return lexer.pos}function lexSpace(lexer){var offset=lexer.source.slice(lexer.pos).search(notSpaceRe);if(offset===EOF)return null;switch(0!==offset&&(lexer.pos+=offset,lexer.ignore()),lexer.next()){case"`":return lexExpression;case'"':return lexDoubleQuote;case"'":return lexSingleQuote;case"[":return lexSquareBracket;default:return lexBareword}}function lexExpression(lexer){return slurpQuote(lexer,"`")===EOF?lexer.error(Item.Error,"unterminated backquote expression"):(lexer.emit(Item.Expression),lexSpace)}function lexDoubleQuote(lexer){return slurpQuote(lexer,'"')===EOF?lexer.error(Item.Error,"unterminated double quoted string"):(lexer.emit(Item.String),lexSpace)}function lexSingleQuote(lexer){return slurpQuote(lexer,"'")===EOF?lexer.error(Item.Error,"unterminated single quoted string"):(lexer.emit(Item.String),lexSpace)}function lexSquareBracket(lexer){var what;if(lexer.accept("<>IiMmGg")?(what="image",lexer.acceptRun("<>IiMmGg")):what="link",!lexer.accept("["))return lexer.error(Item.Error,"malformed ".concat(what," markup"));lexer.depth=2;loop:for(;;)switch(lexer.next()){case"\\":var ch=lexer.next();if(ch!==EOF&&"\n"!==ch)break;case EOF:case"\n":return lexer.error(Item.Error,"unterminated ".concat(what," markup"));case"[":++lexer.depth;break;case"]":if(--lexer.depth,lexer.depth<0)return lexer.error(Item.Error,"unexpected right square bracket ']'");if(1===lexer.depth){if("]"===lexer.next()){--lexer.depth;break loop}lexer.backup()}}return lexer.emit(Item.SquareBracket),lexSpace}function lexBareword(lexer){var offset=lexer.source.slice(lexer.pos).search(spaceRe);return lexer.pos=offset===EOF?lexer.source.length:lexer.pos+offset,lexer.emit(Item.Bareword),offset===EOF?null:lexSpace}return function(rawArgsString){var lexer=new Lexer(rawArgsString,lexSpace),args=[];return lexer.run().forEach((function(item){var arg=item.text;switch(item.type){case Item.Error:throw new Error('unable to parse macro argument "'.concat(arg,'": ').concat(item.message));case Item.Bareword:if(varTest.test(arg))arg=State.getVar(arg);else if(/^(?:settings|setup)[.[]/.test(arg))try{arg=Scripting.evalTwineScript(arg)}catch(ex){throw new Error('unable to parse macro argument "'.concat(arg,'": ').concat(ex.message))}else if("null"===arg)arg=null;else if("undefined"===arg)arg=undefined;else if("true"===arg)arg=!0;else if("false"===arg)arg=!1;else if("NaN"===arg)arg=NaN;else{var argAsNum=Number(arg);Number.isNaN(argAsNum)||(arg=argAsNum)}break;case Item.Expression:if(""===(arg=arg.slice(1,-1).trim()))arg=undefined;else try{arg=Scripting.evalTwineScript("(".concat(arg,")"))}catch(ex){throw new Error('unable to parse macro argument expression "'.concat(arg,'": ').concat(ex.message))}break;case Item.String:try{arg=Scripting.evalJavaScript(arg)}catch(ex){throw new Error('unable to parse macro argument string "'.concat(arg,'": ').concat(ex.message))}break;case Item.SquareBracket:var markup=Wikifier.helpers.parseSquareBracketedMarkup({source:arg,matchStart:0});if(markup.hasOwnProperty("error"))throw new Error('unable to parse macro argument "'.concat(arg,'": ').concat(markup.error));if(markup.pos<arg.length)throw new Error('unable to parse macro argument "'.concat(arg,'": unexpected character(s) "').concat(arg.slice(markup.pos),'" (pos: ').concat(markup.pos,")"));markup.isLink?((arg={isLink:!0}).count=markup.hasOwnProperty("text")?2:1,arg.link=Wikifier.helpers.evalPassageId(markup.link),arg.text=markup.hasOwnProperty("text")?Wikifier.helpers.evalText(markup.text):arg.link,arg.external=!markup.forceInternal&&Wikifier.isExternalLink(arg.link),arg.setFn=markup.hasOwnProperty("setter")?Wikifier.helpers.createShadowSetterCallback(Scripting.parse(markup.setter)):null):markup.isImage&&(arg=function(source){var imgObj={source:source,isImage:!0};if("data:"!==source.slice(0,5)&&Story.has(source)){var passage=Story.get(source);passage.tags.includes("Twine.image")&&(imgObj.source=passage.text,imgObj.passage=passage.title)}return imgObj}(Wikifier.helpers.evalPassageId(markup.source)),markup.hasOwnProperty("align")&&(arg.align=markup.align),markup.hasOwnProperty("text")&&(arg.title=Wikifier.helpers.evalText(markup.text)),markup.hasOwnProperty("link")&&(arg.link=Wikifier.helpers.evalPassageId(markup.link),arg.external=!markup.forceInternal&&Wikifier.isExternalLink(arg.link)),arg.setFn=markup.hasOwnProperty("setter")?Wikifier.helpers.createShadowSetterCallback(Scripting.parse(markup.setter)):null)}args.push(arg)})),args}}()}),Wikifier.Parser.add({name:"link",profiles:["core"],match:"\\[\\[[^[]",handler:function(w){var markup=Wikifier.helpers.parseSquareBracketedMarkup(w);if(markup.hasOwnProperty("error"))w.outputText(w.output,w.matchStart,w.nextMatch);else{w.nextMatch=markup.pos;var link=Wikifier.helpers.evalPassageId(markup.link),text=markup.hasOwnProperty("text")?Wikifier.helpers.evalText(markup.text):link,setFn=markup.hasOwnProperty("setter")?Wikifier.helpers.createShadowSetterCallback(Scripting.parse(markup.setter)):null,output=(Config.debug?new DebugView(w.output,"link-markup","[[link]]",w.source.slice(w.matchStart,w.nextMatch)):w).output;markup.forceInternal||!Wikifier.isExternalLink(link)?Wikifier.createInternalLink(output,link,text,setFn):Wikifier.createExternalLink(output,link,text)}}}),Wikifier.Parser.add({name:"urlLink",profiles:["core"],match:Patterns.url,handler:function(w){w.outputText(Wikifier.createExternalLink(w.output,w.matchText),w.matchStart,w.nextMatch)}}),Wikifier.Parser.add({name:"image",profiles:["core"],match:"\\[[<>]?[Ii][Mm][Gg]\\[",handler:function(w){var markup=Wikifier.helpers.parseSquareBracketedMarkup(w);if(markup.hasOwnProperty("error"))w.outputText(w.output,w.matchStart,w.nextMatch);else{var debugView;w.nextMatch=markup.pos,Config.debug&&(debugView=new DebugView(w.output,"image-markup",markup.hasOwnProperty("link")?"[img[][link]]":"[img[]]",w.source.slice(w.matchStart,w.nextMatch))).modes({block:!0});var source,setFn=markup.hasOwnProperty("setter")?Wikifier.helpers.createShadowSetterCallback(Scripting.parse(markup.setter)):null,el=(Config.debug?debugView:w).output;if(markup.hasOwnProperty("link")){var link=Wikifier.helpers.evalPassageId(markup.link);(el=markup.forceInternal||!Wikifier.isExternalLink(link)?Wikifier.createInternalLink(el,link,null,setFn):Wikifier.createExternalLink(el,link)).classList.add("link-image")}if(el=jQuery(document.createElement("img")).appendTo(el).get(0),"data:"!==(source=Wikifier.helpers.evalPassageId(markup.source)).slice(0,5)&&Story.has(source)){var passage=Story.get(source);passage.tags.includes("Twine.image")&&(el.setAttribute("data-passage",passage.title),source=passage.text.trim())}el.src=source,markup.hasOwnProperty("text")&&(el.title=Wikifier.helpers.evalText(markup.text)),markup.hasOwnProperty("align")&&(el.align=markup.align)}}}),Wikifier.Parser.add({name:"monospacedByBlock",profiles:["block"],match:"^\\{\\{\\{\\n",lookahead:/^\{\{\{\n((?:^[^\n]*\n)+?)(^\}\}\}$\n?)/gm,handler:function(w){this.lookahead.lastIndex=w.matchStart;var match=this.lookahead.exec(w.source);if(match&&match.index===w.matchStart){var pre=jQuery(document.createElement("pre"));jQuery(document.createElement("code")).text(match[1]).appendTo(pre),pre.appendTo(w.output),w.nextMatch=this.lookahead.lastIndex}}}),Wikifier.Parser.add({name:"formatByChar",profiles:["core"],match:"''|//|__|\\^\\^|~~|==|\\{\\{\\{",handler:function(w){switch(w.matchText){case"''":w.subWikify(jQuery(document.createElement("strong")).appendTo(w.output).get(0),"''");break;case"//":w.subWikify(jQuery(document.createElement("em")).appendTo(w.output).get(0),"//");break;case"__":w.subWikify(jQuery(document.createElement("u")).appendTo(w.output).get(0),"__");break;case"^^":w.subWikify(jQuery(document.createElement("sup")).appendTo(w.output).get(0),"\\^\\^");break;case"~~":w.subWikify(jQuery(document.createElement("sub")).appendTo(w.output).get(0),"~~");break;case"==":w.subWikify(jQuery(document.createElement("s")).appendTo(w.output).get(0),"==");break;case"{{{":var lookahead=/\{\{\{((?:.|\n)*?)\}\}\}/gm;lookahead.lastIndex=w.matchStart;var match=lookahead.exec(w.source);match&&match.index===w.matchStart&&(jQuery(document.createElement("code")).text(match[1]).appendTo(w.output),w.nextMatch=lookahead.lastIndex)}}}),Wikifier.Parser.add({name:"customStyle",profiles:["core"],match:"@@",terminator:"@@",blockRe:/\s*\n/gm,handler:function(w){var css=Wikifier.helpers.inlineCss(w);this.blockRe.lastIndex=w.nextMatch;var blockMatch=this.blockRe.exec(w.source),blockLevel=blockMatch&&blockMatch.index===w.nextMatch,$el=jQuery(document.createElement(blockLevel?"div":"span")).appendTo(w.output);0===css.classes.length&&""===css.id&&0===Object.keys(css.styles).length?$el.addClass("marked"):(css.classes.forEach((function(className){return $el.addClass(className)})),""!==css.id&&$el.attr("id",css.id),$el.css(css.styles)),blockLevel?(w.nextMatch+=blockMatch[0].length,w.subWikify($el[0],"\\n?".concat(this.terminator))):w.subWikify($el[0],this.terminator)}}),Wikifier.Parser.add({name:"verbatimText",profiles:["core"],match:'"{3}|<[Nn][Oo][Ww][Ii][Kk][Ii]>',lookahead:/(?:"{3}((?:.|\n)*?)"{3})|(?:<[Nn][Oo][Ww][Ii][Kk][Ii]>((?:.|\n)*?)<\/[Nn][Oo][Ww][Ii][Kk][Ii]>)/gm,handler:function(w){this.lookahead.lastIndex=w.matchStart;var match=this.lookahead.exec(w.source);match&&match.index===w.matchStart&&(w.nextMatch=this.lookahead.lastIndex,jQuery(document.createElement("span")).addClass("verbatim").text(match[1]||match[2]).appendTo(w.output))}}),Wikifier.Parser.add({name:"horizontalRule",profiles:["core"],match:"^----+$\\n?|<[Hh][Rr]\\s*/?>\\n?",handler:function(w){jQuery(document.createElement("hr")).appendTo(w.output)}}),Wikifier.Parser.add({name:"emdash",profiles:["core"],match:"--",handler:function(w){jQuery(document.createTextNode("—")).appendTo(w.output)}}),Wikifier.Parser.add({name:"doubleDollarSign",profiles:["core"],match:"\\${2}",handler:function(w){jQuery(document.createTextNode("$")).appendTo(w.output)}}),Wikifier.Parser.add({name:"nakedVariable",profiles:["core"],match:"".concat(Patterns.variable,"(?:(?:\\.").concat(Patterns.identifier,")|(?:\\[\\d+\\])|(?:\\[\"(?:\\\\.|[^\"\\\\])+\"\\])|(?:\\['(?:\\\\.|[^'\\\\])+'\\])|(?:\\[").concat(Patterns.variable,"\\]))*"),handler:function(w){var result=State.getVar(w.matchText);null==result?jQuery(document.createTextNode(w.matchText)).appendTo(w.output):new Wikifier((Config.debug?new DebugView(w.output,"variable",w.matchText,w.matchText):w).output,stringFrom(result))}}),Wikifier.Parser.add({name:"template",profiles:["core"],match:"\\?".concat(Patterns.templateName),handler:function(w){var name=w.matchText.slice(1),template=Template.get(name),result=null;switch(template instanceof Array&&(template=template.random()),_typeof(template)){case"function":try{result=stringFrom(template.call({name:name}))}catch(ex){return throwError(w.output,"cannot execute function template ?".concat(name,": ").concat(ex.message),w.source.slice(w.matchStart,w.nextMatch))}break;case"string":result=template}null===result?jQuery(document.createTextNode(w.matchText)).appendTo(w.output):new Wikifier((Config.debug?new DebugView(w.output,"template",w.matchText,w.matchText):w).output,result)}}),Wikifier.Parser.add({name:"heading",profiles:["block"],match:"^!{1,6}",terminator:"\\n",handler:function(w){Wikifier.helpers.hasBlockContext(w.output.childNodes)?w.subWikify(jQuery(document.createElement("h".concat(w.matchLength))).appendTo(w.output).get(0),this.terminator):jQuery(w.output).append(document.createTextNode(w.matchText))}}),Wikifier.Parser.add({name:"table",profiles:["block"],match:"^\\|(?:[^\\n]*)\\|(?:[fhck]?)$",lookahead:/^\|([^\n]*)\|([fhck]?)$/gm,rowTerminator:"\\|(?:[cfhk]?)$\\n?",cellPattern:"(?:\\|([^\\n\\|]*)\\|)|(\\|[cfhk]?$\\n?)",cellTerminator:"(?:\\u0020*)\\|",rowTypes:{c:"caption",f:"tfoot",h:"thead","":"tbody"},handler:function(w){if(Wikifier.helpers.hasBlockContext(w.output.childNodes)){var matched,table=jQuery(document.createElement("table")).appendTo(w.output).get(0),prevColumns=[],curRowType=null,$rowContainer=null,rowCount=0;w.nextMatch=w.matchStart;do{this.lookahead.lastIndex=w.nextMatch;var match=this.lookahead.exec(w.source);if(matched=match&&match.index===w.nextMatch){var nextRowType=match[2];"k"===nextRowType?(table.className=match[1],w.nextMatch+=match[0].length+1):(nextRowType!==curRowType&&(curRowType=nextRowType,$rowContainer=jQuery(document.createElement(this.rowTypes[nextRowType])).appendTo(table)),"c"===curRowType?($rowContainer.css("caption-side",0===rowCount?"top":"bottom"),w.nextMatch+=1,w.subWikify($rowContainer[0],this.rowTerminator)):this.rowHandler(w,jQuery(document.createElement("tr")).appendTo($rowContainer).get(0),prevColumns),++rowCount)}}while(matched)}else jQuery(w.output).append(document.createTextNode(w.matchText))},rowHandler:function(w,rowEl,prevColumns){var matched,_this12=this,cellRe=new RegExp(this.cellPattern,"gm"),col=0,curColCount=1;do{cellRe.lastIndex=w.nextMatch;var cellMatch=cellRe.exec(w.source);if(matched=cellMatch&&cellMatch.index===w.nextMatch){if("~"===cellMatch[1]){var last=prevColumns[col];last&&(++last.rowCount,last.$element.attr("rowspan",last.rowCount).css("vertical-align","middle")),w.nextMatch=cellMatch.index+cellMatch[0].length-1}else if(">"===cellMatch[1])++curColCount,w.nextMatch=cellMatch.index+cellMatch[0].length-1;else{if(cellMatch[2]){w.nextMatch=cellMatch.index+cellMatch[0].length;break}!function(){++w.nextMatch;for(var css=Wikifier.helpers.inlineCss(w),spaceLeft=!1,spaceRight=!1,$cell=void 0;" "===w.source.substr(w.nextMatch,1);)spaceLeft=!0,++w.nextMatch;"!"===w.source.substr(w.nextMatch,1)?($cell=jQuery(document.createElement("th")).appendTo(rowEl),++w.nextMatch):$cell=jQuery(document.createElement("td")).appendTo(rowEl),prevColumns[col]={rowCount:1,$element:$cell},curColCount>1&&($cell.attr("colspan",curColCount),curColCount=1),w.subWikify($cell[0],_this12.cellTerminator)," "===w.matchText.substr(w.matchText.length-2,1)&&(spaceRight=!0),css.classes.forEach((function(className){return $cell.addClass(className)})),""!==css.id&&$cell.attr("id",css.id),spaceLeft&&spaceRight?css.styles["text-align"]="center":spaceLeft?css.styles["text-align"]="right":spaceRight&&(css.styles["text-align"]="left"),$cell.css(css.styles),w.nextMatch=w.nextMatch-1}()}++col}}while(matched)}}),Wikifier.Parser.add({name:"list",profiles:["block"],match:"^(?:(?:\\*+)|(?:#+))",lookahead:/^(?:(\*+)|(#+))/gm,terminator:"\\n",handler:function(w){if(Wikifier.helpers.hasBlockContext(w.output.childNodes)){w.nextMatch=w.matchStart;var matched,i,destStack=[w.output],curType=null,curLevel=0;do{this.lookahead.lastIndex=w.nextMatch;var match=this.lookahead.exec(w.source);if(matched=match&&match.index===w.nextMatch){var newType=match[2]?"ol":"ul",newLevel=match[0].length;if(w.nextMatch+=match[0].length,newLevel>curLevel)for(i=curLevel;i<newLevel;++i)destStack.push(jQuery(document.createElement(newType)).appendTo(destStack[destStack.length-1]).get(0));else if(newLevel<curLevel)for(i=curLevel;i>newLevel;--i)destStack.pop();else newLevel===curLevel&&newType!==curType&&(destStack.pop(),destStack.push(jQuery(document.createElement(newType)).appendTo(destStack[destStack.length-1]).get(0)));curLevel=newLevel,curType=newType,w.subWikify(jQuery(document.createElement("li")).appendTo(destStack[destStack.length-1]).get(0),this.terminator)}}while(matched)}else jQuery(w.output).append(document.createTextNode(w.matchText))}}),Wikifier.Parser.add({name:"commentByBlock",profiles:["core"],match:"(?:/(?:%|\\*))|(?:\x3c!--)",lookahead:/(?:\/(%|\*)(?:(?:.|\n)*?)\1\/)|(?:<!--(?:(?:.|\n)*?)-->)/gm,handler:function(w){this.lookahead.lastIndex=w.matchStart;var match=this.lookahead.exec(w.source);match&&match.index===w.matchStart&&(w.nextMatch=this.lookahead.lastIndex)}}),Wikifier.Parser.add({name:"lineContinuation",profiles:["core"],match:"\\\\".concat(Patterns.spaceNoTerminator,"*\\n|\\n").concat(Patterns.spaceNoTerminator,"*\\\\|\\n?\\\\").concat(Patterns.spaceNoTerminator,"*$|^").concat(Patterns.spaceNoTerminator,"*\\\\\\n?"),handler:function(w){w.nextMatch=w.matchStart+w.matchLength}}),Wikifier.Parser.add({name:"lineBreak",profiles:["core"],match:"\\n|<[Bb][Rr]\\s*/?>",handler:function(w){w.options.nobr||jQuery(document.createElement("br")).appendTo(w.output)}}),Wikifier.Parser.add({name:"htmlCharacterReference",profiles:["core"],match:"(?:(?:&#?[0-9A-Za-z]{2,8};|.)(?:&#?(?:x0*(?:3[0-6][0-9A-Fa-f]|1D[C-Fc-f][0-9A-Fa-f]|20[D-Fd-f][0-9A-Fa-f]|FE2[0-9A-Fa-f])|0*(?:76[89]|7[7-9][0-9]|8[0-7][0-9]|761[6-9]|76[2-7][0-9]|84[0-3][0-9]|844[0-7]|6505[6-9]|6506[0-9]|6507[0-1]));)+|&#?[0-9A-Za-z]{2,8};)",handler:function(w){jQuery(document.createDocumentFragment()).append(w.matchText).appendTo(w.output)}}),Wikifier.Parser.add({name:"xmlProlog",profiles:["core"],match:"<\\?[Xx][Mm][Ll][^>]*\\?>",handler:function(w){w.nextMatch=w.matchStart+w.matchLength}}),Wikifier.Parser.add({name:"verbatimHtml",profiles:["core"],match:"<[Hh][Tt][Mm][Ll]>",lookahead:/<[Hh][Tt][Mm][Ll]>((?:.|\n)*?)<\/[Hh][Tt][Mm][Ll]>/gm,handler:_verbatimTagHandler}),Wikifier.Parser.add({name:"verbatimScriptTag",profiles:["core"],match:"<[Ss][Cc][Rr][Ii][Pp][Tt][^>]*>",lookahead:/(<[Ss][Cc][Rr][Ii][Pp][Tt]*>(?:.|\n)*?<\/[Ss][Cc][Rr][Ii][Pp][Tt]>)/gm,handler:_verbatimTagHandler}),Wikifier.Parser.add({name:"styleTag",profiles:["core"],match:"<[Ss][Tt][Yy][Ll][Ee][^>]*>",lookahead:/(<[Ss][Tt][Yy][Ll][Ee]*>)((?:.|\n)*?)(<\/[Ss][Tt][Yy][Ll][Ee]>)/gm,imageMarkup:new RegExp(Patterns.cssImage,"g"),hasImageMarkup:new RegExp(Patterns.cssImage),handler:function(w){this.lookahead.lastIndex=w.matchStart;var match=this.lookahead.exec(w.source);if(match&&match.index===w.matchStart){w.nextMatch=this.lookahead.lastIndex;var css=match[2];this.hasImageMarkup.test(css)&&(this.imageMarkup.lastIndex=0,css=css.replace(this.imageMarkup,(function(wikiImage){var markup=Wikifier.helpers.parseSquareBracketedMarkup({source:wikiImage,matchStart:0});if(markup.hasOwnProperty("error")||markup.pos<wikiImage.length)return wikiImage;var source=markup.source;if("data:"!==source.slice(0,5)&&Story.has(source)){var passage=Story.get(source);passage.tags.includes("Twine.image")&&(source=passage.text)}return'url("'.concat(source.replace(/"/g,"%22"),'")')}))),jQuery(document.createDocumentFragment()).append(match[1]+css+match[3]).appendTo(w.output)}}}),Wikifier.Parser.add({name:"svgTag",profiles:["core"],match:"<[Ss][Vv][Gg][^>]*>",lookahead:/<(\/?)[Ss][Vv][Gg][^>]*>/gm,namespace:"http://www.w3.org/2000/svg",handler:function(w){var _this13=this;this.lookahead.lastIndex=w.nextMatch;for(var match,depth=1;depth>0&&null!==(match=this.lookahead.exec(w.source));)depth+="/"===match[1]?-1:1;if(0===depth){w.nextMatch=this.lookahead.lastIndex;var svgTag=w.source.slice(w.matchStart,this.lookahead.lastIndex),$frag=jQuery(document.createDocumentFragment()).append(svgTag);$frag.find("a[data-passage],image[data-passage]").each((function(_,el){var tagName=el.tagName.toLowerCase();try{_this13.processAttributeDirectives(el)}catch(ex){return throwError(w.output,"svg|<".concat(tagName,">: ").concat(ex.message),"".concat(w.matchText,"…"))}el.hasAttribute("data-passage")&&_this13.processDataAttributes(el,tagName)})),$frag.appendTo(w.output)}},processAttributeDirectives:function(el){_toConsumableArray(el.attributes).forEach((function(_ref10){var name=_ref10.name,value=_ref10.value,evalShorthand="@"===name[0];if(evalShorthand||name.startsWith("sc-eval:")){var result,newName=name.slice(evalShorthand?1:8);if("data-setter"===newName)throw new Error('evaluation directive is not allowed on the data-setter attribute: "'.concat(name,'"'));try{result=Scripting.evalTwineScript(value)}catch(ex){throw new Error('bad evaluation from attribute directive "'.concat(name,'": ').concat(ex.message))}try{el.setAttribute(newName,result),el.removeAttribute(name)}catch(ex){throw new Error('cannot transform attribute directive "'.concat(name,'" into attribute "').concat(newName,'"'))}}}))},processDataAttributes:function(el,tagName){var passage=el.getAttribute("data-passage");if(null!=passage){var evaluated=Wikifier.helpers.evalPassageId(passage);if(evaluated!==passage&&(passage=evaluated,el.setAttribute("data-passage",evaluated)),""!==passage)if("image"===tagName)"data:"!==passage.slice(0,5)&&Story.has(passage)&&(passage=Story.get(passage)).tags.includes("Twine.image")&&el.setAttribute("href",passage.text.trim());else{var setFn,setter=el.getAttribute("data-setter");null!=setter&&""!==(setter=String(setter).trim())&&(setFn=Wikifier.helpers.createShadowSetterCallback(Scripting.parse(setter))),Story.has(passage)?(el.classList.add("link-internal"),Config.addVisitedLinkClass&&State.hasPlayed(passage)&&el.classList.add("link-visited")):el.classList.add("link-broken"),jQuery(el).ariaClick({one:!0},(function(){"function"==typeof setFn&&setFn.call(this),Engine.play(passage)}))}}}}),Wikifier.Parser.add({name:"htmlTag",profiles:["core"],match:"<".concat(Patterns.htmlTagName,"(?:\\s+[^\\u0000-\\u001F\\u007F-\\u009F\\s\"'>\\/=]+(?:\\s*=\\s*(?:\"[^\"]*?\"|'[^']*?'|[^\\s\"'=<>`]+))?)*\\s*\\/?>"),tagRe:new RegExp("^<(".concat(Patterns.htmlTagName,")")),mediaTags:["audio","img","source","track","video"],nobrTags:["audio","colgroup","datalist","dl","figure","meter","ol","optgroup","picture","progress","ruby","select","table","tbody","tfoot","thead","tr","ul","video"],voidTags:["area","base","br","col","embed","hr","img","input","keygen","link","menuitem","meta","param","source","track","wbr"],handler:function(w){var tagMatch=this.tagRe.exec(w.matchText),tag=tagMatch&&tagMatch[1],tagName=tag&&tag.toLowerCase();if(tagName){var terminator,terminatorMatch,isVoid=this.voidTags.includes(tagName)||w.matchText.endsWith("/>"),isNobr=this.nobrTags.includes(tagName);if(!isVoid){terminator="<\\/".concat(tagName,"\\s*>");var terminatorRe=new RegExp(terminator,"gim");terminatorRe.lastIndex=w.matchStart,terminatorMatch=terminatorRe.exec(w.source)}if(!isVoid&&!terminatorMatch)return throwError(w.output,"cannot find a closing tag for HTML <".concat(tag,">"),"".concat(w.matchText,"…"));var debugView,output=w.output,el=document.createElement(w.output.tagName);for(el.innerHTML=w.matchText;el.firstChild;)el=el.firstChild;try{this.processAttributeDirectives(el)}catch(ex){return throwError(w.output,"<".concat(tagName,">: ").concat(ex.message),"".concat(w.matchText,"…"))}if(el.hasAttribute("data-passage")&&(this.processDataAttributes(el,tagName),Config.debug&&((debugView=new DebugView(w.output,"html-".concat(tagName),tagName,w.matchText)).modes({block:"img"===tagName,nonvoid:terminatorMatch}),output=debugView.output)),terminatorMatch){try{Wikifier.Option.push({nobr:isNobr}),w.subWikify(el,terminator,{ignoreTerminatorCase:!0})}finally{Wikifier.Option.pop()}debugView&&jQuery(el).find(".debug.block").length>0&&debugView.modes({block:!0})}output.appendChild("track"===tagName?el.cloneNode(!0):el)}},processAttributeDirectives:function(el){_toConsumableArray(el.attributes).forEach((function(_ref11){var name=_ref11.name,value=_ref11.value,evalShorthand="@"===name[0];if(evalShorthand||name.startsWith("sc-eval:")){var result,newName=name.slice(evalShorthand?1:8);if("data-setter"===newName)throw new Error('evaluation directive is not allowed on the data-setter attribute: "'.concat(name,'"'));try{result=Scripting.evalTwineScript(value)}catch(ex){throw new Error('bad evaluation from attribute directive "'.concat(name,'": ').concat(ex.message))}try{el.setAttribute(newName,result),el.removeAttribute(name)}catch(ex){throw new Error('cannot transform attribute directive "'.concat(name,'" into attribute "').concat(newName,'"'))}}}))},processDataAttributes:function(el,tagName){var passage=el.getAttribute("data-passage");if(null!=passage){var evaluated=Wikifier.helpers.evalPassageId(passage);if(evaluated!==passage&&(passage=evaluated,el.setAttribute("data-passage",evaluated)),""!==passage)if(this.mediaTags.includes(tagName)){if("data:"!==passage.slice(0,5)&&Story.has(passage)){var parentName,twineTag;switch(passage=Story.get(passage),tagName){case"audio":case"video":twineTag="Twine.".concat(tagName);break;case"img":twineTag="Twine.image";break;case"track":twineTag="Twine.vtt";break;case"source":var $parent=$(el).closest("audio,picture,video");$parent.length&&(parentName=$parent.get(0).tagName.toLowerCase(),twineTag="Twine.".concat("picture"===parentName?"image":parentName))}passage.tags.includes(twineTag)&&(el["picture"===parentName?"srcset":"src"]=passage.text.trim())}}else{var setFn,setter=el.getAttribute("data-setter");null!=setter&&""!==(setter=String(setter).trim())&&(setFn=Wikifier.helpers.createShadowSetterCallback(Scripting.parse(setter))),Story.has(passage)?(el.classList.add("link-internal"),Config.addVisitedLinkClass&&State.hasPlayed(passage)&&el.classList.add("link-visited")):el.classList.add("link-broken"),jQuery(el).ariaClick({one:!0},(function(){"function"==typeof setFn&&setFn.call(this),Engine.play(passage)}))}}}})}();var Template=(_templates=new Map,_validNameRe=new RegExp("^(?:".concat(Patterns.templateName,")$")),_validType=function(template){var templateType=_typeof(template);return"function"===templateType||"string"===templateType},Object.freeze(Object.defineProperties({},{add:{value:function(name,template){if(!(_validType(template)||template instanceof Array&&template.length>0&&template.every(_validType)))throw new TypeError("invalid template type (".concat(name,"); templates must be: functions, strings, or an array of either"));(name instanceof Array?name:[name]).forEach((function(name){if(!_validNameRe.test(name))throw new Error('invalid template name "'.concat(name,'"'));if(_templates.has(name))throw new Error("cannot clobber existing template ?".concat(name));_templates.set(name,template)}))}},delete:{value:function(name){(name instanceof Array?name:[name]).forEach((function(name){return _templates.delete(name)}))}},get:{value:function(name){return _templates.has(name)?_templates.get(name):null}},has:{value:function(name){return _templates.has(name)}},size:{get:function(){return _templates.size}}}))),_templates,_validNameRe,_validType,Macro=function(){var _macros={},_tags={},_validNameRe=new RegExp("^(?:".concat(Patterns.macroName,")$"));function macrosHas(name){return _macros.hasOwnProperty(name)}function tagsRegister(parent,bodyTags){if(!parent)throw new Error("no parent specified");for(var endTags=["/".concat(parent),"end".concat(parent)],allTags=[].concat(endTags,Array.isArray(bodyTags)?bodyTags:[]),i=0;i<allTags.length;++i){var tag=allTags[i];if(macrosHas(tag))throw new Error("cannot register tag for an existing macro");tagsHas(tag)?_tags[tag].includes(parent)||(_tags[tag].push(parent),_tags[tag].sort()):_tags[tag]=[parent]}}function tagsUnregister(parent){if(!parent)throw new Error("no parent specified");Object.keys(_tags).forEach((function(tag){var i=_tags[tag].indexOf(parent);-1!==i&&(1===_tags[tag].length?delete _tags[tag]:_tags[tag].splice(i,1))}))}function tagsHas(name){return _tags.hasOwnProperty(name)}return Object.freeze(Object.defineProperties({},{add:{value:function macrosAdd(name,def){if(Array.isArray(name))name.forEach((function(name){return macrosAdd(name,def)}));else{if(!_validNameRe.test(name))throw new Error('invalid macro name "'.concat(name,'"'));if(macrosHas(name))throw new Error("cannot clobber existing macro <<".concat(name,">>"));if(tagsHas(name))throw new Error("cannot clobber child tag <<".concat(name,">> of parent macro").concat(1===_tags[name].length?"":"s"," <<").concat(_tags[name].join(">>, <<"),">>"));try{if("object"===_typeof(def))_macros[name]=Object.assign(Object.create(null),def,{_MACRO_API:!0});else{if(!macrosHas(def))throw new Error("cannot create alias of nonexistent macro <<".concat(def,">>"));_macros[name]=Object.create(_macros[def],{_ALIAS_OF:{enumerable:!0,value:def}})}Object.defineProperty(_macros,name,{writable:!1})}catch(ex){throw"TypeError"===ex.name?new Error("cannot clobber protected macro <<".concat(name,">>")):new Error("unknown error when attempting to add macro <<".concat(name,">>: [").concat(ex.name,"] ").concat(ex.message))}if(void 0!==_macros[name].tags)if(null==_macros[name].tags)tagsRegister(name);else{if(!Array.isArray(_macros[name].tags))throw new Error('bad value for "tags" property of macro <<'.concat(name,">>"));tagsRegister(name,_macros[name].tags)}}}},delete:{value:function macrosDelete(name){if(Array.isArray(name))name.forEach((function(name){return macrosDelete(name)}));else if(macrosHas(name)){void 0!==_macros[name].tags&&tagsUnregister(name);try{Object.defineProperty(_macros,name,{writable:!0}),delete _macros[name]}catch(ex){throw new Error("unknown error removing macro <<".concat(name,">>: ").concat(ex.message))}}else if(tagsHas(name))throw new Error("cannot remove child tag <<".concat(name,">> of parent macro <<").concat(_tags[name],">>"))}},isEmpty:{value:function(){return 0===Object.keys(_macros).length}},has:{value:macrosHas},get:{value:function(name){var macro=null;return macrosHas(name)&&"function"==typeof _macros[name].handler?macro=_macros[name]:macros.hasOwnProperty(name)&&"function"==typeof macros[name].handler&&(macro=macros[name]),macro}},init:{value:function(){var handler=arguments.length>0&&arguments[0]!==undefined?arguments[0]:"init";Object.keys(_macros).forEach((function(name){"function"==typeof _macros[name][handler]&&_macros[name][handler](name)})),Object.keys(macros).forEach((function(name){"function"==typeof macros[name][handler]&&macros[name][handler](name)}))}},tags:{value:Object.freeze(Object.defineProperties({},{register:{value:tagsRegister},unregister:{value:tagsUnregister},has:{value:tagsHas},get:{value:function(name){return tagsHas(name)?_tags[name]:null}}}))},evalStatements:{value:function(){return Scripting.evalJavaScript.apply(Scripting,arguments)}}}))}(),MacroContext=function(){var MacroContext=function(){function MacroContext(contextData){_classCallCheck(this,MacroContext);var context=Object.assign({parent:null,macro:null,name:"",displayName:"",args:null,payload:null,parser:null,source:""},contextData);if(null===context.macro||""===context.name||null===context.parser)throw new TypeError("context object missing required properties");Object.defineProperties(this,{self:{value:context.macro},name:{value:void 0===context.macro._ALIAS_OF?context.name:context.macro._ALIAS_OF},displayName:{value:context.name},args:{value:context.args},payload:{value:context.payload},source:{value:context.source},parent:{value:context.parent},parser:{value:context.parser},_output:{value:context.parser.output},_shadows:{writable:!0,value:null},_debugView:{writable:!0,value:null},_debugViewEnabled:{writable:!0,value:Config.debug}})}return _createClass(MacroContext,[{key:"output",get:function(){return this._debugViewEnabled?this.debugView.output:this._output}},{key:"shadows",get:function(){return _toConsumableArray(this._shadows)}},{key:"shadowView",get:function(){var view=new Set;return this.contextSelectAll((function(ctx){return ctx._shadows})).forEach((function(ctx){return ctx._shadows.forEach((function(name){return view.add(name)}))})),_toConsumableArray(view)}},{key:"debugView",get:function(){return this._debugViewEnabled?null!==this._debugView?this._debugView:this.createDebugView():null}},{key:"contextHas",value:function(filter){for(var context=this;null!==(context=context.parent);)if(filter(context))return!0;return!1}},{key:"contextSelect",value:function(filter){for(var context=this;null!==(context=context.parent);)if(filter(context))return context;return null}},{key:"contextSelectAll",value:function(filter){for(var result=[],context=this;null!==(context=context.parent);)filter(context)&&result.push(context);return result}},{key:"addShadow",value:function(){var _this14=this;this._shadows||(this._shadows=new Set);for(var varRe=new RegExp("^".concat(Patterns.variable,"$")),_len14=arguments.length,names=new Array(_len14),_key14=0;_key14<_len14;_key14++)names[_key14]=arguments[_key14];names.flat(1/0).forEach((function(name){if("string"!=typeof name)throw new TypeError("variable name must be a string; type: ".concat(_typeof(name)));if(!varRe.test(name))throw new Error('invalid variable name "'.concat(name,'"'));_this14._shadows.add(name)}))}},{key:"createShadowWrapper",value:function(callback,doneCallback,startCallback){var shadowStore,shadowContext=this;return"function"==typeof callback&&(shadowStore={},this.shadowView.forEach((function(varName){var varKey=varName.slice(1),store="$"===varName[0]?State.variables:State.temporary;shadowStore[varName]=store[varKey]}))),function(){for(var _len15=arguments.length,args=new Array(_len15),_key15=0;_key15<_len15;_key15++)args[_key15]=arguments[_key15];if("function"==typeof startCallback&&startCallback.apply(this,args),"function"==typeof callback){var contextCache,shadowNames=Object.keys(shadowStore),valueCache=shadowNames.length>0?{}:null,macroParser=Wikifier.Parser.get("macro");try{shadowNames.forEach((function(varName){var varKey=varName.slice(1),store="$"===varName[0]?State.variables:State.temporary;store.hasOwnProperty(varKey)&&(valueCache[varKey]=store[varKey]),store[varKey]=shadowStore[varName]})),contextCache=macroParser.context,macroParser.context=shadowContext,callback.apply(this,args)}finally{contextCache!==undefined&&(macroParser.context=contextCache),shadowNames.forEach((function(varName){var varKey=varName.slice(1),store="$"===varName[0]?State.variables:State.temporary;shadowStore[varName]=store[varKey],valueCache.hasOwnProperty(varKey)?store[varKey]=valueCache[varKey]:delete store[varKey]}))}}"function"==typeof doneCallback&&doneCallback.apply(this,args)}}},{key:"createDebugView",value:function(name,title){return this._debugView=new DebugView(this._output,"macro",name||this.displayName,title||this.source),null!==this.payload&&this.payload.length>0&&this._debugView.modes({nonvoid:!0}),this._debugViewEnabled=!0,this._debugView}},{key:"removeDebugView",value:function(){null!==this._debugView&&(this._debugView.remove(),this._debugView=null),this._debugViewEnabled=!1}},{key:"error",value:function(message,source){return throwError(this._output,"<<".concat(this.displayName,">>: ").concat(message),source||this.source)}}]),MacroContext}();return MacroContext}();!function(){if(Macro.add("capture",{skipArgs:!0,tags:null,tsVarRe:new RegExp("(".concat(Patterns.variable,")"),"g"),handler:function(){if(0===this.args.raw.length)return this.error("no story/temporary variable list specified");var valueCache={};try{for(var match,tsVarRe=this.self.tsVarRe;null!==(match=tsVarRe.exec(this.args.raw));){var varName=match[1],varKey=varName.slice(1),store="$"===varName[0]?State.variables:State.temporary;store.hasOwnProperty(varKey)&&(valueCache[varKey]=store[varKey]),this.addShadow(varName)}new Wikifier(this.output,this.payload[0].contents)}finally{this.shadows.forEach((function(varName){var varKey=varName.slice(1),store="$"===varName[0]?State.variables:State.temporary;valueCache.hasOwnProperty(varKey)?store[varKey]=valueCache[varKey]:delete store[varKey]}))}}}),Macro.add("set",{skipArgs:!0,handler:function(){if(0===this.args.full.length)return this.error("no expression specified");try{Scripting.evalJavaScript(this.args.full)}catch(ex){return this.error("bad evaluation: ".concat("object"===_typeof(ex)?ex.message:ex))}Config.debug&&this.debugView.modes({hidden:!0})}}),Macro.add("unset",{skipArgs:!0,jsVarRe:new RegExp("State\\.(variables|temporary)\\.(".concat(Patterns.identifier,")"),"g"),handler:function(){if(0===this.args.full.length)return this.error("no story/temporary variable list specified");for(var match,jsVarRe=this.self.jsVarRe;null!==(match=jsVarRe.exec(this.args.full));){var store=State[match[1]],name=match[2];store.hasOwnProperty(name)&&delete store[name]}Config.debug&&this.debugView.modes({hidden:!0})}}),Macro.add("remember",{skipArgs:!0,jsVarRe:new RegExp("State\\.variables\\.(".concat(Patterns.identifier,")"),"g"),handler:function(){if(0===this.args.full.length)return this.error("no expression specified");try{Scripting.evalJavaScript(this.args.full)}catch(ex){return this.error("bad evaluation: ".concat("object"===_typeof(ex)?ex.message:ex))}for(var match,remember=storage.get("remember")||{},jsVarRe=this.self.jsVarRe;null!==(match=jsVarRe.exec(this.args.full));){var name=match[1];remember[name]=State.variables[name]}if(!storage.set("remember",remember))return this.error("unknown error, cannot remember: ".concat(this.args.raw));Config.debug&&this.debugView.modes({hidden:!0})},init:function(){var remember=storage.get("remember");remember&&Object.keys(remember).forEach((function(name){return State.variables[name]=remember[name]}))}}),Macro.add("forget",{skipArgs:!0,jsVarRe:new RegExp("State\\.variables\\.(".concat(Patterns.identifier,")"),"g"),handler:function(){if(0===this.args.full.length)return this.error("no story variable list specified");for(var match,remember=storage.get("remember"),jsVarRe=this.self.jsVarRe,needStore=!1;null!==(match=jsVarRe.exec(this.args.full));){var name=match[1];State.variables.hasOwnProperty(name)&&delete State.variables[name],remember&&remember.hasOwnProperty(name)&&(needStore=!0,delete remember[name])}if(needStore)if(0===Object.keys(remember).length){if(!storage.delete("remember"))return this.error("unknown error, cannot update remember store")}else if(!storage.set("remember",remember))return this.error("unknown error, cannot update remember store");Config.debug&&this.debugView.modes({hidden:!0})}}),Macro.add("run","set"),Macro.add("script",{skipArgs:!0,tags:null,handler:function(){var output=document.createDocumentFragment();try{Scripting.evalJavaScript(this.payload[0].contents,output)}catch(ex){return this.error("bad evaluation: ".concat("object"===_typeof(ex)?ex.message:ex))}Config.debug&&this.createDebugView(),output.hasChildNodes()&&this.output.appendChild(output)}}),Macro.add("include",{handler:function(){return 0===this.args.length?this.error("no passage specified"):(passage="object"===_typeof(this.args[0])?this.args[0].link:this.args[0],Story.has(passage)?(Config.debug&&this.debugView.modes({block:!0}),passage=Story.get(passage),void(this.args[1]?jQuery(document.createElement(this.args[1])).addClass("".concat(passage.domId," macro-").concat(this.name)).attr("data-passage",passage.title).appendTo(this.output):jQuery(this.output)).wiki(passage.processText())):this.error('passage "'.concat(passage,'" does not exist')));var passage}}),Macro.add("nobr",{skipArgs:!0,tags:null,handler:function(){new Wikifier(this.output,this.payload[0].contents.replace(/^\n+|\n+$/g,"").replace(/\n+/g," "))}}),Macro.add(["print","=","-"],{skipArgs:!0,handler:function(){if(0===this.args.full.length)return this.error("no expression specified");try{var result=stringFrom(Scripting.evalJavaScript(this.args.full));null!==result&&new Wikifier(this.output,"-"===this.name?Util.escape(result):result)}catch(ex){return this.error("bad evaluation: ".concat("object"===_typeof(ex)?ex.message:ex))}}}),Macro.add("silently",{skipArgs:!0,tags:null,handler:function(){var frag=document.createDocumentFragment();if(new Wikifier(frag,this.payload[0].contents.trim()),Config.debug)this.debugView.modes({block:!0,hidden:!0}),this.output.appendChild(frag);else{var errList=_toConsumableArray(frag.querySelectorAll(".error")).map((function(errEl){return errEl.textContent}));if(errList.length>0)return this.error("error".concat(1===errList.length?"":"s"," within contents (").concat(errList.join("; "),")"))}}}),Macro.add("type",{isAsync:!0,tags:null,typeId:0,handler:function(){if(0===this.args.length)return this.error("no speed specified");var cursor,speed=Util.fromCssTime(this.args[0]);if(speed<0)return this.error("speed time value must be non-negative (received: ".concat(this.args[0],")"));for(var elClass="",elId="",elTag="div",skipKey=Config.macros.typeSkipKey,start=400,options=this.args.slice(1);options.length>0;){var option=options.shift();switch(option){case"class":if(0===options.length)return this.error("class option missing required class name(s)");if(""===(elClass=options.shift()))throw new Error('class option class name(s) must be non-empty (received: "")');break;case"element":if(0===options.length)return this.error("element option missing required element tag name");if(""===(elTag=options.shift()))throw new Error('element option tag name must be non-empty (received: "")');break;case"id":if(0===options.length)return this.error("id option missing required ID");if(""===(elId=options.shift()))throw new Error('id option ID must be non-empty (received: "")');break;case"keep":cursor="keep";break;case"none":cursor="none";break;case"skipkey":if(0===options.length)return this.error("skipkey option missing required key value");if(""===(skipKey=options.shift()))throw new Error('skipkey option key value must be non-empty (received: "")');break;case"start":if(0===options.length)return this.error("start option missing required time value");var value=options.shift();if((start=Util.fromCssTime(value))<0)throw new Error("start option time value must be non-negative (received: ".concat(value,")"));break;default:return this.error("unknown option: ".concat(option))}}var contents=this.payload[0].contents;if(""!==contents.trim()){Config.debug&&this.debugView.modes({block:!0});var className="macro-".concat(this.name),namespace=".".concat(className),$target=jQuery(document.createElement(elTag)).addClass("".concat(className," ").concat(className,"-target")).appendTo(this.output);TempState.macroTypeQueue||(TempState.macroTypeQueue=[],$(document).off(namespace).one(":passageinit".concat(namespace),(function(){return $(document).off(namespace)})));var startTyping=0===TempState.macroTypeQueue.length,selfId=++this.self.typeId;TempState.macroTypeQueue.push({id:selfId,handler:function(){var $wrapper=jQuery(document.createElement(elTag)).addClass(className);elId&&$wrapper.attr("id",elId),elClass&&$wrapper.addClass(elClass),new Wikifier($wrapper,contents);var passage=State.passage,turn=State.turns;if(!Config.macros.typeVisitedPassages&&State.passages.slice(0,-1).some((function(title){return title===passage}))||$wrapper.find(".error").length>0)return $target.replaceWith($wrapper),TempState.macroTypeQueue.shift(),void(TempState.macroTypeQueue.length>0&&TempState.macroTypeQueue.first().handler());var typer=new NodeTyper({targetNode:$wrapper.get(0),classNames:"none"===cursor?null:"".concat(className,"-cursor")});$target.replaceWith($wrapper);var keydownAndNS="keydown".concat(namespace),typingStopAndNS="".concat(":typingstop").concat(namespace);$(document).off(keydownAndNS).on(keydownAndNS,(function(ev){Util.scrubEventKey(ev.key)!==skipKey||ev.target!==document.body&&ev.target!==document.documentElement||(ev.preventDefault(),$(document).off(keydownAndNS),typer.finish())})).one(typingStopAndNS,(function(){TempState.macroTypeQueue&&(0===TempState.macroTypeQueue.length?jQuery.event.trigger(":typingcomplete"):TempState.macroTypeQueue.first().handler())}));var typeNode=function(){var typeNodeMember=function(typeIntervalId){State.passage===passage&&State.turns===turn&&typer.type()||(typeIntervalId&&clearInterval(typeIntervalId),TempState.macroTypeQueue&&TempState.macroTypeQueue.length>0&&TempState.macroTypeQueue.first().id===selfId&&TempState.macroTypeQueue.shift(),$wrapper.trigger(":typingstop"),$wrapper.addClass("".concat(className,"-done")),"keep"===cursor&&$wrapper.addClass("".concat(className,"-cursor")))};$wrapper.trigger(":typingstart"),typeNodeMember();var typeNodeMemberId=setInterval((function(){return typeNodeMember(typeNodeMemberId)}),speed)};start?setTimeout(typeNode,start):typeNode()}}),startTyping&&(Engine.isPlaying()?$(document).one(":passageend".concat(namespace),(function(){return TempState.macroTypeQueue.first().handler()})):TempState.macroTypeQueue.first().handler())}}}),Macro.add("display","include"),Macro.add("if",{skipArgs:!0,tags:["elseif","else"],elseifWsRe:/^\s*if\b/i,ifAssignRe:/[^!=&^|<>*/%+-]=[^=>]/,handler:function(){var i;try{var len=this.payload.length,elseifWsRe=this.self.elseifWsRe,ifAssignRe=this.self.ifAssignRe;for(i=0;i<len;++i)if("else"===this.payload[i].name){if(this.payload[i].args.raw.length>0)return elseifWsRe.test(this.payload[i].args.raw)?this.error('whitespace is not allowed between the "else" and "if" in <<elseif>> clause'.concat(i>0?" (#"+i+")":"")):this.error("<<else>> does not accept a conditional expression (perhaps you meant to use <<elseif>>), invalid: ".concat(this.payload[i].args.raw));if(i+1!==len)return this.error("<<else>> must be the final clause")}else{if(0===this.payload[i].args.full.length)return this.error("no conditional expression specified for <<".concat(this.payload[i].name,">> clause").concat(i>0?" (#"+i+")":""));if(Config.macros.ifAssignmentError&&ifAssignRe.test(this.payload[i].args.full))return this.error("assignment operator found within <<".concat(this.payload[i].name,">> clause").concat(i>0?" (#"+i+")":""," (perhaps you meant to use an equality operator: ==, ===, eq, is), invalid: ").concat(this.payload[i].args.raw))}var evalJavaScript=Scripting.evalJavaScript,success=!1;for(i=0;i<len;++i){if(Config.debug&&this.createDebugView(this.payload[i].name,this.payload[i].source).modes({nonvoid:!1}),"else"===this.payload[i].name||evalJavaScript(this.payload[i].args.full)){success=!0,new Wikifier(this.output,this.payload[i].contents);break}Config.debug&&this.debugView.modes({hidden:!0,invalid:!0})}if(Config.debug){for(++i;i<len;++i)this.createDebugView(this.payload[i].name,this.payload[i].source).modes({nonvoid:!1,hidden:!0,invalid:!0});this.createDebugView("/".concat(this.name),"<</".concat(this.name,">>")).modes({nonvoid:!1,hidden:!success,invalid:!success})}}catch(ex){return this.error("bad conditional expression in <<".concat(0===i?"if":"elseif",">> clause").concat(i>0?" (#"+i+")":"",": ").concat("object"===_typeof(ex)?ex.message:ex))}}}),Macro.add("switch",{skipArgs:["switch"],tags:["case","default"],handler:function(){if(0===this.args.full.length)return this.error("no expression specified");var i,result,len=this.payload.length;if(1===len)return this.error("no cases specified");for(i=1;i<len;++i)if("default"===this.payload[i].name){if(this.payload[i].args.length>0)return this.error("<<default>> does not accept values, invalid: ".concat(this.payload[i].args.raw));if(i+1!==len)return this.error("<<default>> must be the final case")}else if(0===this.payload[i].args.length)return this.error("no value(s) specified for <<".concat(this.payload[i].name,">> (#").concat(i,")"));try{result=Scripting.evalJavaScript(this.args.full)}catch(ex){return this.error("bad evaluation: ".concat("object"===_typeof(ex)?ex.message:ex))}var debugView=this.debugView,success=!1;for(Config.debug&&debugView.modes({nonvoid:!1,hidden:!0}),i=1;i<len;++i){if(Config.debug&&this.createDebugView(this.payload[i].name,this.payload[i].source).modes({nonvoid:!1}),"default"===this.payload[i].name||this.payload[i].args.some((function(val){return val===result}))){success=!0,new Wikifier(this.output,this.payload[i].contents);break}Config.debug&&this.debugView.modes({hidden:!0,invalid:!0})}if(Config.debug){for(++i;i<len;++i)this.createDebugView(this.payload[i].name,this.payload[i].source).modes({nonvoid:!1,hidden:!0,invalid:!0});debugView.modes({nonvoid:!1,hidden:!0,invalid:!success}),this.createDebugView("/".concat(this.name),"<</".concat(this.name,">>")).modes({nonvoid:!1,hidden:!0,invalid:!success})}}}),Macro.add("for",{skipArgs:!0,tags:null,hasRangeRe:new RegExp("^\\S".concat(Patterns.anyChar,"*?\\s+range\\s+\\S").concat(Patterns.anyChar,"*?$")),rangeRe:new RegExp("^(?:State\\.(variables|temporary)\\.(".concat(Patterns.identifier,")\\s*,\\s*)?State\\.(variables|temporary)\\.(").concat(Patterns.identifier,")\\s+range\\s+(\\S").concat(Patterns.anyChar,"*?)$")),threePartRe:/^([^;]*?)\s*;\s*([^;]*?)\s*;\s*([^;]*?)$/,forInRe:/^\S+\s+in\s+\S+/i,forOfRe:/^\S+\s+of\s+\S+/i,handler:function(){var argsStr=this.args.full.trim(),payload=this.payload[0].contents.replace(/\n$/,"");if(0===argsStr.length)this.self.handleFor.call(this,payload,null,!0,null);else if(this.self.hasRangeRe.test(argsStr)){var parts=argsStr.match(this.self.rangeRe);if(null===parts)return this.error("invalid range form syntax, format: [index ,] value range collection");this.self.handleForRange.call(this,payload,{type:parts[1],name:parts[2]},{type:parts[3],name:parts[4]},parts[5])}else{var init,condition,post;if(-1===argsStr.indexOf(";")){if(this.self.forInRe.test(argsStr))return this.error("invalid syntax, for…in is not supported; see: for…range");if(this.self.forOfRe.test(argsStr))return this.error("invalid syntax, for…of is not supported; see: for…range");condition=argsStr}else{var _parts=argsStr.match(this.self.threePartRe);if(null===_parts)return this.error("invalid 3-part conditional form syntax, format: [init] ; [condition] ; [post]");init=_parts[1],condition=_parts[2].trim(),post=_parts[3],0===condition.length&&(condition=!0)}this.self.handleFor.call(this,payload,init,condition,post)}},handleFor:function(payload,init,condition,post){var evalJavaScript=Scripting.evalJavaScript,first=!0,safety=Config.macros.maxLoopIterations;Config.debug&&this.debugView.modes({block:!0});try{if(TempState.break=null,init)try{evalJavaScript(init)}catch(ex){return this.error("bad init expression: ".concat("object"===_typeof(ex)?ex.message:ex))}for(;evalJavaScript(condition);){if(--safety<0)return this.error("exceeded configured maximum loop iterations (".concat(Config.macros.maxLoopIterations,")"));if(new Wikifier(this.output,first?payload.replace(/^\n/,""):payload),first&&(first=!1),null!=TempState.break)if(1===TempState.break)TempState.break=null;else if(2===TempState.break){TempState.break=null;break}if(post)try{evalJavaScript(post)}catch(ex){return this.error("bad post expression: ".concat("object"===_typeof(ex)?ex.message:ex))}}}catch(ex){return this.error("bad conditional expression: ".concat("object"===_typeof(ex)?ex.message:ex))}finally{TempState.break=null}},handleForRange:function(payload,indexVar,valueVar,rangeExp){var rangeList,first=!0;try{rangeList=this.self.toRangeList(rangeExp)}catch(ex){return this.error(ex.message)}Config.debug&&this.debugView.modes({block:!0});try{TempState.break=null;for(var i=0;i<rangeList.length;++i)if(indexVar.name&&(State[indexVar.type][indexVar.name]=rangeList[i][0]),State[valueVar.type][valueVar.name]=rangeList[i][1],new Wikifier(this.output,first?payload.replace(/^\n/,""):payload),first&&(first=!1),null!=TempState.break)if(1===TempState.break)TempState.break=null;else if(2===TempState.break){TempState.break=null;break}}catch(ex){return this.error("object"===_typeof(ex)?ex.message:ex)}finally{TempState.break=null}},toRangeList:function(rangeExp){var value,list,evalJavaScript=Scripting.evalJavaScript;try{value=evalJavaScript("{"===rangeExp[0]?"(".concat(rangeExp,")"):rangeExp)}catch(ex){if("object"!==_typeof(ex))throw new Error("bad range expression: ".concat(ex));throw ex.message="bad range expression: ".concat(ex.message),ex}switch(_typeof(value)){case"string":list=[];for(var i=0;i<value.length;){var obj=Util.charAndPosAt(value,i);list.push([i,obj.char]),i=1+obj.end}break;case"object":if(Array.isArray(value))list=value.map((function(val,i){return[i,val]}));else if(value instanceof Set)list=_toConsumableArray(value).map((function(val,i){return[i,val]}));else if(value instanceof Map)list=_toConsumableArray(value.entries());else{if("Object"!==Util.toStringTag(value))throw new Error("unsupported range expression type: ".concat(Util.toStringTag(value)));list=Object.keys(value).map((function(key){return[key,value[key]]}))}break;default:throw new Error("unsupported range expression type: ".concat(_typeof(value)))}return list}}),Macro.add(["break","continue"],{skipArgs:!0,handler:function(){if(!this.contextHas((function(ctx){return"for"===ctx.name})))return this.error("must only be used in conjunction with its parent macro <<for>>");TempState.break="continue"===this.name?1:2,Config.debug&&this.debugView.modes({hidden:!0})}}),Macro.add(["button","link"],{isAsync:!0,tags:null,handler:function(){var _this15=this;if(0===this.args.length)return this.error("no ".concat("button"===this.name?"button":"link"," text specified"));var passage,$link=jQuery(document.createElement("button"===this.name?"button":"a"));if("object"===_typeof(this.args[0]))if(this.args[0].isImage){var $image=jQuery(document.createElement("img")).attr("src",this.args[0].source).appendTo($link);$link.addClass("link-image"),this.args[0].hasOwnProperty("passage")&&$image.attr("data-passage",this.args[0].passage),this.args[0].hasOwnProperty("title")&&$image.attr("title",this.args[0].title),this.args[0].hasOwnProperty("align")&&$image.attr("align",this.args[0].align),passage=this.args[0].link}else $link.append(document.createTextNode(this.args[0].text)),passage=this.args[0].link;else $link.wikiWithOptions({profile:"core"},this.args[0]),passage=this.args.length>1?this.args[1]:undefined;null!=passage?($link.attr("data-passage",passage),Story.has(passage)?($link.addClass("link-internal"),Config.addVisitedLinkClass&&State.hasPlayed(passage)&&$link.addClass("link-visited")):$link.addClass("link-broken")):$link.addClass("link-internal"),$link.addClass("macro-".concat(this.name)).ariaClick({namespace:".macros",role:null!=passage?"link":"button",one:null!=passage},this.createShadowWrapper(""!==this.payload[0].contents?function(){return Wikifier.wikifyEval(_this15.payload[0].contents.trim())}:null,null!=passage?function(){return Engine.play(passage)}:null)).appendTo(this.output)}}),Macro.add("checkbox",{isAsync:!0,handler:function(){if(this.args.length<3){var errors=[];return this.args.length<1&&errors.push("variable name"),this.args.length<2&&errors.push("unchecked value"),this.args.length<3&&errors.push("checked value"),this.error("no ".concat(errors.join(" or ")," specified"))}if("string"!=typeof this.args[0])return this.error("variable name argument is not a string");var varName=this.args[0].trim();if("$"!==varName[0]&&"_"!==varName[0])return this.error('variable name "'.concat(this.args[0],'" is missing its sigil ($ or _)'));var varId=Util.slugify(varName),uncheckValue=this.args[1],checkValue=this.args[2],el=document.createElement("input");switch(jQuery(el).attr({id:"".concat(this.name,"-").concat(varId),name:"".concat(this.name,"-").concat(varId),type:"checkbox",tabindex:0}).addClass("macro-".concat(this.name)).on("change.macros",this.createShadowWrapper((function(){State.setVar(varName,this.checked?checkValue:uncheckValue)}))).appendTo(this.output),this.args[3]){case"autocheck":State.getVar(varName)===checkValue?el.checked=!0:State.setVar(varName,uncheckValue);break;case"checked":el.checked=!0,State.setVar(varName,checkValue);break;default:State.setVar(varName,uncheckValue)}}}),Macro.add(["cycle","listbox"],{isAsync:!0,skipArgs:["optionsfrom"],tags:["option","optionsfrom"],handler:function(){var _this16=this;if(0===this.args.length)return this.error("no variable name specified");if("string"!=typeof this.args[0])return this.error("variable name argument is not a string");var varName=this.args[0].trim();if("$"!==varName[0]&&"_"!==varName[0])return this.error('variable name "'.concat(this.args[0],'" is missing its sigil ($ or _)'));var varId=Util.slugify(varName),len=this.payload.length;if(1===len)return this.error("no options specified");for(var config={autoselect:!1,once:!1},i=1;i<this.args.length;++i){var arg=this.args[i];switch(arg){case"once":config.once=!0;break;case"autoselect":config.autoselect=!0;break;default:return this.error("unknown argument: ".concat(arg))}}for(var options=[],tagCount={option:0,optionsfrom:0},selectedIdx=-1,_i5=1;_i5<len;++_i5){var payload=this.payload[_i5];if("option"===payload.name){if(++tagCount.option,0===payload.args.length)return this.error("no arguments specified for <<".concat(payload.name,">> (#").concat(tagCount.option,")"));var option={label:String(payload.args[0])},isSelected=!1;switch(payload.args.length){case 1:option.value=payload.args[0];break;case 2:"selected"===payload.args[1]?(option.value=payload.args[0],isSelected=!0):option.value=payload.args[1];break;default:option.value=payload.args[1],"selected"===payload.args[2]&&(isSelected=!0)}if(options.push(option),isSelected){if(config.autoselect)return this.error("cannot specify both the autoselect and selected keywords");if(-1!==selectedIdx)return this.error("multiple selected keywords specified for <<".concat(payload.name,">> (#").concat(selectedIdx+1," & #").concat(tagCount.option,")"));selectedIdx=options.length-1}}else{var _ret=function(){if(++tagCount.optionsfrom,0===payload.args.full.length)return{v:_this16.error("no expression specified for <<".concat(payload.name,">> (#").concat(tagCount.optionsfrom,")"))};var result=void 0;try{var exp=payload.args.full;result=Scripting.evalJavaScript("{"===exp[0]?"(".concat(exp,")"):exp)}catch(ex){return{v:_this16.error("bad evaluation: ".concat("object"===_typeof(ex)?ex.message:ex))}}if("object"!==_typeof(result)||null===result)return{v:_this16.error("expression must yield a supported collection or generic object (type: ".concat(null===result?"null":_typeof(result),")"))};if(result instanceof Array||result instanceof Set)result.forEach((function(val){return options.push({label:String(val),value:val})}));else if(result instanceof Map)result.forEach((function(val,key){return options.push({label:String(key),value:val})}));else{var oType=Util.toStringTag(result);if("Object"!==oType)return{v:_this16.error("expression must yield a supported collection or generic object (object type: ".concat(oType,")"))};Object.keys(result).forEach((function(key){return options.push({label:key,value:result[key]})}))}}();if("object"===_typeof(_ret))return _ret.v}}if(-1===selectedIdx)if(config.autoselect){var sameValueZero=Util.sameValueZero,curValue=State.getVar(varName),curValueIdx=options.findIndex((function(opt){return sameValueZero(opt.value,curValue)}));selectedIdx=-1===curValueIdx?0:curValueIdx}else selectedIdx=0;if("cycle"===this.name){var lastIdx=options.length-1;if(config.once&&selectedIdx===lastIdx)jQuery(this.output).wikiWithOptions({profile:"core"},options[selectedIdx].label);else{var cycleIdx=selectedIdx;jQuery(document.createElement("a")).wikiWithOptions({profile:"core"},options[selectedIdx].label).attr("id","".concat(this.name,"-").concat(varId)).addClass("macro-".concat(this.name)).ariaClick({namespace:".macros",role:"button"},this.createShadowWrapper((function(){var $this=$(this);cycleIdx=(cycleIdx+1)%options.length,State.setVar(varName,options[cycleIdx].value),$this.empty().wikiWithOptions({profile:"core"},options[cycleIdx].label),config.once&&cycleIdx===lastIdx&&$this.off().contents().unwrap()}))).appendTo(this.output)}}else{var $select=jQuery(document.createElement("select"));options.forEach((function(opt,i){jQuery(document.createElement("option")).val(i).text(opt.label).appendTo($select)})),$select.attr({id:"".concat(this.name,"-").concat(varId),name:"".concat(this.name,"-").concat(varId),tabindex:0}).addClass("macro-".concat(this.name)).val(selectedIdx).on("change.macros",this.createShadowWrapper((function(){State.setVar(varName,options[Number(this.value)].value)}))).appendTo(this.output)}State.setVar(varName,options[selectedIdx].value)}}),Macro.add(["linkappend","linkprepend","linkreplace"],{isAsync:!0,tags:null,t8nRe:/^(?:transition|t8n)$/,handler:function(){var _this17=this;if(0===this.args.length)return this.error("no link text specified");var $link=jQuery(document.createElement("a")),$insert=jQuery(document.createElement("span")),transition=this.args.length>1&&this.self.t8nRe.test(this.args[1]);$link.wikiWithOptions({profile:"core"},this.args[0]).addClass("link-internal macro-".concat(this.name)).ariaClick({namespace:".macros",one:!0},this.createShadowWrapper((function(){if("linkreplace"===_this17.name?$link.remove():$link.wrap('<span class="macro-'.concat(_this17.name,'"></span>')).replaceWith((function(){return $link.html()})),""!==_this17.payload[0].contents){var frag=document.createDocumentFragment();new Wikifier(frag,_this17.payload[0].contents),$insert.append(frag)}transition&&setTimeout((function(){return $insert.removeClass("macro-".concat(_this17.name,"-in"))}),Engine.minDomActionDelay)}))).appendTo(this.output),$insert.addClass("macro-".concat(this.name,"-insert")),transition&&$insert.addClass("macro-".concat(this.name,"-in")),"linkprepend"===this.name?$insert.insertBefore($link):$insert.insertAfter($link)}}),Macro.add(["numberbox","textbox"],{isAsync:!0,handler:function(){if(this.args.length<2){var errors=[];return this.args.length<1&&errors.push("variable name"),this.args.length<2&&errors.push("default value"),this.error("no ".concat(errors.join(" or ")," specified"))}if("string"!=typeof this.args[0])return this.error("variable name argument is not a string");var varName=this.args[0].trim();if("$"!==varName[0]&&"_"!==varName[0])return this.error('variable name "'.concat(this.args[0],'" is missing its sigil ($ or _)'));Config.debug&&this.debugView.modes({block:!0});var asNumber="numberbox"===this.name,defaultValue=asNumber?Number(this.args[1]):this.args[1];if(asNumber&&Number.isNaN(defaultValue))return this.error('default value "'.concat(this.args[1],'" is neither a number nor can it be parsed into a number'));var passage,varId=Util.slugify(varName),el=document.createElement("input"),autofocus=!1;this.args.length>3?(passage=this.args[2],autofocus="autofocus"===this.args[3]):this.args.length>2&&("autofocus"===this.args[2]?autofocus=!0:passage=this.args[2]),"object"===_typeof(passage)&&(passage=passage.link),jQuery(el).attr({id:"".concat(this.name,"-").concat(varId),name:"".concat(this.name,"-").concat(varId),type:asNumber?"number":"text",inputmode:asNumber?"decimal":"text",tabindex:0}).addClass("macro-".concat(this.name)).on("change.macros",this.createShadowWrapper((function(){State.setVar(varName,asNumber?Number(this.value):this.value)}))).on("keypress.macros",this.createShadowWrapper((function(ev){13===ev.which&&(ev.preventDefault(),State.setVar(varName,asNumber?Number(this.value):this.value),null!=passage&&Engine.play(passage))}))).appendTo(this.output),asNumber&&(el.step="any"),State.setVar(varName,defaultValue),el.value=defaultValue,autofocus&&(el.setAttribute("autofocus","autofocus"),postdisplay["#autofocus:".concat(el.id)]=function(task){delete postdisplay[task],setTimeout((function(){return el.focus()}),Engine.minDomActionDelay)})}}),Macro.add("radiobutton",{isAsync:!0,handler:function(){if(this.args.length<2){var errors=[];return this.args.length<1&&errors.push("variable name"),this.args.length<2&&errors.push("checked value"),this.error("no ".concat(errors.join(" or ")," specified"))}if("string"!=typeof this.args[0])return this.error("variable name argument is not a string");var varName=this.args[0].trim();if("$"!==varName[0]&&"_"!==varName[0])return this.error('variable name "'.concat(this.args[0],'" is missing its sigil ($ or _)'));var varId=Util.slugify(varName),checkValue=this.args[1],el=document.createElement("input");switch(TempState.hasOwnProperty(this.name)||(TempState[this.name]={}),TempState[this.name].hasOwnProperty(varId)||(TempState[this.name][varId]=0),jQuery(el).attr({id:"".concat(this.name,"-").concat(varId,"-").concat(TempState[this.name][varId]++),name:"".concat(this.name,"-").concat(varId),type:"radio",tabindex:0}).addClass("macro-".concat(this.name)).on("change.macros",this.createShadowWrapper((function(){this.checked&&State.setVar(varName,checkValue)}))).appendTo(this.output),this.args[2]){case"autocheck":State.getVar(varName)===checkValue&&(el.checked=!0);break;case"checked":el.checked=!0,State.setVar(varName,checkValue)}}}),Macro.add("textarea",{isAsync:!0,handler:function(){if(this.args.length<2){var errors=[];return this.args.length<1&&errors.push("variable name"),this.args.length<2&&errors.push("default value"),this.error("no ".concat(errors.join(" or ")," specified"))}if("string"!=typeof this.args[0])return this.error("variable name argument is not a string");var varName=this.args[0].trim();if("$"!==varName[0]&&"_"!==varName[0])return this.error('variable name "'.concat(this.args[0],'" is missing its sigil ($ or _)'));Config.debug&&this.debugView.modes({block:!0});var varId=Util.slugify(varName),defaultValue=this.args[1],autofocus="autofocus"===this.args[2],el=document.createElement("textarea");jQuery(el).attr({id:"".concat(this.name,"-").concat(varId),name:"".concat(this.name,"-").concat(varId),rows:4,tabindex:0}).addClass("macro-".concat(this.name)).on("change.macros",this.createShadowWrapper((function(){State.setVar(varName,this.value)}))).appendTo(this.output),State.setVar(varName,defaultValue),el.textContent=defaultValue,autofocus&&(el.setAttribute("autofocus","autofocus"),postdisplay["#autofocus:".concat(el.id)]=function(task){delete postdisplay[task],setTimeout((function(){return el.focus()}),Engine.minDomActionDelay)})}}),Macro.add("click","link"),Macro.add("actions",{handler:function(){for(var $list=jQuery(document.createElement("ul")).addClass(this.name).appendTo(this.output),i=0;i<this.args.length;++i){var passage=void 0,text=void 0,$image=void 0,setFn=void 0;if("object"===_typeof(this.args[i])?this.args[i].isImage?($image=jQuery(document.createElement("img")).attr("src",this.args[i].source),this.args[i].hasOwnProperty("passage")&&$image.attr("data-passage",this.args[i].passage),this.args[i].hasOwnProperty("title")&&$image.attr("title",this.args[i].title),this.args[i].hasOwnProperty("align")&&$image.attr("align",this.args[i].align),passage=this.args[i].link,setFn=this.args[i].setFn):(text=this.args[i].text,passage=this.args[i].link,setFn=this.args[i].setFn):text=passage=this.args[i],!(State.variables.hasOwnProperty("#actions")&&State.variables["#actions"].hasOwnProperty(passage)&&State.variables["#actions"][passage])){var $link=jQuery(Wikifier.createInternalLink(jQuery(document.createElement("li")).appendTo($list),passage,null,function(passage,fn){return function(){State.variables.hasOwnProperty("#actions")||(State.variables["#actions"]={}),State.variables["#actions"][passage]=!0,"function"==typeof fn&&fn()}}(passage,setFn))).addClass("macro-".concat(this.name)).append($image||document.createTextNode(text));$image&&$link.addClass("link-image")}}}}),Macro.add(["back","return"],{handler:function(){if(this.args.length>1)return this.error("too many arguments specified, check the documentation for details");var passage,text,$image,$link,momentIndex=-1;if(1===this.args.length&&("object"===_typeof(this.args[0])?this.args[0].isImage?($image=jQuery(document.createElement("img")).attr("src",this.args[0].source),this.args[0].hasOwnProperty("passage")&&$image.attr("data-passage",this.args[0].passage),this.args[0].hasOwnProperty("title")&&$image.attr("title",this.args[0].title),this.args[0].hasOwnProperty("align")&&$image.attr("align",this.args[0].align),this.args[0].hasOwnProperty("link")&&(passage=this.args[0].link)):(1===this.args[0].count||(text=this.args[0].text),passage=this.args[0].link):1===this.args.length&&(text=this.args[0])),null==passage){for(var i=State.length-2;i>=0;--i)if(State.history[i].title!==State.passage){momentIndex=i,passage=State.history[i].title;break}if(null==passage&&"return"===this.name)for(var _i6=State.expired.length-1;_i6>=0;--_i6)if(State.expired[_i6]!==State.passage){passage=State.expired[_i6];break}}else{if(!Story.has(passage))return this.error('passage "'.concat(passage,'" does not exist'));if("back"===this.name){for(var _i7=State.length-2;_i7>=0;--_i7)if(State.history[_i7].title===passage){momentIndex=_i7;break}if(-1===momentIndex)return this.error('cannot find passage "'.concat(passage,'" in the current story history'))}}if(null==passage)return this.error("cannot find passage");"back"!==this.name||-1!==momentIndex?($link=jQuery(document.createElement("a")).addClass("link-internal").ariaClick({one:!0},"return"===this.name?function(){return Engine.play(passage)}:function(){return Engine.goTo(momentIndex)}),$image&&$link.addClass("link-image")):$link=jQuery(document.createElement("span")).addClass("link-disabled"),$link.addClass("macro-".concat(this.name)).append($image||document.createTextNode(text||L10n.get("macro".concat(this.name.toUpperFirst(),"Text")))).appendTo(this.output)}}),Macro.add("choice",{handler:function(){if(0===this.args.length)return this.error("no passage specified");var passage,text,$image,setFn,$link,choiceId=State.passage;if(1===this.args.length?"object"===_typeof(this.args[0])?this.args[0].isImage?($image=jQuery(document.createElement("img")).attr("src",this.args[0].source),this.args[0].hasOwnProperty("passage")&&$image.attr("data-passage",this.args[0].passage),this.args[0].hasOwnProperty("title")&&$image.attr("title",this.args[0].title),this.args[0].hasOwnProperty("align")&&$image.attr("align",this.args[0].align),passage=this.args[0].link,setFn=this.args[0].setFn):(text=this.args[0].text,passage=this.args[0].link,setFn=this.args[0].setFn):text=passage=this.args[0]:(passage=this.args[0],text=this.args[1]),State.variables.hasOwnProperty("#choice")&&State.variables["#choice"].hasOwnProperty(choiceId)&&State.variables["#choice"][choiceId])return $link=jQuery(document.createElement("span")).addClass("link-disabled macro-".concat(this.name)).attr("tabindex",-1).append($image||document.createTextNode(text)).appendTo(this.output),void($image&&$link.addClass("link-image"));$link=jQuery(Wikifier.createInternalLink(this.output,passage,null,(function(){State.variables.hasOwnProperty("#choice")||(State.variables["#choice"]={}),State.variables["#choice"][choiceId]=!0,"function"==typeof setFn&&setFn()}))).addClass("macro-".concat(this.name)).append($image||document.createTextNode(text)),$image&&$link.addClass("link-image")}}),Macro.add(["addclass","toggleclass"],{handler:function(){if(this.args.length<2){var errors=[];return this.args.length<1&&errors.push("selector"),this.args.length<2&&errors.push("class names"),this.error("no ".concat(errors.join(" or ")," specified"))}var $targets=jQuery(this.args[0]);if(0===$targets.length)return this.error('no elements matched the selector "'.concat(this.args[0],'"'));switch(this.name){case"addclass":$targets.addClass(this.args[1].trim());break;case"toggleclass":$targets.toggleClass(this.args[1].trim())}Config.debug&&this.debugView.modes({hidden:!0})}}),Macro.add("removeclass",{handler:function(){if(0===this.args.length)return this.error("no selector specified");var $targets=jQuery(this.args[0]);if(0===$targets.length)return this.error('no elements matched the selector "'.concat(this.args[0],'"'));this.args.length>1?$targets.removeClass(this.args[1].trim()):$targets.removeClass(),Config.debug&&this.debugView.modes({hidden:!0})}}),Macro.add("copy",{handler:function(){if(0===this.args.length)return this.error("no selector specified");var $targets=jQuery(this.args[0]);if(0===$targets.length)return this.error('no elements matched the selector "'.concat(this.args[0],'"'));jQuery(this.output).append($targets.html()),Config.debug&&this.debugView.modes({hidden:!0})}}),Macro.add(["append","prepend","replace"],{tags:null,t8nRe:/^(?:transition|t8n)$/,handler:function(){var _this18=this;if(0===this.args.length)return this.error("no selector specified");var $insert,$targets=jQuery(this.args[0]);if(0===$targets.length)return this.error('no elements matched the selector "'.concat(this.args[0],'"'));if(""!==this.payload[0].contents)switch(this.args.length>1&&this.self.t8nRe.test(this.args[1])?(($insert=jQuery(document.createElement("span"))).addClass("macro-".concat(this.name,"-insert macro-").concat(this.name,"-in")),setTimeout((function(){return $insert.removeClass("macro-".concat(_this18.name,"-in"))}),Engine.minDomActionDelay)):$insert=jQuery(document.createDocumentFragment()),$insert.wiki(this.payload[0].contents),this.name){case"replace":$targets.empty();case"append":$targets.append($insert);break;case"prepend":$targets.prepend($insert)}else"replace"===this.name&&$targets.empty();Config.debug&&this.debugView.modes({hidden:!0})}}),Macro.add("remove",{handler:function(){if(0===this.args.length)return this.error("no selector specified");var $targets=jQuery(this.args[0]);if(0===$targets.length)return this.error('no elements matched the selector "'.concat(this.args[0],'"'));$targets.remove(),Config.debug&&this.debugView.modes({hidden:!0})}}),Has.audio){var errorOnePlaybackAction=function(cur,prev){return'only one playback action allowed per invocation, "'.concat(cur,'" cannot be combined with "').concat(prev,'"')};Macro.add("audio",{handler:function(){if(this.args.length<2){var errors=[];return this.args.length<1&&errors.push("track and/or group IDs"),this.args.length<2&&errors.push("actions"),this.error("no ".concat(errors.join(" or ")," specified"))}var selected;try{selected=SimpleAudio.select(this.args[0])}catch(ex){return this.error(ex.message)}for(var action,fadeTo,loop,mute,passage,time,volume,args=this.args.slice(1),fadeOver=5;args.length>0;){var arg=args.shift(),raw=void 0;switch(arg){case"load":case"pause":case"play":case"stop":case"unload":if(action)return this.error(errorOnePlaybackAction(arg,action));action=arg;break;case"fadein":if(action)return this.error(errorOnePlaybackAction(arg,action));action="fade",fadeTo=1;break;case"fadeout":if(action)return this.error(errorOnePlaybackAction(arg,action));action="fade",fadeTo=0;break;case"fadeto":if(action)return this.error(errorOnePlaybackAction(arg,action));if(0===args.length)return this.error("fadeto missing required level value");if(action="fade",raw=args.shift(),fadeTo=Number.parseFloat(raw),Number.isNaN(fadeTo)||!Number.isFinite(fadeTo))return this.error("cannot parse fadeto: ".concat(raw));break;case"fadeoverto":if(action)return this.error(errorOnePlaybackAction(arg,action));if(args.length<2){var _errors=[];return args.length<1&&_errors.push("seconds"),args.length<2&&_errors.push("level"),this.error("fadeoverto missing required ".concat(_errors.join(" and ")," value").concat(_errors.length>1?"s":""))}if(action="fade",raw=args.shift(),fadeOver=Number.parseFloat(raw),Number.isNaN(fadeOver)||!Number.isFinite(fadeOver))return this.error("cannot parse fadeoverto: ".concat(raw));if(raw=args.shift(),fadeTo=Number.parseFloat(raw),Number.isNaN(fadeTo)||!Number.isFinite(fadeTo))return this.error("cannot parse fadeoverto: ".concat(raw));break;case"volume":if(0===args.length)return this.error("volume missing required level value");if(raw=args.shift(),volume=Number.parseFloat(raw),Number.isNaN(volume)||!Number.isFinite(volume))return this.error("cannot parse volume: ".concat(raw));break;case"mute":case"unmute":mute="mute"===arg;break;case"time":if(0===args.length)return this.error("time missing required seconds value");if(raw=args.shift(),time=Number.parseFloat(raw),Number.isNaN(time)||!Number.isFinite(time))return this.error("cannot parse time: ".concat(raw));break;case"loop":case"unloop":loop="loop"===arg;break;case"goto":if(0===args.length)return this.error("goto missing required passage title");if(raw=args.shift(),passage="object"===_typeof(raw)?raw.link:raw,!Story.has(passage))return this.error('passage "'.concat(passage,'" does not exist'));break;default:return this.error("unknown action: ".concat(arg))}}try{if(null!=volume&&selected.volume(volume),null!=time&&selected.time(time),null!=mute&&selected.mute(mute),null!=loop&&selected.loop(loop),null!=passage){var nsEnded="ended.macros.macro-".concat(this.name,"_goto");selected.off(nsEnded).one(nsEnded,(function(){selected.off(nsEnded),Engine.play(passage)}))}switch(action){case"fade":selected.fade(fadeOver,fadeTo);break;case"load":selected.load();break;case"pause":selected.pause();break;case"play":selected.playWhenAllowed();break;case"stop":selected.stop();break;case"unload":selected.unload()}Config.debug&&this.debugView.modes({hidden:!0})}catch(ex){return this.error("error executing action: ".concat(ex.message))}}}),Macro.add("cacheaudio",{handler:function(){var _this19=this;if(this.args.length<2){var errors=[];return this.args.length<1&&errors.push("track ID"),this.args.length<2&&errors.push("sources"),this.error("no ".concat(errors.join(" or ")," specified"))}var id=String(this.args[0]).trim(),oldFmtRe=/^format:\s*([\w-]+)\s*;\s*/i;try{SimpleAudio.tracks.add(id,this.args.slice(1).map((function(source){if(oldFmtRe.test(source)){if(Config.debug)return _this19.error('track ID "'.concat(id,'": format specifier migration required, "format:formatId;" → "formatId|"'));source=source.replace(oldFmtRe,"$1|")}return source})))}catch(ex){return this.error(ex.message)}if(Config.debug&&!SimpleAudio.tracks.get(id).hasSource())return this.error('track ID "'.concat(id,'": no supported audio sources found'));Config.debug&&this.debugView.modes({hidden:!0})}}),Macro.add("createaudiogroup",{tags:["track"],handler:function(){if(0===this.args.length)return this.error("no group ID specified");if(1===this.payload.length)return this.error("no tracks defined via <<track>>");Config.debug&&this.debugView.modes({nonvoid:!1,hidden:!0});for(var groupId=String(this.args[0]).trim(),trackIds=[],i=1,len=this.payload.length;i<len;++i){if(this.payload[i].args.length<1)return this.error("no track ID specified");trackIds.push(String(this.payload[i].args[0]).trim()),Config.debug&&this.createDebugView(this.payload[i].name,this.payload[i].source).modes({nonvoid:!1,hidden:!0})}try{SimpleAudio.groups.add(groupId,trackIds)}catch(ex){return this.error(ex.message)}Config.debug&&this.createDebugView("/".concat(this.name),"<</".concat(this.name,">>")).modes({nonvoid:!1,hidden:!0})}}),Macro.add("createplaylist",{tags:["track"],handler:function(){if(0===this.args.length)return this.error("no list ID specified");if(1===this.payload.length)return this.error("no tracks defined via <<track>>");var playlist=Macro.get("playlist");if(null!==playlist.from&&"createplaylist"!==playlist.from)return this.error("a playlist has already been defined with <<setplaylist>>");Config.debug&&this.debugView.modes({nonvoid:!1,hidden:!0});for(var listId=String(this.args[0]).trim(),trackObjs=[],i=1,len=this.payload.length;i<len;++i){if(0===this.payload[i].args.length)return this.error("no track ID specified");for(var trackObj={id:String(this.payload[i].args[0]).trim()},args=this.payload[i].args.slice(1);args.length>0;){var arg=args.shift(),raw=void 0,parsed=void 0;switch(arg){case"copy":case"own":trackObj.own=!0;break;case"rate":args.length>0&&args.shift();break;case"volume":if(0===args.length)return this.error("volume missing required level value");if(raw=args.shift(),parsed=Number.parseFloat(raw),Number.isNaN(parsed)||!Number.isFinite(parsed))return this.error("cannot parse volume: ".concat(raw));trackObj.volume=parsed;break;default:return this.error("unknown action: ".concat(arg))}}trackObjs.push(trackObj),Config.debug&&this.createDebugView(this.payload[i].name,this.payload[i].source).modes({nonvoid:!1,hidden:!0})}try{SimpleAudio.lists.add(listId,trackObjs)}catch(ex){return this.error(ex.message)}null===playlist.from&&(playlist.from="createplaylist"),Config.debug&&this.createDebugView("/".concat(this.name),"<</".concat(this.name,">>")).modes({nonvoid:!1,hidden:!0})}}),Macro.add("masteraudio",{handler:function(){if(0===this.args.length)return this.error("no actions specified");for(var action,mute,muteOnHide,volume,args=this.args.slice(0);args.length>0;){var arg=args.shift(),raw=void 0;switch(arg){case"load":case"stop":case"unload":if(action)return this.error(errorOnePlaybackAction(arg,action));action=arg;break;case"mute":case"unmute":mute="mute"===arg;break;case"muteonhide":case"nomuteonhide":muteOnHide="muteonhide"===arg;break;case"volume":if(0===args.length)return this.error("volume missing required level value");if(raw=args.shift(),volume=Number.parseFloat(raw),Number.isNaN(volume)||!Number.isFinite(volume))return this.error("cannot parse volume: ".concat(raw));break;default:return this.error("unknown action: ".concat(arg))}}try{switch(null!=mute&&SimpleAudio.mute(mute),null!=muteOnHide&&SimpleAudio.muteOnHidden(muteOnHide),null!=volume&&SimpleAudio.volume(volume),action){case"load":SimpleAudio.load();break;case"stop":SimpleAudio.stop();break;case"unload":SimpleAudio.unload()}Config.debug&&this.debugView.modes({hidden:!0})}catch(ex){return this.error("error executing action: ".concat(ex.message))}}}),Macro.add("playlist",{from:null,handler:function(){var list,args,action,from=this.self.from;if(null===from)return this.error("no playlists have been created");if("createplaylist"===from){if(this.args.length<2){var errors=[];return this.args.length<1&&errors.push("list ID"),this.args.length<2&&errors.push("actions"),this.error("no ".concat(errors.join(" or ")," specified"))}var id=String(this.args[0]).trim();if(!SimpleAudio.lists.has(id))return this.error('playlist "'.concat(id,'" does not exist'));list=SimpleAudio.lists.get(id),args=this.args.slice(1)}else{if(0===this.args.length)return this.error("no actions specified");list=SimpleAudio.lists.get("setplaylist"),args=this.args.slice(0)}for(var fadeTo,loop,mute,shuffle,volume,fadeOver=5;args.length>0;){var arg=args.shift(),raw=void 0;switch(arg){case"load":case"pause":case"play":case"skip":case"stop":case"unload":if(action)return this.error(errorOnePlaybackAction(arg,action));action=arg;break;case"fadein":if(action)return this.error(errorOnePlaybackAction(arg,action));action="fade",fadeTo=1;break;case"fadeout":if(action)return this.error(errorOnePlaybackAction(arg,action));action="fade",fadeTo=0;break;case"fadeto":if(action)return this.error(errorOnePlaybackAction(arg,action));if(0===args.length)return this.error("fadeto missing required level value");if(action="fade",raw=args.shift(),fadeTo=Number.parseFloat(raw),Number.isNaN(fadeTo)||!Number.isFinite(fadeTo))return this.error("cannot parse fadeto: ".concat(raw));break;case"fadeoverto":if(action)return this.error(errorOnePlaybackAction(arg,action));if(args.length<2){var _errors2=[];return args.length<1&&_errors2.push("seconds"),args.length<2&&_errors2.push("level"),this.error("fadeoverto missing required ".concat(_errors2.join(" and ")," value").concat(_errors2.length>1?"s":""))}if(action="fade",raw=args.shift(),fadeOver=Number.parseFloat(raw),Number.isNaN(fadeOver)||!Number.isFinite(fadeOver))return this.error("cannot parse fadeoverto: ".concat(raw));if(raw=args.shift(),fadeTo=Number.parseFloat(raw),Number.isNaN(fadeTo)||!Number.isFinite(fadeTo))return this.error("cannot parse fadeoverto: ".concat(raw));break;case"volume":if(0===args.length)return this.error("volume missing required level value");if(raw=args.shift(),volume=Number.parseFloat(raw),Number.isNaN(volume)||!Number.isFinite(volume))return this.error("cannot parse volume: ".concat(raw));break;case"mute":case"unmute":mute="mute"===arg;break;case"loop":case"unloop":loop="loop"===arg;break;case"shuffle":case"unshuffle":shuffle="shuffle"===arg;break;default:return this.error("unknown action: ".concat(arg))}}try{switch(null!=volume&&list.volume(volume),null!=mute&&list.mute(mute),null!=loop&&list.loop(loop),null!=shuffle&&list.shuffle(shuffle),action){case"fade":list.fade(fadeOver,fadeTo);break;case"load":list.load();break;case"pause":list.pause();break;case"play":list.playWhenAllowed();break;case"skip":list.skip();break;case"stop":list.stop();break;case"unload":list.unload()}Config.debug&&this.debugView.modes({hidden:!0})}catch(ex){return this.error("error executing action: ".concat(ex.message))}}}),Macro.add("removeaudiogroup",{handler:function(){if(0===this.args.length)return this.error("no group ID specified");var id=String(this.args[0]).trim();if(!SimpleAudio.groups.has(id))return this.error('group "'.concat(id,'" does not exist'));SimpleAudio.groups.delete(id),Config.debug&&this.debugView.modes({hidden:!0})}}),Macro.add("removeplaylist",{handler:function(){if(0===this.args.length)return this.error("no list ID specified");var id=String(this.args[0]).trim();if(!SimpleAudio.lists.has(id))return this.error('playlist "'.concat(id,'" does not exist'));SimpleAudio.lists.delete(id),Config.debug&&this.debugView.modes({hidden:!0})}}),Macro.add("waitforaudio",{skipArgs:!0,handler:function(){SimpleAudio.loadWithScreen()}}),Macro.add("setplaylist",{handler:function(){if(0===this.args.length)return this.error("no track ID(s) specified");var playlist=Macro.get("playlist");if(null!==playlist.from&&"setplaylist"!==playlist.from)return this.error("playlists have already been defined with <<createplaylist>>");try{SimpleAudio.lists.add("setplaylist",this.args.slice(0))}catch(ex){return this.error(ex.message)}null===playlist.from&&(playlist.from="setplaylist"),Config.debug&&this.debugView.modes({hidden:!0})}}),Macro.add("stopallaudio",{skipArgs:!0,handler:function(){SimpleAudio.select(":all").stop(),Config.debug&&this.debugView.modes({hidden:!0})}})}else Macro.add(["audio","cacheaudio","createaudiogroup","createplaylist","masteraudio","playlist","removeaudiogroup","removeplaylist","waitforaudio","setplaylist","stopallaudio"],{skipArgs:!0,handler:function(){Config.debug&&this.debugView.modes({hidden:!0})}});Macro.add("done",{skipArgs:!0,tags:null,handler:function(){var contents=this.payload[0].contents.trim();""!==contents&&setTimeout(this.createShadowWrapper((function(){return $.wiki(contents)})),Engine.minDomActionDelay)}}),Macro.add("goto",{handler:function(){return 0===this.args.length?this.error("no passage specified"):(passage="object"===_typeof(this.args[0])?this.args[0].link:this.args[0],Story.has(passage)?void setTimeout((function(){return Engine.play(passage)}),Engine.minDomActionDelay):this.error('passage "'.concat(passage,'" does not exist')));var passage}}),Macro.add("repeat",{isAsync:!0,tags:null,timers:new Set,t8nRe:/^(?:transition|t8n)$/,handler:function(){var delay,_this20=this;if(0===this.args.length)return this.error("no time value specified");try{delay=Math.max(Engine.minDomActionDelay,Util.fromCssTime(this.args[0]))}catch(ex){return this.error(ex.message)}Config.debug&&this.debugView.modes({block:!0});var transition=this.args.length>1&&this.self.t8nRe.test(this.args[1]),$wrapper=jQuery(document.createElement("span")).addClass("macro-".concat(this.name)).appendTo(this.output);this.self.registerInterval(this.createShadowWrapper((function(){var frag=document.createDocumentFragment();new Wikifier(frag,_this20.payload[0].contents);var $output=$wrapper;transition&&($output=jQuery(document.createElement("span")).addClass("macro-repeat-insert macro-repeat-in").appendTo($output)),$output.append(frag),transition&&setTimeout((function(){return $output.removeClass("macro-repeat-in")}),Engine.minDomActionDelay)})),delay)},registerInterval:function(callback,delay){var _this21=this;if("function"!=typeof callback)throw new TypeError("callback parameter must be a function");var passage=State.passage,turn=State.turns,timers=this.timers,timerId=null;timerId=setInterval((function(){if(State.passage!==passage||State.turns!==turn)return clearInterval(timerId),void timers.delete(timerId);var timerIdCache;try{TempState.break=null,TempState.hasOwnProperty("repeatTimerId")&&(timerIdCache=TempState.repeatTimerId),TempState.repeatTimerId=timerId,callback.call(_this21)}finally{void 0!==timerIdCache?TempState.repeatTimerId=timerIdCache:delete TempState.repeatTimerId,TempState.break=null}}),delay),timers.add(timerId),prehistory.hasOwnProperty("#repeat-timers-cleanup")||(prehistory["#repeat-timers-cleanup"]=function(task){delete prehistory[task],timers.forEach((function(timerId){return clearInterval(timerId)})),timers.clear()})}}),Macro.add("stop",{skipArgs:!0,handler:function(){if(!TempState.hasOwnProperty("repeatTimerId"))return this.error("must only be used in conjunction with its parent macro <<repeat>>");var timers=Macro.get("repeat").timers,timerId=TempState.repeatTimerId;clearInterval(timerId),timers.delete(timerId),TempState.break=2,Config.debug&&this.debugView.modes({hidden:!0})}}),Macro.add("timed",{isAsync:!0,tags:["next"],timers:new Set,t8nRe:/^(?:transition|t8n)$/,handler:function(){if(0===this.args.length)return this.error("no time value specified in <<timed>>");var i,items=[];try{items.push({name:this.name,source:this.source,delay:Math.max(Engine.minDomActionDelay,Util.fromCssTime(this.args[0])),content:this.payload[0].contents})}catch(ex){return this.error("".concat(ex.message," in <<timed>>"))}if(this.payload.length>1)try{var len;for(i=1,len=this.payload.length;i<len;++i)items.push({name:this.payload[i].name,source:this.payload[i].source,delay:0===this.payload[i].args.length?items[items.length-1].delay:Math.max(Engine.minDomActionDelay,Util.fromCssTime(this.payload[i].args[0])),content:this.payload[i].contents})}catch(ex){return this.error("".concat(ex.message," in <<next>> (#").concat(i,")"))}Config.debug&&this.debugView.modes({block:!0});var transition=this.args.length>1&&this.self.t8nRe.test(this.args[1]),$wrapper=jQuery(document.createElement("span")).addClass("macro-".concat(this.name)).appendTo(this.output);this.self.registerTimeout(this.createShadowWrapper((function(item){var frag=document.createDocumentFragment();new Wikifier(frag,item.content);var $output=$wrapper;Config.debug&&"next"===item.name&&($output=jQuery(new DebugView($output[0],"macro",item.name,item.source).output)),transition&&($output=jQuery(document.createElement("span")).addClass("macro-timed-insert macro-timed-in").appendTo($output)),$output.append(frag),transition&&setTimeout((function(){return $output.removeClass("macro-timed-in")}),Engine.minDomActionDelay)})),items)},registerTimeout:function(callback,items){if("function"!=typeof callback)throw new TypeError("callback parameter must be a function");var passage=State.passage,turn=State.turns,timers=this.timers,timerId=null,nextItem=items.shift();timerId=setTimeout((function worker(){if(timers.delete(timerId),State.passage===passage&&State.turns===turn){var curItem=nextItem;null!=(nextItem=items.shift())&&(timerId=setTimeout(worker,nextItem.delay),timers.add(timerId)),callback.call(this,curItem)}}),nextItem.delay),timers.add(timerId),prehistory.hasOwnProperty("#timed-timers-cleanup")||(prehistory["#timed-timers-cleanup"]=function(task){delete prehistory[task],timers.forEach((function(timerId){return clearTimeout(timerId)})),timers.clear()})}}),Macro.add("widget",{tags:null,handler:function(){if(0===this.args.length)return this.error("no widget name specified");var widgetCode,widgetName=this.args[0],isNonVoid=this.args.length>1&&"container"===this.args[1];if(Macro.has(widgetName)){if(!Macro.get(widgetName).isWidget)return this.error('cannot clobber existing macro "'.concat(widgetName,'"'));Macro.delete(widgetName)}try{var widgetDef={isWidget:!0,handler:(widgetCode=this.payload[0].contents,function(){var shadowStore={};State.temporary.hasOwnProperty("args")&&(shadowStore._args=State.temporary.args),State.temporary.args=_toConsumableArray(this.args),State.temporary.args.raw=this.args.raw,State.temporary.args.full=this.args.full,this.addShadow("_args"),isNonVoid&&(State.temporary.hasOwnProperty("contents")&&(shadowStore._contents=State.temporary.contents),State.temporary.contents=this.payload[0].contents,this.addShadow("_contents")),State.variables.hasOwnProperty("args")&&(shadowStore.$args=State.variables.args),State.variables.args=State.temporary.args,this.addShadow("$args");try{var resFrag=document.createDocumentFragment(),errList=[];if(new Wikifier(resFrag,widgetCode),Array.from(resFrag.querySelectorAll(".error")).forEach((function(errEl){errList.push(errEl.textContent)})),0!==errList.length)return this.error("error".concat(errList.length>1?"s":""," within widget code (").concat(errList.join("; "),")"));this.output.appendChild(resFrag)}catch(ex){return this.error("cannot execute widget: ".concat(ex.message))}finally{shadowStore.hasOwnProperty("_args")?State.temporary.args=shadowStore._args:delete State.temporary.args,isNonVoid&&(shadowStore.hasOwnProperty("_contents")?State.temporary.contents=shadowStore._contents:delete State.temporary.contents),shadowStore.hasOwnProperty("$args")?State.variables.args=shadowStore.$args:delete State.variables.args}})};isNonVoid&&(widgetDef.tags=[]),Macro.add(widgetName,widgetDef),Config.debug&&this.debugView.modes({hidden:!0})}catch(ex){return this.error('cannot create widget macro "'.concat(widgetName,'": ').concat(ex.message))}}})}();var Dialog=function(){var _$overlay=null,_$dialog=null,_$dialogTitle=null,_$dialogBody=null,_lastActive=null,_scrollbarWidth=0,_dialogObserver=null;function dialogClose(ev){return _$dialogBody.trigger(":dialogclosing"),jQuery(document).off(".dialog-close"),_dialogObserver?(_dialogObserver.disconnect(),_dialogObserver=null):_$dialogBody.off(".dialog-resize"),jQuery(window).off(".dialog-resize"),_$dialog.removeClass("open").css({left:"",right:"",top:"",bottom:""}),jQuery("#ui-bar,#story").find("[tabindex=-2]").removeAttr("aria-hidden").attr("tabindex",0),jQuery("body>[tabindex=-3]").removeAttr("aria-hidden").removeAttr("tabindex"),_$overlay.removeClass("open"),jQuery(document.documentElement).removeAttr("data-dialog"),_$dialogTitle.empty(),_$dialogBody.empty().removeClass(),null!==_lastActive&&(jQuery(_lastActive).focus(),_lastActive=null),ev&&ev.data&&"function"==typeof ev.data.closeFn&&ev.data.closeFn(ev),_$dialogBody.trigger(":dialogclose"),_$dialogBody.trigger(":dialogclosed"),Dialog}function dialogIsOpen(classNames){return _$dialog.hasClass("open")&&(!classNames||classNames.splitOrEmpty(/\s+/).every((function(cn){return _$dialogBody.hasClass(cn)})))}function dialogOpen(options,closeFn){_$dialogBody.trigger(":dialogopening");var top=jQuery.extend({top:50},options).top;return dialogIsOpen()||(_lastActive=safeActiveElement()),jQuery(document.documentElement).attr("data-dialog","open"),_$overlay.addClass("open"),null!==_$dialogBody[0].querySelector("img")&&_$dialogBody.imagesLoaded().always((function(){return _resizeHandler({data:{top:top}})})),jQuery("body>:not(script,#store-area,tw-storydata,#ui-bar,#ui-overlay,#ui-dialog)").attr("tabindex",-3).attr("aria-hidden",!0),jQuery("#ui-bar,#story").find("[tabindex]:not([tabindex^=-])").attr("tabindex",-2).attr("aria-hidden",!0),_$dialog.css(_calcPosition(top)).addClass("open").focus(),jQuery(window).on("resize.dialog-resize",null,{top:top},jQuery.throttle(40,_resizeHandler)),Has.mutationObserver?(_dialogObserver=new MutationObserver((function(mutations){for(var i=0;i<mutations.length;++i)if("childList"===mutations[i].type){_resizeHandler({data:{top:top}});break}}))).observe(_$dialogBody[0],{childList:!0,subtree:!0}):_$dialogBody.on("DOMNodeInserted.dialog-resize DOMNodeRemoved.dialog-resize",null,{top:top},jQuery.throttle(40,_resizeHandler)),jQuery(document).one("click.dialog-close",".ui-close",{closeFn:closeFn},(function(ev){dialogClose(ev)})).one("keypress.dialog-close",".ui-close",(function(ev){13!==ev.which&&32!==ev.which||jQuery(this).trigger("click")})),_$dialogBody.trigger(":dialogopen"),_$dialogBody.trigger(":dialogopened"),Dialog}function _calcPosition(topPos){var top=null!=topPos?topPos:50,$parent=jQuery(window),dialogPos={left:"",right:"",top:"",bottom:""};_$dialog.css(dialogPos);var horzSpace=$parent.width()-_$dialog.outerWidth(!0)-1,vertSpace=$parent.height()-_$dialog.outerHeight(!0)-1;return horzSpace<=32+_scrollbarWidth&&(vertSpace-=_scrollbarWidth),vertSpace<=32+_scrollbarWidth&&(horzSpace-=_scrollbarWidth),dialogPos.left=dialogPos.right=horzSpace<=32?16:horzSpace/2>>0,dialogPos.top=vertSpace<=32?dialogPos.bottom=16:vertSpace/2>top?top:dialogPos.bottom=vertSpace/2>>0,Object.keys(dialogPos).forEach((function(key){""!==dialogPos[key]&&(dialogPos[key]+="px")})),dialogPos}function _resizeHandler(ev){var top=ev&&ev.data&&void 0!==ev.data.top?ev.data.top:50;"block"===_$dialog.css("display")&&(_$dialog.css({display:"none"}),_$dialog.css(jQuery.extend({display:""},_calcPosition(top))))}return Object.freeze(Object.defineProperties({},{append:{value:function(){var _$dialogBody2;return(_$dialogBody2=_$dialogBody).append.apply(_$dialogBody2,arguments),Dialog}},body:{value:function(){return _$dialogBody.get(0)}},close:{value:dialogClose},init:{value:function(){if(!document.getElementById("ui-dialog")){_scrollbarWidth=function(){var scrollbarWidth;try{var inner=document.createElement("p"),outer=document.createElement("div");inner.style.width="100%",inner.style.height="200px",outer.style.position="absolute",outer.style.left="0px",outer.style.top="0px",outer.style.width="100px",outer.style.height="100px",outer.style.visibility="hidden",outer.style.overflow="hidden",outer.appendChild(inner),document.body.appendChild(outer);var w1=inner.offsetWidth;outer.style.overflow="auto";var w2=inner.offsetWidth;w1===w2&&(w2=outer.clientWidth),document.body.removeChild(outer),scrollbarWidth=w1-w2}catch(ex){}return scrollbarWidth||17}();var $elems=jQuery(document.createDocumentFragment()).append('<div id="ui-overlay" class="ui-close"></div><div id="ui-dialog" tabindex="0" role="dialog" aria-labelledby="ui-dialog-title"><div id="ui-dialog-titlebar"><h1 id="ui-dialog-title"></h1>'+'<button id="ui-dialog-close" class="ui-close" tabindex="0" aria-label="'.concat(L10n.get("close"),'"></button>')+'</div><div id="ui-dialog-body"></div></div>');_$overlay=jQuery($elems.find("#ui-overlay").get(0)),_$dialog=jQuery($elems.find("#ui-dialog").get(0)),_$dialogTitle=jQuery($elems.find("#ui-dialog-title").get(0)),_$dialogBody=jQuery($elems.find("#ui-dialog-body").get(0)),$elems.insertBefore("body>script#script-sugarcube")}}},isOpen:{value:dialogIsOpen},open:{value:dialogOpen},resize:{value:function(data){return _resizeHandler("object"===_typeof(data)?{data:data}:undefined)}},setup:{value:function(title,classNames){return _$dialogBody.empty().removeClass(),null!=classNames&&_$dialogBody.addClass(classNames),_$dialogTitle.empty().append((null!=title?String(title):"")||" "),_$dialogBody.get(0)}},wiki:{value:function(){var _$dialogBody3;return(_$dialogBody3=_$dialogBody).wiki.apply(_$dialogBody3,arguments),Dialog}},addClickHandler:{value:function(targets,options,startFn,doneFn,closeFn){return jQuery(targets).ariaClick((function(ev){ev.preventDefault(),"function"==typeof startFn&&startFn(ev),dialogOpen(options,closeFn),"function"==typeof doneFn&&doneFn(ev)}))}}}))}(),Engine=function(){var States=Util.toEnum({Idle:"idle",Playing:"playing",Rendering:"rendering"}),_initDebugViews=[],_state=States.Idle,_lastPlay=null,_outlinePatch=null,_updating=null;function engineGo(offset){var succeded=State.go(offset);return succeded&&engineShow(),succeded}function engineShow(){return enginePlay(State.passage,!0)}function enginePlay(title,noHistory){var passageReadyOutput,passageDoneOutput,passageTitle=title;if(_state=States.Playing,TempState={},State.clearTemporary(),"function"==typeof Config.navigation.override)try{var overrideTitle=Config.navigation.override(passageTitle);overrideTitle&&(passageTitle=overrideTitle)}catch(ex){}var passage=Story.get(passageTitle);if(jQuery.event.trigger({type:":passageinit",passage:passage}),Object.keys(prehistory).forEach((function(task){"function"==typeof prehistory[task]&&prehistory[task].call(passage,task)})),noHistory||State.create(passage.title),document.body.className&&(document.body.className=""),_lastPlay=Util.now(),Object.keys(predisplay).forEach((function(task){"function"==typeof predisplay[task]&&predisplay[task].call(passage,task)})),Story.has("PassageReady"))try{passageReadyOutput=Wikifier.wikifyEval(Story.get("PassageReady").text)}catch(ex){console.error(ex),Alert.error("PassageReady",ex.message)}_state=States.Rendering;var dataTags=passage.tags.length>0?passage.tags.join(" "):null,passageEl=document.createElement("div");jQuery(passageEl).attr({id:passage.domId,"data-passage":passage.title,"data-tags":dataTags}).addClass("passage ".concat(passage.className)),jQuery(document.body).attr("data-tags",dataTags).addClass(passage.className),jQuery(document.documentElement).attr("data-tags",dataTags),jQuery.event.trigger({type:":passagestart",content:passageEl,passage:passage}),Object.keys(prerender).forEach((function(task){"function"==typeof prerender[task]&&prerender[task].call(passage,passageEl,task)})),Story.has("PassageHeader")&&new Wikifier(passageEl,Story.get("PassageHeader").processText()),passageEl.appendChild(passage.render()),Story.has("PassageFooter")&&new Wikifier(passageEl,Story.get("PassageFooter").processText()),jQuery.event.trigger({type:":passagerender",content:passageEl,passage:passage}),Object.keys(postrender).forEach((function(task){"function"==typeof postrender[task]&&postrender[task].call(passage,passageEl,task)}));var debugView,containerEl=document.getElementById("passages");if(containerEl.hasChildNodes()&&("number"==typeof Config.passages.transitionOut||"string"==typeof Config.passages.transitionOut&&""!==Config.passages.transitionOut&&Has.transitionEndEvent?_toConsumableArray(containerEl.childNodes).forEach((function(outgoing){var $outgoing=jQuery(outgoing);if(outgoing.nodeType===Node.ELEMENT_NODE&&$outgoing.hasClass("passage")){if($outgoing.hasClass("passage-out"))return;$outgoing.attr({id:"out-".concat($outgoing.attr("id")),"aria-live":"off"}).addClass("passage-out"),"string"==typeof Config.passages.transitionOut?$outgoing.on(Has.transitionEndEvent,(function(ev){ev.propertyName===Config.passages.transitionOut&&$outgoing.remove()})):setTimeout((function(){return $outgoing.remove()}),Math.max(40,Config.passages.transitionOut))}else $outgoing.remove()})):jQuery(containerEl).empty()),jQuery(passageEl).addClass("passage-in").appendTo(containerEl),setTimeout((function(){return jQuery(passageEl).removeClass("passage-in")}),40),Story.has("StoryDisplayTitle")?null===_updating&&Config.ui.updateStoryElements||setDisplayTitle(Story.get("StoryDisplayTitle").processText()):Config.passages.displayTitles&&passage.title!==Config.passages.start&&(document.title="".concat(passage.title," | ").concat(Story.title)),window.scroll(0,0),_state=States.Playing,Story.has("PassageDone"))try{passageDoneOutput=Wikifier.wikifyEval(Story.get("PassageDone").text)}catch(ex){console.error(ex),Alert.error("PassageDone",ex.message)}(jQuery.event.trigger({type:":passagedisplay",content:passageEl,passage:passage}),Object.keys(postdisplay).forEach((function(task){"function"==typeof postdisplay[task]&&postdisplay[task].call(passage,task)})),null!==_updating?_updating.forEach((function(pair){jQuery(pair.element).empty(),new Wikifier(pair.element,Story.get(pair.passage).processText().trim())})):Config.ui.updateStoryElements&&UIBar.update(),Config.debug)&&(null!=passageReadyOutput&&((debugView=new DebugView(document.createDocumentFragment(),"special","PassageReady","PassageReady")).modes({hidden:!0}),debugView.append(passageReadyOutput),jQuery(passageEl).prepend(debugView.output)),null!=passageDoneOutput&&((debugView=new DebugView(document.createDocumentFragment(),"special","PassageDone","PassageDone")).modes({hidden:!0}),debugView.append(passageDoneOutput),jQuery(passageEl).append(debugView.output)),1===State.turns&&_initDebugViews.length>0&&jQuery(passageEl).prepend(_initDebugViews));switch(jQuery("#story").find("a[href]:not(.link-external)").addClass("link-external").end().find("a,link,button,input,select,textarea").not("[tabindex]").attr("tabindex",0),_typeof(Config.saves.autosave)){case"boolean":Config.saves.autosave&&Save.autosave.save();break;case"object":passage.tags.some((function(tag){return Config.saves.autosave.includes(tag)}))&&Save.autosave.save();break;case"function":Config.saves.autosave()&&Save.autosave.save()}return jQuery.event.trigger({type:":passageend",content:passageEl,passage:passage}),_state=States.Idle,_lastPlay=Util.now(),passageEl}function _hideOutlines(){_outlinePatch.set("*:focus{outline:none;}")}return Object.freeze(Object.defineProperties({},{States:{value:States},minDomActionDelay:{value:40},init:{value:function(){var _lastOutlineEvent;jQuery("#init-no-js,#init-lacking").remove(),function(){var $elems=jQuery(document.createDocumentFragment()),markup=Story.has("StoryInterface")&&Story.get("StoryInterface").text.trim();if(markup){UIBar.destroy(),jQuery(document.head).find("#style-core-display").remove(),$elems.append(markup);var $passages=$elems.find("#passages");if(0===$passages.length)throw new Error('no element with ID "passages" found within "StoryInterface" special passage');$passages.empty().not("[aria-live]").attr("aria-live","polite").end(),$elems.find("[data-init-passage]").each((function(i,el){if("passages"===el.id)throw new Error('"StoryInterface" element <'.concat(el.nodeName.toLowerCase(),' id="passages"> must not contain a "data-init-passage" content attribute'));var passage=el.getAttribute("data-init-passage").trim();if(el.hasAttribute("data-passage"))throw new Error('"StoryInterface" element <'.concat(el.nodeName.toLowerCase(),' data-init-passage="').concat(passage,'"> must not contain a "data-passage" content attribute'));if(null!==el.firstElementChild)throw new Error('"StoryInterface" element <'.concat(el.nodeName.toLowerCase(),' data-init-passage="').concat(passage,'"> contains child elements'));Story.has(passage)&&jQuery(el).empty().wiki(Story.get(passage).processText().trim())}));var updating=[];$elems.find("[data-passage]").each((function(i,el){if("passages"===el.id)throw new Error('"StoryInterface" element <'.concat(el.nodeName.toLowerCase(),' id="passages"> must not contain a "data-passage" content attribute'));var passage=el.getAttribute("data-passage").trim();if(null!==el.firstElementChild)throw new Error('"StoryInterface" element <'.concat(el.nodeName.toLowerCase(),' data-passage="').concat(passage,'"> contains child elements'));Story.has(passage)&&updating.push({passage:passage,element:el})})),updating.length>0&&(_updating=updating),Config.ui.updateStoryElements=!1}else $elems.append('<div id="story" role="main"><div id="passages" aria-live="polite"></div></div>');$elems.insertBefore("body>script#script-sugarcube")}(),_outlinePatch=new StyleWrapper(jQuery(document.createElement("style")).attr({id:"style-aria-outlines",type:"text/css"}).appendTo(document.head).get(0)),_hideOutlines(),jQuery(document).on("mousedown.aria-outlines keydown.aria-outlines",(function(ev){ev.type!==_lastOutlineEvent&&(_lastOutlineEvent=ev.type,"keydown"===ev.type?_outlinePatch.clear():_hideOutlines())}))}},start:{value:function(){if(Story.getAllInit().forEach((function(passage){try{var debugBuffer=Wikifier.wikifyEval(passage.text);if(Config.debug){var debugView=new DebugView(document.createDocumentFragment(),"special","".concat(passage.title," [init-tagged]"),"".concat(passage.title," [init-tagged]"));debugView.modes({hidden:!0}),debugView.append(debugBuffer),_initDebugViews.push(debugView.output)}}catch(ex){console.error(ex),Alert.error("".concat(passage.title," [init-tagged]"),"object"===_typeof(ex)?ex.message:ex)}})),Story.has("StoryInit"))try{var debugBuffer=Wikifier.wikifyEval(Story.get("StoryInit").text);if(Config.debug){var debugView=new DebugView(document.createDocumentFragment(),"special","StoryInit","StoryInit");debugView.modes({hidden:!0}),debugView.append(debugBuffer),_initDebugViews.push(debugView.output)}}catch(ex){console.error(ex),Alert.error("StoryInit","object"===_typeof(ex)?ex.message:ex)}if(null==Config.passages.start)throw new Error("starting passage not selected");if(!Story.has(Config.passages.start))throw new Error('starting passage ("'.concat(Config.passages.start,'") not found'));if(jQuery(document.documentElement).focus(),State.restore())engineShow();else{var loadStart=!0;switch(_typeof(Config.saves.autoload)){case"boolean":Config.saves.autoload&&Save.autosave.ok()&&Save.autosave.has()&&(loadStart=!Save.autosave.load());break;case"string":"prompt"===Config.saves.autoload&&Save.autosave.ok()&&Save.autosave.has()&&(loadStart=!1,UI.buildAutoload(),Dialog.open());break;case"function":Save.autosave.ok()&&Save.autosave.has()&&Config.saves.autoload()&&(loadStart=!Save.autosave.load())}loadStart&&enginePlay(Config.passages.start)}}},restart:{value:function(){LoadScreen.show(),window.scroll(0,0),State.reset(),jQuery.event.trigger(":enginerestart"),window.location.reload()}},state:{get:function(){return _state}},isIdle:{value:function(){return _state===States.Idle}},isPlaying:{value:function(){return _state!==States.Idle}},isRendering:{value:function(){return _state===States.Rendering}},lastPlay:{get:function(){return _lastPlay}},goTo:{value:function(idx){var succeded=State.goTo(idx);return succeded&&engineShow(),succeded}},go:{value:engineGo},backward:{value:function(){return engineGo(-1)}},forward:{value:function(){return engineGo(1)}},show:{value:engineShow},play:{value:enginePlay},display:{value:function(title,link,option){var noHistory=!1;switch(option){case undefined:break;case"replace":case"back":noHistory=!0;break;default:throw new Error('Engine.display option parameter called with obsolete value "'.concat(option,'"; please notify the developer'))}enginePlay(title,noHistory)}}}))}(),Passage=(_tagsToSkip=/^(?:debug|nobr|passage|widget|twine\..*)$/i,function(){function Passage(title,el){var _this22=this;_classCallCheck(this,Passage),Object.defineProperties(this,{title:{value:Util.unescape(title)},element:{value:el||null},tags:{value:Object.freeze(el&&el.hasAttribute("tags")?Array.from(new Set(el.getAttribute("tags").trim().splitOrEmpty(/\s+/))):[])},_excerpt:{writable:!0,value:null}}),Object.defineProperties(this,{domId:{value:"passage-".concat(Util.slugify(this.title))},classes:{value:Object.freeze(0===this.tags.length?[]:_this22.tags.filter((function(tag){return!_tagsToSkip.test(tag)})).map((function(tag){return Util.slugify(tag)})))}})}return _createClass(Passage,[{key:"className",get:function(){return this.classes.join(" ")}},{key:"text",get:function(){if(null==this.element){var passage=Util.escapeMarkup(this.title),mesg="".concat(L10n.get("errorTitle"),": ").concat(L10n.get("errorNonexistentPassage",{passage:passage}));return'<div class="error-view"><span class="error">'.concat(mesg,"</span></div>")}return this.element.textContent.replace(/\r/g,"")}},{key:"description",value:function(){var descriptions=Config.passages.descriptions;switch(_typeof(descriptions)){case"boolean":if(descriptions)return this.title;break;case"object":if(descriptions.hasOwnProperty(this.title))return descriptions[this.title];break;case"function":var result=descriptions.call(this);if(result)return result}return null===this._excerpt&&(this._excerpt=Passage.getExcerptFromText(this.text)),this._excerpt}},{key:"processText",value:function(){if(null==this.element)return this.text;if(this.tags.includes("Twine.image"))return"[img[".concat(this.text,"]]");var processed=this.text;return Config.passages.onProcess&&(processed=Config.passages.onProcess.call(null,{title:this.title,tags:this.tags,text:processed})),(Config.passages.nobr||this.tags.includes("nobr"))&&(processed=processed.replace(/^\n+|\n+$/g,"").replace(/\n+/g," ")),processed}},{key:"render",value:function(options){var frag=document.createDocumentFragment();return new Wikifier(frag,this.processText(),options),this._excerpt=Passage.getExcerptFromNode(frag),frag}}],[{key:"getExcerptFromNode",value:function(node,count){if(!node.hasChildNodes())return"";var excerpt=node.textContent.trim();if(""!==excerpt){var excerptRe=new RegExp("(\\S+(?:\\s+\\S+){0,".concat(count>0?count-1:7,"})"));excerpt=excerpt.replace(/\s+/g," ").match(excerptRe)}return excerpt?"".concat(excerpt[1],"…"):"…"}},{key:"getExcerptFromText",value:function(text,count){if(""===text)return"";var excerptRe=new RegExp("(\\S+(?:\\s+\\S+){0,".concat(count>0?count-1:7,"})")),excerpt=text.replace(/<<.*?>>/g," ").replace(/<.*?>/g," ").trim().replace(/^\s*\|.*\|.*?$/gm,"").replace(/\[[<>]?img\[[^\]]*\]\]/g,"").replace(/\[\[([^|\]]*?)(?:(?:\||->|<-)[^\]]*)?\]\]/g,"$1").replace(/^\s*!+(.*?)$/gm,"$1").replace(/'{2}|\/{2}|_{2}|@{2}/g,"").trim().replace(/\s+/g," ").match(excerptRe);return excerpt?"".concat(excerpt[1],"…"):"…"}}]),Passage}()),_tagsToSkip,Save=function(){var Type=Util.toEnum({Autosave:"autosave",Disk:"disk",Serialize:"serialize",Slot:"slot"}),_slotsUBound=-1,_onLoadHandlers=new Set,_onSaveHandlers=new Set;function savesObjGet(){var saves=storage.get("saves");return null===saves?{autosave:null,slots:_appendSlots([],Config.saves.slots)}:saves}function savesObjClear(){return storage.delete("saves"),!0}function autosaveOk(){return"cookie"!==storage.name&&void 0!==Config.saves.autosave}function slotsOk(){return"cookie"!==storage.name&&-1!==_slotsUBound}function slotsCount(){if(!slotsOk())return 0;for(var saves=savesObjGet(),count=0,i=0,iend=saves.slots.length;i<iend;++i)null!==saves.slots[i]&&++count;return count}function _appendSlots(array,num){for(var i=0;i<num;++i)array.push(null);return array}function _savesObjIsEmpty(saves){for(var slots=saves.slots,isSlotsEmpty=!0,i=0,iend=slots.length;i<iend;++i)if(null!==slots[i]){isSlotsEmpty=!1;break}return null===saves.autosave&&isSlotsEmpty}function _savesObjSave(saves){return _savesObjIsEmpty(saves)?(storage.delete("saves"),!0):storage.set("saves",saves)}function _savesObjUpdate(saveObj){if(null==saveObj||"object"!==_typeof(saveObj))return!1;var updated=!1;return saveObj.hasOwnProperty("state")&&saveObj.state.hasOwnProperty("delta")&&saveObj.state.hasOwnProperty("index")||(saveObj.hasOwnProperty("data")?(delete saveObj.mode,saveObj.state={delta:State.deltaEncode(saveObj.data)},delete saveObj.data):saveObj.state.hasOwnProperty("delta")?saveObj.state.hasOwnProperty("index")||delete saveObj.state.mode:(delete saveObj.state.mode,saveObj.state.delta=State.deltaEncode(saveObj.state.history),delete saveObj.state.history),saveObj.state.index=saveObj.state.delta.length-1,updated=!0),saveObj.state.hasOwnProperty("rseed")&&(saveObj.state.seed=saveObj.state.rseed,delete saveObj.state.rseed,saveObj.state.delta.forEach((function(_,i,delta){delta[i].hasOwnProperty("rcount")&&(delta[i].pull=delta[i].rcount,delete delta[i].rcount)})),updated=!0),(saveObj.state.hasOwnProperty("expired")&&"number"==typeof saveObj.state.expired||saveObj.state.hasOwnProperty("unique")||saveObj.state.hasOwnProperty("last"))&&(saveObj.state.hasOwnProperty("expired")&&"number"==typeof saveObj.state.expired&&delete saveObj.state.expired,(saveObj.state.hasOwnProperty("unique")||saveObj.state.hasOwnProperty("last"))&&(saveObj.state.expired=[],saveObj.state.hasOwnProperty("unique")&&(saveObj.state.expired.push(saveObj.state.unique),delete saveObj.state.unique),saveObj.state.hasOwnProperty("last")&&(saveObj.state.expired.push(saveObj.state.last),delete saveObj.state.last)),updated=!0),updated}function _marshal(supplemental,details){if(null!=supplemental&&"object"!==_typeof(supplemental))throw new Error("supplemental parameter must be an object");var saveObj=Object.assign({},supplemental,{id:Config.saves.id,state:State.marshalForSave()});return Config.saves.version&&(saveObj.version=Config.saves.version),_onSaveHandlers.forEach((function(fn){return fn(saveObj,details)})),saveObj.state.delta=State.deltaEncode(saveObj.state.history),delete saveObj.state.history,saveObj}function _unmarshal(saveObj){try{if(_savesObjUpdate(saveObj),!saveObj||!saveObj.hasOwnProperty("id")||!saveObj.hasOwnProperty("state"))throw new Error(L10n.get("errorSaveMissingData"));if(saveObj.state.history=State.deltaDecode(saveObj.state.delta),delete saveObj.state.delta,_onLoadHandlers.forEach((function(fn){return fn(saveObj)})),saveObj.id!==Config.saves.id)throw new Error(L10n.get("errorSaveIdMismatch"));State.unmarshalForSave(saveObj.state),Engine.show()}catch(ex){return UI.alert("".concat(ex.message.toUpperFirst(),".</p><p>").concat(L10n.get("aborting"),".")),!1}return!0}return Object.freeze(Object.defineProperties({},{init:{value:function(){if("cookie"===storage.name)return savesObjClear(),Config.saves.autoload=undefined,Config.saves.autosave=undefined,Config.saves.slots=0,!1;var saves=savesObjGet(),updated=!1;Array.isArray(saves)&&(saves={autosave:null,slots:saves},updated=!0),Config.saves.slots!==saves.slots.length&&(Config.saves.slots<saves.slots.length?(saves.slots.reverse(),saves.slots=saves.slots.filter((function(val){return!(null===val&&this.count>0)||(--this.count,!1)}),{count:saves.slots.length-Config.saves.slots}),saves.slots.reverse()):Config.saves.slots>saves.slots.length&&_appendSlots(saves.slots,Config.saves.slots-saves.slots.length),updated=!0),_savesObjUpdate(saves.autosave)&&(updated=!0);for(var i=0;i<saves.slots.length;++i)_savesObjUpdate(saves.slots[i])&&(updated=!0);return _savesObjIsEmpty(saves)&&(storage.delete("saves"),updated=!1),updated&&_savesObjSave(saves),_slotsUBound=saves.slots.length-1,!0}},get:{value:savesObjGet},clear:{value:savesObjClear},ok:{value:function(){return autosaveOk()||slotsOk()}},autosave:{value:Object.freeze(Object.defineProperties({},{ok:{value:autosaveOk},has:{value:function(){return null!==savesObjGet().autosave}},get:{value:function(){return savesObjGet().autosave}},load:{value:function(){var saves=savesObjGet();return null!==saves.autosave&&_unmarshal(saves.autosave)}},save:{value:function(title,metadata){if("function"==typeof Config.saves.isAllowed&&!Config.saves.isAllowed())return!1;var saves=savesObjGet(),supplemental={title:title||Story.get(State.passage).description(),date:Date.now()};return null!=metadata&&(supplemental.metadata=metadata),saves.autosave=_marshal(supplemental,{type:Type.Autosave}),_savesObjSave(saves)}},delete:{value:function(){var saves=savesObjGet();return saves.autosave=null,_savesObjSave(saves)}}}))},slots:{value:Object.freeze(Object.defineProperties({},{ok:{value:slotsOk},length:{get:function(){return _slotsUBound+1}},isEmpty:{value:function(){return 0===slotsCount()}},count:{value:slotsCount},has:{value:function(slot){if(slot<0||slot>_slotsUBound)return!1;var saves=savesObjGet();return!(slot>=saves.slots.length||null===saves.slots[slot])}},get:{value:function(slot){if(slot<0||slot>_slotsUBound)return null;var saves=savesObjGet();return slot>=saves.slots.length?null:saves.slots[slot]}},load:{value:function(slot){if(slot<0||slot>_slotsUBound)return!1;var saves=savesObjGet();return!(slot>=saves.slots.length||null===saves.slots[slot])&&_unmarshal(saves.slots[slot])}},save:{value:function(slot,title,metadata){if("function"==typeof Config.saves.isAllowed&&!Config.saves.isAllowed())return Dialog.isOpen()?$(document).one(":dialogclosed",(function(){return UI.alert(L10n.get("savesDisallowed"))})):UI.alert(L10n.get("savesDisallowed")),!1;if(slot<0||slot>_slotsUBound)return!1;var saves=savesObjGet();if(slot>=saves.slots.length)return!1;var supplemental={title:title||Story.get(State.passage).description(),date:Date.now()};return null!=metadata&&(supplemental.metadata=metadata),saves.slots[slot]=_marshal(supplemental,{type:Type.Slot}),_savesObjSave(saves)}},delete:{value:function(slot){if(slot<0||slot>_slotsUBound)return!1;var saves=savesObjGet();return!(slot>=saves.slots.length)&&(saves.slots[slot]=null,_savesObjSave(saves))}}}))},export:{value:function(filename,metadata){if("function"!=typeof Config.saves.isAllowed||Config.saves.isAllowed()){var str,now,MM,DD,hh,mm,ss,baseName=null==filename?Story.domId:(str=filename,Util.sanitizeFilename(str).replace(/[_\s\u2013\u2014-]+/g,"-")),saveName="".concat(baseName,"-").concat((now=new Date,MM=now.getMonth()+1,DD=now.getDate(),hh=now.getHours(),mm=now.getMinutes(),ss=now.getSeconds(),MM<10&&(MM="0".concat(MM)),DD<10&&(DD="0".concat(DD)),hh<10&&(hh="0".concat(hh)),mm<10&&(mm="0".concat(mm)),ss<10&&(ss="0".concat(ss)),"".concat(now.getFullYear()).concat(MM).concat(DD,"-").concat(hh).concat(mm).concat(ss)),".save"),supplemental=null==metadata?{}:{metadata:metadata},saveObj=LZString.compressToBase64(JSON.stringify(_marshal(supplemental,{type:Type.Disk})));saveAs(new Blob([saveObj],{type:"text/plain;charset=UTF-8"}),saveName)}else Dialog.isOpen()?$(document).one(":dialogclosed",(function(){return UI.alert(L10n.get("savesDisallowed"))})):UI.alert(L10n.get("savesDisallowed"))}},import:{value:function(event){var file=event.target.files[0],reader=new FileReader;jQuery(reader).one("loadend",(function(){if(reader.error){var ex=reader.error;UI.alert("".concat(L10n.get("errorSaveDiskLoadFailed").toUpperFirst()," (").concat(ex.name,": ").concat(ex.message,").</p><p>").concat(L10n.get("aborting"),"."))}else{var saveObj;try{saveObj=JSON.parse(/\.json$/i.test(file.name)||/^\{/.test(reader.result)?reader.result:LZString.decompressFromBase64(reader.result))}catch(ex){}_unmarshal(saveObj)}})),reader.readAsText(file)}},serialize:{value:function(metadata){if("function"==typeof Config.saves.isAllowed&&!Config.saves.isAllowed())return Dialog.isOpen()?$(document).one(":dialogclosed",(function(){return UI.alert(L10n.get("savesDisallowed"))})):UI.alert(L10n.get("savesDisallowed")),null;var supplemental=null==metadata?{}:{metadata:metadata};return LZString.compressToBase64(JSON.stringify(_marshal(supplemental,{type:Type.Serialize})))}},deserialize:{value:function(base64Str){var saveObj;try{saveObj=JSON.parse(LZString.decompressFromBase64(base64Str))}catch(ex){}return _unmarshal(saveObj)?saveObj.metadata:null}},onLoad:{value:Object.freeze(Object.defineProperties({},{add:{value:function(handler){var valueType=Util.getType(handler);if("function"!==valueType)throw new TypeError("Save.onLoad.add handler parameter must be a function (received: ".concat(valueType,")"));_onLoadHandlers.add(handler)}},clear:{value:function(){_onLoadHandlers.clear()}},delete:{value:function(handler){return _onLoadHandlers.delete(handler)}},size:{get:function(){return _onLoadHandlers.size}}}))},onSave:{value:Object.freeze(Object.defineProperties({},{add:{value:function(handler){var valueType=Util.getType(handler);if("function"!==valueType)throw new TypeError("Save.onSave.add handler parameter must be a function (received: ".concat(valueType,")"));_onSaveHandlers.add(handler)}},clear:{value:function(){_onSaveHandlers.clear()}},delete:{value:function(handler){return _onSaveHandlers.delete(handler)}},size:{get:function(){return _onSaveHandlers.size}}}))}}))}(),Setting=function(){var Types=Util.toEnum({Header:0,Toggle:1,List:2,Range:3}),_definitions=[];function settingsCreate(){return Object.create(null)}function settingsSave(){var savedSettings=settingsCreate();return Object.keys(settings).length>0&&_definitions.filter((function(def){return def.type!==Types.Header&&settings[def.name]!==def.default})).forEach((function(def){return savedSettings[def.name]=settings[def.name]})),0===Object.keys(savedSettings).length?(storage.delete("settings"),!0):storage.set("settings",savedSettings)}function settingsLoad(){var defaultSettings=settingsCreate(),loadedSettings=storage.get("settings")||settingsCreate();_definitions.filter((function(def){return def.type!==Types.Header})).forEach((function(def){return defaultSettings[def.name]=def.default})),window.SugarCube.settings=settings=Object.assign(defaultSettings,loadedSettings)}function settingsClear(){return window.SugarCube.settings=settings=settingsCreate(),storage.delete("settings"),!0}function definitionsAdd(type,name,def){if(arguments.length<3){var errors=[];throw arguments.length<1&&errors.push("type"),arguments.length<2&&errors.push("name"),arguments.length<3&&errors.push("definition"),new Error("missing parameters, no ".concat(errors.join(" or ")," specified"))}if("object"!==_typeof(def))throw new TypeError("definition parameter must be an object");if(definitionsHas(name))throw new Error('cannot clobber existing setting "'.concat(name,'"'));var str,pos,definition={type:type,name:name,label:"string"==typeof def.label?def.label.trim():""};if("string"==typeof def.desc){var desc=def.desc.trim();""!==desc&&(definition.desc=desc)}switch(type){case Types.Header:break;case Types.Toggle:definition.default=!!def.default;break;case Types.List:if(!def.hasOwnProperty("list"))throw new Error("no list specified");if(!Array.isArray(def.list))throw new TypeError("list must be an array");if(0===def.list.length)throw new Error("list must not be empty");if(definition.list=Object.freeze(def.list),null==def.default)definition.default=def.list[0];else{var defaultIndex=def.list.indexOf(def.default);if(-1===defaultIndex)throw new Error("list does not contain default");definition.default=def.list[defaultIndex]}break;case Types.Range:if(!def.hasOwnProperty("min"))throw new Error("no min specified");if("number"!=typeof def.min||Number.isNaN(def.min)||!Number.isFinite(def.min))throw new TypeError("min must be a finite number");if(!def.hasOwnProperty("max"))throw new Error("no max specified");if("number"!=typeof def.max||Number.isNaN(def.max)||!Number.isFinite(def.max))throw new TypeError("max must be a finite number");if(!def.hasOwnProperty("step"))throw new Error("no step specified");if("number"!=typeof def.step||Number.isNaN(def.step)||!Number.isFinite(def.step)||def.step<=0)throw new TypeError("step must be a finite number greater than zero");var stepValidate=function(value){if(fracDigits>0){var ma=Number("".concat(def.min,"e").concat(fracDigits)),sa=Number("".concat(def.step,"e").concat(fracDigits)),_va=Number("".concat(value,"e").concat(fracDigits))-ma;return Number("".concat(_va-_va%sa+ma,"e-").concat(fracDigits))}var va=value-def.min;return va-va%def.step+def.min},fracDigits=(str=String(def.step),-1===(pos=str.lastIndexOf("."))?0:str.length-pos-1);if(stepValidate(def.max)!==def.max)throw new RangeError("max (".concat(def.max,") is not a multiple of the step (").concat(def.step,") plus the min (").concat(def.min,")"));if(definition.max=def.max,definition.min=def.min,definition.step=def.step,null==def.default)definition.default=def.max;else{if("number"!=typeof def.default||Number.isNaN(def.default)||!Number.isFinite(def.default))throw new TypeError("default must be a finite number");if(def.default<def.min)throw new RangeError("default (".concat(def.default,") is less than min (").concat(def.min,")"));if(def.default>def.max)throw new RangeError("default (".concat(def.default,") is greater than max (").concat(def.max,")"));definition.default=def.default}break;default:throw new Error("unknown Setting type: ".concat(type))}"function"==typeof def.onInit&&(definition.onInit=Object.freeze(def.onInit)),"function"==typeof def.onChange&&(definition.onChange=Object.freeze(def.onChange)),_definitions.push(Object.freeze(definition))}function definitionsHas(name){return _definitions.some((function(definition){return definition.name===name}))}function definitionsGet(name){return _definitions.find((function(definition){return definition.name===name}))}return Object.freeze(Object.defineProperties({},{Types:{value:Types},init:{value:function(){if(storage.has("options")){var old=storage.get("options");null!==old&&(window.SugarCube.settings=settings=Object.assign(settingsCreate(),old)),settingsSave(),storage.delete("options")}settingsLoad(),_definitions.forEach((function(def){if(def.hasOwnProperty("onInit")){var thisArg={name:def.name,value:settings[def.name],default:def.default};def.hasOwnProperty("list")&&(thisArg.list=def.list),def.onInit.call(thisArg)}}))}},create:{value:settingsCreate},save:{value:settingsSave},load:{value:settingsLoad},clear:{value:settingsClear},reset:{value:function(name){if(0===arguments.length)settingsClear(),settingsLoad();else{if(null==name||!definitionsHas(name))throw new Error('nonexistent setting "'.concat(name,'"'));var def=definitionsGet(name);def.type!==Types.Header&&(settings[name]=def.default)}return settingsSave()}},forEach:{value:function(callback,thisArg){_definitions.forEach(callback,thisArg)}},add:{value:definitionsAdd},addHeader:{value:function(name,desc){definitionsAdd(Types.Header,name,{desc:desc})}},addToggle:{value:function(){for(var _len16=arguments.length,args=new Array(_len16),_key16=0;_key16<_len16;_key16++)args[_key16]=arguments[_key16];definitionsAdd.apply(void 0,[Types.Toggle].concat(args))}},addList:{value:function(){for(var _len17=arguments.length,args=new Array(_len17),_key17=0;_key17<_len17;_key17++)args[_key17]=arguments[_key17];definitionsAdd.apply(void 0,[Types.List].concat(args))}},addRange:{value:function(){for(var _len18=arguments.length,args=new Array(_len18),_key18=0;_key18<_len18;_key18++)args[_key18]=arguments[_key18];definitionsAdd.apply(void 0,[Types.Range].concat(args))}},isEmpty:{value:function(){return 0===_definitions.length}},has:{value:definitionsHas},get:{value:definitionsGet},delete:{value:function definitionsDelete(name){definitionsHas(name)&&delete settings[name];for(var i=0;i<_definitions.length;++i)if(_definitions[i].name===name){_definitions.splice(i,1),definitionsDelete(name);break}}}}))}(),Story=function(){var _passages={},_inits=[],_scripts=[],_styles=[],_widgets=[],_title="",_ifId="",_domId="";function _storySetTitle(rawTitle){if(null==rawTitle)throw new Error("story title must not be null or undefined");var title=Util.unescape(String(rawTitle)).trim();if(""===title)throw new Error("story title must not be empty or consist solely of whitespace");if(document.title=_title=title,""===(_domId=Util.slugify(_title)))if(""!==_ifId)_domId=_ifId;else for(var i=0,len=_title.length;i<len;++i){var _Util$charAndPosAt2=Util.charAndPosAt(_title,i),char=_Util$charAndPosAt2.char,start=_Util$charAndPosAt2.start,end=_Util$charAndPosAt2.end;_domId+=char.codePointAt(0).toString(16),i+=end-start}}return Object.freeze(Object.defineProperties({},{load:{value:function(){var validationCodeTags=["init","widget"],validationNoCodeTagPassages=["PassageDone","PassageFooter","PassageHeader","PassageReady","StoryAuthor","StoryBanner","StoryCaption","StoryInit","StoryMenu","StoryShare","StorySubtitle"];function validateStartingPassage(passage){if(passage.tags.includesAny(validationCodeTags))throw new Error('starting passage "'.concat(passage.title,'" contains special tags; invalid: "').concat(passage.tags.filter((function(tag){return validationCodeTags.includes(tag)})).sort().join('", "'),'"'))}function validateSpecialPassages(passage){if(validationNoCodeTagPassages.includes(passage.title)){for(var _len19=arguments.length,tags=new Array(_len19>1?_len19-1:0),_key19=1;_key19<_len19;_key19++)tags[_key19-1]=arguments[_key19];throw new Error('special passage "'.concat(passage.title,'" contains special tags; invalid: "').concat(tags.sort().join('", "'),'"'))}var codeTags=[].concat(validationCodeTags),foundTags=[];if(passage.tags.forEach((function(tag){codeTags.includes(tag)&&foundTags.push.apply(foundTags,_toConsumableArray(codeTags.delete(tag)))})),foundTags.length>1)throw new Error('passage "'.concat(passage.title,'" contains multiple special tags; invalid: "').concat(foundTags.sort().join('", "'),'"'))}var $storydata=jQuery("tw-storydata"),startNode=$storydata.attr("startnode")||"";Config.passages.start=null,Config.debug=/\bdebug\b/.test($storydata.attr("options")),$storydata.children("style").each((function(i){_styles.push(new Passage("tw-user-style-".concat(i),this))})),$storydata.children("script").each((function(i){_scripts.push(new Passage("tw-user-script-".concat(i),this))})),$storydata.children('tw-passagedata:not([tags~="Twine.private"],[tags~="annotation"])').each((function(){var $this=jQuery(this),pid=$this.attr("pid")||"",passage=new Passage($this.attr("name"),this);pid===startNode&&""!==startNode?(Config.passages.start=passage.title,validateStartingPassage(passage),_passages[passage.title]=passage):passage.tags.includes("init")?(validateSpecialPassages(passage,"init"),_inits.push(passage)):passage.tags.includes("widget")?(validateSpecialPassages(passage,"widget"),_widgets.push(passage)):_passages[passage.title]=passage})),_ifId=$storydata.attr("ifid"),_storySetTitle("未命名故事"),Config.saves.id=Story.domId}},init:{value:function(){var storyStyle;storyStyle=document.createElement("style"),new StyleWrapper(storyStyle).add(_styles.map((function(style){return style.text.trim()})).join("\n")),jQuery(storyStyle).appendTo(document.head).attr({id:"style-story",type:"text/css"});for(var i=0;i<_scripts.length;++i)try{Scripting.evalJavaScript(_scripts[i].text)}catch(ex){console.error(ex),Alert.error(_scripts[i].title,"object"===_typeof(ex)?ex.message:ex)}for(var _i8=0;_i8<_widgets.length;++_i8)try{Wikifier.wikifyEval(_widgets[_i8].processText())}catch(ex){console.error(ex),Alert.error(_widgets[_i8].title,"object"===_typeof(ex)?ex.message:ex)}}},title:{get:function(){return _title}},domId:{get:function(){return _domId}},ifId:{get:function(){return _ifId}},add:{value:function(passage){if(!(passage instanceof Passage))throw new TypeError("Story.add passage parameter must be an instance of Passage");var title=passage.title;return!_passages.hasOwnProperty(title)&&(_passages[title]=passage,!0)}},has:{value:function(title){var type=_typeof(title);switch(type){case"number":case"string":return _passages.hasOwnProperty(String(title));case"undefined":break;case"object":type=null===title?"null":"an object";break;default:type="a ".concat(type)}throw new TypeError("Story.has title parameter cannot be ".concat(type))}},get:{value:function(title){var type=_typeof(title);switch(type){case"number":case"string":var id=String(title);return _passages.hasOwnProperty(id)?_passages[id]:new Passage(id||"(unknown)");case"undefined":break;case"object":type=null===title?"null":"an object";break;default:type="a ".concat(type)}throw new TypeError("Story.get title parameter cannot be ".concat(type))}},getAllInit:{value:function(){return Object.freeze(Array.from(_inits))}},getAllRegular:{value:function(){return Object.freeze(Object.assign({},_passages))}},getAllScript:{value:function(){return Object.freeze(Array.from(_scripts))}},getAllStylesheet:{value:function(){return Object.freeze(Array.from(_styles))}},getAllWidget:{value:function(){return Object.freeze(Array.from(_widgets))}},lookup:{value:function(key,value){var sortKey=arguments.length>2&&arguments[2]!==undefined?arguments[2]:"title",results=[];return Object.keys(_passages).forEach((function(name){var passage=_passages[name];"object"===_typeof(passage[key])&&null!==passage[key]?passage[key]instanceof Array&&passage[key].some((function(m){return Util.sameValueZero(m,value)}))&&results.push(passage):Util.sameValueZero(passage[key],value)&&results.push(passage)})),results.sort((function(a,b){return a[sortKey]==b[sortKey]?0:a[sortKey]<b[sortKey]?-1:1})),results}},lookupWith:{value:function(predicate){var sortKey=arguments.length>1&&arguments[1]!==undefined?arguments[1]:"title";if("function"!=typeof predicate)throw new TypeError("Story.lookupWith predicate parameter must be a function");var results=[];return Object.keys(_passages).forEach((function(name){var passage=_passages[name];predicate(passage)&&results.push(passage)})),results.sort((function(a,b){return a[sortKey]==b[sortKey]?0:a[sortKey]<b[sortKey]?-1:1})),results}}}))}(),UI=function(){function uiAssembleLinkList(passage,listEl){var list=listEl,debugState=Config.debug,cleanState=Config.cleanupWikifierOutput;Config.debug=!1,Config.cleanupWikifierOutput=!1;try{null==list&&(list=document.createElement("ul"));var frag=document.createDocumentFragment();new Wikifier(frag,Story.get(passage).processText().trim());var errors=_toConsumableArray(frag.querySelectorAll(".error")).map((function(errEl){return errEl.textContent.replace(errorPrologRegExp,"")}));if(errors.length>0)throw new Error(errors.join("; "));for(;frag.hasChildNodes();){var node=frag.firstChild;if(node.nodeType===Node.ELEMENT_NODE&&"A"===node.nodeName.toUpperCase()){var li=document.createElement("li");list.appendChild(li),li.appendChild(node)}else frag.removeChild(node)}}finally{Config.cleanupWikifierOutput=cleanState,Config.debug=debugState}return list}function uiOpenAlert(message){jQuery(Dialog.setup(L10n.get("alertTitle"),"alert")).append("<p>".concat(message,'</p><ul class="buttons">')+'<li><button id="alert-ok" class="ui-close">'.concat(L10n.get(["alertOk","ok"]),"</button></li>")+"</ul>");for(var _len20=arguments.length,args=new Array(_len20>1?_len20-1:0),_key20=1;_key20<_len20;_key20++)args[_key20-1]=arguments[_key20];Dialog.open.apply(Dialog,args)}function uiBuildAutoload(){return jQuery(Dialog.setup(L10n.get("autoloadTitle"),"autoload")).append("<p>".concat(L10n.get("autoloadPrompt"),'</p><ul class="buttons">')+'<li><button id="autoload-ok" class="ui-close">'.concat(L10n.get(["autoloadOk","ok"]),"</button></li>")+'<li><button id="autoload-cancel" class="ui-close">'.concat(L10n.get(["autoloadCancel","cancel"]),"</button></li>")+"</ul>"),jQuery(document).one("click.autoload",".ui-close",(function(ev){var isAutoloadOk="autoload-ok"===ev.target.id;jQuery(document).one(":dialogclosed",(function(){isAutoloadOk&&Save.autosave.load()||Engine.play(Config.passages.start)}))})),!0}function uiBuildJumpto(){var list=document.createElement("ul");jQuery(Dialog.setup(L10n.get("jumptoTitle"),"jumpto list")).append(list);for(var expired=State.expired.length,i=State.size-1;i>=0;--i)if(i!==State.activeIndex){var passage=Story.get(State.history[i].title);passage&&passage.tags.includes("bookmark")&&jQuery(document.createElement("li")).append(jQuery(document.createElement("a")).ariaClick({one:!0},function(idx){return function(){return jQuery(document).one(":dialogclosed",(function(){return Engine.goTo(idx)}))}}(i)).addClass("ui-close").text("".concat(L10n.get("jumptoTurn")," ").concat(expired+i+1,": ").concat(passage.description()))).appendTo(list)}list.hasChildNodes()||jQuery(list).append("<li><a><em>".concat(L10n.get("jumptoUnavailable"),"</em></a></li>"))}function uiBuildRestart(){return jQuery(Dialog.setup(L10n.get("restartTitle"),"restart")).append("<p>".concat(L10n.get("restartPrompt"),'</p><ul class="buttons">')+'<li><button id="restart-ok">'.concat(L10n.get(["restartOk","ok"]),"</button></li>")+'<li><button id="restart-cancel" class="ui-close">'.concat(L10n.get(["restartCancel","cancel"]),"</button></li>")+"</ul>").find("#restart-ok").ariaClick({one:!0},(function(){jQuery(document).one(":dialogclosed",(function(){return Engine.restart()})),Dialog.close()})),!0}function uiBuildSaves(){var savesAllowed="function"!=typeof Config.saves.isAllowed||Config.saves.isAllowed();function createActionItem(bId,bClass,bText,bAction){var $btn=jQuery(document.createElement("button")).attr("id","saves-".concat(bId)).html(bText);return bClass&&$btn.addClass(bClass),bAction?$btn.ariaClick(bAction):$btn.ariaDisabled(!0),jQuery(document.createElement("li")).append($btn)}var $dialogBody=jQuery(Dialog.setup(L10n.get("savesTitle"),"saves")),savesOk=Save.ok(),fileOk=Has.fileAPI&&(Config.saves.tryDiskOnMobile||!Browser.isMobile.any());if(savesOk&&$dialogBody.append(function(){function createButton(bId,bClass,bText,bSlot,bAction){var $btn=jQuery(document.createElement("button")).attr("id","saves-".concat(bId,"-").concat(bSlot)).addClass(bId).html(bText);return bClass&&$btn.addClass(bClass),bAction?"auto"===bSlot?$btn.ariaClick({label:"".concat(bText," ").concat(L10n.get("savesLabelAuto"))},(function(){return bAction()})):$btn.ariaClick({label:"".concat(bText," ").concat(L10n.get("savesLabelSlot")," ").concat(bSlot+1)},(function(){return bAction(bSlot)})):$btn.ariaDisabled(!0),$btn}var saves=Save.get(),$tbody=jQuery(document.createElement("tbody"));if(Save.autosave.ok()){var $tdSlot=jQuery(document.createElement("td")),$tdLoad=jQuery(document.createElement("td")),$tdDesc=jQuery(document.createElement("td")),$tdDele=jQuery(document.createElement("td"));jQuery(document.createElement("b")).attr({title:L10n.get("savesLabelAuto"),"aria-label":L10n.get("savesLabelAuto")}).text("A").appendTo($tdSlot),saves.autosave?($tdLoad.append(createButton("load","ui-close",L10n.get("savesLabelLoad"),"auto",(function(){jQuery(document).one(":dialogclosed",(function(){return Save.autosave.load()}))}))),jQuery(document.createElement("div")).text(saves.autosave.title).appendTo($tdDesc),jQuery(document.createElement("div")).addClass("datestamp").html(saves.autosave.date?"".concat(new Date(saves.autosave.date).toLocaleString()):"<em>".concat(L10n.get("savesUnknownDate"),"</em>")).appendTo($tdDesc),$tdDele.append(createButton("delete",null,L10n.get("savesLabelDelete"),"auto",(function(){Save.autosave.delete(),uiBuildSaves()})))):($tdLoad.append(createButton("load",null,L10n.get("savesLabelLoad"),"auto")),$tdDesc.addClass("empty").text("•  •  •"),$tdDele.append(createButton("delete",null,L10n.get("savesLabelDelete"),"auto"))),jQuery(document.createElement("tr")).append($tdSlot).append($tdLoad).append($tdDesc).append($tdDele).appendTo($tbody)}for(var i=0,iend=saves.slots.length;i<iend;++i){var _$tdSlot=jQuery(document.createElement("td")),_$tdLoad=jQuery(document.createElement("td")),_$tdDesc=jQuery(document.createElement("td")),_$tdDele=jQuery(document.createElement("td"));_$tdSlot.append(document.createTextNode(i+1)),saves.slots[i]?(_$tdLoad.append(createButton("load","ui-close",L10n.get("savesLabelLoad"),i,(function(slot){jQuery(document).one(":dialogclosed",(function(){return Save.slots.load(slot)}))}))),jQuery(document.createElement("div")).text(saves.slots[i].title).appendTo(_$tdDesc),jQuery(document.createElement("div")).addClass("datestamp").html(saves.slots[i].date?"".concat(new Date(saves.slots[i].date).toLocaleString()):"<em>".concat(L10n.get("savesUnknownDate"),"</em>")).appendTo(_$tdDesc),_$tdDele.append(createButton("delete",null,L10n.get("savesLabelDelete"),i,(function(slot){Save.slots.delete(slot),uiBuildSaves()})))):(_$tdLoad.append(createButton("save","ui-close",L10n.get("savesLabelSave"),i,savesAllowed?Save.slots.save:null)),_$tdDesc.addClass("empty").text("•  •  •"),_$tdDele.append(createButton("delete",null,L10n.get("savesLabelDelete"),i))),jQuery(document.createElement("tr")).append(_$tdSlot).append(_$tdLoad).append(_$tdDesc).append(_$tdDele).appendTo($tbody)}return jQuery(document.createElement("table")).attr("id","saves-list").append($tbody)}()),savesOk||fileOk){var $btnBar=jQuery(document.createElement("ul")).addClass("buttons").appendTo($dialogBody);return fileOk&&($btnBar.append(createActionItem("export","ui-close",L10n.get("savesLabelExport"),savesAllowed?function(){return Save.export()}:null)),$btnBar.append(createActionItem("import",null,L10n.get("savesLabelImport"),(function(){return $dialogBody.find("#saves-import-file").trigger("click")}))),jQuery(document.createElement("input")).css({display:"block",visibility:"hidden",position:"fixed",left:"-9999px",top:"-9999px",width:"1px",height:"1px"}).attr({type:"file",id:"saves-import-file",tabindex:-1,"aria-hidden":!0}).on("change",(function(ev){jQuery(document).one(":dialogclosed",(function(){return Save.import(ev)})),Dialog.close()})).appendTo($dialogBody)),savesOk&&$btnBar.append(createActionItem("clear",null,L10n.get("savesLabelClear"),Save.autosave.has()||!Save.slots.isEmpty()?function(){Save.clear(),uiBuildSaves()}:null)),!0}return uiOpenAlert(L10n.get("savesIncapable")),!1}function uiBuildSettings(){var $dialogBody=jQuery(Dialog.setup(L10n.get("settingsTitle"),"settings"));return Setting.forEach((function(control){if(control.type===Setting.Types.Header){var _name=control.name,_id=Util.slugify(_name),$header=jQuery(document.createElement("div")),$heading=jQuery(document.createElement("h2"));return $header.attr("id","header-body-".concat(_id)).append($heading).appendTo($dialogBody),$heading.attr("id","header-heading-".concat(_id)).wiki(_name),void(control.desc&&jQuery(document.createElement("p")).attr("id","header-desc-".concat(_id)).wiki(control.desc).appendTo($header))}var $control,name=control.name,id=Util.slugify(name),$setting=jQuery(document.createElement("div")),$label=jQuery(document.createElement("label")),$controlBox=jQuery(document.createElement("div"));switch(jQuery(document.createElement("div")).append($label).append($controlBox).appendTo($setting),control.desc&&jQuery(document.createElement("p")).attr("id","setting-desc-".concat(id)).wiki(control.desc).appendTo($setting),$label.attr({id:"setting-label-".concat(id),for:"setting-control-".concat(id)}).wiki(control.label),null==settings[name]&&(settings[name]=control.default),control.type){case Setting.Types.Toggle:$control=jQuery(document.createElement("button")),settings[name]?$control.addClass("enabled").text(L10n.get("settingsOn")):$control.text(L10n.get("settingsOff")),$control.ariaClick((function(){settings[name]?(jQuery(this).removeClass("enabled").text(L10n.get("settingsOff")),settings[name]=!1):(jQuery(this).addClass("enabled").text(L10n.get("settingsOn")),settings[name]=!0),Setting.save(),control.hasOwnProperty("onChange")&&control.onChange.call({name:name,value:settings[name],default:control.default})}));break;case Setting.Types.List:$control=jQuery(document.createElement("select"));for(var i=0,iend=control.list.length;i<iend;++i)jQuery(document.createElement("option")).val(i).text(control.list[i]).appendTo($control);$control.val(control.list.indexOf(settings[name])).attr("tabindex",0).on("change",(function(){settings[name]=control.list[Number(this.value)],Setting.save(),control.hasOwnProperty("onChange")&&control.onChange.call({name:name,value:settings[name],default:control.default,list:control.list})}));break;case Setting.Types.Range:($control=jQuery(document.createElement("input"))).attr({type:"range",min:control.min,max:control.max,step:control.step,value:settings[name],tabindex:0}).on("change input",(function(){settings[name]=Number(this.value),Setting.save(),control.hasOwnProperty("onChange")&&control.onChange.call({name:name,value:settings[name],default:control.default,min:control.min,max:control.max,step:control.step})})).on("keypress",(function(ev){13===ev.which&&(ev.preventDefault(),$control.trigger("change"))}))}$control.attr("id","setting-control-".concat(id)).appendTo($controlBox),$setting.attr("id","setting-body-".concat(id)).appendTo($dialogBody)})),$dialogBody.append('<ul class="buttons">'+'<li><button id="settings-ok" class="ui-close">'.concat(L10n.get(["settingsOk","ok"]),"</button></li>")+'<li><button id="settings-reset">'.concat(L10n.get("settingsReset"),"</button></li>")+"</ul>").find("#settings-reset").ariaClick({one:!0},(function(){jQuery(document).one(":dialogclosed",(function(){Setting.reset(),window.location.reload()})),Dialog.close()})),!0}function uiBuildShare(){try{jQuery(Dialog.setup(L10n.get("shareTitle"),"share list")).append(uiAssembleLinkList("StoryShare"))}catch(ex){return console.error(ex),Alert.error("StoryShare",ex.message),!1}return!0}return Object.freeze(Object.defineProperties({},{assembleLinkList:{value:uiAssembleLinkList},alert:{value:uiOpenAlert},jumpto:{value:function(){uiBuildJumpto(),Dialog.open.apply(Dialog,arguments)}},restart:{value:function(){uiBuildRestart(),Dialog.open.apply(Dialog,arguments)}},saves:{value:function(){uiBuildSaves(),Dialog.open.apply(Dialog,arguments)}},settings:{value:function(){uiBuildSettings(),Dialog.open.apply(Dialog,arguments)}},share:{value:function(){uiBuildShare(),Dialog.open.apply(Dialog,arguments)}},buildAutoload:{value:uiBuildAutoload},buildJumpto:{value:uiBuildJumpto},buildRestart:{value:uiBuildRestart},buildSaves:{value:uiBuildSaves},buildSettings:{value:uiBuildSettings},buildShare:{value:uiBuildShare},stow:{value:function(){return UIBar.stow()}},unstow:{value:function(){return UIBar.unstow()}},setStoryElements:{value:function(){return UIBar.update()}},isOpen:{value:function(){return Dialog.isOpen.apply(Dialog,arguments)}},body:{value:function(){return Dialog.body()}},setup:{value:function(){return Dialog.setup.apply(Dialog,arguments)}},addClickHandler:{value:function(){return Dialog.addClickHandler.apply(Dialog,arguments)}},open:{value:function(){return Dialog.open.apply(Dialog,arguments)}},close:{value:function(){return Dialog.close.apply(Dialog,arguments)}},resize:{value:function(){return Dialog.resize()}},buildDialogAutoload:{value:uiBuildAutoload},buildDialogJumpto:{value:uiBuildJumpto},buildDialogRestart:{value:uiBuildRestart},buildDialogSaves:{value:uiBuildSaves},buildDialogSettings:{value:uiBuildSettings},buildDialogShare:{value:uiBuildShare},buildLinkListFromPassage:{value:uiAssembleLinkList}}))}(),UIBar=function(){var _$uiBar=null;function uiBarStow(noAnimation){var $story;_$uiBar&&!_$uiBar.hasClass("stowed")&&(noAnimation&&(($story=jQuery("#story")).addClass("no-transition"),_$uiBar.addClass("no-transition")),_$uiBar.addClass("stowed"),noAnimation&&setTimeout((function(){$story.removeClass("no-transition"),_$uiBar.removeClass("no-transition")}),Engine.minDomActionDelay));return this}function uiBarUpdate(){if(Story.has("StoryDisplayTitle")&&setDisplayTitle(Story.get("StoryDisplayTitle").processText()),_$uiBar){setPageElement("story-banner","StoryBanner"),setPageElement("story-subtitle","StorySubtitle"),setPageElement("story-author","StoryAuthor"),setPageElement("story-caption","StoryCaption");var menuStory=document.getElementById("menu-story");if(null!==menuStory&&(jQuery(menuStory).empty(),Story.has("StoryMenu")))try{UI.assembleLinkList("StoryMenu",menuStory)}catch(ex){console.error(ex),Alert.error("StoryMenu",ex.message)}}}return Object.freeze(Object.defineProperties({},{destroy:{value:function(){_$uiBar&&(_$uiBar.hide(),jQuery(document).off(".ui-bar"),jQuery(document.head).find("#style-ui-bar").remove(),_$uiBar.remove(),_$uiBar=null)}},hide:{value:function(){return _$uiBar&&_$uiBar.hide(),this}},init:{value:function(){if(!document.getElementById("ui-bar")){var toggleLabel,backwardLabel,jumptoLabel,forwardLabel,$backward,$forward,$elems=(toggleLabel=L10n.get("uiBarToggle"),backwardLabel=L10n.get("uiBarBackward"),jumptoLabel=L10n.get("uiBarJumpto"),forwardLabel=L10n.get("uiBarForward"),jQuery(document.createDocumentFragment()).append('<div id="ui-bar" aria-live="polite"><div id="ui-bar-tray">'+'<button id="ui-bar-toggle" tabindex="0" title="'.concat(toggleLabel,'" aria-label="').concat(toggleLabel,'"></button>')+'<div id="ui-bar-history">'+'<button id="history-backward" tabindex="0" title="'.concat(backwardLabel,'" aria-label="').concat(backwardLabel,'"></button>')+'<button id="history-jumpto" tabindex="0" title="'.concat(jumptoLabel,'" aria-label="').concat(jumptoLabel,'"></button>')+'<button id="history-forward" tabindex="0" title="'.concat(forwardLabel,'" aria-label="').concat(forwardLabel,'"></button>')+'</div></div><div id="ui-bar-body"><header id="title" role="banner"><div id="story-banner"></div><h1 id="story-title"></h1><div id="story-subtitle"></div><div id="story-title-separator"></div><p id="story-author"></p></header><div id="story-caption"></div><nav id="menu" role="navigation"><ul id="menu-story"></ul><ul id="menu-core">'+'<li id="menu-item-saves"><a tabindex="0">'.concat(L10n.get("savesTitle"),"</a></li>")+'<li id="menu-item-settings"><a tabindex="0">'.concat(L10n.get("settingsTitle"),"</a></li>")+'<li id="menu-item-restart"><a tabindex="0">'.concat(L10n.get("restartTitle"),"</a></li>")+'<li id="menu-item-share"><a tabindex="0">'.concat(L10n.get("shareTitle"),"</a></li>")+"</ul></nav></div></div>"));_$uiBar=jQuery($elems.find("#ui-bar").get(0)),$elems.insertBefore("body>script#script-sugarcube"),jQuery(document).on(":historyupdate.ui-bar",($backward=jQuery("#history-backward"),$forward=jQuery("#history-forward"),function(){$backward.ariaDisabled(State.length<2),$forward.ariaDisabled(State.length===State.size)}))}}},isHidden:{value:function(){return _$uiBar&&"none"===_$uiBar.css("display")}},isStowed:{value:function(){return _$uiBar&&_$uiBar.hasClass("stowed")}},show:{value:function(){return _$uiBar&&_$uiBar.show(),this}},start:{value:function(){_$uiBar&&(("boolean"==typeof Config.ui.stowBarInitially?Config.ui.stowBarInitially:jQuery(window).width()<=Config.ui.stowBarInitially)&&uiBarStow(!0),jQuery("#ui-bar-toggle").ariaClick({label:L10n.get("uiBarToggle")},(function(){return _$uiBar.toggleClass("stowed")})),Config.history.controls?(jQuery("#history-backward").ariaDisabled(State.length<2).ariaClick({label:L10n.get("uiBarBackward")},(function(){return Engine.backward()})),Story.lookup("tags","bookmark").length>0?jQuery("#history-jumpto").ariaClick({label:L10n.get("uiBarJumpto")},(function(){return UI.jumpto()})):jQuery("#history-jumpto").remove(),jQuery("#history-forward").ariaDisabled(State.length===State.size).ariaClick({label:L10n.get("uiBarForward")},(function(){return Engine.forward()}))):jQuery("#ui-bar-history").remove(),Story.has("StoryDisplayTitle")?setDisplayTitle(Story.get("StoryDisplayTitle").processText()):jQuery("#story-title").text(Story.title),Story.has("StoryCaption")||jQuery("#story-caption").remove(),Story.has("StoryMenu")||jQuery("#menu-story").remove(),Config.ui.updateStoryElements||uiBarUpdate(),jQuery("#menu-item-saves a").ariaClick({role:"button"},(function(ev){ev.preventDefault(),UI.buildSaves(),Dialog.open()})).text(L10n.get("savesTitle")),Setting.isEmpty()?jQuery("#menu-item-settings").remove():jQuery("#menu-item-settings a").ariaClick({role:"button"},(function(ev){ev.preventDefault(),UI.buildSettings(),Dialog.open()})).text(L10n.get("settingsTitle")),jQuery("#menu-item-restart a").ariaClick({role:"button"},(function(ev){ev.preventDefault(),UI.buildRestart(),Dialog.open()})).text(L10n.get("restartTitle")),Story.has("StoryShare")?jQuery("#menu-item-share a").ariaClick({role:"button"},(function(ev){ev.preventDefault(),UI.buildShare(),Dialog.open()})).text(L10n.get("shareTitle")):jQuery("#menu-item-share").remove())}},stow:{value:uiBarStow},unstow:{value:function(noAnimation){var $story;return _$uiBar&&_$uiBar.hasClass("stowed")&&(noAnimation&&(($story=jQuery("#story")).addClass("no-transition"),_$uiBar.addClass("no-transition")),_$uiBar.removeClass("stowed"),noAnimation&&setTimeout((function(){$story.removeClass("no-transition"),_$uiBar.removeClass("no-transition")}),Engine.minDomActionDelay)),this}},update:{value:uiBarUpdate},setStoryElements:{value:uiBarUpdate}}))}(),DebugBar=function(){var _variableRe=new RegExp("^".concat(Patterns.variable,"$")),_numericKeyRe=/^\d+$/,_watchList=[],_$debugBar=null,_$watchBody=null,_$watchList=null,_$turnSelect=null,_stowed=!0;function debugBarStow(){_$debugBar.css("right","-".concat(_$debugBar.outerWidth(),"px")),_stowed=!0,_updateSession()}function debugBarUnstow(){_$debugBar.css("right",0),_stowed=!1,_updateSession()}function debugBarToggle(){_stowed?debugBarUnstow():debugBarStow()}function debugBarWatchAdd(varName){_variableRe.test(varName)&&(_watchList.pushUnique(varName),_watchList.sort(),_updateWatchBody(),_updateWatchList(),_updateSession())}function debugBarWatchAddAll(){Object.keys(State.variables).map((function(name){return _watchList.pushUnique("$".concat(name))})),Object.keys(State.temporary).map((function(name){return _watchList.pushUnique("_".concat(name))})),_watchList.sort(),_updateWatchBody(),_updateWatchList(),_updateSession()}function debugBarWatchClear(){for(var i=_watchList.length-1;i>=0;--i)_watchList.pop();_updateWatchBody(),_updateWatchList(),_updateSession()}function debugBarWatchDelete(varName){_watchList.delete(varName),_updateWatchBody(),_updateWatchList(),_updateSession()}function debugBarWatchDisable(){_debugBarWatchDisableNoUpdate(),_updateSession()}function debugBarWatchEnable(){_debugBarWatchEnableNoUpdate(),_updateSession()}function debugBarWatchIsEnabled(){return!_$watchBody.attr("hidden")}function debugBarWatchToggle(){_$watchBody.attr("hidden")?debugBarWatchEnable():debugBarWatchDisable()}function _debugBarWatchDisableNoUpdate(){_$watchBody.attr({"aria-hidden":!0,hidden:"hidden"})}function _debugBarWatchEnableNoUpdate(){_$watchBody.removeAttr("aria-hidden hidden")}function _clearSession(){session.delete("debugState")}function _hasSession(){return session.has("debugState")}function _updateSession(){session.set("debugState",{stowed:_stowed,watchList:_watchList,watchEnabled:debugBarWatchIsEnabled(),viewsEnabled:DebugView.isEnabled()})}function _updateWatchBody(){if(0!==_watchList.length){for(var delLabel=L10n.get("debugBarDeleteWatch"),$table=jQuery(document.createElement("table")),$tbody=jQuery(document.createElement("tbody")),_loop4=function(i,len){var varName=_watchList[i],varKey=varName.slice(1),store="$"===varName[0]?State.variables:State.temporary,$row=jQuery(document.createElement("tr")),$delBtn=jQuery(document.createElement("button")),$code=jQuery(document.createElement("code"));$delBtn.addClass("watch-delete").attr("data-name",varName).ariaClick({one:!0,label:delLabel},(function(){return debugBarWatchDelete(varName)})),$code.text(_toWatchString(store[varKey])),jQuery(document.createElement("td")).append($delBtn).appendTo($row),jQuery(document.createElement("td")).text(varName).appendTo($row),jQuery(document.createElement("td")).append($code).appendTo($row),$row.appendTo($tbody)},i=0,len=_watchList.length;i<len;++i)_loop4(i);$table.append($tbody),_$watchBody.empty().append($table)}else _$watchBody.empty().append("<div>".concat(L10n.get("debugBarNoWatches"),"</div>"))}function _updateWatchList(){var svn=Object.keys(State.variables),tvn=Object.keys(State.temporary);if(0!==svn.length||0!==tvn.length){var names=[].concat(_toConsumableArray(svn.map((function(name){return"$".concat(name)}))),_toConsumableArray(tvn.map((function(name){return"_".concat(name)})))).sort(),options=document.createDocumentFragment();names.delete(_watchList);for(var i=0,len=names.length;i<len;++i)jQuery(document.createElement("option")).val(names[i]).appendTo(options);_$watchList.empty().append(options)}else _$watchList.empty()}function _updateTurnSelect(){for(var histLen=State.size,expLen=State.expired.length,options=document.createDocumentFragment(),i=0;i<histLen;++i)jQuery(document.createElement("option")).val(i).text("".concat(expLen+i+1,". ").concat(Util.escape(State.history[i].title))).appendTo(options);_$turnSelect.empty().ariaDisabled(histLen<2).append(options).val(State.activeIndex)}function _toWatchString(value){if(null===value)return"null";switch(_typeof(value)){case"number":if(Number.isNaN(value))return"NaN";if(!Number.isFinite(value))return"Infinity";case"boolean":case"symbol":case"undefined":return String(value);case"string":return JSON.stringify(value);case"function":return"Function"}var objType=Util.toStringTag(value);if("Date"===objType)return"Date {".concat(value.toLocaleString(),"}");if("RegExp"===objType)return"RegExp ".concat(value.toString());var result=[];if(value instanceof Array||value instanceof Set){for(var list=value instanceof Array?value:Array.from(value),i=0,len=list.length;i<len;++i)result.push(list.hasOwnProperty(i)?_toWatchString(list[i]):"<empty>");return Object.keys(list).filter((function(key){return!_numericKeyRe.test(key)})).forEach((function(key){return result.push("".concat(_toWatchString(key),": ").concat(_toWatchString(list[key])))})),"".concat(objType,"(").concat(list.length,") [").concat(result.join(", "),"]")}return value instanceof Map?(value.forEach((function(val,key){return result.push("".concat(_toWatchString(key)," → ").concat(_toWatchString(val)))})),"".concat(objType,"(").concat(value.size,") {").concat(result.join(", "),"}")):(Object.keys(value).forEach((function(key){return result.push("".concat(_toWatchString(key),": ").concat(_toWatchString(value[key])))})),"".concat(objType," {").concat(result.join(", "),"}"))}return Object.freeze(Object.defineProperties({},{init:{value:function(){var barToggleLabel=L10n.get("debugBarToggle"),watchAddLabel=L10n.get("debugBarAddWatch"),watchAllLabel=L10n.get("debugBarWatchAll"),watchNoneLabel=L10n.get("debugBarWatchNone"),watchToggleLabel=L10n.get("debugBarWatchToggle"),viewsToggleLabel=L10n.get("debugBarViewsToggle");jQuery(document.createDocumentFragment()).append('<div id="debug-bar"><div id="debug-bar-watch">'+"<div>".concat(L10n.get("debugBarNoWatches"),"</div>>")+"</div><div>"+'<button id="debug-bar-watch-toggle" tabindex="0" title="'.concat(watchToggleLabel,'" aria-label="').concat(watchToggleLabel,'">').concat(L10n.get("debugBarLabelWatch"),"</button>")+'<label id="debug-bar-watch-label" for="debug-bar-watch-input">'.concat(L10n.get("debugBarLabelAdd"),"</label>")+'<input id="debug-bar-watch-input" name="debug-bar-watch-input" type="text" list="debug-bar-watch-list" tabindex="0"><datalist id="debug-bar-watch-list" aria-hidden="true" hidden="hidden"></datalist>'+'<button id="debug-bar-watch-add" tabindex="0" title="'.concat(watchAddLabel,'" aria-label="').concat(watchAddLabel,'"></button>')+'<button id="debug-bar-watch-all" tabindex="0" title="'.concat(watchAllLabel,'" aria-label="').concat(watchAllLabel,'"></button>')+'<button id="debug-bar-watch-none" tabindex="0" title="'.concat(watchNoneLabel,'" aria-label="').concat(watchNoneLabel,'"></button>')+"</div><div>"+'<button id="debug-bar-views-toggle" tabindex="0" title="'.concat(viewsToggleLabel,'" aria-label="').concat(viewsToggleLabel,'">').concat(L10n.get("debugBarLabelViews"),"</button>")+'<label id="debug-bar-turn-label" for="debug-bar-turn-select">'.concat(L10n.get("debugBarLabelTurn"),"</label>")+'<select id="debug-bar-turn-select" tabindex="0"></select></div>'+'<button id="debug-bar-toggle" tabindex="0" title="'.concat(barToggleLabel,'" aria-label="').concat(barToggleLabel,'"></button>')+'</div><div id="debug-bar-hint"></div>').appendTo("body"),_$debugBar=jQuery("#debug-bar"),_$watchBody=jQuery(_$debugBar.find("#debug-bar-watch").get(0)),_$watchList=jQuery(_$debugBar.find("#debug-bar-watch-list").get(0)),_$turnSelect=jQuery(_$debugBar.find("#debug-bar-turn-select").get(0));var $barToggle=jQuery(_$debugBar.find("#debug-bar-toggle").get(0)),$watchToggle=jQuery(_$debugBar.find("#debug-bar-watch-toggle").get(0)),$watchInput=jQuery(_$debugBar.find("#debug-bar-watch-input").get(0)),$watchAdd=jQuery(_$debugBar.find("#debug-bar-watch-add").get(0)),$watchAll=jQuery(_$debugBar.find("#debug-bar-watch-all").get(0)),$watchNone=jQuery(_$debugBar.find("#debug-bar-watch-none").get(0)),$viewsToggle=jQuery(_$debugBar.find("#debug-bar-views-toggle").get(0));$barToggle.ariaClick(debugBarToggle),$watchToggle.ariaClick(debugBarWatchToggle),$watchInput.on(":addwatch",(function(){debugBarWatchAdd(this.value.trim()),this.value=""})).on("keypress",(function(ev){13===ev.which&&(ev.preventDefault(),$watchInput.trigger(":addwatch"))})),$watchAdd.ariaClick((function(){return $watchInput.trigger(":addwatch")})),$watchAll.ariaClick(debugBarWatchAddAll),$watchNone.ariaClick(debugBarWatchClear),_$turnSelect.on("change",(function(){Engine.goTo(Number(this.value))})),$viewsToggle.ariaClick((function(){DebugView.toggle(),_updateSession()})),jQuery(document).on(":historyupdate.debug-bar",_updateTurnSelect).on(":passageend.debug-bar",(function(){_updateWatchBody(),_updateWatchList()})).on(":enginerestart.debug-bar",_clearSession),_hasSession()||DebugView.enable()}},isStowed:{value:function(){return _stowed}},start:{value:function(){(function(){if(!_hasSession())return!1;var debugState=session.get("debugState");_stowed=debugState.stowed,_watchList.push.apply(_watchList,_toConsumableArray(debugState.watchList)),debugState.watchEnabled?_debugBarWatchEnableNoUpdate():_debugBarWatchDisableNoUpdate();debugState.viewsEnabled?DebugView.enable():DebugView.disable()})(),_stowed?debugBarStow():debugBarUnstow(),_updateTurnSelect(),_updateWatchBody(),_updateWatchList()}},stow:{value:debugBarStow},toggle:{value:debugBarToggle},unstow:{value:debugBarUnstow},watch:{value:Object.freeze(Object.defineProperties({},{add:{value:debugBarWatchAdd},all:{value:debugBarWatchAddAll},clear:{value:debugBarWatchClear},delete:{value:debugBarWatchDelete},disable:{value:debugBarWatchDisable},enable:{value:debugBarWatchEnable},isEnabled:{value:debugBarWatchIsEnabled},toggle:{value:debugBarWatchToggle}}))}}))}(),LoadScreen=function(){var _locks=new Set,_autoId=0;function loadScreenHide(){jQuery(document.documentElement).removeAttr("data-init")}function loadScreenShow(){jQuery(document.documentElement).attr("data-init","loading")}return Object.freeze(Object.defineProperties({},{init:{value:function(){jQuery(document).on("readystatechange.SugarCube",(function(){_locks.size>0||("complete"===document.readyState?"loading"===jQuery(document.documentElement).attr("data-init")&&(Config.loadDelay>0?setTimeout((function(){0===_locks.size&&loadScreenHide()}),Math.max(Engine.minDomActionDelay,Config.loadDelay)):loadScreenHide()):loadScreenShow())}))}},clear:{value:function(){jQuery(document).off("readystatechange.SugarCube"),_locks.clear(),loadScreenHide()}},hide:{value:loadScreenHide},show:{value:loadScreenShow},lock:{value:function(){return++_autoId,_locks.add(_autoId),loadScreenShow(),_autoId}},unlock:{value:function(id){if(null==id)throw new Error("LoadScreen.unlock called with a null or undefined ID");_locks.has(id)&&_locks.delete(id),0===_locks.size&&jQuery(document).trigger("readystatechange")}}}))}(),version=Object.freeze({title:"SugarCube",major:2,minor:36,patch:1,prerelease:null,build:9717,date:new Date("2021-12-22T05:37:33.467Z"),extensions:{},toString:function(){var prerelease=this.prerelease?"-".concat(this.prerelease):"";return"".concat(this.major,".").concat(this.minor,".").concat(this.patch).concat(prerelease,"+").concat(this.build)},short:function(){var prerelease=this.prerelease?"-".concat(this.prerelease):"";return"".concat(this.title," (v").concat(this.major,".").concat(this.minor,".").concat(this.patch).concat(prerelease,")")},long:function(){return"".concat(this.title," v").concat(this.toString()," (").concat(this.date.toUTCString(),")")}}),TempState={},macros={},postdisplay={},postrender={},predisplay={},prehistory={},prerender={},session=null,settings={},setup={},storage=null,browser=Browser,config=Config,has=Has,History=State,state=State,tale=Story,TempVariables=State.temporary;window.SugarCube={},jQuery((function(){try{var lockId=LoadScreen.lock();LoadScreen.init(),document.normalize&&document.normalize(),Story.load(),storage=SimpleStore.create(Story.domId,!0),session=SimpleStore.create(Story.domId,!1),Dialog.init(),UIBar.init(),Engine.init(),Story.init(),L10n.init(),session.has("rcWarn")||"cookie"!==storage.name||(session.set("rcWarn",1),window.alert(L10n.get("warningNoWebStorage"))),Save.init(),Setting.init(),Macro.init(),Engine.start(),Config.debug&&DebugBar.init();var $window=$(window),vprCheckId=setInterval((function(){$window.width()&&(clearInterval(vprCheckId),UIBar.start(),Config.debug&&DebugBar.start(),jQuery.event.trigger({type:":storyready"}),setTimeout((function(){return LoadScreen.unlock(lockId)}),2*Engine.minDomActionDelay))}),Engine.minDomActionDelay);Object.defineProperty(window,"SugarCube",{value:Object.seal(Object.assign(Object.create(null),{Browser:Browser,Config:Config,Dialog:Dialog,Engine:Engine,Fullscreen:Fullscreen,Has:Has,L10n:L10n,Macro:Macro,Passage:Passage,Save:Save,Scripting:Scripting,Setting:Setting,SimpleAudio:SimpleAudio,State:State,Story:Story,UI:UI,UIBar:UIBar,DebugBar:DebugBar,Util:Util,Visibility:Visibility,Wikifier:Wikifier,session:session,settings:settings,setup:setup,storage:storage,version:version}))})}catch(ex){return console.error(ex),LoadScreen.clear(),Alert.fatal(null,ex.message,ex)}}))})(window,window.document,jQuery);}
	</script>
</body>
</html>
